{"version":3,"file":"create-image-source.js","names":["ImageService","WMSService","ArcGISImageServer","SERVICES","createImageSource","props","type","serviceType","guessServiceType","url","Error","Service","testURL"],"sources":["../../../src/lib/create-image-source.ts"],"sourcesContent":["// loaders.gl, MIT license\n\nimport {ImageSource} from './sources/image-source';\nimport {ImageService, ImageServiceProps} from './services/generic/image-service';\nimport type {WMSServiceProps} from './services/ogc/wms-service';\nimport {WMSService} from './services/ogc/wms-service';\nimport {ArcGISImageServer} from './services/arcgis/arcgis-image-service';\n\nexport type ImageServiceType = 'wms' | 'arcgis-image-server' | 'template';\n\nconst SERVICES = [WMSService, ArcGISImageServer, ImageService];\n\ntype ImageSourceProps = ImageServiceProps &\n  WMSServiceProps & {\n    type?: ImageServiceType | 'auto';\n  };\n\n/**\n * Creates an image source\n * If type is not supplied, will try to automatically detect the the\n * @param url URL to the image source\n * @param type type of source. if not known, set to 'auto'\n * @returns an ImageSource instance\n */\nexport function createImageSource(props: ImageSourceProps): ImageSource<ImageSourceProps> {\n  const {type = 'auto'} = props;\n  const serviceType = type === 'auto' ? guessServiceType(props.url) : type;\n  switch (serviceType) {\n    case 'template':\n      return new ImageService(props);\n    case 'wms':\n      return new WMSService(props);\n    default:\n      // currently only wms service supported\n      throw new Error('Not a valid image source type');\n  }\n}\n\n/** Guess service type from URL */\nfunction guessServiceType(url: string): ImageServiceType {\n  for (const Service of SERVICES) {\n    if (Service.testURL && Service.testURL(url)) {\n      return Service.type;\n    }\n  }\n  // If all else fails, guess that this is MS service\n  return 'wms';\n}\n"],"mappings":"AAGA,SAAQA,YAAY,QAA0B,kCAAkC;AAEhF,SAAQC,UAAU,QAAO,4BAA4B;AACrD,SAAQC,iBAAiB,QAAO,wCAAwC;AAIxE,MAAMC,QAAQ,GAAG,CAACF,UAAU,EAAEC,iBAAiB,EAAEF,YAAY,CAAC;AAc9D,OAAO,SAASI,iBAAiBA,CAACC,KAAuB,EAAiC;EACxF,MAAM;IAACC,IAAI,GAAG;EAAM,CAAC,GAAGD,KAAK;EAC7B,MAAME,WAAW,GAAGD,IAAI,KAAK,MAAM,GAAGE,gBAAgB,CAACH,KAAK,CAACI,GAAG,CAAC,GAAGH,IAAI;EACxE,QAAQC,WAAW;IACjB,KAAK,UAAU;MACb,OAAO,IAAIP,YAAY,CAACK,KAAK,CAAC;IAChC,KAAK,KAAK;MACR,OAAO,IAAIJ,UAAU,CAACI,KAAK,CAAC;IAC9B;MAEE,MAAM,IAAIK,KAAK,CAAC,+BAA+B,CAAC;EACpD;AACF;AAGA,SAASF,gBAAgBA,CAACC,GAAW,EAAoB;EACvD,KAAK,MAAME,OAAO,IAAIR,QAAQ,EAAE;IAC9B,IAAIQ,OAAO,CAACC,OAAO,IAAID,OAAO,CAACC,OAAO,CAACH,GAAG,CAAC,EAAE;MAC3C,OAAOE,OAAO,CAACL,IAAI;IACrB;EACF;EAEA,OAAO,KAAK;AACd"}