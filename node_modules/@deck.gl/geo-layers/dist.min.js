(function webpackUniversalModuleDefinition(root, factory) {
  if (typeof exports === 'object' && typeof module === 'object')
    module.exports = factory();
  else if (typeof define === 'function' && define.amd) define([], factory);
        else if (typeof exports === 'object') exports['deck'] = factory();
  else root['deck'] = factory();})(globalThis, function () {
"use strict";var __exports__=(()=>{var BM=Object.create;var Lo=Object.defineProperty;var MM=Object.getOwnPropertyDescriptor;var OM=Object.getOwnPropertyNames;var PM=Object.getPrototypeOf,IM=Object.prototype.hasOwnProperty;var Mv=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(r,t)=>(typeof require<"u"?require:r)[t]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var Z=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),Gt=(e,r)=>{for(var t in r)Lo(e,t,{get:r[t],enumerable:!0})},Fo=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of OM(r))!IM.call(e,a)&&a!==t&&Lo(e,a,{get:()=>r[a],enumerable:!(n=MM(r,a))||n.enumerable});return e},Fr=(e,r,t)=>(Fo(e,r,"default"),t&&Fo(t,r,"default")),m=(e,r,t)=>(t=e!=null?BM(PM(e)):{},Fo(r||!e||!e.__esModule?Lo(t,"default",{value:e,enumerable:!0}):t,e)),RM=e=>Fo(Lo({},"__esModule",{value:!0}),e);var Nt=Z((B8,Ov)=>{Ov.exports=globalThis.deck});var Rv=Z((O8,Iv)=>{function FM(e){if(Array.isArray(e))return e}Iv.exports=FM});var Lv=Z((P8,Fv)=>{function LM(e,r){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]"){var t=[],n=!0,a=!1,i=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(u){a=!0,i=u}finally{try{!n&&o.return!=null&&o.return()}finally{if(a)throw i}}return t}}Fv.exports=LM});var Dv=Z((I8,kv)=>{function kM(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}kv.exports=kM});var ie=Z((R8,Gv)=>{var DM=Rv(),GM=Lv(),NM=Dv();function UM(e,r){return DM(e)||GM(e,r)||NM()}Gv.exports=UM});var K=Z((F8,Uv)=>{function Nv(e,r,t,n,a,i,o){try{var s=e[i](o),u=s.value}catch(f){t(f);return}s.done?r(u):Promise.resolve(u).then(n,a)}function jM(e){return function(){var r=this,t=arguments;return new Promise(function(n,a){var i=e.apply(r,t);function o(u){Nv(i,n,a,o,s,"next",u)}function s(u){Nv(i,n,a,o,s,"throw",u)}o(void 0)})}}Uv.exports=jM});var H=Z((L8,jv)=>{function HM(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}jv.exports=HM});var z=Z((k8,Vv)=>{function Hv(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function VM(e,r,t){return r&&Hv(e.prototype,r),t&&Hv(e,t),e}Vv.exports=VM});var wt=Z((D8,zv)=>{function zM(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}zv.exports=zM});var be=Z((G8,Hf)=>{function jf(e){return Hf.exports=jf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},jf(e)}Hf.exports=jf});var qv=Z((N8,Wv)=>{var WM=be();function qM(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=WM(e),e!==null););return e}Wv.exports=qM});var dn=Z((U8,Do)=>{var JM=qv();function ko(e,r,t){return typeof Reflect<"u"&&Reflect.get?Do.exports=ko=Reflect.get:Do.exports=ko=function(a,i,o){var s=JM(a,i);if(s){var u=Object.getOwnPropertyDescriptor(s,i);return u.get?u.get.call(o):u.value}},ko(e,r,t||e)}Do.exports=ko});var Wf=Z((j8,zf)=>{function Vf(e,r){return zf.exports=Vf=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Vf(e,r)}zf.exports=Vf});var Te=Z((H8,Jv)=>{var XM=Wf();function KM(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&XM(e,r)}Jv.exports=KM});var Ge=Z((V8,No)=>{function Go(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?No.exports=Go=function(t){return typeof t}:No.exports=Go=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Go(e)}No.exports=Go});var xe=Z((z8,Xv)=>{var YM=Ge(),ZM=wt();function $M(e,r){return r&&(YM(r)==="object"||typeof r=="function")?r:ZM(e)}Xv.exports=$M});var W=Z((W8,Kv)=>{function QM(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}Kv.exports=QM});var Zv=Z((q8,qf)=>{var Yv=function(e){"use strict";var r=Object.prototype,t=r.hasOwnProperty,n,a=typeof Symbol=="function"?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(O,P,R,j){var G=P&&P.prototype instanceof v?P:v,V=Object.create(G.prototype),X=new L(j||[]);return V._invoke=M(O,R,X),V}e.wrap=u;function f(O,P,R){try{return{type:"normal",arg:O.call(P,R)}}catch(j){return{type:"throw",arg:j}}}var l="suspendedStart",c="suspendedYield",h="executing",d="completed",p={};function v(){}function y(){}function A(){}var _={};_[i]=function(){return this};var E=Object.getPrototypeOf,x=E&&E(E(k([])));x&&x!==r&&t.call(x,i)&&(_=x);var C=A.prototype=v.prototype=Object.create(_);y.prototype=C.constructor=A,A.constructor=y,A[s]=y.displayName="GeneratorFunction";function B(O){["next","throw","return"].forEach(function(P){O[P]=function(R){return this._invoke(P,R)}})}e.isGeneratorFunction=function(O){var P=typeof O=="function"&&O.constructor;return P?P===y||(P.displayName||P.name)==="GeneratorFunction":!1},e.mark=function(O){return Object.setPrototypeOf?Object.setPrototypeOf(O,A):(O.__proto__=A,s in O||(O[s]="GeneratorFunction")),O.prototype=Object.create(C),O},e.awrap=function(O){return{__await:O}};function F(O){function P(G,V,X,ne){var ke=f(O[G],O,V);if(ke.type==="throw")ne(ke.arg);else{var Oe=ke.arg,Et=Oe.value;return Et&&typeof Et=="object"&&t.call(Et,"__await")?Promise.resolve(Et.__await).then(function(He){P("next",He,X,ne)},function(He){P("throw",He,X,ne)}):Promise.resolve(Et).then(function(He){Oe.value=He,X(Oe)},function(He){return P("throw",He,X,ne)})}}var R;function j(G,V){function X(){return new Promise(function(ne,ke){P(G,V,ne,ke)})}return R=R?R.then(X,X):X()}this._invoke=j}B(F.prototype),F.prototype[o]=function(){return this},e.AsyncIterator=F,e.async=function(O,P,R,j){var G=new F(u(O,P,R,j));return e.isGeneratorFunction(P)?G:G.next().then(function(V){return V.done?V.value:G.next()})};function M(O,P,R){var j=l;return function(V,X){if(j===h)throw new Error("Generator is already running");if(j===d){if(V==="throw")throw X;return D()}for(R.method=V,R.arg=X;;){var ne=R.delegate;if(ne){var ke=w(ne,R);if(ke){if(ke===p)continue;return ke}}if(R.method==="next")R.sent=R._sent=R.arg;else if(R.method==="throw"){if(j===l)throw j=d,R.arg;R.dispatchException(R.arg)}else R.method==="return"&&R.abrupt("return",R.arg);j=h;var Oe=f(O,P,R);if(Oe.type==="normal"){if(j=R.done?d:c,Oe.arg===p)continue;return{value:Oe.arg,done:R.done}}else Oe.type==="throw"&&(j=d,R.method="throw",R.arg=Oe.arg)}}}function w(O,P){var R=O.iterator[P.method];if(R===n){if(P.delegate=null,P.method==="throw"){if(O.iterator.return&&(P.method="return",P.arg=n,w(O,P),P.method==="throw"))return p;P.method="throw",P.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var j=f(R,O.iterator,P.arg);if(j.type==="throw")return P.method="throw",P.arg=j.arg,P.delegate=null,p;var G=j.arg;if(!G)return P.method="throw",P.arg=new TypeError("iterator result is not an object"),P.delegate=null,p;if(G.done)P[O.resultName]=G.value,P.next=O.nextLoc,P.method!=="return"&&(P.method="next",P.arg=n);else return G;return P.delegate=null,p}B(C),C[s]="Generator",C[i]=function(){return this},C.toString=function(){return"[object Generator]"};function b(O){var P={tryLoc:O[0]};1 in O&&(P.catchLoc=O[1]),2 in O&&(P.finallyLoc=O[2],P.afterLoc=O[3]),this.tryEntries.push(P)}function I(O){var P=O.completion||{};P.type="normal",delete P.arg,O.completion=P}function L(O){this.tryEntries=[{tryLoc:"root"}],O.forEach(b,this),this.reset(!0)}e.keys=function(O){var P=[];for(var R in O)P.push(R);return P.reverse(),function j(){for(;P.length;){var G=P.pop();if(G in O)return j.value=G,j.done=!1,j}return j.done=!0,j}};function k(O){if(O){var P=O[i];if(P)return P.call(O);if(typeof O.next=="function")return O;if(!isNaN(O.length)){var R=-1,j=function G(){for(;++R<O.length;)if(t.call(O,R))return G.value=O[R],G.done=!1,G;return G.value=n,G.done=!0,G};return j.next=j}}return{next:D}}e.values=k;function D(){return{value:n,done:!0}}return L.prototype={constructor:L,reset:function(O){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(I),!O)for(var P in this)P.charAt(0)==="t"&&t.call(this,P)&&!isNaN(+P.slice(1))&&(this[P]=n)},stop:function(){this.done=!0;var O=this.tryEntries[0],P=O.completion;if(P.type==="throw")throw P.arg;return this.rval},dispatchException:function(O){if(this.done)throw O;var P=this;function R(ke,Oe){return V.type="throw",V.arg=O,P.next=ke,Oe&&(P.method="next",P.arg=n),!!Oe}for(var j=this.tryEntries.length-1;j>=0;--j){var G=this.tryEntries[j],V=G.completion;if(G.tryLoc==="root")return R("end");if(G.tryLoc<=this.prev){var X=t.call(G,"catchLoc"),ne=t.call(G,"finallyLoc");if(X&&ne){if(this.prev<G.catchLoc)return R(G.catchLoc,!0);if(this.prev<G.finallyLoc)return R(G.finallyLoc)}else if(X){if(this.prev<G.catchLoc)return R(G.catchLoc,!0)}else if(ne){if(this.prev<G.finallyLoc)return R(G.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(O,P){for(var R=this.tryEntries.length-1;R>=0;--R){var j=this.tryEntries[R];if(j.tryLoc<=this.prev&&t.call(j,"finallyLoc")&&this.prev<j.finallyLoc){var G=j;break}}G&&(O==="break"||O==="continue")&&G.tryLoc<=P&&P<=G.finallyLoc&&(G=null);var V=G?G.completion:{};return V.type=O,V.arg=P,G?(this.method="next",this.next=G.finallyLoc,p):this.complete(V)},complete:function(O,P){if(O.type==="throw")throw O.arg;return O.type==="break"||O.type==="continue"?this.next=O.arg:O.type==="return"?(this.rval=this.arg=O.arg,this.method="return",this.next="end"):O.type==="normal"&&P&&(this.next=P),p},finish:function(O){for(var P=this.tryEntries.length-1;P>=0;--P){var R=this.tryEntries[P];if(R.finallyLoc===O)return this.complete(R.completion,R.afterLoc),I(R),p}},catch:function(O){for(var P=this.tryEntries.length-1;P>=0;--P){var R=this.tryEntries[P];if(R.tryLoc===O){var j=R.completion;if(j.type==="throw"){var G=j.arg;I(R)}return G}}throw new Error("illegal catch attempt")},delegateYield:function(O,P,R){return this.delegate={iterator:k(O),resultName:P,nextLoc:R},this.method==="next"&&(this.arg=n),p}},e}(typeof qf=="object"?qf.exports:{});try{regeneratorRuntime=Yv}catch{Function("r","regeneratorRuntime = r")(Yv)}});var Y=Z((J8,$v)=>{$v.exports=Zv()});var Ut=Z((X8,Qv)=>{Qv.exports=globalThis.deck});var Jf=Z(cr=>{"use strict";var eg=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",eO=eg+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",tg="["+eg+"]["+eO+"]*",tO=new RegExp("^"+tg+"$"),rO=function(r,t){for(var n=[],a=t.exec(r);a;){var i=[];i.startIndex=t.lastIndex-a[0].length;for(var o=a.length,s=0;s<o;s++)i.push(a[s]);n.push(i),a=t.exec(r)}return n},nO=function(r){var t=tO.exec(r);return!(t===null||typeof t>"u")};cr.isExist=function(e){return typeof e<"u"};cr.isEmptyObject=function(e){return Object.keys(e).length===0};cr.merge=function(e,r,t){if(r)for(var n=Object.keys(r),a=n.length,i=0;i<a;i++)t==="strict"?e[n[i]]=[r[n[i]]]:e[n[i]]=r[n[i]]};cr.getValue=function(e){return cr.isExist(e)?e:""};cr.isName=nO;cr.getAllMatches=rO;cr.nameRegexp=tg});var Kf=Z(og=>{"use strict";var Xf=Jf(),aO={allowBooleanAttributes:!1,unpairedTags:[]};og.validate=function(e,r){r=Object.assign({},aO,r);var t=[],n=!1,a=!1;e[0]==="\uFEFF"&&(e=e.substr(1));for(var i=0;i<e.length;i++)if(e[i]==="<"&&e[i+1]==="?"){if(i+=2,i=ng(e,i),i.err)return i}else if(e[i]==="<"){var o=i;if(i++,e[i]==="!"){i=ag(e,i);continue}else{var s=!1;e[i]==="/"&&(s=!0,i++);for(var u="";i<e.length&&e[i]!==">"&&e[i]!==" "&&e[i]!=="	"&&e[i]!==`
`&&e[i]!=="\r";i++)u+=e[i];if(u=u.trim(),u[u.length-1]==="/"&&(u=u.substring(0,u.length-1),i--),!hO(u)){var f=void 0;return u.trim().length===0?f="Invalid space after '<'.":f="Tag '"+u+"' is an invalid name.",Ve("InvalidTag",f,vt(e,i))}var l=sO(e,i);if(l===!1)return Ve("InvalidAttr","Attributes for '"+u+"' have open quote.",vt(e,i));var c=l.value;if(i=l.index,c[c.length-1]==="/"){var h=i-c.length;c=c.substring(0,c.length-1);var d=ig(c,r);if(d===!0)n=!0;else return Ve(d.err.code,d.err.msg,vt(e,h+d.err.line))}else if(s)if(l.tagClosed){if(c.trim().length>0)return Ve("InvalidTag","Closing tag '"+u+"' can't have attributes or invalid starting.",vt(e,o));var p=t.pop();if(u!==p.tagName){var v=vt(e,p.tagStartPos);return Ve("InvalidTag","Expected closing tag '"+p.tagName+"' (opened in line "+v.line+", col "+v.col+") instead of closing tag '"+u+"'.",vt(e,o))}t.length==0&&(a=!0)}else return Ve("InvalidTag","Closing tag '"+u+"' doesn't have proper closing.",vt(e,i));else{var y=ig(c,r);if(y!==!0)return Ve(y.err.code,y.err.msg,vt(e,i-c.length+y.err.line));if(a===!0)return Ve("InvalidXml","Multiple possible root nodes found.",vt(e,i));r.unpairedTags.indexOf(u)!==-1||t.push({tagName:u,tagStartPos:o}),n=!0}for(i++;i<e.length;i++)if(e[i]==="<")if(e[i+1]==="!"){i++,i=ag(e,i);continue}else if(e[i+1]==="?"){if(i=ng(e,++i),i.err)return i}else break;else if(e[i]==="&"){var A=lO(e,i);if(A==-1)return Ve("InvalidChar","char '&' is not expected.",vt(e,i));i=A}else if(a===!0&&!rg(e[i]))return Ve("InvalidXml","Extra text at the end",vt(e,i));e[i]==="<"&&i--}}else{if(rg(e[i]))continue;return Ve("InvalidChar","char '"+e[i]+"' is not expected.",vt(e,i))}if(n){if(t.length==1)return Ve("InvalidTag","Unclosed tag '"+t[0].tagName+"'.",vt(e,t[0].tagStartPos));if(t.length>0)return Ve("InvalidXml","Invalid '"+JSON.stringify(t.map(function(_){return _.tagName}),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return Ve("InvalidXml","Start tag expected.",1);return!0};function rg(e){return e===" "||e==="	"||e===`
`||e==="\r"}function ng(e,r){for(var t=r;r<e.length;r++)if(e[r]=="?"||e[r]==" "){var n=e.substr(t,r-t);if(r>5&&n==="xml")return Ve("InvalidXml","XML declaration allowed only at the start of the document.",vt(e,r));if(e[r]=="?"&&e[r+1]==">"){r++;break}else continue}return r}function ag(e,r){if(e.length>r+5&&e[r+1]==="-"&&e[r+2]==="-"){for(r+=3;r<e.length;r++)if(e[r]==="-"&&e[r+1]==="-"&&e[r+2]===">"){r+=2;break}}else if(e.length>r+8&&e[r+1]==="D"&&e[r+2]==="O"&&e[r+3]==="C"&&e[r+4]==="T"&&e[r+5]==="Y"&&e[r+6]==="P"&&e[r+7]==="E"){var t=1;for(r+=8;r<e.length;r++)if(e[r]==="<")t++;else if(e[r]===">"&&(t--,t===0))break}else if(e.length>r+9&&e[r+1]==="["&&e[r+2]==="C"&&e[r+3]==="D"&&e[r+4]==="A"&&e[r+5]==="T"&&e[r+6]==="A"&&e[r+7]==="["){for(r+=8;r<e.length;r++)if(e[r]==="]"&&e[r+1]==="]"&&e[r+2]===">"){r+=2;break}}return r}var iO='"',oO="'";function sO(e,r){for(var t="",n="",a=!1;r<e.length;r++){if(e[r]===iO||e[r]===oO)n===""?n=e[r]:n!==e[r]||(n="");else if(e[r]===">"&&n===""){a=!0;break}t+=e[r]}return n!==""?!1:{value:t,index:r,tagClosed:a}}var uO=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function ig(e,r){for(var t=Xf.getAllMatches(e,uO),n={},a=0;a<t.length;a++){if(t[a][1].length===0)return Ve("InvalidAttr","Attribute '"+t[a][2]+"' has no space in starting.",ai(t[a]));if(t[a][3]!==void 0&&t[a][4]===void 0)return Ve("InvalidAttr","Attribute '"+t[a][2]+"' is without value.",ai(t[a]));if(t[a][3]===void 0&&!r.allowBooleanAttributes)return Ve("InvalidAttr","boolean attribute '"+t[a][2]+"' is not allowed.",ai(t[a]));var i=t[a][2];if(!cO(i))return Ve("InvalidAttr","Attribute '"+i+"' is an invalid name.",ai(t[a]));if(!n.hasOwnProperty(i))n[i]=1;else return Ve("InvalidAttr","Attribute '"+i+"' is repeated.",ai(t[a]))}return!0}function fO(e,r){var t=/\d/;for(e[r]==="x"&&(r++,t=/[\da-fA-F]/);r<e.length;r++){if(e[r]===";")return r;if(!e[r].match(t))break}return-1}function lO(e,r){if(r++,e[r]===";")return-1;if(e[r]==="#")return r++,fO(e,r);for(var t=0;r<e.length;r++,t++)if(!(e[r].match(/\w/)&&t<20)){if(e[r]===";")break;return-1}return r}function Ve(e,r,t){return{err:{code:e,msg:r,line:t.line||t,col:t.col}}}function cO(e){return Xf.isName(e)}function hO(e){return Xf.isName(e)}function vt(e,r){var t=e.substring(0,r).split(/\r?\n/);return{line:t.length,col:t[t.length-1].length+1}}function ai(e){return e.startIndex+e[1].length}});var ug=Z(Yf=>{var sg={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(r,t){return t},attributeValueProcessor:function(r,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:function(){return!1},commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(r,t,n){return r}},dO=function(r){return Object.assign({},sg,r)};Yf.buildOptions=dO;Yf.defaultOptions=sg});var hg=Z((Q8,cg)=>{"use strict";var ii=m(W()),fg=m(H()),lg=m(z()),pO=function(){function e(r){(0,fg.default)(this,e),this.tagname=r,this.child=[],this[":@"]={}}return(0,lg.default)(e,[{key:"add",value:function(t,n){t==="__proto__"&&(t="#__proto__"),this.child.push((0,ii.default)({},t,n))}},{key:"addChild",value:function(t){if(t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0){var n;this.child.push((n={},(0,ii.default)(n,t.tagname,t.child),(0,ii.default)(n,":@",t[":@"]),n))}else this.child.push((0,ii.default)({},t.tagname,t.child))}}]),e}();cg.exports=pO});var mg=Z((e4,pg)=>{var dg=m(ie());function mO(e,r){var t={};if(e[r+3]==="O"&&e[r+4]==="C"&&e[r+5]==="T"&&e[r+6]==="Y"&&e[r+7]==="P"&&e[r+8]==="E"){r=r+9;for(var n=1,a=!1,i=!1,o="";r<e.length;r++)if(e[r]==="<"&&!i){if(a&&yO(e,r)){r+=7;var s=vO(e,r+1),u=(0,dg.default)(s,3);entityName=u[0],val=u[1],r=u[2],val.indexOf("&")===-1&&(t[entityName]={regx:RegExp("&".concat(entityName,";"),"g"),val})}else if(a&&AO(e,r))r+=8;else if(a&&_O(e,r))r+=8;else if(a&&bO(e,r))r+=9;else if(gO)i=!0;else throw new Error("Invalid DOCTYPE");n++,o=""}else if(e[r]===">"){if(i?e[r-1]==="-"&&e[r-2]==="-"&&(i=!1,n--):n--,n===0)break}else e[r]==="["?a=!0:o+=e[r];if(n!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:t,i:r}}function vO(e,r){for(var t="";r<e.length&&e[r]!=="'"&&e[r]!=='"';r++)t+=e[r];if(t=t.trim(),t.indexOf(" ")!==-1)throw new Error("External entites are not supported");for(var n=e[r++],a="";r<e.length&&e[r]!==n;r++)a+=e[r];return[t,a,r]}function gO(e,r){return e[r+1]==="!"&&e[r+2]==="-"&&e[r+3]==="-"}function yO(e,r){return e[r+1]==="!"&&e[r+2]==="E"&&e[r+3]==="N"&&e[r+4]==="T"&&e[r+5]==="I"&&e[r+6]==="T"&&e[r+7]==="Y"}function AO(e,r){return e[r+1]==="!"&&e[r+2]==="E"&&e[r+3]==="L"&&e[r+4]==="E"&&e[r+5]==="M"&&e[r+6]==="E"&&e[r+7]==="N"&&e[r+8]==="T"}function _O(e,r){return e[r+1]==="!"&&e[r+2]==="A"&&e[r+3]==="T"&&e[r+4]==="T"&&e[r+5]==="L"&&e[r+6]==="I"&&e[r+7]==="S"&&e[r+8]==="T"}function bO(e,r){return e[r+1]==="!"&&e[r+2]==="N"&&e[r+3]==="O"&&e[r+4]==="T"&&e[r+5]==="A"&&e[r+6]==="T"&&e[r+7]==="I"&&e[r+8]==="O"&&e[r+9]==="N"}pg.exports=mO});var gg=Z((t4,vg)=>{var TO=/^[-+]?0x[a-fA-F0-9]+$/,xO=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);var EO={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function SO(e,r={}){if(r=Object.assign({},EO,r),!e||typeof e!="string")return e;let t=e.trim();if(r.skipLike!==void 0&&r.skipLike.test(t))return e;if(r.hex&&TO.test(t))return Number.parseInt(t,16);{let n=xO.exec(t);if(n){let a=n[1],i=n[2],o=wO(n[3]),s=n[4]||n[6];if(!r.leadingZeros&&i.length>0&&a&&t[2]!==".")return e;if(!r.leadingZeros&&i.length>0&&!a&&t[1]!==".")return e;{let u=Number(t),f=""+u;return f.search(/[eE]/)!==-1||s?r.eNotation?u:e:t.indexOf(".")!==-1?f==="0"&&o===""||f===o||a&&f==="-"+o?u:e:i?o===f||a+o===f?u:e:t===f||t===a+f?u:e}}else return e}}function wO(e){return e&&e.indexOf(".")!==-1&&(e=e.replace(/0+$/,""),e==="."?e="0":e[0]==="."?e="0"+e:e[e.length-1]==="."&&(e=e.substr(0,e.length-1))),e}vg.exports=SO});var _g=Z((n4,Ag)=>{"use strict";var Zf=m(W()),si=m(Ge()),yg=m(H()),el=Jf(),oi=hg(),CO=mg(),BO=gg(),r4="<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,el.nameRegexp),MO=function e(r){(0,yg.default)(this,e),this.options=r,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"\xA2"},pound:{regex:/&(pound|#163);/g,val:"\xA3"},yen:{regex:/&(yen|#165);/g,val:"\xA5"},euro:{regex:/&(euro|#8364);/g,val:"\u20AC"},copyright:{regex:/&(copy|#169);/g,val:"\xA9"},reg:{regex:/&(reg|#174);/g,val:"\xAE"},inr:{regex:/&(inr|#8377);/g,val:"\u20B9"}},this.addExternalEntities=OO,this.parseXml=LO,this.parseTextData=PO,this.resolveNameSpace=IO,this.buildAttributesMap=FO,this.isItStopNode=NO,this.replaceEntitiesValue=DO,this.readStopNodeData=jO,this.saveTextToParentTag=GO,this.addChild=kO};function OO(e){for(var r=Object.keys(e),t=0;t<r.length;t++){var n=r[t];this.lastEntities[n]={regex:new RegExp("&"+n+";","g"),val:e[n]}}}function PO(e,r,t,n,a,i,o){if(e!==void 0&&(this.options.trimValues&&!n&&(e=e.trim()),e.length>0)){o||(e=this.replaceEntitiesValue(e));var s=this.options.tagValueProcessor(r,e,t,a,i);if(s==null)return e;if((0,si.default)(s)!==(0,si.default)(e)||s!==e)return s;if(this.options.trimValues)return Qf(e,this.options.parseTagValue,this.options.numberParseOptions);var u=e.trim();return u===e?Qf(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function IO(e){if(this.options.removeNSPrefix){var r=e.split(":"),t=e.charAt(0)==="/"?"/":"";if(r[0]==="xmlns")return"";r.length===2&&(e=t+r[1])}return e}var RO=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function FO(e,r,t){if(!this.options.ignoreAttributes&&typeof e=="string"){for(var n=el.getAllMatches(e,RO),a=n.length,i={},o=0;o<a;o++){var s=this.resolveNameSpace(n[o][1]),u=n[o][4],f=this.options.attributeNamePrefix+s;if(s.length)if(this.options.transformAttributeName&&(f=this.options.transformAttributeName(f)),f==="__proto__"&&(f="#__proto__"),u!==void 0){this.options.trimValues&&(u=u.trim()),u=this.replaceEntitiesValue(u);var l=this.options.attributeValueProcessor(s,u,r);l==null?i[f]=u:(0,si.default)(l)!==(0,si.default)(u)||l!==u?i[f]=l:i[f]=Qf(u,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(i[f]=!0)}if(!Object.keys(i).length)return;if(this.options.attributesGroupName){var c={};return c[this.options.attributesGroupName]=i,c}return i}}var LO=function(r){r=r.replace(/\r\n?/g,`
`);for(var t=new oi("!xml"),n=t,a="",i="",o=0;o<r.length;o++){var s=r[o];if(s==="<")if(r[o+1]==="/"){var u=pn(r,">",o,"Closing Tag is not closed."),f=r.substring(o+2,u).trim();if(this.options.removeNSPrefix){var l=f.indexOf(":");l!==-1&&(f=f.substr(l+1))}this.options.transformTagName&&(f=this.options.transformTagName(f)),n&&(a=this.saveTextToParentTag(a,n,i));var c=i.substring(i.lastIndexOf(".")+1);if(f&&this.options.unpairedTags.indexOf(f)!==-1)throw new Error("Unpaired tag can not be used as closing tag: </".concat(f,">"));var h=0;c&&this.options.unpairedTags.indexOf(c)!==-1?(h=i.lastIndexOf(".",i.lastIndexOf(".")-1),this.tagsNodeStack.pop()):h=i.lastIndexOf("."),i=i.substring(0,h),n=this.tagsNodeStack.pop(),a="",o=u}else if(r[o+1]==="?"){var d=$f(r,o,!1,"?>");if(!d)throw new Error("Pi Tag is not closed.");if(a=this.saveTextToParentTag(a,n,i),!(this.options.ignoreDeclaration&&d.tagName==="?xml"||this.options.ignorePiTags)){var p=new oi(d.tagName);p.add(this.options.textNodeName,""),d.tagName!==d.tagExp&&d.attrExpPresent&&(p[":@"]=this.buildAttributesMap(d.tagExp,i,d.tagName)),this.addChild(n,p,i)}o=d.closeIndex+1}else if(r.substr(o+1,3)==="!--"){var v=pn(r,"-->",o+4,"Comment is not closed.");if(this.options.commentPropName){var y=r.substring(o+4,v-2);a=this.saveTextToParentTag(a,n,i),n.add(this.options.commentPropName,[(0,Zf.default)({},this.options.textNodeName,y)])}o=v}else if(r.substr(o+1,2)==="!D"){var A=CO(r,o);this.docTypeEntities=A.entities,o=A.i}else if(r.substr(o+1,2)==="!["){var _=pn(r,"]]>",o,"CDATA is not closed.")-2,E=r.substring(o+9,_);if(a=this.saveTextToParentTag(a,n,i),this.options.cdataPropName)n.add(this.options.cdataPropName,[(0,Zf.default)({},this.options.textNodeName,E)]);else{var x=this.parseTextData(E,n.tagname,i,!0,!1,!0);x==null&&(x=""),n.add(this.options.textNodeName,x)}o=_+2}else{var C=$f(r,o,this.options.removeNSPrefix),B=C.tagName,F=C.tagExp,M=C.attrExpPresent,w=C.closeIndex;this.options.transformTagName&&(B=this.options.transformTagName(B)),n&&a&&n.tagname!=="!xml"&&(a=this.saveTextToParentTag(a,n,i,!1));var b=n;if(b&&this.options.unpairedTags.indexOf(b.tagname)!==-1&&(n=this.tagsNodeStack.pop(),i=i.substring(0,i.lastIndexOf("."))),B!==t.tagname&&(i+=i?"."+B:B),this.isItStopNode(this.options.stopNodes,i,B)){var I="";if(F.length>0&&F.lastIndexOf("/")===F.length-1)o=C.closeIndex;else if(this.options.unpairedTags.indexOf(B)!==-1)o=C.closeIndex;else{var L=this.readStopNodeData(r,B,w+1);if(!L)throw new Error("Unexpected end of ".concat(B));o=L.i,I=L.tagContent}var k=new oi(B);B!==F&&M&&(k[":@"]=this.buildAttributesMap(F,i,B)),I&&(I=this.parseTextData(I,B,i,!0,M,!0,!0)),i=i.substr(0,i.lastIndexOf(".")),k.add(this.options.textNodeName,I),this.addChild(n,k,i)}else{if(F.length>0&&F.lastIndexOf("/")===F.length-1){B[B.length-1]==="/"?(B=B.substr(0,B.length-1),F=B):F=F.substr(0,F.length-1),this.options.transformTagName&&(B=this.options.transformTagName(B));var D=new oi(B);B!==F&&M&&(D[":@"]=this.buildAttributesMap(F,i,B)),this.addChild(n,D,i),i=i.substr(0,i.lastIndexOf("."))}else{var O=new oi(B);this.tagsNodeStack.push(n),B!==F&&M&&(O[":@"]=this.buildAttributesMap(F,i,B)),this.addChild(n,O,i),n=O}a="",o=w}}else a+=r[o]}return t.child};function kO(e,r,t){var n=this.options.updateTag(r.tagname,t,r[":@"]);n===!1||(typeof n=="string"&&(r.tagname=n),e.addChild(r))}var DO=function(r){if(this.options.processEntities){for(var t in this.docTypeEntities){var n=this.docTypeEntities[t];r=r.replace(n.regx,n.val)}for(var a in this.lastEntities){var i=this.lastEntities[a];r=r.replace(i.regex,i.val)}if(this.options.htmlEntities)for(var o in this.htmlEntities){var s=this.htmlEntities[o];r=r.replace(s.regex,s.val)}r=r.replace(this.ampEntity.regex,this.ampEntity.val)}return r};function GO(e,r,t,n){return e&&(n===void 0&&(n=Object.keys(r.child).length===0),e=this.parseTextData(e,r.tagname,t,!1,r[":@"]?Object.keys(r[":@"]).length!==0:!1,n),e!==void 0&&e!==""&&r.add(this.options.textNodeName,e),e=""),e}function NO(e,r,t){var n="*."+t;for(var a in e){var i=e[a];if(n===i||r===i)return!0}return!1}function UO(e,r){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:">",n,a="",i=r;i<e.length;i++){var o=e[i];if(n)o===n&&(n="");else if(o==='"'||o==="'")n=o;else if(o===t[0])if(t[1]){if(e[i+1]===t[1])return{data:a,index:i}}else return{data:a,index:i};else o==="	"&&(o=" ");a+=o}}function pn(e,r,t,n){var a=e.indexOf(r,t);if(a===-1)throw new Error(n);return a+r.length-1}function $f(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:">",a=UO(e,r+1,n);if(a){var i=a.data,o=a.index,s=i.search(/\s/),u=i,f=!0;if(s!==-1&&(u=i.substr(0,s).replace(/\s\s*$/,""),i=i.substr(s+1)),t){var l=u.indexOf(":");l!==-1&&(u=u.substr(l+1),f=u!==a.data.substr(l+1))}return{tagName:u,tagExp:i,closeIndex:o,attrExpPresent:f}}}function jO(e,r,t){for(var n=t,a=1;t<e.length;t++)if(e[t]==="<")if(e[t+1]==="/"){var i=pn(e,">",t,"".concat(r," is not closed")),o=e.substring(t+2,i).trim();if(o===r&&(a--,a===0))return{tagContent:e.substring(n,t),i};t=i}else if(e[t+1]==="?"){var s=pn(e,"?>",t+1,"StopNode is not closed.");t=s}else if(e.substr(t+1,3)==="!--"){var u=pn(e,"-->",t+3,"StopNode is not closed.");t=u}else if(e.substr(t+1,2)==="!["){var f=pn(e,"]]>",t,"StopNode is not closed.")-2;t=f}else{var l=$f(e,t,">");if(l){var c=l&&l.tagName;c===r&&l.tagExp[l.tagExp.length-1]!=="/"&&a++,t=l.closeIndex}}}function Qf(e,r,t){if(r&&typeof e=="string"){var n=e.trim();return n==="true"?!0:n==="false"?!1:BO(e,t)}else return el.isExist(e)?e:""}Ag.exports=MO});var xg=Z(Tg=>{"use strict";function HO(e,r){return bg(e,r)}function bg(e,r,t){for(var n,a={},i=0;i<e.length;i++){var o=e[i],s=VO(o),u="";if(t===void 0?u=s:u=t+"."+s,s===r.textNodeName)n===void 0?n=o[s]:n+=""+o[s];else{if(s===void 0)continue;if(o[s]){var f=bg(o[s],r,u),l=WO(f,r);o[":@"]?zO(f,o[":@"],u,r):Object.keys(f).length===1&&f[r.textNodeName]!==void 0&&!r.alwaysCreateTextNode?f=f[r.textNodeName]:Object.keys(f).length===0&&(r.alwaysCreateTextNode?f[r.textNodeName]="":f=""),a[s]!==void 0&&a.hasOwnProperty(s)?(Array.isArray(a[s])||(a[s]=[a[s]]),a[s].push(f)):r.isArray(s,u,l)?a[s]=[f]:a[s]=f}}}return typeof n=="string"?n.length>0&&(a[r.textNodeName]=n):n!==void 0&&(a[r.textNodeName]=n),a}function VO(e){for(var r=Object.keys(e),t=0;t<r.length;t++){var n=r[t];if(n!==":@")return n}}function zO(e,r,t,n){if(r)for(var a=Object.keys(r),i=a.length,o=0;o<i;o++){var s=a[o];n.isArray(s,t+"."+s,!0,!0)?e[s]=[r[s]]:e[s]=r[s]}}function WO(e,r){var t=r.textNodeName,n=Object.keys(e).length;return!!(n===0||n===1&&(e[t]||typeof e[t]=="boolean"||e[t]===0))}Tg.prettify=HO});var Cg=Z((i4,wg)=>{var Eg=m(H()),Sg=m(z()),qO=ug(),JO=qO.buildOptions,XO=_g(),KO=xg(),YO=KO.prettify,ZO=Kf(),$O=function(){function e(r){(0,Eg.default)(this,e),this.externalEntities={},this.options=JO(r)}return(0,Sg.default)(e,[{key:"parse",value:function(t,n){if(typeof t!="string")if(t.toString)t=t.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(n){n===!0&&(n={});var a=ZO.validate(t,n);if(a!==!0)throw Error("".concat(a.err.msg,":").concat(a.err.line,":").concat(a.err.col))}var i=new XO(this.options);i.addExternalEntities(this.externalEntities);var o=i.parseXml(t);return this.options.preserveOrder||o===void 0?o:YO(o,this.options)}},{key:"addEntity",value:function(t,n){if(n.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(t.indexOf("&")!==-1||t.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(n==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[t]=n}}]),e}();wg.exports=$O});var Ig=Z((o4,Pg)=>{var QO=`
`;function e3(e,r){var t="";return r.format&&r.indentBy.length>0&&(t=QO),Mg(e,r,"",t)}function Mg(e,r,t,n){for(var a="",i=!1,o=0;o<e.length;o++){var s=e[o],u=t3(s),f="";if(t.length===0?f=u:f="".concat(t,".").concat(u),u===r.textNodeName){var l=s[u];r3(f,r)||(l=r.tagValueProcessor(u,l),l=Og(l,r)),i&&(a+=n),a+=l,i=!1;continue}else if(u===r.cdataPropName){i&&(a+=n),a+="<![CDATA[".concat(s[u][0][r.textNodeName],"]]>"),i=!1;continue}else if(u===r.commentPropName){a+=n+"<!--".concat(s[u][0][r.textNodeName],"-->"),i=!0;continue}else if(u[0]==="?"){var c=Bg(s[":@"],r),h=u==="?xml"?"":n,d=s[u][0][r.textNodeName];d=d.length!==0?" "+d:"",a+=h+"<".concat(u).concat(d).concat(c,"?>"),i=!0;continue}var p=n;p!==""&&(p+=r.indentBy);var v=Bg(s[":@"],r),y=n+"<".concat(u).concat(v),A=Mg(s[u],r,f,p);r.unpairedTags.indexOf(u)!==-1?r.suppressUnpairedNode?a+=y+">":a+=y+"/>":(!A||A.length===0)&&r.suppressEmptyNode?a+=y+"/>":A&&A.endsWith(">")?a+=y+">".concat(A).concat(n,"</").concat(u,">"):(a+=y+">",A&&n!==""&&(A.includes("/>")||A.includes("</"))?a+=n+r.indentBy+A+n:a+=A,a+="</".concat(u,">")),i=!0}return a}function t3(e){for(var r=Object.keys(e),t=0;t<r.length;t++){var n=r[t];if(n!==":@")return n}}function Bg(e,r){var t="";if(e&&!r.ignoreAttributes)for(var n in e){var a=r.attributeValueProcessor(n,e[n]);a=Og(a,r),a===!0&&r.suppressBooleanAttributes?t+=" ".concat(n.substr(r.attributeNamePrefix.length)):t+=" ".concat(n.substr(r.attributeNamePrefix.length),'="').concat(a,'"')}return t}function r3(e,r){e=e.substr(0,e.length-r.textNodeName.length-1);var t=e.substr(e.lastIndexOf(".")+1);for(var n in r.stopNodes)if(r.stopNodes[n]===e||r.stopNodes[n]==="*."+t)return!0;return!1}function Og(e,r){if(e&&e.length>0&&r.processEntities)for(var t=0;t<r.entities.length;t++){var n=r.entities[t];e=e.replace(n.regex,n.val)}return e}Pg.exports=e3});var Lg=Z((s4,Fg)=>{"use strict";var tl=m(Ge()),Rg=m(W()),n3=Ig(),a3={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(r,t){return t},attributeValueProcessor:function(r,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function Lr(e){this.options=Object.assign({},a3,e),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=s3),this.processTextOrObjNode=i3,this.options.format?(this.indentate=o3,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}Lr.prototype.build=function(e){return this.options.preserveOrder?n3(e,this.options):(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(e=(0,Rg.default)({},this.options.arrayNodeName,e)),this.j2x(e,0).val)};Lr.prototype.j2x=function(e,r){var t="",n="";for(var a in e)if(!(typeof e[a]>"u"))if(e[a]===null)a[0]==="?"?n+=this.indentate(r)+"<"+a+"?"+this.tagEndChar:n+=this.indentate(r)+"<"+a+"/"+this.tagEndChar;else if(e[a]instanceof Date)n+=this.buildTextValNode(e[a],a,"",r);else if((0,tl.default)(e[a])!=="object"){var i=this.isAttribute(a);if(i)t+=this.buildAttrPairStr(i,""+e[a]);else if(a===this.options.textNodeName){var o=this.options.tagValueProcessor(a,""+e[a]);n+=this.replaceEntitiesValue(o)}else n+=this.buildTextValNode(e[a],a,"",r)}else if(Array.isArray(e[a])){for(var s=e[a].length,u="",f=0;f<s;f++){var l=e[a][f];typeof l>"u"||(l===null?a[0]==="?"?n+=this.indentate(r)+"<"+a+"?"+this.tagEndChar:n+=this.indentate(r)+"<"+a+"/"+this.tagEndChar:(0,tl.default)(l)==="object"?this.options.oneListGroup?u+=this.j2x(l,r+1).val:u+=this.processTextOrObjNode(l,a,r):u+=this.buildTextValNode(l,a,"",r))}this.options.oneListGroup&&(u=this.buildObjectNode(u,a,"",r)),n+=u}else if(this.options.attributesGroupName&&a===this.options.attributesGroupName)for(var c=Object.keys(e[a]),h=c.length,d=0;d<h;d++)t+=this.buildAttrPairStr(c[d],""+e[a][c[d]]);else n+=this.processTextOrObjNode(e[a],a,r);return{attrStr:t,val:n}};Lr.prototype.buildAttrPairStr=function(e,r){return r=this.options.attributeValueProcessor(e,""+r),r=this.replaceEntitiesValue(r),this.options.suppressBooleanAttributes&&r==="true"?" "+e:" "+e+'="'+r+'"'};function i3(e,r,t){var n=this.j2x(e,t+1);return e[this.options.textNodeName]!==void 0&&Object.keys(e).length===1?this.buildTextValNode(e[this.options.textNodeName],r,n.attrStr,t):this.buildObjectNode(n.val,r,n.attrStr,t)}Lr.prototype.buildObjectNode=function(e,r,t,n){if(e==="")return r[0]==="?"?this.indentate(n)+"<"+r+t+"?"+this.tagEndChar:this.indentate(n)+"<"+r+t+this.closeTag(r)+this.tagEndChar;var a="</"+r+this.tagEndChar,i="";return r[0]==="?"&&(i="?",a=""),t&&e.indexOf("<")===-1?this.indentate(n)+"<"+r+t+i+">"+e+a:this.options.commentPropName!==!1&&r===this.options.commentPropName&&i.length===0?this.indentate(n)+"<!--".concat(e,"-->")+this.newLine:this.indentate(n)+"<"+r+t+i+this.tagEndChar+e+this.indentate(n)+a};Lr.prototype.closeTag=function(e){var r="";return this.options.unpairedTags.indexOf(e)!==-1?this.options.suppressUnpairedNode||(r="/"):this.options.suppressEmptyNode?r="/":r="></".concat(e),r};Lr.prototype.buildTextValNode=function(e,r,t,n){if(this.options.cdataPropName!==!1&&r===this.options.cdataPropName)return this.indentate(n)+"<![CDATA[".concat(e,"]]>")+this.newLine;if(this.options.commentPropName!==!1&&r===this.options.commentPropName)return this.indentate(n)+"<!--".concat(e,"-->")+this.newLine;if(r[0]==="?")return this.indentate(n)+"<"+r+t+"?"+this.tagEndChar;var a=this.options.tagValueProcessor(r,e);return a=this.replaceEntitiesValue(a),a===""?this.indentate(n)+"<"+r+t+this.closeTag(r)+this.tagEndChar:this.indentate(n)+"<"+r+t+">"+a+"</"+r+this.tagEndChar};Lr.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities)for(var r=0;r<this.options.entities.length;r++){var t=this.options.entities[r];e=e.replace(t.regex,t.val)}return e};function o3(e){return this.options.indentBy.repeat(e)}function s3(e){return e.startsWith(this.options.attributeNamePrefix)?e.substr(this.attrPrefixLen):!1}Fg.exports=Lr});var Dg=Z((u4,kg)=>{"use strict";var u3=Kf(),f3=Cg(),l3=Lg();kg.exports={XMLParser:f3,XMLValidator:u3,XMLBuilder:l3}});var ay=Z(()=>{});var _y=Z((y9,Ay)=>{function D3(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}Ay.exports=D3});var Ty=Z((A9,by)=>{function G3(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}by.exports=G3});var Ey=Z((_9,xy)=>{function N3(){throw new TypeError("Invalid attempt to spread non-iterable instance")}xy.exports=N3});var st=Z((b9,Sy)=>{var U3=_y(),j3=Ty(),H3=Ey();function V3(e){return U3(e)||j3(e)||H3()}Sy.exports=V3});var xc=Z((w1,Ii)=>{(function(e,r){typeof define=="function"&&define.amd?define([],r):typeof Mv=="function"&&typeof Ii=="object"&&Ii&&Ii.exports?Ii.exports=r():(e.dcodeIO=e.dcodeIO||{}).Long=r()})(w1,function(){"use strict";function e(w,b,I){this.low=w|0,this.high=b|0,this.unsigned=!!I}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1});function r(w){return(w&&w.__isLong__)===!0}e.isLong=r;var t={},n={};function a(w,b){var I,L,k;return b?(w>>>=0,(k=0<=w&&w<256)&&(L=n[w],L)?L:(I=o(w,(w|0)<0?-1:0,!0),k&&(n[w]=I),I)):(w|=0,(k=-128<=w&&w<128)&&(L=t[w],L)?L:(I=o(w,w<0?-1:0,!1),k&&(t[w]=I),I))}e.fromInt=a;function i(w,b){if(isNaN(w)||!isFinite(w))return b?A:y;if(b){if(w<0)return A;if(w>=d)return B}else{if(w<=-p)return F;if(w+1>=p)return C}return w<0?i(-w,b).neg():o(w%h|0,w/h|0,b)}e.fromNumber=i;function o(w,b,I){return new e(w,b,I)}e.fromBits=o;var s=Math.pow;function u(w,b,I){if(w.length===0)throw Error("empty string");if(w==="NaN"||w==="Infinity"||w==="+Infinity"||w==="-Infinity")return y;if(typeof b=="number"?(I=b,b=!1):b=!!b,I=I||10,I<2||36<I)throw RangeError("radix");var L;if((L=w.indexOf("-"))>0)throw Error("interior hyphen");if(L===0)return u(w.substring(1),b,I).neg();for(var k=i(s(I,8)),D=y,O=0;O<w.length;O+=8){var P=Math.min(8,w.length-O),R=parseInt(w.substring(O,O+P),I);if(P<8){var j=i(s(I,P));D=D.mul(j).add(i(R))}else D=D.mul(k),D=D.add(i(R))}return D.unsigned=b,D}e.fromString=u;function f(w){return w instanceof e?w:typeof w=="number"?i(w):typeof w=="string"?u(w):o(w.low,w.high,w.unsigned)}e.fromValue=f;var l=1<<16,c=1<<24,h=l*l,d=h*h,p=d/2,v=a(c),y=a(0);e.ZERO=y;var A=a(0,!0);e.UZERO=A;var _=a(1);e.ONE=_;var E=a(1,!0);e.UONE=E;var x=a(-1);e.NEG_ONE=x;var C=o(-1,2147483647,!1);e.MAX_VALUE=C;var B=o(-1,-1,!0);e.MAX_UNSIGNED_VALUE=B;var F=o(0,-2147483648,!1);e.MIN_VALUE=F;var M=e.prototype;return M.toInt=function(){return this.unsigned?this.low>>>0:this.low},M.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},M.toString=function(b){if(b=b||10,b<2||36<b)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(F)){var I=i(b),L=this.div(I),k=L.mul(I).sub(this);return L.toString(b)+k.toInt().toString(b)}else return"-"+this.neg().toString(b);for(var D=i(s(b,6),this.unsigned),O=this,P="";;){var R=O.div(D),j=O.sub(R.mul(D)).toInt()>>>0,G=j.toString(b);if(O=R,O.isZero())return G+P;for(;G.length<6;)G="0"+G;P=""+G+P}},M.getHighBits=function(){return this.high},M.getHighBitsUnsigned=function(){return this.high>>>0},M.getLowBits=function(){return this.low},M.getLowBitsUnsigned=function(){return this.low>>>0},M.getNumBitsAbs=function(){if(this.isNegative())return this.eq(F)?64:this.neg().getNumBitsAbs();for(var b=this.high!=0?this.high:this.low,I=31;I>0&&!(b&1<<I);I--);return this.high!=0?I+33:I+1},M.isZero=function(){return this.high===0&&this.low===0},M.isNegative=function(){return!this.unsigned&&this.high<0},M.isPositive=function(){return this.unsigned||this.high>=0},M.isOdd=function(){return(this.low&1)===1},M.isEven=function(){return(this.low&1)===0},M.equals=function(b){return r(b)||(b=f(b)),this.unsigned!==b.unsigned&&this.high>>>31===1&&b.high>>>31===1?!1:this.high===b.high&&this.low===b.low},M.eq=M.equals,M.notEquals=function(b){return!this.eq(b)},M.neq=M.notEquals,M.lessThan=function(b){return this.comp(b)<0},M.lt=M.lessThan,M.lessThanOrEqual=function(b){return this.comp(b)<=0},M.lte=M.lessThanOrEqual,M.greaterThan=function(b){return this.comp(b)>0},M.gt=M.greaterThan,M.greaterThanOrEqual=function(b){return this.comp(b)>=0},M.gte=M.greaterThanOrEqual,M.compare=function(b){if(r(b)||(b=f(b)),this.eq(b))return 0;var I=this.isNegative(),L=b.isNegative();return I&&!L?-1:!I&&L?1:this.unsigned?b.high>>>0>this.high>>>0||b.high===this.high&&b.low>>>0>this.low>>>0?-1:1:this.sub(b).isNegative()?-1:1},M.comp=M.compare,M.negate=function(){return!this.unsigned&&this.eq(F)?F:this.not().add(_)},M.neg=M.negate,M.add=function(b){r(b)||(b=f(b));var I=this.high>>>16,L=this.high&65535,k=this.low>>>16,D=this.low&65535,O=b.high>>>16,P=b.high&65535,R=b.low>>>16,j=b.low&65535,G=0,V=0,X=0,ne=0;return ne+=D+j,X+=ne>>>16,ne&=65535,X+=k+R,V+=X>>>16,X&=65535,V+=L+P,G+=V>>>16,V&=65535,G+=I+O,G&=65535,o(X<<16|ne,G<<16|V,this.unsigned)},M.subtract=function(b){return r(b)||(b=f(b)),this.add(b.neg())},M.sub=M.subtract,M.multiply=function(b){if(this.isZero()||(r(b)||(b=f(b)),b.isZero()))return y;if(this.eq(F))return b.isOdd()?F:y;if(b.eq(F))return this.isOdd()?F:y;if(this.isNegative())return b.isNegative()?this.neg().mul(b.neg()):this.neg().mul(b).neg();if(b.isNegative())return this.mul(b.neg()).neg();if(this.lt(v)&&b.lt(v))return i(this.toNumber()*b.toNumber(),this.unsigned);var I=this.high>>>16,L=this.high&65535,k=this.low>>>16,D=this.low&65535,O=b.high>>>16,P=b.high&65535,R=b.low>>>16,j=b.low&65535,G=0,V=0,X=0,ne=0;return ne+=D*j,X+=ne>>>16,ne&=65535,X+=k*j,V+=X>>>16,X&=65535,X+=D*R,V+=X>>>16,X&=65535,V+=L*j,G+=V>>>16,V&=65535,V+=k*R,G+=V>>>16,V&=65535,V+=D*P,G+=V>>>16,V&=65535,G+=I*j+L*R+k*P+D*O,G&=65535,o(X<<16|ne,G<<16|V,this.unsigned)},M.mul=M.multiply,M.divide=function(b){if(r(b)||(b=f(b)),b.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?A:y;var I,L,k;if(this.unsigned){if(b.unsigned||(b=b.toUnsigned()),b.gt(this))return A;if(b.gt(this.shru(1)))return E;k=A}else{if(this.eq(F)){if(b.eq(_)||b.eq(x))return F;if(b.eq(F))return _;var D=this.shr(1);return I=D.div(b).shl(1),I.eq(y)?b.isNegative()?_:x:(L=this.sub(b.mul(I)),k=I.add(L.div(b)),k)}else if(b.eq(F))return this.unsigned?A:y;if(this.isNegative())return b.isNegative()?this.neg().div(b.neg()):this.neg().div(b).neg();if(b.isNegative())return this.div(b.neg()).neg();k=y}for(L=this;L.gte(b);){I=Math.max(1,Math.floor(L.toNumber()/b.toNumber()));for(var O=Math.ceil(Math.log(I)/Math.LN2),P=O<=48?1:s(2,O-48),R=i(I),j=R.mul(b);j.isNegative()||j.gt(L);)I-=P,R=i(I,this.unsigned),j=R.mul(b);R.isZero()&&(R=_),k=k.add(R),L=L.sub(j)}return k},M.div=M.divide,M.modulo=function(b){return r(b)||(b=f(b)),this.sub(this.div(b).mul(b))},M.mod=M.modulo,M.not=function(){return o(~this.low,~this.high,this.unsigned)},M.and=function(b){return r(b)||(b=f(b)),o(this.low&b.low,this.high&b.high,this.unsigned)},M.or=function(b){return r(b)||(b=f(b)),o(this.low|b.low,this.high|b.high,this.unsigned)},M.xor=function(b){return r(b)||(b=f(b)),o(this.low^b.low,this.high^b.high,this.unsigned)},M.shiftLeft=function(b){return r(b)&&(b=b.toInt()),(b&=63)===0?this:b<32?o(this.low<<b,this.high<<b|this.low>>>32-b,this.unsigned):o(0,this.low<<b-32,this.unsigned)},M.shl=M.shiftLeft,M.shiftRight=function(b){return r(b)&&(b=b.toInt()),(b&=63)===0?this:b<32?o(this.low>>>b|this.high<<32-b,this.high>>b,this.unsigned):o(this.high>>b-32,this.high>=0?0:-1,this.unsigned)},M.shr=M.shiftRight,M.shiftRightUnsigned=function(b){if(r(b)&&(b=b.toInt()),b&=63,b===0)return this;var I=this.high;if(b<32){var L=this.low;return o(L>>>b|I<<32-b,I>>>b,this.unsigned)}else return b===32?o(I,0,this.unsigned):o(I>>>b-32,0,this.unsigned)},M.shru=M.shiftRightUnsigned,M.toSigned=function(){return this.unsigned?o(this.low,this.high,!1):this},M.toUnsigned=function(){return this.unsigned?this:o(this.low,this.high,!0)},M.toBytes=function(w){return w?this.toBytesLE():this.toBytesBE()},M.toBytesLE=function(){var w=this.high,b=this.low;return[b&255,b>>>8&255,b>>>16&255,b>>>24&255,w&255,w>>>8&255,w>>>16&255,w>>>24&255]},M.toBytesBE=function(){var w=this.high,b=this.low;return[w>>>24&255,w>>>16&255,w>>>8&255,w&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255]},e})});var hh=Z((uJ,p_)=>{p_.exports=globalThis.h3||{}});var gh=Z((pJ,R_)=>{R_.exports=globalThis.luma});var Xs=Z((mJ,F_)=>{F_.exports=globalThis.deck});var wb=Z((M7,lu)=>{var cL=Wf();function hL(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function fu(e,r,t){return hL()?lu.exports=fu=Reflect.construct:lu.exports=fu=function(a,i,o){var s=[null];s.push.apply(s,i);var u=Function.bind.apply(a,s),f=new u;return o&&cL(f,o.prototype),f},fu.apply(null,arguments)}lu.exports=fu});var La=Z((sY,jT)=>{jT.exports=globalThis.loaders});var W2=Z((xae,z2)=>{z2.exports=globalThis.deck});var pB=Z(lv=>{lv.read=function(e,r,t,n,a){var i,o,s=a*8-n-1,u=(1<<s)-1,f=u>>1,l=-7,c=t?a-1:0,h=t?-1:1,d=e[r+c];for(c+=h,i=d&(1<<-l)-1,d>>=-l,l+=s;l>0;i=i*256+e[r+c],c+=h,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=n;l>0;o=o*256+e[r+c],c+=h,l-=8);if(i===0)i=1-f;else{if(i===u)return o?NaN:(d?-1:1)*(1/0);o=o+Math.pow(2,n),i=i-f}return(d?-1:1)*o*Math.pow(2,i-n)};lv.write=function(e,r,t,n,a,i){var o,s,u,f=i*8-a-1,l=(1<<f)-1,c=l>>1,h=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:i-1,p=n?1:-1,v=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(s=isNaN(r)?1:0,o=l):(o=Math.floor(Math.log(r)/Math.LN2),r*(u=Math.pow(2,-o))<1&&(o--,u*=2),o+c>=1?r+=h/u:r+=h*Math.pow(2,1-c),r*u>=2&&(o++,u/=2),o+c>=l?(s=0,o=l):o+c>=1?(s=(r*u-1)*Math.pow(2,a),o=o+c):(s=r*Math.pow(2,c-1)*Math.pow(2,a),o=0));a>=8;e[t+d]=s&255,d+=p,s/=256,a-=8);for(o=o<<a|s,f+=a;f>0;e[t+d]=o&255,d+=p,o/=256,f-=8);e[t+d-p]|=v*128}});var _B=Z((lie,AB)=>{"use strict";AB.exports=ye;var If=pB();function ye(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}ye.Varint=0;ye.Fixed64=1;ye.Bytes=2;ye.Fixed32=5;var cv=(1<<16)*(1<<16),mB=1/cv,_6=12,yB=typeof TextDecoder>"u"?null:new TextDecoder("utf8");ye.prototype={destroy:function(){this.buf=null},readFields:function(e,r,t){for(t=t||this.length;this.pos<t;){var n=this.readVarint(),a=n>>3,i=this.pos;this.type=n&7,e(a,r,this),this.pos===i&&this.skip(n)}return r},readMessage:function(e,r){return this.readFields(e,r,this.readVarint()+this.pos)},readFixed32:function(){var e=Rf(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=gB(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Rf(this.buf,this.pos)+Rf(this.buf,this.pos+4)*cv;return this.pos+=8,e},readSFixed64:function(){var e=Rf(this.buf,this.pos)+gB(this.buf,this.pos+4)*cv;return this.pos+=8,e},readFloat:function(){var e=If.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=If.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var r=this.buf,t,n;return n=r[this.pos++],t=n&127,n<128||(n=r[this.pos++],t|=(n&127)<<7,n<128)||(n=r[this.pos++],t|=(n&127)<<14,n<128)||(n=r[this.pos++],t|=(n&127)<<21,n<128)?t:(n=r[this.pos],t|=(n&15)<<28,b6(t,e,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2===1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,r=this.pos;return this.pos=e,e-r>=_6&&yB?L6(this.buf,r,e):F6(this.buf,r,e)},readBytes:function(){var e=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,e);return this.pos=e,r},readPackedVarint:function(e,r){if(this.type!==ye.Bytes)return e.push(this.readVarint(r));var t=Ir(this);for(e=e||[];this.pos<t;)e.push(this.readVarint(r));return e},readPackedSVarint:function(e){if(this.type!==ye.Bytes)return e.push(this.readSVarint());var r=Ir(this);for(e=e||[];this.pos<r;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==ye.Bytes)return e.push(this.readBoolean());var r=Ir(this);for(e=e||[];this.pos<r;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==ye.Bytes)return e.push(this.readFloat());var r=Ir(this);for(e=e||[];this.pos<r;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==ye.Bytes)return e.push(this.readDouble());var r=Ir(this);for(e=e||[];this.pos<r;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==ye.Bytes)return e.push(this.readFixed32());var r=Ir(this);for(e=e||[];this.pos<r;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==ye.Bytes)return e.push(this.readSFixed32());var r=Ir(this);for(e=e||[];this.pos<r;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==ye.Bytes)return e.push(this.readFixed64());var r=Ir(this);for(e=e||[];this.pos<r;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==ye.Bytes)return e.push(this.readSFixed64());var r=Ir(this);for(e=e||[];this.pos<r;)e.push(this.readSFixed64());return e},skip:function(e){var r=e&7;if(r===ye.Varint)for(;this.buf[this.pos++]>127;);else if(r===ye.Bytes)this.pos=this.readVarint()+this.pos;else if(r===ye.Fixed32)this.pos+=4;else if(r===ye.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+r)},writeTag:function(e,r){this.writeVarint(e<<3|r)},realloc:function(e){for(var r=this.length||16;r<this.pos+e;)r*=2;if(r!==this.length){var t=new Uint8Array(r);t.set(this.buf),this.buf=t,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),ni(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),ni(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),ni(this.buf,e&-1,this.pos),ni(this.buf,Math.floor(e*mB),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),ni(this.buf,e&-1,this.pos),ni(this.buf,Math.floor(e*mB),this.pos+4),this.pos+=8},writeVarint:function(e){if(e=+e||0,e>268435455||e<0){T6(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))},writeSVarint:function(e){this.writeVarint(e<0?-e*2-1:e*2)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(e.length*4),this.pos++;var r=this.pos;this.pos=k6(this.buf,e,this.pos);var t=this.pos-r;t>=128&&vB(r,t,this),this.pos=r-1,this.writeVarint(t),this.pos+=t},writeFloat:function(e){this.realloc(4),If.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),If.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var r=e.length;this.writeVarint(r),this.realloc(r);for(var t=0;t<r;t++)this.buf[this.pos++]=e[t]},writeRawMessage:function(e,r){this.pos++;var t=this.pos;e(r,this);var n=this.pos-t;n>=128&&vB(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,r,t){this.writeTag(e,ye.Bytes),this.writeRawMessage(r,t)},writePackedVarint:function(e,r){r.length&&this.writeMessage(e,S6,r)},writePackedSVarint:function(e,r){r.length&&this.writeMessage(e,w6,r)},writePackedBoolean:function(e,r){r.length&&this.writeMessage(e,M6,r)},writePackedFloat:function(e,r){r.length&&this.writeMessage(e,C6,r)},writePackedDouble:function(e,r){r.length&&this.writeMessage(e,B6,r)},writePackedFixed32:function(e,r){r.length&&this.writeMessage(e,O6,r)},writePackedSFixed32:function(e,r){r.length&&this.writeMessage(e,P6,r)},writePackedFixed64:function(e,r){r.length&&this.writeMessage(e,I6,r)},writePackedSFixed64:function(e,r){r.length&&this.writeMessage(e,R6,r)},writeBytesField:function(e,r){this.writeTag(e,ye.Bytes),this.writeBytes(r)},writeFixed32Field:function(e,r){this.writeTag(e,ye.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(e,r){this.writeTag(e,ye.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(e,r){this.writeTag(e,ye.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(e,r){this.writeTag(e,ye.Fixed64),this.writeSFixed64(r)},writeVarintField:function(e,r){this.writeTag(e,ye.Varint),this.writeVarint(r)},writeSVarintField:function(e,r){this.writeTag(e,ye.Varint),this.writeSVarint(r)},writeStringField:function(e,r){this.writeTag(e,ye.Bytes),this.writeString(r)},writeFloatField:function(e,r){this.writeTag(e,ye.Fixed32),this.writeFloat(r)},writeDoubleField:function(e,r){this.writeTag(e,ye.Fixed64),this.writeDouble(r)},writeBooleanField:function(e,r){this.writeVarintField(e,Boolean(r))}};function b6(e,r,t){var n=t.buf,a,i;if(i=n[t.pos++],a=(i&112)>>4,i<128||(i=n[t.pos++],a|=(i&127)<<3,i<128)||(i=n[t.pos++],a|=(i&127)<<10,i<128)||(i=n[t.pos++],a|=(i&127)<<17,i<128)||(i=n[t.pos++],a|=(i&127)<<24,i<128)||(i=n[t.pos++],a|=(i&1)<<31,i<128))return ri(e,a,r);throw new Error("Expected varint not more than 10 bytes")}function Ir(e){return e.type===ye.Bytes?e.readVarint()+e.pos:e.pos+1}function ri(e,r,t){return t?r*4294967296+(e>>>0):(r>>>0)*4294967296+(e>>>0)}function T6(e,r){var t,n;if(e>=0?(t=e%4294967296|0,n=e/4294967296|0):(t=~(-e%4294967296),n=~(-e/4294967296),t^4294967295?t=t+1|0:(t=0,n=n+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),x6(t,n,r),E6(n,r)}function x6(e,r,t){t.buf[t.pos++]=e&127|128,e>>>=7,t.buf[t.pos++]=e&127|128,e>>>=7,t.buf[t.pos++]=e&127|128,e>>>=7,t.buf[t.pos++]=e&127|128,e>>>=7,t.buf[t.pos]=e&127}function E6(e,r){var t=(e&7)<<4;r.buf[r.pos++]|=t|((e>>>=3)?128:0),e&&(r.buf[r.pos++]=e&127|((e>>>=7)?128:0),e&&(r.buf[r.pos++]=e&127|((e>>>=7)?128:0),e&&(r.buf[r.pos++]=e&127|((e>>>=7)?128:0),e&&(r.buf[r.pos++]=e&127|((e>>>=7)?128:0),e&&(r.buf[r.pos++]=e&127)))))}function vB(e,r,t){var n=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(Math.LN2*7));t.realloc(n);for(var a=t.pos-1;a>=e;a--)t.buf[a+n]=t.buf[a]}function S6(e,r){for(var t=0;t<e.length;t++)r.writeVarint(e[t])}function w6(e,r){for(var t=0;t<e.length;t++)r.writeSVarint(e[t])}function C6(e,r){for(var t=0;t<e.length;t++)r.writeFloat(e[t])}function B6(e,r){for(var t=0;t<e.length;t++)r.writeDouble(e[t])}function M6(e,r){for(var t=0;t<e.length;t++)r.writeBoolean(e[t])}function O6(e,r){for(var t=0;t<e.length;t++)r.writeFixed32(e[t])}function P6(e,r){for(var t=0;t<e.length;t++)r.writeSFixed32(e[t])}function I6(e,r){for(var t=0;t<e.length;t++)r.writeFixed64(e[t])}function R6(e,r){for(var t=0;t<e.length;t++)r.writeSFixed64(e[t])}function Rf(e,r){return(e[r]|e[r+1]<<8|e[r+2]<<16)+e[r+3]*16777216}function ni(e,r,t){e[t]=r,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24}function gB(e,r){return(e[r]|e[r+1]<<8|e[r+2]<<16)+(e[r+3]<<24)}function F6(e,r,t){for(var n="",a=r;a<t;){var i=e[a],o=null,s=i>239?4:i>223?3:i>191?2:1;if(a+s>t)break;var u,f,l;s===1?i<128&&(o=i):s===2?(u=e[a+1],(u&192)===128&&(o=(i&31)<<6|u&63,o<=127&&(o=null))):s===3?(u=e[a+1],f=e[a+2],(u&192)===128&&(f&192)===128&&(o=(i&15)<<12|(u&63)<<6|f&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):s===4&&(u=e[a+1],f=e[a+2],l=e[a+3],(u&192)===128&&(f&192)===128&&(l&192)===128&&(o=(i&15)<<18|(u&63)<<12|(f&63)<<6|l&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,s=1):o>65535&&(o-=65536,n+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),n+=String.fromCharCode(o),a+=s}return n}function L6(e,r,t){return yB.decode(e.subarray(r,t))}function k6(e,r,t){for(var n=0,a,i;n<r.length;n++){if(a=r.charCodeAt(n),a>55295&&a<57344)if(i)if(a<56320){e[t++]=239,e[t++]=191,e[t++]=189,i=a;continue}else a=i-55296<<10|a-56320|65536,i=null;else{a>56319||n+1===r.length?(e[t++]=239,e[t++]=191,e[t++]=189):i=a;continue}else i&&(e[t++]=239,e[t++]=191,e[t++]=189,i=null);a<128?e[t++]=a:(a<2048?e[t++]=a>>6|192:(a<65536?e[t++]=a>>12|224:(e[t++]=a>>18|240,e[t++]=a>>12&63|128),e[t++]=a>>6&63|128),e[t++]=a&63|128)}return t}});var Ro={};Gt(Ro,{GeohashLayer:()=>Uf,GreatCircleLayer:()=>ms,H3ClusterLayer:()=>Js,H3HexagonLayer:()=>Pn,MVTLayer:()=>Nf,QuadkeyLayer:()=>_s,S2Layer:()=>ys,TerrainLayer:()=>Sf,Tile3DLayer:()=>vf,TileLayer:()=>yr,TripsLayer:()=>zs,_GeoCellLayer:()=>Pt,_Tile2DHeader:()=>Li,_Tileset2D:()=>Hi,_WMSLayer:()=>ps,_getURLFromTemplate:()=>ar});var Xt={},Pv=m(Nt());Fr(Xt,m(Nt()));if(!Pv.GeoJsonLayer)throw new Error("@deck.gl/layers is not found");Fr(Ro,Xt);var yc=m(ie()),hs=m(K()),f1=m(H()),l1=m(z()),c1=m(wt()),h1=m(dn()),d1=m(Te()),p1=m(xe()),ds=m(be()),Pi=m(W()),En=m(Y()),Sn=m(Ut()),m1=m(Nt());var qg=m(W()),Jg=m(K()),nl=m(Y());var Ng=m(W());function g(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var Ug=m(Dg());function Gg(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function c3(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Gg(Object(t),!0).forEach(function(n){(0,Ng.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Gg(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function jg(e,r){var t=new Ug.XMLParser(c3({ignoreAttributes:!1,attributeNamePrefix:""},r)),n=t.parse(e);return n}var Hg=m(ie()),Vg=m(Ge());function h3(e){return typeof e=="string"?e.charAt(0).toLowerCase()+e.slice(1):e}function Uo(e){if(Array.isArray(e))return e.map(function(s){return Uo(s)});if(e&&(0,Vg.default)(e)==="object"){for(var r={},t=0,n=Object.entries(e);t<n.length;t++){var a=(0,Hg.default)(n[t],2),i=a[0],o=a[1];r[h3(i)]=Uo(o)}return r}return e}function zg(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function rl(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?zg(Object(t),!0).forEach(function(n){(0,qg.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):zg(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var d3="3.4.2",Ot={name:"XML",id:"xml",module:"xml",version:d3,worker:!1,extensions:["xml"],mimeTypes:["application/xml","text/xml"],testText:p3,options:{xml:{parser:"fast-xml-parser",uncapitalizeKeys:!1,removeNSPrefix:!1,textNodeName:"value",arrayPaths:[]}},parse:function(){var e=(0,Jg.default)(nl.default.mark(function t(n,a){return nl.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",Wg(new TextDecoder().decode(n),a));case 1:case"end":return o.stop()}},t)}));function r(t,n){return e.apply(this,arguments)}return r}(),parseTextSync:function(r,t){return Wg(r,t)}};function p3(e){return e.startsWith("<?xml")}function Wg(e,r){var t,n=rl(rl({},Ot.options.xml),r?.xml);switch(n.parser){case"fast-xml-parser":var a=rl({allowBooleanAttributes:!0,ignoreDeclaration:!0,removeNSPrefix:n.removeNSPrefix,textNodeName:n.textNodeName,isArray:function(s,u,f,l){var c,h=Boolean(n==null||(c=n.arrayPaths)===null||c===void 0?void 0:c.some(function(d){return u===d}));return h}},r?._fastXML),i=jg(e,a);return n.uncapitalizeKeys?Uo(i):i;default:throw new Error(r==null||(t=r.xml)===null||t===void 0?void 0:t.parser)}}function se(e,r){if(!e)throw new Error(r||"loader assertion failed.")}var Kg=m(Ge()),Kt={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},m3=Kt.self||Kt.window||Kt.global||{},v3=Kt.window||Kt.self||Kt.global||{},g3=Kt.global||Kt.self||Kt.window||{},y3=Kt.document||{};var ui=Boolean((typeof process>"u"?"undefined":(0,Kg.default)(process))!=="object"||String(process)!=="[object process]"||process.browser);var Xg=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),A3=Xg&&parseFloat(Xg[1])||0;var Zg=m(Ge()),$g=m(ie()),Qg=m(W());function Yg(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function _3(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Yg(Object(t),!0).forEach(function(n){(0,Qg.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Yg(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function al(e,r){for(var t=_3({},e),n=0,a=Object.entries(r);n<a.length;n++){var i=(0,$g.default)(a[n],2),o=i[0],s=i[1];s&&(0,Zg.default)(s)==="object"?(t[o]=t[o]||{},Object.assign(t[o],r[o])):t[o]=r[o]}return t}function ey(e,r){if(!e)throw new Error(r||"loaders.gl assertion failed.")}var ry=m(Ge()),Yt={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},y4=Yt.self||Yt.window||Yt.global||{},A4=Yt.window||Yt.self||Yt.global||{},ny=Yt.global||Yt.self||Yt.window||{},_4=Yt.document||{};var hr=(typeof process>"u"?"undefined":(0,ry.default)(process))!=="object"||String(process)!=="[object process]"||process.browser,fi=typeof importScripts=="function",b4=typeof window<"u"&&typeof window.orientation<"u",ty=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),T4=ty&&parseFloat(ty[1])||0;var ul=m(K()),li=m(Y());var mn=m(ay());var b3="3.4.2",il={};function Zt(e){return ol.apply(this,arguments)}function ol(){return ol=(0,ul.default)(li.default.mark(function e(r){var t,n,a=arguments;return li.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=a.length>1&&a[1]!==void 0?a[1]:null,n=a.length>2&&a[2]!==void 0?a[2]:{},t&&(r=iy(r,t,n)),il[r]=il[r]||T3(r),o.next=6,il[r];case 6:return o.abrupt("return",o.sent);case 7:case"end":return o.stop()}},e)})),ol.apply(this,arguments)}function iy(e,r,t){if(e.startsWith("http"))return e;var n=t.modules||{};return n[e]?n[e]:hr?t.CDN?(ey(t.CDN.startsWith("http")),"".concat(t.CDN,"/").concat(r,"@").concat(b3,"/dist/libs/").concat(e)):fi?"../src/libs/".concat(e):"modules/".concat(r,"/src/libs/").concat(e):"modules/".concat(r,"/dist/libs/").concat(e)}function T3(e){return sl.apply(this,arguments)}function sl(){return sl=(0,ul.default)(li.default.mark(function e(r){var t,n,a;return li.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!r.endsWith("wasm")){o.next=7;break}return o.next=3,fetch(r);case 3:return t=o.sent,o.next=6,t.arrayBuffer();case 6:return o.abrupt("return",o.sent);case 7:if(hr){o.next=20;break}if(o.prev=8,o.t0=mn&&mn.requireFromFile,!o.t0){o.next=14;break}return o.next=13,mn.requireFromFile(r);case 13:o.t0=o.sent;case 14:return o.abrupt("return",o.t0);case 17:return o.prev=17,o.t1=o.catch(8),o.abrupt("return",null);case 20:if(!fi){o.next=22;break}return o.abrupt("return",importScripts(r));case 22:return o.next=24,fetch(r);case 24:return n=o.sent,o.next=27,n.text();case 27:return a=o.sent,o.abrupt("return",x3(a,r));case 29:case"end":return o.stop()}},e,null,[[8,17]])})),sl.apply(this,arguments)}function x3(e,r){if(!hr)return mn.requireFromString&&mn.requireFromString(e,r);if(fi)return eval.call(ny,e),null;var t=document.createElement("script");t.id=r;try{t.appendChild(document.createTextNode(e))}catch{t.text=e}return document.body.appendChild(t),null}function sy(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;if(typeof e=="string")return e.slice(0,r);if(ArrayBuffer.isView(e))return oy(e.buffer,e.byteOffset,r);if(e instanceof ArrayBuffer){var t=0;return oy(e,t,r)}return""}function oy(e,r,t){if(e.byteLength<=r+t)return"";for(var n=new DataView(e),a="",i=0;i<t;i++)a+=String.fromCharCode(n.getUint8(r+i));return a}function fl(e){try{return JSON.parse(e)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(sy(e),'"'))}}function ci(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var n=r,a=n&&n.length>1&&n[0].constructor||null;if(!a)throw new Error('"concatenateTypedArrays" - incorrect quantity of arguments or arguments have incompatible data types');for(var i=n.reduce(function(c,h){return c+h.length},0),o=new a(i),s=0,u=0,f=n;u<f.length;u++){var l=f[u];o.set(l,s),s+=l.length}return o}function vn(e,r,t){var n=t!==void 0?new Uint8Array(e).subarray(r,r+t):new Uint8Array(e).subarray(r),a=new Uint8Array(n);return a.buffer}function kr(e,r){return se(e>=0),se(r>0),e+(r-1)&~(r-1)}function ll(e,r,t){var n;if(e instanceof ArrayBuffer)n=new Uint8Array(e);else{var a=e.byteOffset,i=e.byteLength;n=new Uint8Array(e.buffer||e.arrayBuffer,a,i)}return r.set(n,t),t+kr(n.byteLength,4)}var ly=m(W()),cy=m(H()),hy=m(z());function hi(){let e;if(typeof window<"u"&&window.performance)e=window.performance.now();else if(typeof process<"u"&&process.hrtime){let r=process.hrtime();e=r[0]*1e3+r[1]/1e6}else e=Date.now();return e}var gn=class{constructor(r,t){g(this,"name",void 0),g(this,"type",void 0),g(this,"sampleSize",1),g(this,"time",0),g(this,"count",0),g(this,"samples",0),g(this,"lastTiming",0),g(this,"lastSampleTime",0),g(this,"lastSampleCount",0),g(this,"_count",0),g(this,"_time",0),g(this,"_samples",0),g(this,"_startTime",0),g(this,"_timerPending",!1),this.name=r,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(r){return this.sampleSize=r,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(r){return this._count+=r,this._samples++,this._checkSampling(),this}subtractCount(r){return this._count-=r,this._samples++,this._checkSampling(),this}addTime(r){return this._time+=r,this.lastTiming=r,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=hi(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(hi()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}};var ua=class{constructor(r){g(this,"id",void 0),g(this,"stats",{}),this.id=r.id,this.stats={},this._initializeStats(r.stats),Object.seal(this)}get(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:r,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(let r of Object.values(this.stats))r.reset();return this}forEach(r){for(let t of Object.values(this.stats))r(t)}getTable(){let r={};return this.forEach(t=>{r[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),r}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(t=>this._getOrCreate(t))}_getOrCreate(r){let{name:t,type:n}=r,a=this.stats[t];return a||(r instanceof gn?a=r:a=new gn(t,n),this.stats[t]=a),a}};function uy(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function fy(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?uy(Object(t),!0).forEach(function(n){(0,ly.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):uy(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var E3="Queued Requests",S3="Active Requests",w3="Cancelled Requests",C3="Queued Requests Ever",B3="Active Requests Ever",M3={id:"request-scheduler",throttleRequests:!0,maxRequests:6},di=function(){function e(){(0,cy.default)(this,e);var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};g(this,"props",void 0),g(this,"stats",void 0),g(this,"activeRequestCount",0),g(this,"requestQueue",[]),g(this,"requestMap",new Map),g(this,"deferredUpdate",null),this.props=fy(fy({},M3),r),this.stats=new ua({id:this.props.id}),this.stats.get(E3),this.stats.get(S3),this.stats.get(w3),this.stats.get(C3),this.stats.get(B3)}return(0,hy.default)(e,[{key:"scheduleRequest",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return 0};if(!this.props.throttleRequests)return Promise.resolve({done:function(){}});if(this.requestMap.has(t))return this.requestMap.get(t);var a={handle:t,priority:0,getPriority:n},i=new Promise(function(o){return a.resolve=o,a});return this.requestQueue.push(a),this.requestMap.set(t,i),this._issueNewRequests(),i}},{key:"_issueRequest",value:function(t){var n=this,a=t.handle,i=t.resolve,o=!1,s=function(){o||(o=!0,n.requestMap.delete(a),n.activeRequestCount--,n._issueNewRequests())};return this.activeRequestCount++,i?i({done:s}):Promise.resolve({done:s})}},{key:"_issueNewRequests",value:function(){var t=this;this.deferredUpdate||(this.deferredUpdate=setTimeout(function(){return t._issueNewRequestsAsync()},0))}},{key:"_issueNewRequestsAsync",value:function(){this.deferredUpdate=null;var t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(t!==0){this._updateAllRequests();for(var n=0;n<t;++n){var a=this.requestQueue.shift();a&&this._issueRequest(a)}}}},{key:"_updateAllRequests",value:function(){for(var t=this.requestQueue,n=0;n<t.length;++n){var a=t[n];this._updateRequest(a)||(t.splice(n,1),this.requestMap.delete(a.handle),n--)}t.sort(function(i,o){return i.priority-o.priority})}},{key:"_updateRequest",value:function(t){return t.priority=t.getPriority(t.handle),t.priority<0?(t.resolve(null),!1):!0}}]),e}();var fa={};Gt(fa,{dirname:()=>P3,filename:()=>O3,join:()=>I3,resolve:()=>R3});function dy(){var e;if(typeof process<"u"&&typeof process.cwd<"u")return process.cwd();var r=(e=window.location)===null||e===void 0?void 0:e.pathname;return r?.slice(0,r.lastIndexOf("/")+1)||""}function O3(e){var r=e?e.lastIndexOf("/"):-1;return r>=0?e.substr(r+1):""}function P3(e){var r=e?e.lastIndexOf("/"):-1;return r>=0?e.substr(0,r):""}function I3(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var n="/";return r=r.map(function(a,i){return i&&(a=a.replace(new RegExp("^".concat(n)),"")),i!==r.length-1&&(a=a.replace(new RegExp("".concat(n,"$")),"")),a}),r.join(n)}function R3(){for(var e=[],r=0;r<arguments.length;r++)e[r]=r<0||arguments.length<=r?void 0:arguments[r];for(var t="",n=!1,a,i=e.length-1;i>=-1&&!n;i--){var o=void 0;i>=0?o=e[i]:(a===void 0&&(a=dy()),o=a),o.length!==0&&(t="".concat(o,"/").concat(t),n=o.charCodeAt(0)===pi)}return t=F3(t,!n),n?"/".concat(t):t.length>0?t:"."}var pi=47,cl=46;function F3(e,r){for(var t="",n=-1,a=0,i,o=!1,s=0;s<=e.length;++s){if(s<e.length)i=e.charCodeAt(s);else{if(i===pi)break;i=pi}if(i===pi){if(!(n===s-1||a===1))if(n!==s-1&&a===2){if(t.length<2||!o||t.charCodeAt(t.length-1)!==cl||t.charCodeAt(t.length-2)!==cl){if(t.length>2){for(var u=t.length-1,f=u;f>=0&&t.charCodeAt(f)!==pi;--f);if(f!==u){t=f===-1?"":t.slice(0,f),n=s,a=0,o=!1;continue}}else if(t.length===2||t.length===1){t="",n=s,a=0,o=!1;continue}}r&&(t.length>0?t+="/..":t="..",o=!0)}else{var l=e.slice(n+1,s);t.length>0?t+="/".concat(l):t=l,o=!1}n=s,a=0}else i===cl&&a!==-1?++a:a=-1}return t}var gy=m(W()),yy=m(K()),dl=m(Y());function py(e,r){var t,n,a,i=(t=Ot.parseTextSync)===null||t===void 0?void 0:t.call(Ot,e,r),o=(i==null||(n=i.ServiceExceptionReport)===null||n===void 0?void 0:n.ServiceException)||(i==null||(a=i["ogc:ServiceExceptionReport"])===null||a===void 0?void 0:a["ogc:ServiceException"]),s=typeof o=="string"?o:o.value||o.code||"Unknown error";return s}function my(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function vy(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?my(Object(t),!0).forEach(function(n){(0,gy.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):my(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var L3="3.4.2",la={id:"wms-error",name:"WMS Error",module:"wms",version:L3,worker:!1,extensions:["xml"],mimeTypes:["application/vnd.ogc.se_xml","application/xml","text/xml"],testText:k3,options:{wms:{throwOnError:!1}},parse:function(){var e=(0,yy.default)(dl.default.mark(function t(n,a){return dl.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",hl(new TextDecoder().decode(n),a));case 1:case"end":return o.stop()}},t)}));function r(t,n){return e.apply(this,arguments)}return r}(),parseSync:function(r,t){return hl(new TextDecoder().decode(r),t)},parseTextSync:function(r,t){return hl(r,t)}};function k3(e){return e.startsWith("<?xml")}function hl(e,r){var t=vy(vy({},la.options.wms),r?.wms),n=py(e,t),a=t.minimalErrors?n:"WMS Service error: ".concat(n);if(t.throwOnError)throw new Error(a);return a}var My=m(K()),vl=m(Y());var gi=m(st()),Ho=m(ie());var pl=m(Ge());function yn(e){return Array.isArray(e)?e:e?[e]:[]}function mi(e){var r=yn(e);return r.length>0&&r.every(function(t){return typeof t=="string"})?r:[]}function vi(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;switch((0,pl.default)(e)){case"number":return e;case"string":return parseFloat(e);default:return}}function jo(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;switch((0,pl.default)(e)){case"number":return e;case"string":return parseInt(e,10);default:return}}function An(e){switch(e){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1;default:return!1}}function Vo(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=z3(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function z3(e,r){if(e){if(typeof e=="string")return wy(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return wy(e,r)}}function wy(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function ml(e,r){var t=Ot.parseTextSync(e,r),n=t.WMT_MS_Capabilities||t.WMS_Capabilities||t,a=W3(n);if(r!=null&&r.inheritedLayerProps){var i=Vo(a.layers),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;By(s,null)}}catch(u){i.e(u)}finally{i.f()}}return(r!=null&&r.includeRawData||r!=null&&r.raw)&&(a.raw=n),r!=null&&r.includeXMLText&&(a.xml=e),a}function W3(e){var r,t,n,a,i,o,s,u,f,l,c,h,d,p,v,y,A={version:String(e.version||""),name:String(((r=e.Service)===null||r===void 0?void 0:r.Name)||"unnamed"),title:(t=e.Service)!==null&&t!==void 0&&t.Title?String((n=e.Service)===null||n===void 0?void 0:n.Title):void 0,abstract:(a=e.Service)!==null&&a!==void 0&&a.Abstract?String((i=e.Service)===null||i===void 0?void 0:i.Abstract):void 0,keywords:mi((o=e.Service)===null||o===void 0||(s=o.KeywordList)===null||s===void 0?void 0:s.Keyword),fees:(u=e.Service)!==null&&u!==void 0&&u.Fees?JSON.stringify((f=e.Service)===null||f===void 0?void 0:f.Fees):void 0,accessConstraints:(l=e.Service)!==null&&l!==void 0&&l.AccessConstraints?JSON.stringify((c=e.Service)===null||c===void 0?void 0:c.AccessConstraints):void 0,layerLimit:jo((h=e.Service)===null||h===void 0?void 0:h.LayerLimit),maxWidth:jo((d=e.Service)===null||d===void 0?void 0:d.maxWidth),maxHeight:jo((p=e.Service)===null||p===void 0?void 0:p.maxHeight),layers:[],requests:q3((v=e.Capability)===null||v===void 0?void 0:v.Request),exceptions:J3(e.Exception)},_=yn((y=e.Capability)===null||y===void 0?void 0:y.Layer),E=Vo(_),x;try{for(E.s();!(x=E.n()).done;){var C=x.value;A.layers.push(Cy(C))}}catch(I){E.e(I)}finally{E.f()}for(var B=0,F=Object.entries(A);B<F.length;B++){var M=(0,Ho.default)(F[B],2),w=M[0],b=M[1];b===void 0&&delete A[w]}return A}function q3(e){for(var r={},t=0,n=Object.entries(e||{});t<n.length;t++){var a=(0,Ho.default)(n[t],2),i=a[0],o=a[1],s=mi(o?.Format);r[i]={mimeTypes:s}}return r}function J3(e){var r=yn(e?.Format);if(r.length>0)return{mimeTypes:mi(e)}}function Cy(e){var r,t={title:String(e?.Title||""),name:e?.Name&&String(e?.Name),abstract:e?.Name&&String(e?.Abstract),keywords:mi((r=e.KeywordList)===null||r===void 0?void 0:r.Keyword)},n=e?.CRS||e?.SRS;n&&Array.isArray(n)&&n.every(function(_){return typeof _=="string"})&&(t.crs=n);var a=e?.EX_GeographicBoundingBox&&X3(e?.EX_GeographicBoundingBox);a&&(t.geographicBoundingBox=a),a=e?.LatLonBoundingBox&&K3(e?.LatLonBoundingBox),a&&(t.geographicBoundingBox=a);var i=e?.BoundingBox&&Y3(e?.BoundingBox);i&&i.length>0&&(t.boundingBoxes=i);var o=yn(e?.Dimension),s=o.map(function(_){return $3(_)});s.length&&(t.dimensions=s),e!=null&&e.opaque&&(t.opaque=An(e?.opaque)),e!=null&&e.cascaded&&(t.cascaded=An(e?.cascaded)),e!=null&&e.queryable&&(t.queryable=An(e?.queryable));var u=yn(e?.Layer),f=[],l=Vo(u),c;try{for(l.s();!(c=l.n()).done;){var h=c.value;f.push(Cy(h))}}catch(_){l.e(_)}finally{l.f()}f.length>0&&(t.layers=f);for(var d=0,p=Object.entries(t);d<p.length;d++){var v=(0,Ho.default)(p[d],2),y=v[0],A=v[1];A===void 0&&delete t[y]}return t}function X3(e){var r=e.westBoundLongitude,t=e.northBoundLatitude,n=e.eastBoundLongitude,a=e.southBoundLatitude;return[[r,a],[n,t]]}function K3(e){var r=e.minx,t=e.miny,n=e.maxx,a=e.maxy;return[[r,t],[n,a]]}function Y3(e){var r=yn(e);return r.map(function(t){return Z3(t)})}function Z3(e){var r=e.CRS,t=e.SRS,n=e.minx,a=e.miny,i=e.maxx,o=e.maxy,s=e.resx,u=e.resy,f={crs:r||t,boundingBox:[[vi(n),vi(a)],[vi(i),vi(o)]]};return s&&(f.xResolution=s),u&&(f.yResolution=u),f}function $3(e){var r=e.name,t=e.units,n=e.value,a={name:r,units:t,extent:n};return e.unitSymbol&&(a.unitSymbol=e.unitSymbol),e.default&&(a.defaultValue=e.default),e.multipleValues&&(a.multipleValues=An(e.multipleValues)),e.nearestValue&&(a.nearestValue=An(e.nearestValue)),e.current&&(a.current=An(e.current)),a}function By(e,r){r!=null&&r.geographicBoundingBox&&!e.geographicBoundingBox&&(e.geographicBoundingBox=(0,gi.default)(r.geographicBoundingBox)),r!=null&&r.crs&&!e.crs&&(e.crs=(0,gi.default)(r.crs)),r!=null&&r.boundingBoxes&&!e.boundingBoxes&&(e.boundingBoxes=(0,gi.default)(r.boundingBoxes)),r!=null&&r.dimensions&&!e.dimensions&&(e.dimensions=(0,gi.default)(r.dimensions));var t=Vo(e.layers||[]),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;By(a,e)}}catch(i){t.e(i)}finally{t.f()}}var Q3="3.4.2",_n={id:"wms-capabilities",name:"WMS Capabilities",module:"wms",version:Q3,worker:!1,extensions:["xml"],mimeTypes:["application/vnd.ogc.wms_xml","application/xml","text/xml"],testText:eP,options:{wms:{}},parse:function(){var e=(0,My.default)(vl.default.mark(function t(n,a){return vl.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",ml(new TextDecoder().decode(n),a?.wms));case 1:case"end":return o.stop()}},t)}));function r(t,n){return e.apply(this,arguments)}return r}(),parseTextSync:function(r,t){return ml(r,t?.wms)}};function eP(e){return e.startsWith("<?xml")}var Iy=m(K()),Ry=m(W()),yl=m(Y());function gl(e,r){var t,n=Ot.parseTextSync(e,r),a=((t=n.FeatureInfoResponse)===null||t===void 0?void 0:t.FIELDS)||[],i=Array.isArray(a)?a:[a];return{features:i.map(function(o){return tP(o)})}}function tP(e){var r=e||{};return{attributes:r,type:"",bounds:{bottom:0,top:0,left:0,right:0}}}function Oy(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Py(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Oy(Object(t),!0).forEach(function(n){(0,Ry.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Oy(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Al=Py(Py({},_n),{},{id:"wms-feature-info",name:"WMS FeatureInfo",parse:function(){var e=(0,Iy.default)(yl.default.mark(function t(n,a){return yl.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",gl(new TextDecoder().decode(n),a));case 1:case"end":return o.stop()}},t)}));function r(t,n){return e.apply(this,arguments)}return r}(),parseTextSync:function(r,t){return gl(r,t)}});var ky=m(K()),Dy=m(W()),bl=m(Y());function _l(e,r){var t,n=(t=Ot.parseTextSync)===null||t===void 0?void 0:t.call(Ot,e,r);return n}function Fy(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Ly(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Fy(Object(t),!0).forEach(function(n){(0,Dy.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Fy(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Tl=Ly(Ly({},_n),{},{id:"wms-layer-description",name:"WMS DescribeLayer",parse:function(){var e=(0,ky.default)(bl.default.mark(function t(n,a){return bl.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",_l(new TextDecoder().decode(n),a));case 1:case"end":return o.stop()}},t)}));function r(t,n){return e.apply(this,arguments)}return r}(),parseTextSync:function(r,t){return _l(r,t)}});var zy=m(H()),Wy=m(Te()),qy=m(xe()),xl=m(be());var Uy=m(W()),jy=m(H()),Hy=m(z());function Gy(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Ny(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Gy(Object(t),!0).forEach(function(n){(0,Uy.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Gy(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Vy=function(){function e(r){(0,jy.default)(this,e),g(this,"fetch",void 0),g(this,"loadOptions",void 0),g(this,"_needsRefresh",!0),g(this,"props",void 0),this.props=Ny({},r),this.loadOptions=Ny({},r.loadOptions),this.fetch=rP(this.loadOptions)}return(0,Hy.default)(e,[{key:"setProps",value:function(t){this.props=Object.assign(this.props,t),this.setNeedsRefresh()}},{key:"setNeedsRefresh",value:function(){this._needsRefresh=!0}},{key:"getNeedsRefresh",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=this._needsRefresh;return t&&(this._needsRefresh=!1),n}}]),e}();function rP(e){var r=e?.fetch;if(r&&typeof r=="function")return function(n,a){return r(n,a)};var t=e?.fetch;return t&&typeof t!="function"?function(n){return fetch(n,t)}:function(n){return fetch(n)}}function nP(e){var r=aP();return function(){var n=(0,xl.default)(e),a;if(r){var i=(0,xl.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,qy.default)(this,a)}}function aP(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var dr=function(e){(0,Wy.default)(t,e);var r=nP(t);function t(){return(0,zy.default)(this,t),r.apply(this,arguments)}return t}(Vy);var i0=m(W()),zl=m(ie()),Wl=m(K()),o0=m(H()),s0=m(z()),u0=m(Te()),f0=m(xe()),ql=m(be()),xi=m(Y());var Jy="3.4.2";var r0=m(K()),Nl=m(Y());var iP=globalThis._parseImageNode,El=typeof Image<"u",Sl=typeof ImageBitmap<"u",oP=Boolean(iP),wl=ui?!0:oP;function Xy(e){switch(e){case"auto":return Sl||El||wl;case"imagebitmap":return Sl;case"image":return El;case"data":return wl;default:throw new Error("@loaders.gl/images: image ".concat(e," not supported in this environment"))}}function Ky(){if(Sl)return"imagebitmap";if(El)return"image";if(wl)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}var Yy=m(Ge());function sP(e){var r=uP(e);if(!r)throw new Error("Not an image");return r}function Zy(e){switch(sP(e)){case"data":return e;case"image":case"imagebitmap":var r=document.createElement("canvas"),t=r.getContext("2d");if(!t)throw new Error("getImageData");return r.width=e.width,r.height=e.height,t.drawImage(e,0,0),t.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function uP(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&e instanceof Image?"image":e&&(0,Yy.default)(e)==="object"&&e.data&&e.width&&e.height?"data":null}var Ol=m(K()),yi=m(Y());var fP=/^data:image\/svg\+xml/,lP=/\.svg((\?|#).*)?$/;function zo(e){return e&&(fP.test(e)||lP.test(e))}function $y(e,r){if(zo(r)){var t=new TextDecoder,n=t.decode(e);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(n=unescape(encodeURIComponent(n)))}catch(i){throw new Error(i.message)}var a="data:image/svg+xml;base64,".concat(btoa(n));return a}return Cl(e,r)}function Cl(e,r){if(zo(r))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}function Ai(e,r,t){return Bl.apply(this,arguments)}function Bl(){return Bl=(0,Ol.default)(yi.default.mark(function e(r,t,n){var a,i,o;return yi.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return a=$y(r,n),i=self.URL||self.webkitURL,o=typeof a!="string"&&i.createObjectURL(a),u.prev=3,u.next=6,cP(o||a,t);case 6:return u.abrupt("return",u.sent);case 7:return u.prev=7,o&&i.revokeObjectURL(o),u.finish(7);case 10:case"end":return u.stop()}},e,null,[[3,,7,10]])})),Bl.apply(this,arguments)}function cP(e,r){return Ml.apply(this,arguments)}function Ml(){return Ml=(0,Ol.default)(yi.default.mark(function e(r,t){var n;return yi.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n=new Image,n.src=r,!(t.image&&t.image.decode&&n.decode)){i.next=6;break}return i.next=5,n.decode();case 5:return i.abrupt("return",n);case 6:return i.next=8,new Promise(function(o,s){try{n.onload=function(){return o(n)},n.onerror=function(u){return s(new Error("Could not load image ".concat(r,": ").concat(u)))}}catch(u){s(u)}});case 8:return i.abrupt("return",i.sent);case 9:case"end":return i.stop()}},e)})),Ml.apply(this,arguments)}var Rl=m(K()),_i=m(Y());var hP={},Qy=!0;function Fl(e,r,t){return Pl.apply(this,arguments)}function Pl(){return Pl=(0,Rl.default)(_i.default.mark(function e(r,t,n){var a,i,o;return _i.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!zo(n)){u.next=7;break}return u.next=3,Ai(r,t,n);case 3:i=u.sent,a=i,u.next=8;break;case 7:a=Cl(r,n);case 8:return o=t&&t.imagebitmap,u.next=11,dP(a,o);case 11:return u.abrupt("return",u.sent);case 12:case"end":return u.stop()}},e)})),Pl.apply(this,arguments)}function dP(e){return Il.apply(this,arguments)}function Il(){return Il=(0,Rl.default)(_i.default.mark(function e(r){var t,n=arguments;return _i.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(t=n.length>1&&n[1]!==void 0?n[1]:null,(pP(t)||!Qy)&&(t=null),!t){i.next=13;break}return i.prev=3,i.next=6,createImageBitmap(r,t);case 6:return i.abrupt("return",i.sent);case 9:i.prev=9,i.t0=i.catch(3),console.warn(i.t0),Qy=!1;case 13:return i.next=15,createImageBitmap(r);case 15:return i.abrupt("return",i.sent);case 16:case"end":return i.stop()}},e,null,[[3,9]])})),Il.apply(this,arguments)}function pP(e){for(var r in e||hP)return!1;return!0}var t0=m(K()),kl=m(Y());var Ll=m(st());function e0(e){return!yP(e,"ftyp",4)||!(e[8]&96)?null:mP(e)}function mP(e){var r=vP(e,8,12).replace("\0"," ").trim();switch(r){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function vP(e,r,t){return String.fromCharCode.apply(String,(0,Ll.default)(e.slice(r,t)))}function gP(e){return(0,Ll.default)(e).map(function(r){return r.charCodeAt(0)})}function yP(e,r){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=gP(r),a=0;a<n.length;++a)if(n[a]!==e[a+t])return!1;return!0}var $t=!1,bi=!0;function bn(e){var r=Ti(e);return _P(r)||xP(r)||bP(r)||TP(r)||AP(r)}function AP(e){var r=new Uint8Array(e instanceof DataView?e.buffer:e),t=e0(r);return t?{mimeType:t.mimeType,width:0,height:0}:null}function _P(e){var r=Ti(e),t=r.byteLength>=24&&r.getUint32(0,$t)===2303741511;return t?{mimeType:"image/png",width:r.getUint32(16,$t),height:r.getUint32(20,$t)}:null}function bP(e){var r=Ti(e),t=r.byteLength>=10&&r.getUint32(0,$t)===1195984440;return t?{mimeType:"image/gif",width:r.getUint16(6,bi),height:r.getUint16(8,bi)}:null}function TP(e){var r=Ti(e),t=r.byteLength>=14&&r.getUint16(0,$t)===16973&&r.getUint32(2,bi)===r.byteLength;return t?{mimeType:"image/bmp",width:r.getUint32(18,bi),height:r.getUint32(22,bi)}:null}function xP(e){var r=Ti(e),t=r.byteLength>=3&&r.getUint16(0,$t)===65496&&r.getUint8(2)===255;if(!t)return null;for(var n=EP(),a=n.tableMarkers,i=n.sofMarkers,o=2;o+9<r.byteLength;){var s=r.getUint16(o,$t);if(i.has(s))return{mimeType:"image/jpeg",height:r.getUint16(o+5,$t),width:r.getUint16(o+7,$t)};if(!a.has(s))return null;o+=2,o+=r.getUint16(o,$t)}return null}function EP(){for(var e=new Set([65499,65476,65484,65501,65534]),r=65504;r<65520;++r)e.add(r);var t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}function Ti(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}function Gl(e,r){return Dl.apply(this,arguments)}function Dl(){return Dl=(0,t0.default)(kl.default.mark(function e(r,t){var n,a,i;return kl.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=bn(r)||{},a=n.mimeType,i=globalThis._parseImageNode,se(i),s.next=5,i(r,a);case 5:return s.abrupt("return",s.sent);case 6:case"end":return s.stop()}},e)})),Dl.apply(this,arguments)}function jl(e,r,t){return Ul.apply(this,arguments)}function Ul(){return Ul=(0,r0.default)(Nl.default.mark(function e(r,t,n){var a,i,o,s,u,f;return Nl.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:t=t||{},a=t.image||{},i=a.type||"auto",o=n||{},s=o.url,u=SP(i),c.t0=u,c.next=c.t0==="imagebitmap"?8:c.t0==="image"?12:c.t0==="data"?16:20;break;case 8:return c.next=10,Fl(r,t,s);case 10:return f=c.sent,c.abrupt("break",21);case 12:return c.next=14,Ai(r,t,s);case 14:return f=c.sent,c.abrupt("break",21);case 16:return c.next=18,Gl(r,t);case 18:return f=c.sent,c.abrupt("break",21);case 20:se(!1);case 21:return i==="data"&&(f=Zy(f)),c.abrupt("return",f);case 23:case"end":return c.stop()}},e)})),Ul.apply(this,arguments)}function SP(e){switch(e){case"auto":case"data":return Ky();default:return Xy(e),e}}var wP=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],CP=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],BP={image:{type:"auto",decode:!0}},pr={id:"image",module:"images",name:"Images",version:Jy,mimeTypes:CP,extensions:wP,parse:jl,tests:[function(e){return Boolean(bn(new DataView(e)))}],options:BP};var MP=m(K()),OP=m(Y());var Hl={};function Vl(e){if(Hl[e]===void 0){var r=ui?IP(e):PP(e);Hl[e]=r}return Hl[e]}function PP(e){var r=["image/png","image/jpeg","image/gif"],t=globalThis._parseImageNode,n=globalThis._imageFormatsNode,a=n===void 0?r:n;return Boolean(t)&&a.includes(e)}function IP(e){switch(e){case"image/avif":case"image/webp":return RP(e);default:return!0}}function RP(e){try{var r=document.createElement("canvas"),t=r.toDataURL(e);return t.indexOf("data:".concat(e))===0}catch{return!1}}function n0(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function a0(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?n0(Object(t),!0).forEach(function(n){(0,i0.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n0(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function FP(e){var r=LP();return function(){var n=(0,ql.default)(e),a;if(r){var i=(0,ql.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,f0.default)(this,a)}}function LP(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ei=function(e){(0,u0.default)(t,e);var r=FP(t);function t(n){return(0,o0.default)(this,t),r.call(this,n)}return(0,s0.default)(t,[{key:"getMetadata",value:function(){var n=(0,Wl.default)(xi.default.mark(function i(){return xi.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:throw new Error("ImageSource.getMetadata not implemented");case 1:case"end":return s.stop()}},i)}));function a(){return n.apply(this,arguments)}return a}()},{key:"getImage",value:function(){var n=(0,Wl.default)(xi.default.mark(function i(o){var s,u,f,l;return xi.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return s=this.getGranularParameters(o),u=this.getURLFromTemplate(s),h.next=4,this.fetch(u);case 4:return f=h.sent,h.next=7,f.arrayBuffer();case 7:return l=h.sent,h.next=10,pr.parse(l);case 10:return h.abrupt("return",h.sent);case 11:case"end":return h.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getGranularParameters",value:function(a){var i=(0,zl.default)(a.bbox,4),o=i[0],s=i[1],u=i[2],f=i[3];return a0(a0({},a),{},{east:o,north:s,south:f,west:u})}},{key:"getURLFromTemplate",value:function(a){for(var i=this.props.url,o=0,s=Object.entries(a);o<s.length;o++){var u=(0,zl.default)(s[o],2),f=u[0],l=u[1];i=i.replace("${".concat(f,"}"),String(l)),i=i.replace("{".concat(f,"}"),String(l))}return i}}]),t}(dr);g(Ei,"type","template");g(Ei,"testURL",function(e){return e.toLowerCase().includes("{")});var Wo=m(ie()),er=m(K()),h0=m(W()),d0=m(H()),p0=m(z()),Dr=m(wt()),m0=m(Te()),v0=m(xe()),Jl=m(be()),qe=m(Y());function kP(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=DP(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function DP(e,r){if(e){if(typeof e=="string")return l0(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return l0(e,r)}}function l0(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function c0(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Qt(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?c0(Object(t),!0).forEach(function(n){(0,h0.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c0(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function GP(e){var r=NP();return function(){var n=(0,Jl.default)(e),a;if(r){var i=(0,Jl.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,v0.default)(this,a)}}function NP(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Si=function(e){(0,m0.default)(t,e);var r=GP(t);function t(n){var a;(0,d0.default)(this,t);var i;return a=r.call(this,n),g((0,Dr.default)(a),"url",void 0),g((0,Dr.default)(a),"substituteCRS84",void 0),g((0,Dr.default)(a),"flipCRS",void 0),g((0,Dr.default)(a),"wmsParameters",void 0),g((0,Dr.default)(a),"vendorParameters",void 0),g((0,Dr.default)(a),"capabilities",null),g((0,Dr.default)(a),"loaders",[pr,la,_n,Al,Tl]),a.url=n.url,a.substituteCRS84=(i=n.substituteCRS84)!==null&&i!==void 0?i:!1,a.flipCRS=["EPSG:4326"],a.wmsParameters=Qt({layers:void 0,query_layers:void 0,styles:void 0,version:"1.3.0",crs:"EPSG:4326",format:"image/png",info_format:"text/plain",transparent:void 0,time:void 0,elevation:void 0},n.wmsParameters),a.vendorParameters=n.vendorParameters||{},a}return(0,p0.default)(t,[{key:"getMetadata",value:function(){var n=(0,er.default)(qe.default.mark(function i(){var o;return qe.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.getCapabilities();case 2:return o=u.sent,u.abrupt("return",this.normalizeMetadata(o));case 4:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"getImage",value:function(){var n=(0,er.default)(qe.default.mark(function i(o){return qe.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.getMap(o);case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"normalizeMetadata",value:function(a){return a}},{key:"getCapabilities",value:function(){var n=(0,er.default)(qe.default.mark(function i(o,s){var u,f,l,c;return qe.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return u=this.getCapabilitiesURL(o,s),d.next=3,this.fetch(u);case 3:return f=d.sent,d.next=6,f.arrayBuffer();case 6:return l=d.sent,this._checkResponse(f,l),d.next=10,_n.parse(l,this.loadOptions);case 10:return c=d.sent,this.capabilities=c,d.abrupt("return",c);case 13:case"end":return d.stop()}},i,this)}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"getMap",value:function(){var n=(0,er.default)(qe.default.mark(function i(o,s){var u,f,l;return qe.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return u=this.getMapURL(o,s),h.next=3,this.fetch(u);case 3:return f=h.sent,h.next=6,f.arrayBuffer();case 6:return l=h.sent,this._checkResponse(f,l),h.prev=8,h.next=11,pr.parse(l,this.loadOptions);case 11:return h.abrupt("return",h.sent);case 14:throw h.prev=14,h.t0=h.catch(8),this._parseError(l);case 17:case"end":return h.stop()}},i,this,[[8,14]])}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"getFeatureInfo",value:function(){var n=(0,er.default)(qe.default.mark(function i(o,s){var u,f,l;return qe.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return u=this.getFeatureInfoURL(o,s),h.next=3,this.fetch(u);case 3:return f=h.sent,h.next=6,f.arrayBuffer();case 6:return l=h.sent,this._checkResponse(f,l),h.next=10,Al.parse(l,this.loadOptions);case 10:return h.abrupt("return",h.sent);case 11:case"end":return h.stop()}},i,this)}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"getFeatureInfoText",value:function(){var n=(0,er.default)(qe.default.mark(function i(o,s){var u,f,l;return qe.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return u=this.getFeatureInfoURL(o,s),h.next=3,this.fetch(u);case 3:return f=h.sent,h.next=6,f.arrayBuffer();case 6:return l=h.sent,this._checkResponse(f,l),h.abrupt("return",new TextDecoder().decode(l));case 9:case"end":return h.stop()}},i,this)}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"describeLayer",value:function(){var n=(0,er.default)(qe.default.mark(function i(o,s){var u,f,l;return qe.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return u=this.describeLayerURL(o,s),h.next=3,this.fetch(u);case 3:return f=h.sent,h.next=6,f.arrayBuffer();case 6:return l=h.sent,this._checkResponse(f,l),h.next=10,Tl.parse(l,this.loadOptions);case 10:return h.abrupt("return",h.sent);case 11:case"end":return h.stop()}},i,this)}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"getLegendGraphic",value:function(){var n=(0,er.default)(qe.default.mark(function i(o,s){var u,f,l;return qe.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return u=this.getLegendGraphicURL(o,s),h.next=3,this.fetch(u);case 3:return f=h.sent,h.next=6,f.arrayBuffer();case 6:return l=h.sent,this._checkResponse(f,l),h.prev=8,h.next=11,pr.parse(l,this.loadOptions);case 11:return h.abrupt("return",h.sent);case 14:throw h.prev=14,h.t0=h.catch(8),this._parseError(l);case 17:case"end":return h.stop()}},i,this,[[8,14]])}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"getCapabilitiesURL",value:function(a,i){var o=Qt({version:this.wmsParameters.version},a);return this._getWMSUrl("GetCapabilities",o,i)}},{key:"getMapURL",value:function(a,i){a=this._getWMS130Parameters(a);var o=Qt({version:this.wmsParameters.version,format:this.wmsParameters.format,transparent:this.wmsParameters.transparent,time:this.wmsParameters.time,elevation:this.wmsParameters.elevation,layers:this.wmsParameters.layers,styles:this.wmsParameters.styles,crs:this.wmsParameters.crs},a);return this._getWMSUrl("GetMap",o,i)}},{key:"getFeatureInfoURL",value:function(a,i){var o=Qt({version:this.wmsParameters.version,info_format:this.wmsParameters.info_format,layers:this.wmsParameters.layers,query_layers:this.wmsParameters.query_layers,styles:this.wmsParameters.styles,crs:this.wmsParameters.crs},a);return this._getWMSUrl("GetFeatureInfo",o,i)}},{key:"describeLayerURL",value:function(a,i){var o=Qt({version:this.wmsParameters.version},a);return this._getWMSUrl("DescribeLayer",o,i)}},{key:"getLegendGraphicURL",value:function(a,i){var o=Qt({version:this.wmsParameters.version},a);return this._getWMSUrl("GetLegendGraphic",o,i)}},{key:"_parseWMSUrl",value:function(a){var i=a.split("?"),o=(0,Wo.default)(i,2),s=o[0],u=o[1],f=u.split("&"),l={},c=kP(f),h;try{for(c.s();!(h=c.n()).done;){var d=h.value,p=d.split("="),v=(0,Wo.default)(p,2),y=v[0],A=v[1];l[y]=A}}catch(_){c.e(_)}finally{c.f()}return{url:s,parameters:l}}},{key:"_getWMSUrl",value:function(a,i,o){for(var s=this.url,u=!0,f=Qt(Qt(Qt({service:"WMS",version:i.version,request:a},i),this.vendorParameters),o),l=["transparent","time","elevation"],c=0,h=Object.entries(f);c<h.length;c++){var d=(0,Wo.default)(h[c],2),p=d[0],v=d[1];(!l.includes(p)||v)&&(s+=u?"?":"&",u=!1,s+=this._getURLParameter(p,v,i))}return encodeURI(s)}},{key:"_getWMS130Parameters",value:function(a){var i=Qt({},a);return i.srs&&(i.crs=i.crs||i.srs,delete i.srs),i}},{key:"_getURLParameter",value:function(a,i,o){switch(a){case"crs":o.version!=="1.3.0"?a="srs":this.substituteCRS84&&i==="EPSG:4326"&&(i="CRS:84");break;case"srs":o.version==="1.3.0"&&(a="crs");break;case"bbox":var s=this._flipBoundingBox(i,o);s&&(i=s);break;default:}return a=a.toUpperCase(),Array.isArray(i)?"".concat(a,"=").concat(i.join(",")):"".concat(a,"=").concat(i?String(i):"")}},{key:"_flipBoundingBox",value:function(a,i){if(!Array.isArray(a)||a.length!==4)return null;var o=i.version==="1.3.0"&&this.flipCRS.includes(i.crs||"")&&!(this.substituteCRS84&&i.crs==="EPSG:4326"),s=a;return o?[s[1],s[0],s[3],s[2]]:s}},{key:"_fetchArrayBuffer",value:function(){var n=(0,er.default)(qe.default.mark(function i(o){var s,u;return qe.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.fetch(o);case 2:return s=l.sent,l.next=5,s.arrayBuffer();case 5:return u=l.sent,this._checkResponse(s,u),l.abrupt("return",u);case 8:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_checkResponse",value:function(a,i){var o=a.headers["content-type"];if(!a.ok||la.mimeTypes.includes(o)){var s=al(this.loadOptions,{wms:{throwOnError:!0}}),u=la.parseSync(i,s);throw new Error(u)}}},{key:"_parseError",value:function(a){var i=la.parseSync(a,this.loadOptions);return new Error(i)}}]),t}(dr);g(Si,"type","wms");g(Si,"testURL",function(e){return e.toLowerCase().includes("wms")});var A0=m(ie()),_0=m(W()),wi=m(K()),b0=m(H()),T0=m(z()),x0=m(Te()),E0=m(xe()),Xl=m(be()),mr=m(Y());function g0(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function y0(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?g0(Object(t),!0).forEach(function(n){(0,_0.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g0(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function UP(e){var r=jP();return function(){var n=(0,Xl.default)(e),a;if(r){var i=(0,Xl.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,E0.default)(this,a)}}function jP(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var qo=function(e){(0,x0.default)(t,e);var r=UP(t);function t(n){return(0,b0.default)(this,t),r.call(this,n)}return(0,T0.default)(t,[{key:"getMetadata",value:function(){var n=(0,wi.default)(mr.default.mark(function i(){return mr.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.metadata();case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"getImage",value:function(){var n=(0,wi.default)(mr.default.mark(function i(o){return mr.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:throw new Error("not implemented");case 1:case"end":return u.stop()}},i)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"metadata",value:function(){var n=(0,wi.default)(mr.default.mark(function i(){return mr.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:throw new Error("not implemented");case 1:case"end":return s.stop()}},i)}));function a(){return n.apply(this,arguments)}return a}()},{key:"exportImage",value:function(a){throw new Error("not implemented")}},{key:"metadataURL",value:function(a){return"".concat(this.props.url,"?f=pjson")}},{key:"exportImageURL",value:function(a){var i="bbox=".concat(a.bbox[0],",").concat(a.bbox[1],",").concat(a.bbox[2],",").concat(a.bbox[3]),o="size=".concat(a.width,",").concat(a.height),s=y0(y0({},a),{},{bbox:i,size:o});return delete s.width,delete s.height,this.getUrl("exportImage",s)}},{key:"getUrl",value:function(a,i,o){for(var s="".concat(this.props.url,"/").concat(a),u=!0,f=0,l=Object.entries(i);f<l.length;f++){var c=(0,A0.default)(l[f],2),h=c[0],d=c[1];s+=u?"?":"&",u=!1,Array.isArray(d)?s+="".concat(h.toUpperCase(),"=").concat(d.join(",")):s+="".concat(h.toUpperCase(),"=").concat(d?String(d):"")}return s}},{key:"checkResponse",value:function(){var n=(0,wi.default)(mr.default.mark(function i(o){return mr.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(o.ok){u.next=2;break}throw new Error("error");case 2:case"end":return u.stop()}},i)}));function a(i){return n.apply(this,arguments)}return a}()}]),t}(dr);g(qo,"type","arcgis-image-server");g(qo,"testURL",function(e){return e.toLowerCase().includes("ImageServer")});function HP(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=VP(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function VP(e,r){if(e){if(typeof e=="string")return S0(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return S0(e,r)}}function S0(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var zP=[Si,qo,Ei];function Kl(e){var r=e.type,t=r===void 0?"auto":r,n=t==="auto"?WP(e.url):t;switch(n){case"template":return new Ei(e);case"wms":return new Si(e);default:throw new Error("Not a valid image source type")}}function WP(e){var r=HP(zP),t;try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.testURL&&n.testURL(e))return n.type}}catch(a){r.e(a)}finally{r.f()}return"wms"}function ca(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Yl(e){if(Array.isArray(e))return ca(e)}function Zl(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ci(e,r){if(e){if(typeof e=="string")return ca(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ca(e,r)}}function $l(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ha(e){return Yl(e)||Zl(e)||Ci(e)||$l()}function Ql(e){if(Array.isArray(e))return e}function ec(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],a=!0,i=!1,o,s;try{for(t=t.call(e);!(a=(o=t.next()).done)&&(n.push(o.value),!(r&&n.length===r));a=!0);}catch(u){i=!0,s=u}finally{try{!a&&t.return!=null&&t.return()}finally{if(i)throw s}}return n}}function tc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rt(e,r){return Ql(e)||ec(e,r)||Ci(e,r)||tc()}function rc(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function w0(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nc(e,r,t){return r&&w0(e.prototype,r),t&&w0(e,t),e}function we(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var Ee=1e-6,tt=typeof Float32Array<"u"?Float32Array:Array;var dH=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,r=arguments.length;r--;)e+=arguments[r]*arguments[r];return Math.sqrt(e)});function qP(){var e=new tt(4);return tt!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function C0(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e}function Jo(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e}function B0(e){var r=e[0],t=e[1],n=e[2],a=e[3];return Math.hypot(r,t,n,a)}function M0(e){var r=e[0],t=e[1],n=e[2],a=e[3];return r*r+t*t+n*n+a*a}function O0(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],o=t*t+n*n+a*a+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t*o,e[1]=n*o,e[2]=a*o,e[3]=i*o,e}function P0(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3]}function I0(e,r,t,n){var a=r[0],i=r[1],o=r[2],s=r[3];return e[0]=a+n*(t[0]-a),e[1]=i+n*(t[1]-i),e[2]=o+n*(t[2]-o),e[3]=s+n*(t[3]-s),e}function Xo(e,r,t){var n=r[0],a=r[1],i=r[2],o=r[3];return e[0]=t[0]*n+t[4]*a+t[8]*i+t[12]*o,e[1]=t[1]*n+t[5]*a+t[9]*i+t[13]*o,e[2]=t[2]*n+t[6]*a+t[10]*i+t[14]*o,e[3]=t[3]*n+t[7]*a+t[11]*i+t[15]*o,e}function R0(e,r,t){var n=r[0],a=r[1],i=r[2],o=t[0],s=t[1],u=t[2],f=t[3],l=f*n+s*i-u*a,c=f*a+u*n-o*i,h=f*i+o*a-s*n,d=-o*n-s*a-u*i;return e[0]=l*f+d*-o+c*-u-h*-s,e[1]=c*f+d*-s+h*-o-l*-u,e[2]=h*f+d*-u+l*-s-c*-o,e[3]=r[3],e}var pH=function(){var e=qP();return function(r,t,n,a,i,o){var s,u;for(t||(t=4),n||(n=0),a?u=Math.min(a*t+n,r.length):u=r.length,s=n;s<u;s+=t)e[0]=r[s],e[1]=r[s+1],e[2]=r[s+2],e[3]=r[s+3],i(e,e,o),r[s]=e[0],r[s+1]=e[1],r[s+2]=e[2],r[s+3]=e[3];return r}}();function pa(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Gr(e,r){var t=Xo([],r,e);return Jo(t,t,1/t[3]),t}function Bi(e,r,t){return e<r?r:e>t?t:e}function JP(e){return Math.log(e)*Math.LOG2E}var Ko=Math.log2||JP;function XP(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function F0(e,r){if(e===r){var t=r[1],n=r[2],a=r[3],i=r[6],o=r[7],s=r[11];e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=t,e[6]=r[9],e[7]=r[13],e[8]=n,e[9]=i,e[11]=r[14],e[12]=a,e[13]=o,e[14]=s}else e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=r[1],e[5]=r[5],e[6]=r[9],e[7]=r[13],e[8]=r[2],e[9]=r[6],e[10]=r[10],e[11]=r[14],e[12]=r[3],e[13]=r[7],e[14]=r[11],e[15]=r[15];return e}function Yo(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],o=r[4],s=r[5],u=r[6],f=r[7],l=r[8],c=r[9],h=r[10],d=r[11],p=r[12],v=r[13],y=r[14],A=r[15],_=t*s-n*o,E=t*u-a*o,x=t*f-i*o,C=n*u-a*s,B=n*f-i*s,F=a*f-i*u,M=l*v-c*p,w=l*y-h*p,b=l*A-d*p,I=c*y-h*v,L=c*A-d*v,k=h*A-d*y,D=_*k-E*L+x*I+C*b-B*w+F*M;return D?(D=1/D,e[0]=(s*k-u*L+f*I)*D,e[1]=(a*L-n*k-i*I)*D,e[2]=(v*F-y*B+A*C)*D,e[3]=(h*B-c*F-d*C)*D,e[4]=(u*b-o*k-f*w)*D,e[5]=(t*k-a*b+i*w)*D,e[6]=(y*x-p*F-A*E)*D,e[7]=(l*F-h*x+d*E)*D,e[8]=(o*L-s*b+f*M)*D,e[9]=(n*b-t*L-i*M)*D,e[10]=(p*B-v*x+A*_)*D,e[11]=(c*x-l*B-d*_)*D,e[12]=(s*w-o*I-u*M)*D,e[13]=(t*I-n*w+a*M)*D,e[14]=(v*E-p*C-y*_)*D,e[15]=(l*C-c*E+h*_)*D,e):null}function L0(e){var r=e[0],t=e[1],n=e[2],a=e[3],i=e[4],o=e[5],s=e[6],u=e[7],f=e[8],l=e[9],c=e[10],h=e[11],d=e[12],p=e[13],v=e[14],y=e[15],A=r*o-t*i,_=r*s-n*i,E=r*u-a*i,x=t*s-n*o,C=t*u-a*o,B=n*u-a*s,F=f*p-l*d,M=f*v-c*d,w=f*y-h*d,b=l*v-c*p,I=l*y-h*p,L=c*y-h*v;return A*L-_*I+E*b+x*w-C*M+B*F}function Tn(e,r,t){var n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],u=r[5],f=r[6],l=r[7],c=r[8],h=r[9],d=r[10],p=r[11],v=r[12],y=r[13],A=r[14],_=r[15],E=t[0],x=t[1],C=t[2],B=t[3];return e[0]=E*n+x*s+C*c+B*v,e[1]=E*a+x*u+C*h+B*y,e[2]=E*i+x*f+C*d+B*A,e[3]=E*o+x*l+C*p+B*_,E=t[4],x=t[5],C=t[6],B=t[7],e[4]=E*n+x*s+C*c+B*v,e[5]=E*a+x*u+C*h+B*y,e[6]=E*i+x*f+C*d+B*A,e[7]=E*o+x*l+C*p+B*_,E=t[8],x=t[9],C=t[10],B=t[11],e[8]=E*n+x*s+C*c+B*v,e[9]=E*a+x*u+C*h+B*y,e[10]=E*i+x*f+C*d+B*A,e[11]=E*o+x*l+C*p+B*_,E=t[12],x=t[13],C=t[14],B=t[15],e[12]=E*n+x*s+C*c+B*v,e[13]=E*a+x*u+C*h+B*y,e[14]=E*i+x*f+C*d+B*A,e[15]=E*o+x*l+C*p+B*_,e}function xn(e,r,t){var n=t[0],a=t[1],i=t[2],o,s,u,f,l,c,h,d,p,v,y,A;return r===e?(e[12]=r[0]*n+r[4]*a+r[8]*i+r[12],e[13]=r[1]*n+r[5]*a+r[9]*i+r[13],e[14]=r[2]*n+r[6]*a+r[10]*i+r[14],e[15]=r[3]*n+r[7]*a+r[11]*i+r[15]):(o=r[0],s=r[1],u=r[2],f=r[3],l=r[4],c=r[5],h=r[6],d=r[7],p=r[8],v=r[9],y=r[10],A=r[11],e[0]=o,e[1]=s,e[2]=u,e[3]=f,e[4]=l,e[5]=c,e[6]=h,e[7]=d,e[8]=p,e[9]=v,e[10]=y,e[11]=A,e[12]=o*n+l*a+p*i+r[12],e[13]=s*n+c*a+v*i+r[13],e[14]=u*n+h*a+y*i+r[14],e[15]=f*n+d*a+A*i+r[15]),e}function ma(e,r,t){var n=t[0],a=t[1],i=t[2];return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e[4]=r[4]*a,e[5]=r[5]*a,e[6]=r[6]*a,e[7]=r[7]*a,e[8]=r[8]*i,e[9]=r[9]*i,e[10]=r[10]*i,e[11]=r[11]*i,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function k0(e,r,t,n){var a=n[0],i=n[1],o=n[2],s=Math.hypot(a,i,o),u,f,l,c,h,d,p,v,y,A,_,E,x,C,B,F,M,w,b,I,L,k,D,O;return s<Ee?null:(s=1/s,a*=s,i*=s,o*=s,u=Math.sin(t),f=Math.cos(t),l=1-f,c=r[0],h=r[1],d=r[2],p=r[3],v=r[4],y=r[5],A=r[6],_=r[7],E=r[8],x=r[9],C=r[10],B=r[11],F=a*a*l+f,M=i*a*l+o*u,w=o*a*l-i*u,b=a*i*l-o*u,I=i*i*l+f,L=o*i*l+a*u,k=a*o*l+i*u,D=i*o*l-a*u,O=o*o*l+f,e[0]=c*F+v*M+E*w,e[1]=h*F+y*M+x*w,e[2]=d*F+A*M+C*w,e[3]=p*F+_*M+B*w,e[4]=c*b+v*I+E*L,e[5]=h*b+y*I+x*L,e[6]=d*b+A*I+C*L,e[7]=p*b+_*I+B*L,e[8]=c*k+v*D+E*O,e[9]=h*k+y*D+x*O,e[10]=d*k+A*D+C*O,e[11]=p*k+_*D+B*O,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)}function Zo(e,r,t){var n=Math.sin(t),a=Math.cos(t),i=r[4],o=r[5],s=r[6],u=r[7],f=r[8],l=r[9],c=r[10],h=r[11];return r!==e&&(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[4]=i*a+f*n,e[5]=o*a+l*n,e[6]=s*a+c*n,e[7]=u*a+h*n,e[8]=f*a-i*n,e[9]=l*a-o*n,e[10]=c*a-s*n,e[11]=h*a-u*n,e}function D0(e,r,t){var n=Math.sin(t),a=Math.cos(t),i=r[0],o=r[1],s=r[2],u=r[3],f=r[8],l=r[9],c=r[10],h=r[11];return r!==e&&(e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=i*a-f*n,e[1]=o*a-l*n,e[2]=s*a-c*n,e[3]=u*a-h*n,e[8]=i*n+f*a,e[9]=o*n+l*a,e[10]=s*n+c*a,e[11]=u*n+h*a,e}function $o(e,r,t){var n=Math.sin(t),a=Math.cos(t),i=r[0],o=r[1],s=r[2],u=r[3],f=r[4],l=r[5],c=r[6],h=r[7];return r!==e&&(e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=i*a+f*n,e[1]=o*a+l*n,e[2]=s*a+c*n,e[3]=u*a+h*n,e[4]=f*a-i*n,e[5]=l*a-o*n,e[6]=c*a-s*n,e[7]=h*a-u*n,e}function G0(e,r){var t=r[0],n=r[1],a=r[2],i=r[4],o=r[5],s=r[6],u=r[8],f=r[9],l=r[10];return e[0]=Math.hypot(t,n,a),e[1]=Math.hypot(i,o,s),e[2]=Math.hypot(u,f,l),e}function N0(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],o=t+t,s=n+n,u=a+a,f=t*o,l=n*o,c=n*s,h=a*o,d=a*s,p=a*u,v=i*o,y=i*s,A=i*u;return e[0]=1-c-p,e[1]=l+A,e[2]=h-y,e[3]=0,e[4]=l-A,e[5]=1-f-p,e[6]=d+v,e[7]=0,e[8]=h+y,e[9]=d-v,e[10]=1-f-c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function U0(e,r,t,n,a,i,o){var s=1/(t-r),u=1/(a-n),f=1/(i-o);return e[0]=i*2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i*2*u,e[6]=0,e[7]=0,e[8]=(t+r)*s,e[9]=(a+n)*u,e[10]=(o+i)*f,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*i*2*f,e[15]=0,e}function KP(e,r,t,n,a){var i=1/Math.tan(r/2),o;return e[0]=i/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,a!=null&&a!==1/0?(o=1/(n-a),e[10]=(a+n)*o,e[14]=2*a*n*o):(e[10]=-1,e[14]=-2*n),e}var Qo=KP;function YP(e,r,t,n,a,i,o){var s=1/(r-t),u=1/(n-a),f=1/(i-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*f,e[11]=0,e[12]=(r+t)*s,e[13]=(a+n)*u,e[14]=(o+i)*f,e[15]=1,e}var j0=YP;function H0(e,r,t,n){var a,i,o,s,u,f,l,c,h,d,p=r[0],v=r[1],y=r[2],A=n[0],_=n[1],E=n[2],x=t[0],C=t[1],B=t[2];return Math.abs(p-x)<Ee&&Math.abs(v-C)<Ee&&Math.abs(y-B)<Ee?XP(e):(l=p-x,c=v-C,h=y-B,d=1/Math.hypot(l,c,h),l*=d,c*=d,h*=d,a=_*h-E*c,i=E*l-A*h,o=A*c-_*l,d=Math.hypot(a,i,o),d?(d=1/d,a*=d,i*=d,o*=d):(a=0,i=0,o=0),s=c*o-h*i,u=h*a-l*o,f=l*i-c*a,d=Math.hypot(s,u,f),d?(d=1/d,s*=d,u*=d,f*=d):(s=0,u=0,f=0),e[0]=a,e[1]=s,e[2]=l,e[3]=0,e[4]=i,e[5]=u,e[6]=c,e[7]=0,e[8]=o,e[9]=f,e[10]=h,e[11]=0,e[12]=-(a*p+i*v+o*y),e[13]=-(s*p+u*v+f*y),e[14]=-(l*p+c*v+h*y),e[15]=1,e)}function oc(e,r){var t=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],f=e[7],l=e[8],c=e[9],h=e[10],d=e[11],p=e[12],v=e[13],y=e[14],A=e[15],_=r[0],E=r[1],x=r[2],C=r[3],B=r[4],F=r[5],M=r[6],w=r[7],b=r[8],I=r[9],L=r[10],k=r[11],D=r[12],O=r[13],P=r[14],R=r[15];return Math.abs(t-_)<=Ee*Math.max(1,Math.abs(t),Math.abs(_))&&Math.abs(n-E)<=Ee*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(a-x)<=Ee*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(i-C)<=Ee*Math.max(1,Math.abs(i),Math.abs(C))&&Math.abs(o-B)<=Ee*Math.max(1,Math.abs(o),Math.abs(B))&&Math.abs(s-F)<=Ee*Math.max(1,Math.abs(s),Math.abs(F))&&Math.abs(u-M)<=Ee*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(f-w)<=Ee*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(l-b)<=Ee*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(c-I)<=Ee*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(h-L)<=Ee*Math.max(1,Math.abs(h),Math.abs(L))&&Math.abs(d-k)<=Ee*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(p-D)<=Ee*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(v-O)<=Ee*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(y-P)<=Ee*Math.max(1,Math.abs(y),Math.abs(P))&&Math.abs(A-R)<=Ee*Math.max(1,Math.abs(A),Math.abs(R))}function ZP(){var e=new tt(2);return tt!=Float32Array&&(e[0]=0,e[1]=0),e}function sc(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e}function V0(e,r){return e[0]=-r[0],e[1]=-r[1],e}function ts(e,r,t,n){var a=r[0],i=r[1];return e[0]=a+n*(t[0]-a),e[1]=i+n*(t[1]-i),e}function z0(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[2]*a,e[1]=t[1]*n+t[3]*a,e}function W0(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[2]*a+t[4],e[1]=t[1]*n+t[3]*a+t[5],e}function rs(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[3]*a+t[6],e[1]=t[1]*n+t[4]*a+t[7],e}function ns(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[4]*a+t[12],e[1]=t[1]*n+t[5]*a+t[13],e}var gH=function(){var e=ZP();return function(r,t,n,a,i,o){var s,u;for(t||(t=2),n||(n=0),a?u=Math.min(a*t+n,r.length):u=r.length,s=n;s<u;s+=t)e[0]=r[s],e[1]=r[s+1],i(e,e,o),r[s]=e[0],r[s+1]=e[1];return r}}();function uc(){var e=new tt(3);return tt!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function fc(e){var r=e[0],t=e[1],n=e[2];return Math.hypot(r,t,n)}function lc(e,r,t){var n=new tt(3);return n[0]=e,n[1]=r,n[2]=t,n}function q0(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e}function $P(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e[2]=r[2]*t[2],e}function J0(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e}function X0(e,r){var t=r[0],n=r[1],a=r[2],i=t*t+n*n+a*a;return i>0&&(i=1/Math.sqrt(i)),e[0]=r[0]*i,e[1]=r[1]*i,e[2]=r[2]*i,e}function Mi(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}function ga(e,r,t){var n=r[0],a=r[1],i=r[2],o=t[0],s=t[1],u=t[2];return e[0]=a*u-i*s,e[1]=i*o-n*u,e[2]=n*s-a*o,e}function ya(e,r,t){var n=r[0],a=r[1],i=r[2],o=t[3]*n+t[7]*a+t[11]*i+t[15];return o=o||1,e[0]=(t[0]*n+t[4]*a+t[8]*i+t[12])/o,e[1]=(t[1]*n+t[5]*a+t[9]*i+t[13])/o,e[2]=(t[2]*n+t[6]*a+t[10]*i+t[14])/o,e}function as(e,r,t){var n=r[0],a=r[1],i=r[2];return e[0]=n*t[0]+a*t[3]+i*t[6],e[1]=n*t[1]+a*t[4]+i*t[7],e[2]=n*t[2]+a*t[5]+i*t[8],e}function is(e,r,t){var n=t[0],a=t[1],i=t[2],o=t[3],s=r[0],u=r[1],f=r[2],l=a*f-i*u,c=i*s-n*f,h=n*u-a*s,d=a*h-i*c,p=i*l-n*h,v=n*c-a*l,y=o*2;return l*=y,c*=y,h*=y,d*=2,p*=2,v*=2,e[0]=s+l+d,e[1]=u+c+p,e[2]=f+h+v,e}function K0(e,r,t,n){var a=[],i=[];return a[0]=r[0]-t[0],a[1]=r[1]-t[1],a[2]=r[2]-t[2],i[0]=a[0],i[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),i[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e}function Y0(e,r,t,n){var a=[],i=[];return a[0]=r[0]-t[0],a[1]=r[1]-t[1],a[2]=r[2]-t[2],i[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),i[1]=a[1],i[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e}function Z0(e,r,t,n){var a=[],i=[];return a[0]=r[0]-t[0],a[1]=r[1]-t[1],a[2]=r[2]-t[2],i[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),i[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),i[2]=a[2],e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e}function $0(e,r){var t=e[0],n=e[1],a=e[2],i=r[0],o=r[1],s=r[2],u=Math.sqrt(t*t+n*n+a*a),f=Math.sqrt(i*i+o*o+s*s),l=u*f,c=l&&Mi(e,r)/l;return Math.acos(Math.min(Math.max(c,-1),1))}var Q0=$P;var e1=fc;var yH=function(){var e=uc();return function(r,t,n,a,i,o){var s,u;for(t||(t=3),n||(n=0),a?u=Math.min(a*t+n,r.length):u=r.length,s=n;s<u;s+=t)e[0]=r[s],e[1]=r[s+1],e[2]=r[s+2],i(e,e,o),r[s]=e[0],r[s+1]=e[1],r[s+2]=e[2];return r}}();function jt(e,r){if(!e)throw new Error(r||"@math.gl/web-mercator: assertion failed.")}var Ht=Math.PI,r1=Ht/4,tr=Ht/180,cc=180/Ht,Oi=512,t1=4003e4,_a=85.051129,hc=1.5;function os(e){return Math.pow(2,e)}function ut(e){var r=rt(e,2),t=r[0],n=r[1];jt(Number.isFinite(t)),jt(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");var a=t*tr,i=n*tr,o=Oi*(a+Ht)/(2*Ht),s=Oi*(Ht+Math.log(Math.tan(r1+i*.5)))/(2*Ht);return[o,s]}function gt(e){var r=rt(e,2),t=r[0],n=r[1],a=t/Oi*(2*Ht)-Ht,i=2*(Math.atan(Math.exp(n/Oi*(2*Ht)-Ht))-r1);return[a*cc,i*cc]}function dc(e){var r=e.latitude,t=e.longitude,n=e.highPrecision,a=n===void 0?!1:n;jt(Number.isFinite(r)&&Number.isFinite(t));var i=Oi,o=Math.cos(r*tr),s=i/360,u=s/o,f=i/t1/o,l={unitsPerMeter:[f,f,f],metersPerUnit:[1/f,1/f,1/f],unitsPerDegree:[s,u,f],degreesPerUnit:[1/s,1/u,1/f]};if(a){var c=tr*Math.tan(r*tr)/o,h=s*c/2,d=i/t1*c,p=d/u*f;l.unitsPerDegree2=[0,h,d],l.unitsPerMeter2=[p,0,p]}return l}function pc(e){var r=e.height,t=e.pitch,n=e.bearing,a=e.altitude,i=e.scale,o=e.center,s=pa();xn(s,s,[0,0,-a]),Zo(s,s,-t*tr),$o(s,s,n*tr);var u=i/r;return ma(s,s,[u,u,u]),o&&xn(s,s,J0([],o)),s}function n1(e){var r=e.width,t=e.height,n=e.altitude,a=e.pitch,i=a===void 0?0:a,o=e.offset,s=e.center,u=e.scale,f=e.nearZMultiplier,l=f===void 0?1:f,c=e.farZMultiplier,h=c===void 0?1:c,d=e.fovy,p=d===void 0?Aa(hc):d;n!==void 0&&(p=Aa(n));var v=p*tr,y=i*tr,A=ss(p),_=A;s&&(_+=s[2]*u/Math.cos(y)/t);var E=v*(.5+(o?o[1]:0)/t),x=Math.sin(E)*_/Math.sin(Bi(Math.PI/2-y-E,.01,Math.PI-.01)),C=Math.sin(y)*x+_,B=_*10,F=Math.min(C*h,B);return{fov:v,aspect:r/t,focalDistance:A,near:l,far:F}}function mc(e){var r=n1(e),t=r.fov,n=r.aspect,a=r.near,i=r.far,o=Qo([],t,n,a,i);return o}function Aa(e){return 2*Math.atan(.5/e)*cc}function ss(e){return .5/Math.tan(.5*e*tr)}function vc(e,r){var t=rt(e,3),n=t[0],a=t[1],i=t[2],o=i===void 0?0:i;return jt(Number.isFinite(n)&&Number.isFinite(a)&&Number.isFinite(o)),Gr(r,[n,a,o,1])}function us(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=rt(e,3),a=n[0],i=n[1],o=n[2];if(jt(Number.isFinite(a)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(o)){var s=Gr(r,[a,i,o,1]);return s}var u=Gr(r,[a,i,0,1]),f=Gr(r,[a,i,1,1]),l=u[2],c=f[2],h=l===c?0:((t||0)-l)/(c-l);return ts([],u,f,h)}function fs(e){var r=e.width,t=e.height,n=e.bounds,a=e.minExtent,i=a===void 0?0:a,o=e.maxZoom,s=o===void 0?24:o,u=e.offset,f=u===void 0?[0,0]:u,l=rt(n,2),c=rt(l[0],2),h=c[0],d=c[1],p=rt(l[1],2),v=p[0],y=p[1],A=QP(e.padding),_=ut([h,Bi(y,-_a,_a)]),E=ut([v,Bi(d,-_a,_a)]),x=[Math.max(Math.abs(E[0]-_[0]),i),Math.max(Math.abs(E[1]-_[1]),i)],C=[r-A.left-A.right-Math.abs(f[0])*2,t-A.top-A.bottom-Math.abs(f[1])*2];jt(C[0]>0&&C[1]>0);var B=C[0]/x[0],F=C[1]/x[1],M=(A.right-A.left)/2/B,w=(A.bottom-A.top)/2/F,b=[(E[0]+_[0])/2+M,(E[1]+_[1])/2+w],I=gt(b),L=Math.min(s,Ko(Math.abs(Math.min(B,F))));return jt(Number.isFinite(L)),{longitude:I[0],latitude:I[1],zoom:L}}function QP(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return typeof e=="number"?{top:e,bottom:e,left:e,right:e}:(jt(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e)}var a1=Math.PI/180;function ls(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=e.width,n=e.height,a=e.unproject,i={targetZ:r},o=a([0,n],i),s=a([t,n],i),u,f,l=e.fovy?.5*e.fovy*a1:Math.atan(.5/e.altitude),c=(90-e.pitch)*a1;return l>c-.01?(u=i1(e,0,r),f=i1(e,t,r)):(u=a([0,0],i),f=a([t,0],i)),[o,s,f,u]}function i1(e,r,t){var n=e.pixelUnprojectionMatrix,a=Gr(n,[r,0,1,1]),i=Gr(n,[r,e.height,1,1]),o=t*e.distanceScales.unitsPerMeter[2],s=(o-a[2])/(i[2]-a[2]),u=ts([],a,i,s),f=gt(u);return f.push(t),f}var o1=function(){function e(){var r=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{width:1,height:1};rc(this,e),we(this,"latitude",void 0),we(this,"longitude",void 0),we(this,"zoom",void 0),we(this,"pitch",void 0),we(this,"bearing",void 0),we(this,"altitude",void 0),we(this,"fovy",void 0),we(this,"meterOffset",void 0),we(this,"center",void 0),we(this,"width",void 0),we(this,"height",void 0),we(this,"scale",void 0),we(this,"distanceScales",void 0),we(this,"viewMatrix",void 0),we(this,"projectionMatrix",void 0),we(this,"viewProjectionMatrix",void 0),we(this,"pixelProjectionMatrix",void 0),we(this,"pixelUnprojectionMatrix",void 0),we(this,"equals",function(L){return L instanceof e?L.width===r.width&&L.height===r.height&&oc(L.projectionMatrix,r.projectionMatrix)&&oc(L.viewMatrix,r.viewMatrix):!1}),we(this,"project",function(L){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},D=k.topLeft,O=D===void 0?!0:D,P=r.projectPosition(L),R=vc(P,r.pixelProjectionMatrix),j=rt(R,2),G=j[0],V=j[1],X=O?V:r.height-V;return L.length===2?[G,X]:[G,X,R[2]]}),we(this,"unproject",function(L){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},D=k.topLeft,O=D===void 0?!0:D,P=k.targetZ,R=P===void 0?void 0:P,j=rt(L,3),G=j[0],V=j[1],X=j[2],ne=O?V:r.height-V,ke=R&&R*r.distanceScales.unitsPerMeter[2],Oe=us([G,ne,X],r.pixelUnprojectionMatrix,ke),Et=r.unprojectPosition(Oe),He=rt(Et,3),Rr=He[0],mt=He[1],sa=He[2];return Number.isFinite(X)?[Rr,mt,sa]:Number.isFinite(R)?[Rr,mt,R]:[Rr,mt]}),we(this,"projectPosition",function(L){var k=ut(L),D=rt(k,2),O=D[0],P=D[1],R=(L[2]||0)*r.distanceScales.unitsPerMeter[2];return[O,P,R]}),we(this,"unprojectPosition",function(L){var k=gt(L),D=rt(k,2),O=D[0],P=D[1],R=(L[2]||0)*r.distanceScales.metersPerUnit[2];return[O,P,R]});var n=t.width,a=t.height,i=t.altitude,o=i===void 0?null:i,s=t.fovy,u=s===void 0?null:s,f=t.latitude,l=f===void 0?0:f,c=t.longitude,h=c===void 0?0:c,d=t.zoom,p=d===void 0?0:d,v=t.pitch,y=v===void 0?0:v,A=t.bearing,_=A===void 0?0:A,E=t.position,x=E===void 0?null:E,C=t.nearZMultiplier,B=C===void 0?.02:C,F=t.farZMultiplier,M=F===void 0?1.01:F;n=n||1,a=a||1,u===null&&o===null?(o=hc,u=Aa(o)):u===null?u=Aa(o):o===null&&(o=ss(u));var w=os(p);o=Math.max(.75,o);var b=dc({longitude:h,latitude:l}),I=ut([h,l]);I.push(0),x&&q0(I,I,Q0([],x,b.unitsPerMeter)),this.projectionMatrix=mc({width:n,height:a,scale:w,center:I,pitch:y,fovy:u,nearZMultiplier:B,farZMultiplier:M}),this.viewMatrix=pc({height:a,scale:w,center:I,pitch:y,bearing:_,altitude:o}),this.width=n,this.height=a,this.scale=w,this.latitude=l,this.longitude=h,this.zoom=p,this.pitch=y,this.bearing=_,this.altitude=o,this.fovy=u,this.center=I,this.meterOffset=x||[0,0,0],this.distanceScales=b,this._initMatrices(),Object.freeze(this)}return nc(e,[{key:"_initMatrices",value:function(){var t=this.width,n=this.height,a=this.projectionMatrix,i=this.viewMatrix,o=pa();Tn(o,o,a),Tn(o,o,i),this.viewProjectionMatrix=o;var s=pa();ma(s,s,[t/2,-n/2,1]),xn(s,s,[1,-1,0]),Tn(s,s,o);var u=Yo(pa(),s);if(!u)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=s,this.pixelUnprojectionMatrix=u}},{key:"projectFlat",value:function(t){return ut(t)}},{key:"unprojectFlat",value:function(t){return gt(t)}},{key:"getMapCenterByLngLatPosition",value:function(t){var n=t.lngLat,a=t.pos,i=us(a,this.pixelUnprojectionMatrix),o=ut(n),s=sc([],o,V0([],i)),u=sc([],this.center,s);return gt(u)}},{key:"fitBounds",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.width,i=this.height,o=fs(Object.assign({width:a,height:i,bounds:t},n)),s=o.longitude,u=o.latitude,f=o.zoom;return new e({width:a,height:i,longitude:s,latitude:u,zoom:f})}},{key:"getBounds",value:function(t){var n=this.getBoundingRegion(t),a=Math.min.apply(Math,ha(n.map(function(u){return u[0]}))),i=Math.max.apply(Math,ha(n.map(function(u){return u[0]}))),o=Math.min.apply(Math,ha(n.map(function(u){return u[1]}))),s=Math.max.apply(Math,ha(n.map(function(u){return u[1]})));return[[a,o],[i,s]]}},{key:"getBoundingRegion",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ls(this,t.z||0)}},{key:"getLocationAtPoint",value:function(t){var n=t.lngLat,a=t.pos;return this.getMapCenterByLngLatPosition({lngLat:n,pos:a})}}]),e}();var s1=6378137*Math.PI;function gc(e){var r=ut(e);return r[0]=(r[0]/256-1)*s1,r[1]=(r[1]/256-1)*s1,r}function u1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function cs(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?u1(Object(t),!0).forEach(function(n){(0,Pi.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):u1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function tI(e){var r=rI();return function(){var n=(0,ds.default)(e),a;if(r){var i=(0,ds.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,p1.default)(this,a)}}function rI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var nI={id:"imagery-layer",data:"",serviceType:"auto",srs:"auto",layers:{type:"array",compare:!0,value:[]},onMetadataLoad:{type:"function",value:function(){}},onMetadataLoadError:{type:"function",value:console.error},onImageLoadStart:{type:"function",value:function(){}},onImageLoad:{type:"function",value:function(){}},onImageLoadError:{type:"function",compare:!1,value:function(r,t){return console.error(t,r)}}},ps=function(e){(0,d1.default)(t,e);var r=tI(t);function t(){var n;(0,f1.default)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=r.call.apply(r,[this].concat(i)),(0,Pi.default)((0,c1.default)(n),"state",void 0),n}return(0,l1.default)(t,[{key:"isLoaded",get:function(){return Boolean(this.state)&&this.state.loadCounter===0&&(0,h1.default)((0,ds.default)(t.prototype),"isLoaded",this)}},{key:"shouldUpdateState",value:function(){return!0}},{key:"initializeState",value:function(){this.state._nextRequestId=0,this.state.lastRequestId=-1,this.state.loadCounter=0}},{key:"updateState",value:function(a){var i=this,o=a.changeFlags,s=a.props,u=a.oldProps,f=this.context.viewport;o.dataChanged||s.serviceType!==u.serviceType?(this.state.imageSource=this._createImageSource(s),this._loadMetadata(),this.debounce(function(){return i.loadImage(f,"image source changed")},0)):(0,Sn._deepEqual)(s.layers,u.layers,1)?o.viewportChanged&&this.debounce(function(){return i.loadImage(f,"viewport changed")}):this.debounce(function(){return i.loadImage(f,"layers changed")},0)}},{key:"finalizeState",value:function(){}},{key:"renderLayers",value:function(){var a=this.state,i=a.bounds,o=a.image,s=a.lastRequestParameters;return o&&new m1.BitmapLayer(cs(cs({},this.getSubLayerProps({id:"bitmap"})),{},{_imageCoordinateSystem:s.srs==="EPSG:4326"?Sn.COORDINATE_SYSTEM.LNGLAT:Sn.COORDINATE_SYSTEM.CARTESIAN,bounds:i,image:o}))}},{key:"getFeatureInfoText",value:function(){var n=(0,hs.default)(En.default.mark(function i(o,s){var u,f,l,c;return En.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(u=this.state.lastRequestParameters,!u){d.next=6;break}return d.next=4,(f=(l=this.state.imageSource).getFeatureInfoText)===null||f===void 0?void 0:f.call(l,cs(cs({},u),{},{query_layers:u.layers,x:o,y:s,info_format:"application/vnd.ogc.gml"}));case 4:return c=d.sent,d.abrupt("return",c);case 6:return d.abrupt("return","");case 7:case"end":return d.stop()}},i,this)}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"_createImageSource",value:function(a){if(a.data instanceof dr)return a.data;if(typeof a.data=="string")return Kl({url:a.data,loadOptions:a.loadOptions,type:a.serviceType});throw new Error("invalid image source in props.data")}},{key:"_loadMetadata",value:function(){var n=(0,hs.default)(En.default.mark(function i(){var o,s,u,f;return En.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=this.state.imageSource,c.prev=1,this.state.loadCounter++,c.next=5,o.getMetadata();case 5:s=c.sent,this.state.imageSource===o&&((u=this.getCurrentLayer())===null||u===void 0||u.props.onMetadataLoad(s)),c.next=12;break;case 9:c.prev=9,c.t0=c.catch(1),(f=this.getCurrentLayer())===null||f===void 0||f.props.onMetadataLoadError(c.t0);case 12:return c.prev=12,this.state.loadCounter--,c.finish(12);case 15:case"end":return c.stop()}},i,this,[[1,9,12,15]])}));function a(){return n.apply(this,arguments)}return a}()},{key:"loadImage",value:function(){var n=(0,hs.default)(En.default.mark(function i(o,s){var u,f,l,c,h,d,p,v,y,A,_,E,x,C,B,F,M,w,b,I;return En.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(u=this.props,f=u.layers,l=u.serviceType,!(l==="wms"&&f.length===0)){k.next=3;break}return k.abrupt("return");case 3:return c=o.getBounds(),h=o.width,d=o.height,p=this.getRequestId(),v=this.props.srs,v==="auto"&&(v=o.resolution?"EPSG:4326":"EPSG:3857"),y={width:h,height:d,bbox:c,layers:f,srs:v},v==="EPSG:3857"&&(A=gc([c[0],c[1]]),_=(0,yc.default)(A,2),E=_[0],x=_[1],C=gc([c[2],c[3]]),B=(0,yc.default)(C,2),F=B[0],M=B[1],y.bbox=[E,x,F,M]),k.prev=10,this.state.loadCounter++,this.props.onImageLoadStart(p),k.next=15,this.state.imageSource.getImage(y);case 15:w=k.sent,this.state.lastRequestId<p&&((b=this.getCurrentLayer())===null||b===void 0||b.props.onImageLoad(p),this.setState({image:w,bounds:c,lastRequestParameters:y,lastRequestId:p})),k.next=23;break;case 19:k.prev=19,k.t0=k.catch(10),this.raiseError(k.t0,"Load image"),(I=this.getCurrentLayer())===null||I===void 0||I.props.onImageLoadError(p,k.t0);case 23:return k.prev=23,this.state.loadCounter--,k.finish(23);case 26:case"end":return k.stop()}},i,this,[[10,19,23,26]])}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"getRequestId",value:function(){return this.state._nextRequestId++}},{key:"debounce",value:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:500;clearTimeout(this.state._timeoutId),this.state._timeoutId=setTimeout(function(){return a()},i)}}]),t}(Sn.CompositeLayer);(0,Pi.default)(ps,"layerName","WMSLayer");(0,Pi.default)(ps,"defaultProps",nI);var v1=m(H()),g1=m(Te()),y1=m(xe()),Ac=m(be()),_c=m(W()),A1=m(Nt());function aI(e){var r=iI();return function(){var n=(0,Ac.default)(e),a;if(r){var i=(0,Ac.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,y1.default)(this,a)}}function iI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var oI={getHeight:{type:"accessor",value:0},greatCircle:!0},ms=function(e){(0,g1.default)(t,e);var r=aI(t);function t(){return(0,v1.default)(this,t),r.apply(this,arguments)}return t}(A1.ArcLayer);(0,_c.default)(ms,"layerName","GreatCircleLayer");(0,_c.default)(ms,"defaultProps",oI);var D1=m(H()),G1=m(z()),N1=m(Te()),U1=m(xe()),Sc=m(be()),wc=m(W());var b1=m(H()),T1=m(z()),x1=m(Te()),E1=m(xe()),bc=m(be()),vs=m(W()),S1=m(Ut()),Tc=m(Nt());function sI(e){var r=uI();return function(){var n=(0,bc.default)(e),a;if(r){var i=(0,bc.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,E1.default)(this,a)}}function uI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function fI(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?_1(Object(t),!0).forEach(function(n){(0,vs.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):_1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var lI=fI({},Tc.PolygonLayer.defaultProps),Pt=function(e){(0,x1.default)(t,e);var r=sI(t);function t(){return(0,b1.default)(this,t),r.apply(this,arguments)}return(0,T1.default)(t,[{key:"indexToBounds",value:function(){return null}},{key:"renderLayers",value:function(){var a=this.props,i=a.elevationScale,o=a.extruded,s=a.wireframe,u=a.filled,f=a.stroked,l=a.lineWidthUnits,c=a.lineWidthScale,h=a.lineWidthMinPixels,d=a.lineWidthMaxPixels,p=a.lineJointRounded,v=a.lineMiterLimit,y=a.lineDashJustified,A=a.getElevation,_=a.getFillColor,E=a.getLineColor,x=a.getLineWidth,C=this.props,B=C.updateTriggers,F=C.material,M=C.transitions,w=this.getSubLayerClass("cell",Tc.PolygonLayer);return new w({filled:u,wireframe:s,extruded:o,elevationScale:i,stroked:f,lineWidthUnits:l,lineWidthScale:c,lineWidthMinPixels:h,lineWidthMaxPixels:d,lineJointRounded:p,lineMiterLimit:v,lineDashJustified:y,material:F,transitions:M,getElevation:A,getFillColor:_,getLineColor:E,getLineWidth:x},this.getSubLayerProps({id:"cell",updateTriggers:B&&{getElevation:B.getElevation,getFillColor:B.getFillColor,getLineColor:B.getLineColor,getLineWidth:B.getLineWidth}}),this.indexToBounds())}}]),t}(S1.CompositeLayer);(0,vs.default)(Pt,"layerName","GeoCellLayer");(0,vs.default)(Pt,"defaultProps",lI);var Ec=m(ie()),gs=m(xc()),cI=3,hI=30,dI=2*hI+1,C1=180/Math.PI;function M1(e,r,t){var n=1<<r;return[(e[0]+t[0])/n,(e[1]+t[1])/n]}function B1(e){return e>=.5?1/3*(4*e*e-1):1/3*(1-4*(1-e)*(1-e))}function O1(e){return[B1(e[0]),B1(e[1])]}function P1(e,r){var t=(0,Ec.default)(r,2),n=t[0],a=t[1];switch(e){case 0:return[1,n,a];case 1:return[-n,1,a];case 2:return[-n,-a,1];case 3:return[-1,-a,-n];case 4:return[a,-1,-n];case 5:return[a,n,-1];default:throw new Error("Invalid face")}}function I1(e){var r=(0,Ec.default)(e,3),t=r[0],n=r[1],a=r[2],i=Math.atan2(a,Math.sqrt(t*t+n*n)),o=Math.atan2(n,t);return[o*C1,i*C1]}function R1(e){for(var r=gs.default.fromString(e,!0,10).toString(2);r.length<cI+dI;)r="0"+r;for(var t=r.lastIndexOf("1"),n=r.substring(0,3),a=r.substring(3,t),i=a.length/2,o=gs.default.fromString(n,!0,2).toString(10),s=gs.default.fromString(a,!0,2).toString(4);s.length<i;)s="0"+s;return"".concat(o,"/").concat(s)}function pI(e,r,t,n){if(n===0){t===1&&(r[0]=e-1-r[0],r[1]=e-1-r[1]);var a=r[0];r[0]=r[1],r[1]=a}}function F1(e){for(var r=e.split("/"),t=parseInt(r[0],10),n=r[1],a=n.length,i=[0,0],o,s=a-1;s>=0;s--){o=a-s;var u=n[s],f=0,l=0;u==="1"?l=1:u==="2"?(f=1,l=1):u==="3"&&(f=1);var c=Math.pow(2,o-1);pI(c,i,f,l),i[0]+=c*f,i[1]+=c*l}if(t%2===1){var h=i[0];i[0]=i[1],i[1]=h}return{face:t,ij:i,level:o}}var L1=m(xc());function mI(e){var r=e.padEnd(16,"0");return L1.default.fromString(r,16)}var vI=100;function gI(e){for(var r=e.face,t=e.ij,n=e.level,a=[[0,0],[0,1],[1,1],[1,0],[0,0]],i=Math.max(1,Math.ceil(vI*Math.pow(2,-n))),o=new Float64Array(4*i*2+2),s=0,u=0,f=0;f<4;f++)for(var l=a[f].slice(0),c=a[f+1],h=(c[0]-l[0])/i,d=(c[1]-l[1])/i,p=0;p<i;p++){l[0]+=h,l[1]+=d;var v=M1(t,n,l),y=O1(v),A=P1(r,y),_=I1(A);Math.abs(_[1])>89.999&&(_[0]=u);var E=_[0]-u;_[0]+=E>180?-360:E<-180?360:0,o[s++]=_[0],o[s++]=_[1],u=_[0]}return o[s++]=o[0],o[s++]=o[1],o}function yI(e){if(typeof e=="string"){if(e.indexOf("/")>0)return e;e=mI(e)}return R1(e.toString())}function k1(e){var r=yI(e),t=F1(r);return gI(t)}function AI(e){var r=_I();return function(){var n=(0,Sc.default)(e),a;if(r){var i=(0,Sc.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,U1.default)(this,a)}}function _I(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var bI={getS2Token:{type:"accessor",value:function(r){return r.token}}},ys=function(e){(0,N1.default)(t,e);var r=AI(t);function t(){return(0,D1.default)(this,t),r.apply(this,arguments)}return(0,G1.default)(t,[{key:"indexToBounds",value:function(){var a=this.props,i=a.data,o=a.getS2Token;return{data:i,_normalize:!1,positionFormat:"XY",getPolygon:function(u,f){return k1(o(u,f))}}}}]),t}(Pt);(0,wc.default)(ys,"layerName","S2Layer");(0,wc.default)(ys,"defaultProps",bI);var H1=m(H()),V1=m(z()),z1=m(Te()),W1=m(xe()),Bc=m(be()),Mc=m(W());var As=m(ie());var Cc=512;function TI(e){for(var r=0,t=0,n=1<<e.length,a=n/Cc,i=0;i<e.length;i++){n>>=1;var o=parseInt(e[i]);o%2&&(r|=n),o>1&&(t|=n)}return[[r/a,Cc-t/a],[(r+.99)/a,Cc-(t+.99)/a]]}function j1(e){var r=TI(e),t=(0,As.default)(r,2),n=t[0],a=t[1],i=gt(n),o=(0,As.default)(i,2),s=o[0],u=o[1],f=gt(a),l=(0,As.default)(f,2),c=l[0],h=l[1];return[c,u,c,h,s,h,s,u,c,u]}function xI(e){var r=EI();return function(){var n=(0,Bc.default)(e),a;if(r){var i=(0,Bc.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,W1.default)(this,a)}}function EI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var SI={getQuadkey:{type:"accessor",value:function(r){return r.quadkey}}},_s=function(e){(0,z1.default)(t,e);var r=xI(t);function t(){return(0,H1.default)(this,t),r.apply(this,arguments)}return(0,V1.default)(t,[{key:"indexToBounds",value:function(){var a=this.props,i=a.data,o=a.getQuadkey;return{data:i,_normalize:!1,positionFormat:"XY",getPolygon:function(u,f){return j1(o(u,f))}}}}]),t}(Pt);(0,Mc.default)(_s,"layerName","QuadkeyLayer");(0,Mc.default)(_s,"defaultProps",SI);var r_=m(H()),n_=m(z()),a_=m(Te()),i_=m(xe()),ch=m(be()),Us=m(W()),js=m(Ut()),o_=m(Nt());var uh=m(ie()),ZA=m(H()),$A=m(z()),je=m(W());function Je(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function q1(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xe(e,r,t){return r&&q1(e.prototype,r),t&&q1(e,t),e}function Ri(e,r){return Ri=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Ri(e,r)}function Ke(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Ri(e,r)}function wn(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wn=function(t){return typeof t}:wn=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wn(e)}function Oc(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ye(e,r){if(r&&(wn(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Oc(e)}function Ae(e){return Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ae(e)}function le(e,r){if(!e)throw new Error("math.gl assertion ".concat(r))}var wI=1/Math.PI*180,CI=1/180*Math.PI,Se={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function Pc(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.precision,n=t===void 0?Se.precision:t;return e=BI(e),"".concat(parseFloat(e.toPrecision(n)))}function ft(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Ic(e){return J1(e)}function Rc(e){return Vt(e)}function J1(e,r){return Fc(e,function(t){return t*CI},r)}function Vt(e,r){return Fc(e,function(t){return t*wI},r)}function bs(e,r,t){return Fc(e,function(n){return Math.max(r,Math.min(t,n))})}function Ur(e,r,t){return ft(e)?e.map(function(n,a){return Ur(n,r[a],t)}):t*r+(1-t)*e}function Ze(e,r,t){var n=Se.EPSILON;t&&(Se.EPSILON=t);try{if(e===r)return!0;if(ft(e)&&ft(r)){if(e.length!==r.length)return!1;for(var a=0;a<e.length;++a)if(!Ze(e[a],r[a]))return!1;return!0}return e&&e.equals?e.equals(r):r&&r.equals?r.equals(e):typeof e=="number"&&typeof r=="number"?Math.abs(e-r)<=Se.EPSILON*Math.max(1,Math.abs(e),Math.abs(r)):!1}finally{Se.EPSILON=n}}function BI(e){return Math.round(e/Se.EPSILON)*Se.EPSILON}function MI(e){return e.clone?e.clone():new Array(e.length)}function Fc(e,r,t){if(ft(e)){var n=e;t=t||MI(n);for(var a=0;a<t.length&&a<n.length;++a)t[a]=r(e[a],a,t);return t}return r(e)}function OI(e){var r=PI();return function(){var n=Ae(e),a;if(r){var i=Ae(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Ye(this,a)}}function PI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function II(e){function r(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return r.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e,r}var ba=function(e){Ke(t,e);var r=OI(t);function t(){return Je(this,t),r.apply(this,arguments)}return Xe(t,[{key:"clone",value:function(){return new this.constructor().copy(this)}},{key:"fromArray",value:function(a){for(var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=0;o<this.ELEMENTS;++o)this[o]=a[o+i];return this.check()}},{key:"toArray",value:function(){for(var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=0;o<this.ELEMENTS;++o)a[i+o]=this[o];return a}},{key:"from",value:function(a){return Array.isArray(a)?this.copy(a):this.fromObject(a)}},{key:"to",value:function(a){return a===this?this:ft(a)?this.toArray(a):this.toObject(a)}},{key:"toTarget",value:function(a){return a?this.to(a):this}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"toString",value:function(){return this.formatString(Se)}},{key:"formatString",value:function(a){for(var i="",o=0;o<this.ELEMENTS;++o)i+=(o>0?", ":"")+Pc(this[o],a);return"".concat(a.printTypes?this.constructor.name:"","[").concat(i,"]")}},{key:"equals",value:function(a){if(!a||this.length!==a.length)return!1;for(var i=0;i<this.ELEMENTS;++i)if(!Ze(this[i],a[i]))return!1;return!0}},{key:"exactEquals",value:function(a){if(!a||this.length!==a.length)return!1;for(var i=0;i<this.ELEMENTS;++i)if(this[i]!==a[i])return!1;return!0}},{key:"negate",value:function(){for(var a=0;a<this.ELEMENTS;++a)this[a]=-this[a];return this.check()}},{key:"lerp",value:function(a,i,o){if(o===void 0)return this.lerp(this,a,i);for(var s=0;s<this.ELEMENTS;++s){var u=a[s];this[s]=u+o*(i[s]-u)}return this.check()}},{key:"min",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]=Math.min(a[i],this[i]);return this.check()}},{key:"max",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]=Math.max(a[i],this[i]);return this.check()}},{key:"clamp",value:function(a,i){for(var o=0;o<this.ELEMENTS;++o)this[o]=Math.min(Math.max(this[o],a[o]),i[o]);return this.check()}},{key:"add",value:function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];for(var s=0,u=i;s<u.length;s++)for(var f=u[s],l=0;l<this.ELEMENTS;++l)this[l]+=f[l];return this.check()}},{key:"subtract",value:function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];for(var s=0,u=i;s<u.length;s++)for(var f=u[s],l=0;l<this.ELEMENTS;++l)this[l]-=f[l];return this.check()}},{key:"scale",value:function(a){if(typeof a=="number")for(var i=0;i<this.ELEMENTS;++i)this[i]*=a;else for(var o=0;o<this.ELEMENTS&&o<a.length;++o)this[o]*=a[o];return this.check()}},{key:"multiplyByScalar",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]*=a;return this.check()}},{key:"check",value:function(){if(Se.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"validate",value:function(){for(var a=this.length===this.ELEMENTS,i=0;i<this.ELEMENTS;++i)a=a&&Number.isFinite(this[i]);return a}},{key:"sub",value:function(a){return this.subtract(a)}},{key:"setScalar",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]=a;return this.check()}},{key:"addScalar",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]+=a;return this.check()}},{key:"subScalar",value:function(a){return this.addScalar(-a)}},{key:"multiplyScalar",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]*=a;return this.check()}},{key:"divideScalar",value:function(a){return this.multiplyByScalar(1/a)}},{key:"clampScalar",value:function(a,i){for(var o=0;o<this.ELEMENTS;++o)this[o]=Math.min(Math.max(this[o],a),i);return this.check()}},{key:"elements",get:function(){return this}}]),t}(II(Array));function RI(e,r){if(e.length!==r)return!1;for(var t=0;t<e.length;++t)if(!Number.isFinite(e[t]))return!1;return!0}function oe(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(e));return e}function jr(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(Se.debug&&!RI(e,r))throw new Error("math.gl: ".concat(t," some fields set to invalid numbers'"));return e}function FI(e){var r=LI();return function(){var n=Ae(e),a;if(r){var i=Ae(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Ye(this,a)}}function LI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ta=function(e){Ke(t,e);var r=FI(t);function t(){return Je(this,t),r.apply(this,arguments)}return Xe(t,[{key:"x",get:function(){return this[0]},set:function(a){this[0]=oe(a)}},{key:"y",get:function(){return this[1]},set:function(a){this[1]=oe(a)}},{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return this.len()}},{key:"lengthSquared",value:function(){for(var a=0,i=0;i<this.ELEMENTS;++i)a+=this[i]*this[i];return a}},{key:"magnitudeSquared",value:function(){return this.lengthSquared()}},{key:"distance",value:function(a){return Math.sqrt(this.distanceSquared(a))}},{key:"distanceSquared",value:function(a){for(var i=0,o=0;o<this.ELEMENTS;++o){var s=this[o]-a[o];i+=s*s}return oe(i)}},{key:"dot",value:function(a){for(var i=0,o=0;o<this.ELEMENTS;++o)i+=this[o]*a[o];return oe(i)}},{key:"normalize",value:function(){var a=this.magnitude();if(a!==0)for(var i=0;i<this.ELEMENTS;++i)this[i]/=a;return this.check()}},{key:"multiply",value:function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];for(var s=0,u=i;s<u.length;s++)for(var f=u[s],l=0;l<this.ELEMENTS;++l)this[l]*=f[l];return this.check()}},{key:"divide",value:function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];for(var s=0,u=i;s<u.length;s++)for(var f=u[s],l=0;l<this.ELEMENTS;++l)this[l]/=f[l];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(a){return this.distance(a)}},{key:"distanceToSquared",value:function(a){return this.distanceSquared(a)}},{key:"getComponent",value:function(a){return le(a>=0&&a<this.ELEMENTS,"index is out of range"),oe(this[a])}},{key:"setComponent",value:function(a,i){return le(a>=0&&a<this.ELEMENTS,"index is out of range"),this[a]=i,this.check()}},{key:"addVectors",value:function(a,i){return this.copy(a).add(i)}},{key:"subVectors",value:function(a,i){return this.copy(a).subtract(i)}},{key:"multiplyVectors",value:function(a,i){return this.copy(a).multiply(i)}},{key:"addScaledVector",value:function(a,i){return this.add(new this.constructor(a).multiplyScalar(i))}}]),t}(ba);function Ts(e,r,t){var n=r[0],a=r[1],i=t[3]*n+t[7]*a||1;return e[0]=(t[0]*n+t[4]*a)/i,e[1]=(t[1]*n+t[5]*a)/i,e}function xs(e,r,t){var n=r[0],a=r[1],i=r[2],o=t[3]*n+t[7]*a+t[11]*i||1;return e[0]=(t[0]*n+t[4]*a+t[8]*i)/o,e[1]=(t[1]*n+t[5]*a+t[9]*i)/o,e[2]=(t[2]*n+t[6]*a+t[10]*i)/o,e}function X1(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[2]*a,e[1]=t[1]*n+t[3]*a,e[2]=r[2],e}function K1(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[2]*a,e[1]=t[1]*n+t[3]*a,e[2]=r[2],e[3]=r[3],e}function Es(e,r,t){var n=r[0],a=r[1],i=r[2];return e[0]=t[0]*n+t[3]*a+t[6]*i,e[1]=t[1]*n+t[4]*a+t[7]*i,e[2]=t[2]*n+t[5]*a+t[8]*i,e[3]=r[3],e}function kI(e){var r=DI();return function(){var n=Ae(e),a;if(r){var i=Ae(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Ye(this,a)}}function DI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Cn=function(e){Ke(t,e);var r=kI(t);function t(){var n,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Je(this,t),n=r.call(this,2),ft(a)&&arguments.length===1?n.copy(a):(Se.debug&&(oe(a),oe(i)),n[0]=a,n[1]=i),n}return Xe(t,[{key:"set",value:function(a,i){return this[0]=a,this[1]=i,this.check()}},{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this.check()}},{key:"fromObject",value:function(a){return Se.debug&&(oe(a.x),oe(a.y)),this[0]=a.x,this[1]=a.y,this.check()}},{key:"toObject",value:function(a){return a.x=this[0],a.y=this[1],a}},{key:"ELEMENTS",get:function(){return 2}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"transform",value:function(a){return this.transformAsPoint(a)}},{key:"transformAsPoint",value:function(a){return ns(this,this,a),this.check()}},{key:"transformAsVector",value:function(a){return Ts(this,this,a),this.check()}},{key:"transformByMatrix3",value:function(a){return rs(this,this,a),this.check()}},{key:"transformByMatrix2x3",value:function(a){return W0(this,this,a),this.check()}},{key:"transformByMatrix2",value:function(a){return z0(this,this,a),this.check()}}]),t}(Ta);function GI(e){var r=NI();return function(){var n=Ae(e),a;if(r){var i=Ae(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Ye(this,a)}}function NI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Lc=[0,0,0],Ss,S=function(e){Ke(t,e);var r=GI(t);function t(){var n,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return Je(this,t),n=r.call(this,-0,-0,-0),arguments.length===1&&ft(a)?n.copy(a):(Se.debug&&(oe(a),oe(i),oe(o)),n[0]=a,n[1]=i,n[2]=o),n}return Xe(t,[{key:"set",value:function(a,i,o){return this[0]=a,this[1]=i,this[2]=o,this.check()}},{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this.check()}},{key:"fromObject",value:function(a){return Se.debug&&(oe(a.x),oe(a.y),oe(a.z)),this[0]=a.x,this[1]=a.y,this[2]=a.z,this.check()}},{key:"toObject",value:function(a){return a.x=this[0],a.y=this[1],a.z=this[2],a}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(a){this[2]=oe(a)}},{key:"angle",value:function(a){return $0(this,a)}},{key:"cross",value:function(a){return ga(this,this,a),this.check()}},{key:"rotateX",value:function(a){var i=a.radians,o=a.origin,s=o===void 0?Lc:o;return K0(this,this,s,i),this.check()}},{key:"rotateY",value:function(a){var i=a.radians,o=a.origin,s=o===void 0?Lc:o;return Y0(this,this,s,i),this.check()}},{key:"rotateZ",value:function(a){var i=a.radians,o=a.origin,s=o===void 0?Lc:o;return Z0(this,this,s,i),this.check()}},{key:"transform",value:function(a){return this.transformAsPoint(a)}},{key:"transformAsPoint",value:function(a){return ya(this,this,a),this.check()}},{key:"transformAsVector",value:function(a){return xs(this,this,a),this.check()}},{key:"transformByMatrix3",value:function(a){return as(this,this,a),this.check()}},{key:"transformByMatrix2",value:function(a){return X1(this,this,a),this.check()}},{key:"transformByQuaternion",value:function(a){return is(this,this,a),this.check()}}],[{key:"ZERO",get:function(){return Ss||(Ss=new t(0,0,0),Object.freeze(Ss)),Ss}}]),t}(Ta);function UI(e){var r=jI();return function(){var n=Ae(e),a;if(r){var i=Ae(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Ye(this,a)}}function jI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ws,Y1=function(e){Ke(t,e);var r=UI(t);function t(){var n,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return Je(this,t),n=r.call(this,-0,-0,-0,-0),ft(a)&&arguments.length===1?n.copy(a):(Se.debug&&(oe(a),oe(i),oe(o),oe(s)),n[0]=a,n[1]=i,n[2]=o,n[3]=s),n}return Xe(t,[{key:"set",value:function(a,i,o,s){return this[0]=a,this[1]=i,this[2]=o,this[3]=s,this.check()}},{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=a[3],this.check()}},{key:"fromObject",value:function(a){return Se.debug&&(oe(a.x),oe(a.y),oe(a.z),oe(a.w)),this[0]=a.x,this[1]=a.y,this[2]=a.z,this[3]=a.w,this}},{key:"toObject",value:function(a){return a.x=this[0],a.y=this[1],a.z=this[2],a.w=this[3],a}},{key:"ELEMENTS",get:function(){return 4}},{key:"z",get:function(){return this[2]},set:function(a){this[2]=oe(a)}},{key:"w",get:function(){return this[3]},set:function(a){this[3]=oe(a)}},{key:"transform",value:function(a){return ya(this,this,a),this.check()}},{key:"transformByMatrix3",value:function(a){return Es(this,this,a),this.check()}},{key:"transformByMatrix2",value:function(a){return K1(this,this,a),this.check()}},{key:"transformByQuaternion",value:function(a){return is(this,this,a),this.check()}},{key:"applyMatrix4",value:function(a){return a.transform(this,this),this}}],[{key:"ZERO",get:function(){return ws||(ws=new t(0,0,0,0),Object.freeze(ws)),ws}}]),t}(Ta);function HI(e){var r=VI();return function(){var n=Ae(e),a;if(r){var i=Ae(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Ye(this,a)}}function VI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Cs=function(e){Ke(t,e);var r=HI(t);function t(){return Je(this,t),r.apply(this,arguments)}return Xe(t,[{key:"toString",value:function(){var a="[";if(Se.printRowMajor){a+="row-major:";for(var i=0;i<this.RANK;++i)for(var o=0;o<this.RANK;++o)a+=" ".concat(this[o*this.RANK+i])}else{a+="column-major:";for(var s=0;s<this.ELEMENTS;++s)a+=" ".concat(this[s])}return a+="]",a}},{key:"getElementIndex",value:function(a,i){return i*this.RANK+a}},{key:"getElement",value:function(a,i){return this[i*this.RANK+a]}},{key:"setElement",value:function(a,i,o){return this[i*this.RANK+a]=oe(o),this}},{key:"getColumn",value:function(a){for(var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Array(this.RANK).fill(-0),o=a*this.RANK,s=0;s<this.RANK;++s)i[s]=this[o+s];return i}},{key:"setColumn",value:function(a,i){for(var o=a*this.RANK,s=0;s<this.RANK;++s)this[o+s]=i[s];return this}}]),t}(ba);function Z1(){var e=new tt(9);return tt!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function $1(e,r){if(e===r){var t=r[1],n=r[2],a=r[5];e[1]=r[3],e[2]=r[6],e[3]=t,e[5]=r[7],e[6]=n,e[7]=a}else e[0]=r[0],e[1]=r[3],e[2]=r[6],e[3]=r[1],e[4]=r[4],e[5]=r[7],e[6]=r[2],e[7]=r[5],e[8]=r[8];return e}function Q1(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],o=r[4],s=r[5],u=r[6],f=r[7],l=r[8],c=l*o-s*f,h=-l*i+s*u,d=f*i-o*u,p=t*c+n*h+a*d;return p?(p=1/p,e[0]=c*p,e[1]=(-l*n+a*f)*p,e[2]=(s*n-a*o)*p,e[3]=h*p,e[4]=(l*t-a*u)*p,e[5]=(-s*t+a*i)*p,e[6]=d*p,e[7]=(-f*t+n*u)*p,e[8]=(o*t-n*i)*p,e):null}function eA(e){var r=e[0],t=e[1],n=e[2],a=e[3],i=e[4],o=e[5],s=e[6],u=e[7],f=e[8];return r*(f*i-o*u)+t*(-f*a+o*s)+n*(u*a-i*s)}function kc(e,r,t){var n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],u=r[5],f=r[6],l=r[7],c=r[8],h=t[0],d=t[1],p=t[2],v=t[3],y=t[4],A=t[5],_=t[6],E=t[7],x=t[8];return e[0]=h*n+d*o+p*f,e[1]=h*a+d*s+p*l,e[2]=h*i+d*u+p*c,e[3]=v*n+y*o+A*f,e[4]=v*a+y*s+A*l,e[5]=v*i+y*u+A*c,e[6]=_*n+E*o+x*f,e[7]=_*a+E*s+x*l,e[8]=_*i+E*u+x*c,e}function tA(e,r,t){var n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],u=r[5],f=r[6],l=r[7],c=r[8],h=t[0],d=t[1];return e[0]=n,e[1]=a,e[2]=i,e[3]=o,e[4]=s,e[5]=u,e[6]=h*n+d*o+f,e[7]=h*a+d*s+l,e[8]=h*i+d*u+c,e}function rA(e,r,t){var n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],u=r[5],f=r[6],l=r[7],c=r[8],h=Math.sin(t),d=Math.cos(t);return e[0]=d*n+h*o,e[1]=d*a+h*s,e[2]=d*i+h*u,e[3]=d*o-h*n,e[4]=d*s-h*a,e[5]=d*u-h*i,e[6]=f,e[7]=l,e[8]=c,e}function Dc(e,r,t){var n=t[0],a=t[1];return e[0]=n*r[0],e[1]=n*r[1],e[2]=n*r[2],e[3]=a*r[3],e[4]=a*r[4],e[5]=a*r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e}function nA(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],o=t+t,s=n+n,u=a+a,f=t*o,l=n*o,c=n*s,h=a*o,d=a*s,p=a*u,v=i*o,y=i*s,A=i*u;return e[0]=1-c-p,e[3]=l-A,e[6]=h+y,e[1]=l+A,e[4]=1-f-p,e[7]=d-v,e[2]=h-y,e[5]=d+v,e[8]=1-f-c,e}function zI(e){var r=WI();return function(){var n=Ae(e),a;if(r){var i=Ae(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Ye(this,a)}}function WI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Gc;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"})(Gc||(Gc={}));var qI=Object.freeze([1,0,0,0,1,0,0,0,1]),_e=function(e){Ke(t,e);var r=zI(t);function t(n){for(var a,i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return Je(this,t),a=r.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(n)?a.copy(n):o.length>0?a.copy([n].concat(o)):a.identity(),a}return Xe(t,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return Gc}},{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=a[3],this[4]=a[4],this[5]=a[5],this[6]=a[6],this[7]=a[7],this[8]=a[8],this.check()}},{key:"identity",value:function(){return this.copy(qI)}},{key:"fromObject",value:function(a){return this.check()}},{key:"fromQuaternion",value:function(a){return nA(this,a),this.check()}},{key:"set",value:function(a,i,o,s,u,f,l,c,h){return this[0]=a,this[1]=i,this[2]=o,this[3]=s,this[4]=u,this[5]=f,this[6]=l,this[7]=c,this[8]=h,this.check()}},{key:"setRowMajor",value:function(a,i,o,s,u,f,l,c,h){return this[0]=a,this[1]=s,this[2]=l,this[3]=i,this[4]=u,this[5]=c,this[6]=o,this[7]=f,this[8]=h,this.check()}},{key:"determinant",value:function(){return eA(this)}},{key:"transpose",value:function(){return $1(this,this),this.check()}},{key:"invert",value:function(){return Q1(this,this),this.check()}},{key:"multiplyLeft",value:function(a){return kc(this,a,this),this.check()}},{key:"multiplyRight",value:function(a){return kc(this,this,a),this.check()}},{key:"rotate",value:function(a){return rA(this,this,a),this.check()}},{key:"scale",value:function(a){return Array.isArray(a)?Dc(this,this,a):Dc(this,this,[a,a]),this.check()}},{key:"translate",value:function(a){return tA(this,this,a),this.check()}},{key:"transform",value:function(a,i){var o;switch(a.length){case 2:o=rs(i||[-0,-0],a,this);break;case 3:o=as(i||[-0,-0,-0],a,this);break;case 4:o=Es(i||[-0,-0,-0,-0],a,this);break;default:throw new Error("Illegal vector")}return jr(o,a.length),o}},{key:"transformVector",value:function(a,i){return this.transform(a,i)}},{key:"transformVector2",value:function(a,i){return this.transform(a,i)}},{key:"transformVector3",value:function(a,i){return this.transform(a,i)}}],[{key:"IDENTITY",get:function(){return XI()}},{key:"ZERO",get:function(){return JI()}}]),t}(Cs);var Bs,Ms;function JI(){return Bs||(Bs=new _e([0,0,0,0,0,0,0,0,0]),Object.freeze(Bs)),Bs}function XI(){return Ms||(Ms=new _e,Object.freeze(Ms)),Ms}function KI(e){var r=YI();return function(){var n=Ae(e),a;if(r){var i=Ae(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Ye(this,a)}}function YI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var jc;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"})(jc||(jc={}));var ZI=45*Math.PI/180,$I=1,Nc=.1,Uc=500,QI=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),ee=function(e){Ke(t,e);var r=KI(t);function t(n){var a;return Je(this,t),a=r.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(n)?a.copy(n):a.identity(),a}return Xe(t,[{key:"ELEMENTS",get:function(){return 16}},{key:"RANK",get:function(){return 4}},{key:"INDICES",get:function(){return jc}},{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=a[3],this[4]=a[4],this[5]=a[5],this[6]=a[6],this[7]=a[7],this[8]=a[8],this[9]=a[9],this[10]=a[10],this[11]=a[11],this[12]=a[12],this[13]=a[13],this[14]=a[14],this[15]=a[15],this.check()}},{key:"set",value:function(a,i,o,s,u,f,l,c,h,d,p,v,y,A,_,E){return this[0]=a,this[1]=i,this[2]=o,this[3]=s,this[4]=u,this[5]=f,this[6]=l,this[7]=c,this[8]=h,this[9]=d,this[10]=p,this[11]=v,this[12]=y,this[13]=A,this[14]=_,this[15]=E,this.check()}},{key:"setRowMajor",value:function(a,i,o,s,u,f,l,c,h,d,p,v,y,A,_,E){return this[0]=a,this[1]=u,this[2]=h,this[3]=y,this[4]=i,this[5]=f,this[6]=d,this[7]=A,this[8]=o,this[9]=l,this[10]=p,this[11]=_,this[12]=s,this[13]=c,this[14]=v,this[15]=E,this.check()}},{key:"toRowMajor",value:function(a){return a[0]=this[0],a[1]=this[4],a[2]=this[8],a[3]=this[12],a[4]=this[1],a[5]=this[5],a[6]=this[9],a[7]=this[13],a[8]=this[2],a[9]=this[6],a[10]=this[10],a[11]=this[14],a[12]=this[3],a[13]=this[7],a[14]=this[11],a[15]=this[15],a}},{key:"identity",value:function(){return this.copy(QI)}},{key:"fromObject",value:function(a){return this.check()}},{key:"fromQuaternion",value:function(a){return N0(this,a),this.check()}},{key:"frustum",value:function(a){var i=a.left,o=a.right,s=a.bottom,u=a.top,f=a.near,l=f===void 0?Nc:f,c=a.far,h=c===void 0?Uc:c;return h===1/0?rR(this,i,o,s,u,l):U0(this,i,o,s,u,l,h),this.check()}},{key:"lookAt",value:function(a){var i=a.eye,o=a.center,s=o===void 0?[0,0,0]:o,u=a.up,f=u===void 0?[0,1,0]:u;return H0(this,i,s,f),this.check()}},{key:"ortho",value:function(a){var i=a.left,o=a.right,s=a.bottom,u=a.top,f=a.near,l=f===void 0?Nc:f,c=a.far,h=c===void 0?Uc:c;return j0(this,i,o,s,u,l,h),this.check()}},{key:"orthographic",value:function(a){var i=a.fovy,o=i===void 0?ZI:i,s=a.aspect,u=s===void 0?$I:s,f=a.focalDistance,l=f===void 0?1:f,c=a.near,h=c===void 0?Nc:c,d=a.far,p=d===void 0?Uc:d;iA(o);var v=o/2,y=l*Math.tan(v),A=y*u;return this.ortho({left:-A,right:A,bottom:-y,top:y,near:h,far:p})}},{key:"perspective",value:function(a){var i=a.fovy,o=i===void 0?45*Math.PI/180:i,s=a.aspect,u=s===void 0?1:s,f=a.near,l=f===void 0?.1:f,c=a.far,h=c===void 0?500:c;return iA(o),Qo(this,o,u,l,h),this.check()}},{key:"determinant",value:function(){return L0(this)}},{key:"getScale",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[-0,-0,-0];return a[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),a[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),a[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),a}},{key:"getTranslation",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[-0,-0,-0];return a[0]=this[12],a[1]=this[13],a[2]=this[14],a}},{key:"getRotation",value:function(a,i){a=a||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],i=i||[-0,-0,-0];var o=this.getScale(i),s=1/o[0],u=1/o[1],f=1/o[2];return a[0]=this[0]*s,a[1]=this[1]*u,a[2]=this[2]*f,a[3]=0,a[4]=this[4]*s,a[5]=this[5]*u,a[6]=this[6]*f,a[7]=0,a[8]=this[8]*s,a[9]=this[9]*u,a[10]=this[10]*f,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{key:"getRotationMatrix3",value:function(a,i){a=a||[-0,-0,-0,-0,-0,-0,-0,-0,-0],i=i||[-0,-0,-0];var o=this.getScale(i),s=1/o[0],u=1/o[1],f=1/o[2];return a[0]=this[0]*s,a[1]=this[1]*u,a[2]=this[2]*f,a[3]=this[4]*s,a[4]=this[5]*u,a[5]=this[6]*f,a[6]=this[8]*s,a[7]=this[9]*u,a[8]=this[10]*f,a}},{key:"transpose",value:function(){return F0(this,this),this.check()}},{key:"invert",value:function(){return Yo(this,this),this.check()}},{key:"multiplyLeft",value:function(a){return Tn(this,a,this),this.check()}},{key:"multiplyRight",value:function(a){return Tn(this,this,a),this.check()}},{key:"rotateX",value:function(a){return Zo(this,this,a),this.check()}},{key:"rotateY",value:function(a){return D0(this,this,a),this.check()}},{key:"rotateZ",value:function(a){return $o(this,this,a),this.check()}},{key:"rotateXYZ",value:function(a){return this.rotateX(a[0]).rotateY(a[1]).rotateZ(a[2])}},{key:"rotateAxis",value:function(a,i){return k0(this,this,a,i),this.check()}},{key:"scale",value:function(a){return ma(this,this,Array.isArray(a)?a:[a,a,a]),this.check()}},{key:"translate",value:function(a){return xn(this,this,a),this.check()}},{key:"transform",value:function(a,i){return a.length===4?(i=Xo(i||[-0,-0,-0,-0],a,this),jr(i,4),i):this.transformAsPoint(a,i)}},{key:"transformAsPoint",value:function(a,i){var o=a.length,s;switch(o){case 2:s=ns(i||[-0,-0],a,this);break;case 3:s=ya(i||[-0,-0,-0],a,this);break;default:throw new Error("Illegal vector")}return jr(s,a.length),s}},{key:"transformAsVector",value:function(a,i){var o;switch(a.length){case 2:o=Ts(i||[-0,-0],a,this);break;case 3:o=xs(i||[-0,-0,-0],a,this);break;default:throw new Error("Illegal vector")}return jr(o,a.length),o}},{key:"transformPoint",value:function(a,i){return this.transformAsPoint(a,i)}},{key:"transformVector",value:function(a,i){return this.transformAsPoint(a,i)}},{key:"transformDirection",value:function(a,i){return this.transformAsVector(a,i)}},{key:"makeRotationX",value:function(a){return this.identity().rotateX(a)}},{key:"makeTranslation",value:function(a,i,o){return this.identity().translate([a,i,o])}}],[{key:"IDENTITY",get:function(){return tR()}},{key:"ZERO",get:function(){return eR()}}]),t}(Cs);var Os,Ps;function eR(){return Os||(Os=new ee([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Os)),Os}function tR(){return Ps||(Ps=new ee,Object.freeze(Ps)),Ps}function iA(e){if(e>Math.PI*2)throw Error("expected radians")}function rR(e,r,t,n,a,i){var o=2*i/(t-r),s=2*i/(a-n),u=(t+r)/(t-r),f=(a+n)/(a-n),l=-1,c=-1,h=-2*i;return e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=u,e[9]=f,e[10]=l,e[11]=c,e[12]=0,e[13]=0,e[14]=h,e[15]=0,e}function oA(){var e=new tt(4);return tt!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function sA(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Hc(e,r,t){t=t*.5;var n=Math.sin(t);return e[0]=n*r[0],e[1]=n*r[1],e[2]=n*r[2],e[3]=Math.cos(t),e}function Vc(e,r,t){var n=r[0],a=r[1],i=r[2],o=r[3],s=t[0],u=t[1],f=t[2],l=t[3];return e[0]=n*l+o*s+a*f-i*u,e[1]=a*l+o*u+i*s-n*f,e[2]=i*l+o*f+n*u-a*s,e[3]=o*l-n*s-a*u-i*f,e}function uA(e,r,t){t*=.5;var n=r[0],a=r[1],i=r[2],o=r[3],s=Math.sin(t),u=Math.cos(t);return e[0]=n*u+o*s,e[1]=a*u+i*s,e[2]=i*u-a*s,e[3]=o*u-n*s,e}function fA(e,r,t){t*=.5;var n=r[0],a=r[1],i=r[2],o=r[3],s=Math.sin(t),u=Math.cos(t);return e[0]=n*u-i*s,e[1]=a*u+o*s,e[2]=i*u+n*s,e[3]=o*u-a*s,e}function lA(e,r,t){t*=.5;var n=r[0],a=r[1],i=r[2],o=r[3],s=Math.sin(t),u=Math.cos(t);return e[0]=n*u+a*s,e[1]=a*u-n*s,e[2]=i*u+o*s,e[3]=o*u-i*s,e}function cA(e,r){var t=r[0],n=r[1],a=r[2];return e[0]=t,e[1]=n,e[2]=a,e[3]=Math.sqrt(Math.abs(1-t*t-n*n-a*a)),e}function Fi(e,r,t,n){var a=r[0],i=r[1],o=r[2],s=r[3],u=t[0],f=t[1],l=t[2],c=t[3],h,d,p,v,y;return d=a*u+i*f+o*l+s*c,d<0&&(d=-d,u=-u,f=-f,l=-l,c=-c),1-d>Ee?(h=Math.acos(d),p=Math.sin(h),v=Math.sin((1-n)*h)/p,y=Math.sin(n*h)/p):(v=1-n,y=n),e[0]=v*a+y*u,e[1]=v*i+y*f,e[2]=v*o+y*l,e[3]=v*s+y*c,e}function hA(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],o=t*t+n*n+a*a+i*i,s=o?1/o:0;return e[0]=-t*s,e[1]=-n*s,e[2]=-a*s,e[3]=i*s,e}function dA(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e[3]=r[3],e}function zc(e,r){var t=r[0]+r[4]+r[8],n;if(t>0)n=Math.sqrt(t+1),e[3]=.5*n,n=.5/n,e[0]=(r[5]-r[7])*n,e[1]=(r[6]-r[2])*n,e[2]=(r[1]-r[3])*n;else{var a=0;r[4]>r[0]&&(a=1),r[8]>r[a*3+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;n=Math.sqrt(r[a*3+a]-r[i*3+i]-r[o*3+o]+1),e[a]=.5*n,n=.5/n,e[3]=(r[i*3+o]-r[o*3+i])*n,e[i]=(r[i*3+a]+r[a*3+i])*n,e[o]=(r[o*3+a]+r[a*3+o])*n}return e}var pA=C0;var mA=Jo,vA=P0,gA=I0,yA=B0;var AA=M0;var _A=O0;var bA=function(){var e=uc(),r=lc(1,0,0),t=lc(0,1,0);return function(n,a,i){var o=Mi(a,i);return o<-.999999?(ga(e,r,a),e1(e)<1e-6&&ga(e,t,a),X0(e,e),Hc(n,e,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(ga(e,a,i),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+o,_A(n,n))}}(),yz=function(){var e=oA(),r=oA();return function(t,n,a,i,o,s){return Fi(e,n,o,s),Fi(r,a,i,s),Fi(t,e,r,2*s*(1-s)),t}}(),Az=function(){var e=Z1();return function(r,t,n,a){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-t[0],e[5]=-t[1],e[8]=-t[2],_A(r,zc(r,e))}}();function aR(e){var r=iR();return function(){var n=Ae(e),a;if(r){var i=Ae(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Ye(this,a)}}function iR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var oR=[0,0,0,1],Hr=function(e){Ke(t,e);var r=aR(t);function t(){var n,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;return Je(this,t),n=r.call(this,-0,-0,-0,-0),Array.isArray(a)&&arguments.length===1?n.copy(a):n.set(a,i,o,s),n}return Xe(t,[{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=a[3],this.check()}},{key:"set",value:function(a,i,o,s){return this[0]=a,this[1]=i,this[2]=o,this[3]=s,this.check()}},{key:"fromObject",value:function(a){return this[0]=a.x,this[1]=a.y,this[2]=a.z,this[3]=a.w,this.check()}},{key:"fromMatrix3",value:function(a){return zc(this,a),this.check()}},{key:"fromAxisRotation",value:function(a,i){return Hc(this,a,i),this.check()}},{key:"identity",value:function(){return sA(this),this.check()}},{key:"setAxisAngle",value:function(a,i){return this.fromAxisRotation(a,i)}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(a){this[0]=oe(a)}},{key:"y",get:function(){return this[1]},set:function(a){this[1]=oe(a)}},{key:"z",get:function(){return this[2]},set:function(a){this[2]=oe(a)}},{key:"w",get:function(){return this[3]},set:function(a){this[3]=oe(a)}},{key:"len",value:function(){return yA(this)}},{key:"lengthSquared",value:function(){return AA(this)}},{key:"dot",value:function(a){return vA(this,a)}},{key:"rotationTo",value:function(a,i){return bA(this,a,i),this.check()}},{key:"add",value:function(a){return pA(this,this,a),this.check()}},{key:"calculateW",value:function(){return cA(this,this),this.check()}},{key:"conjugate",value:function(){return dA(this,this),this.check()}},{key:"invert",value:function(){return hA(this,this),this.check()}},{key:"lerp",value:function(a,i,o){return o===void 0?this.lerp(this,a,i):(gA(this,a,i,o),this.check())}},{key:"multiplyRight",value:function(a){return Vc(this,this,a),this.check()}},{key:"multiplyLeft",value:function(a){return Vc(this,a,this),this.check()}},{key:"normalize",value:function(){var a=this.len(),i=a>0?1/a:0;return this[0]=this[0]*i,this[1]=this[1]*i,this[2]=this[2]*i,this[3]=this[3]*i,a===0&&(this[3]=1),this.check()}},{key:"rotateX",value:function(a){return uA(this,this,a),this.check()}},{key:"rotateY",value:function(a){return fA(this,this,a),this.check()}},{key:"rotateZ",value:function(a){return lA(this,this,a),this.check()}},{key:"scale",value:function(a){return mA(this,this,a),this.check()}},{key:"slerp",value:function(a,i,o){var s,u,f;switch(arguments.length){case 1:var l=a.start;s=l===void 0?oR:l,u=a.target,f=a.ratio;break;case 2:s=this,u=a,f=i;break;default:s=a,u=i,f=o}return Fi(this,s,u,f),this.check()}},{key:"transformVector4",value:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Y1;return R0(i,a,this),jr(i,4)}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"setFromAxisAngle",value:function(a,i){return this.setAxisAngle(a,i)}},{key:"premultiply",value:function(a){return this.multiplyLeft(a)}},{key:"multiply",value:function(a){return this.multiplyRight(a)}}]),t}(ba);var rr={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2};var TA=m(K()),xA=m(H()),EA=m(z()),ze=m(W()),Wc=m(Y()),Li=function(){function e(r){(0,xA.default)(this,e),(0,ze.default)(this,"index",void 0),(0,ze.default)(this,"isVisible",void 0),(0,ze.default)(this,"isSelected",void 0),(0,ze.default)(this,"parent",void 0),(0,ze.default)(this,"children",void 0),(0,ze.default)(this,"content",void 0),(0,ze.default)(this,"state",void 0),(0,ze.default)(this,"layers",void 0),(0,ze.default)(this,"id",void 0),(0,ze.default)(this,"zoom",void 0),(0,ze.default)(this,"userData",void 0),(0,ze.default)(this,"boundingBox",void 0),(0,ze.default)(this,"_abortController",void 0),(0,ze.default)(this,"_loader",void 0),(0,ze.default)(this,"_loaderId",void 0),(0,ze.default)(this,"_isLoaded",void 0),(0,ze.default)(this,"_isCancelled",void 0),(0,ze.default)(this,"_needsReload",void 0),(0,ze.default)(this,"_bbox",void 0),this.index=r,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}return(0,EA.default)(e,[{key:"bbox",get:function(){return this._bbox},set:function(t){this._bbox||(this._bbox=t,"west"in t?this.boundingBox=[[t.west,t.south],[t.east,t.north]]:this.boundingBox=[[t.left,t.top],[t.right,t.bottom]])}},{key:"data",get:function(){var t=this;return this.isLoading&&this._loader?this._loader.then(function(){return t.data}):this.content}},{key:"isLoaded",get:function(){return this._isLoaded&&!this._needsReload}},{key:"isLoading",get:function(){return Boolean(this._loader)&&!this._isCancelled}},{key:"needsReload",get:function(){return this._needsReload||this._isCancelled}},{key:"byteLength",get:function(){var t=this.content?this.content.byteLength:0;return Number.isFinite(t)||console.error("byteLength not defined in tile data"),t}},{key:"_loadData",value:function(){var r=(0,TA.default)(Wc.default.mark(function n(a){var i,o,s,u,f,l,c,h,d,p,v,y,A,_;return Wc.default.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return i=a.getData,o=a.requestScheduler,s=a.onLoad,u=a.onError,f=this.index,l=this.id,c=this.bbox,h=this.userData,d=this.zoom,p=this._loaderId,this._abortController=new AbortController,v=this._abortController.signal,x.next=7,o.scheduleRequest(this,function(C){return C.isSelected?1:-1});case 7:if(y=x.sent,y){x.next=11;break}return this._isCancelled=!0,x.abrupt("return");case 11:if(!this._isCancelled){x.next=14;break}return y.done(),x.abrupt("return");case 14:return A=null,x.prev=15,x.next=18,i({index:f,id:l,bbox:c,userData:h,zoom:d,signal:v});case 18:A=x.sent,x.next=24;break;case 21:x.prev=21,x.t0=x.catch(15),_=x.t0||!0;case 24:return x.prev=24,y.done(),x.finish(24);case 27:if(p===this._loaderId){x.next=29;break}return x.abrupt("return");case 29:if(this._loader=void 0,this.content=A,!(this._isCancelled&&!A)){x.next=34;break}return this._isLoaded=!1,x.abrupt("return");case 34:this._isLoaded=!0,this._isCancelled=!1,_?u(_,this):s(this);case 37:case"end":return x.stop()}},n,this,[[15,21,24,27]])}));function t(n){return r.apply(this,arguments)}return t}()},{key:"loadData",value:function(t){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(t),this._loader}},{key:"setNeedsReload",value:function(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}},{key:"abort",value:function(){var t;this.isLoaded||(this._isCancelled=!0,(t=this._abortController)===null||t===void 0||t.abort())}}]),e}();var On=m(ie()),Ni=m(st());var th=m(ie()),GA=m(H()),NA=m(z()),Mn=m(W()),Gi=m(Ut());var Ne={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};function lt(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function SA(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ct(e,r,t){return r&&SA(e.prototype,r),t&&SA(e,t),e}function J(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var wA=new S,sR=new S,Is=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],n=arguments.length>2?arguments[2]:void 0;lt(this,e),J(this,"center",void 0),J(this,"halfDiagonal",void 0),J(this,"minimum",void 0),J(this,"maximum",void 0),n=n||wA.copy(r).add(t).scale(.5),this.center=new S(n),this.halfDiagonal=new S(t).subtract(this.center),this.minimum=new S(r),this.maximum=new S(t)}return ct(e,[{key:"clone",value:function(){return new e(this.minimum,this.maximum,this.center)}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.minimum.equals(t.minimum)&&this.maximum.equals(t.maximum)}},{key:"transform",value:function(t){return this.center.transformAsPoint(t),this.halfDiagonal.transform(t),this.minimum.transform(t),this.maximum.transform(t),this}},{key:"intersectPlane",value:function(t){var n=this.halfDiagonal,a=sR.from(t.normal),i=n.x*Math.abs(a.x)+n.y*Math.abs(a.y)+n.z*Math.abs(a.z),o=this.center.dot(a)+t.distance;return o-i>0?Ne.INSIDE:o+i<0?Ne.OUTSIDE:Ne.INTERSECTING}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}},{key:"distanceSquaredTo",value:function(t){var n=wA.from(t).subtract(this.center),a=this.halfDiagonal,i=0,o;return o=Math.abs(n.x)-a.x,o>0&&(i+=o*o),o=Math.abs(n.y)-a.y,o>0&&(i+=o*o),o=Math.abs(n.z)-a.z,o>0&&(i+=o*o),i}}]),e}();var ki=new S,CA=new S,Vr=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;lt(this,e),J(this,"center",void 0),J(this,"radius",void 0),this.radius=-0,this.center=new S,this.fromCenterRadius(r,t)}return ct(e,[{key:"fromCenterRadius",value:function(t,n){return this.center.from(t),this.radius=n,this}},{key:"fromCornerPoints",value:function(t,n){return n=ki.from(n),this.center=new S().from(t).add(n).scale(.5),this.radius=this.center.distance(n),this}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}},{key:"clone",value:function(){return new e(this.center,this.radius)}},{key:"union",value:function(t){var n=this.center,a=this.radius,i=t.center,o=t.radius,s=ki.copy(i).subtract(n),u=s.magnitude();if(a>=u+o)return this.clone();if(o>=u+a)return t.clone();var f=(a+u+o)*.5;return CA.copy(s).scale((-a+f)/u).add(n),this.center.copy(CA),this.radius=f,this}},{key:"expand",value:function(t){var n=ki.from(t),a=n.subtract(this.center).magnitude();return a>this.radius&&(this.radius=a),this}},{key:"transform",value:function(t){this.center.transform(t);var n=G0(ki,t);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}},{key:"distanceSquaredTo",value:function(t){var n=this.distanceTo(t);return n*n}},{key:"distanceTo",value:function(t){var n=ki.from(t),a=n.subtract(this.center);return Math.max(0,a.len()-this.radius)}},{key:"intersectPlane",value:function(t){var n=this.center,a=this.radius,i=t.normal,o=i.dot(n)+t.distance;return o<-a?Ne.OUTSIDE:o<a?Ne.INTERSECTING:Ne.INSIDE}}]),e}();function xa(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function qc(e){if(Array.isArray(e))return xa(e)}function Jc(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Xc(e,r){if(e){if(typeof e=="string")return xa(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return xa(e,r)}}function Kc(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zr(e){return qc(e)||Jc(e)||Xc(e)||Kc()}var uR=new S,fR=new S,Rs=new S,Fs=new S,Ls=new S,lR=new S,cR=new S,vr={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8},Bn=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0,0,0,0,0,0,0];lt(this,e),J(this,"center",void 0),J(this,"halfAxes",void 0),this.center=new S().from(r),this.halfAxes=new _e(t)}return ct(e,[{key:"halfSize",get:function(){var t=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),a=this.halfAxes.getColumn(2);return[new S(t).len(),new S(n).len(),new S(a).len()]}},{key:"quaternion",get:function(){var t=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),a=this.halfAxes.getColumn(2),i=new S(t).normalize(),o=new S(n).normalize(),s=new S(a).normalize();return new Hr().fromMatrix3(new _e([].concat(zr(i),zr(o),zr(s))))}},{key:"fromCenterHalfSizeQuaternion",value:function(t,n,a){var i=new Hr(a),o=new _e().fromQuaternion(i);return o[0]=o[0]*n[0],o[1]=o[1]*n[0],o[2]=o[2]*n[0],o[3]=o[3]*n[1],o[4]=o[4]*n[1],o[5]=o[5]*n[1],o[6]=o[6]*n[2],o[7]=o[7]*n[2],o[8]=o[8]*n[2],this.center=new S().from(t),this.halfAxes=o,this}},{key:"clone",value:function(){return new e(this.center,this.halfAxes)}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}},{key:"getBoundingSphere",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Vr,n=this.halfAxes,a=n.getColumn(0,Rs),i=n.getColumn(1,Fs),o=n.getColumn(2,Ls),s=uR.copy(a).add(i).add(o);return t.center.copy(this.center),t.radius=s.magnitude(),t}},{key:"intersectPlane",value:function(t){var n=this.center,a=t.normal,i=this.halfAxes,o=a.x,s=a.y,u=a.z,f=Math.abs(o*i[vr.COLUMN0ROW0]+s*i[vr.COLUMN0ROW1]+u*i[vr.COLUMN0ROW2])+Math.abs(o*i[vr.COLUMN1ROW0]+s*i[vr.COLUMN1ROW1]+u*i[vr.COLUMN1ROW2])+Math.abs(o*i[vr.COLUMN2ROW0]+s*i[vr.COLUMN2ROW1]+u*i[vr.COLUMN2ROW2]),l=a.dot(n)+t.distance;return l<=-f?Ne.OUTSIDE:l>=f?Ne.INSIDE:Ne.INTERSECTING}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}},{key:"distanceSquaredTo",value:function(t){var n=fR.from(t).subtract(this.center),a=this.halfAxes,i=a.getColumn(0,Rs),o=a.getColumn(1,Fs),s=a.getColumn(2,Ls),u=i.magnitude(),f=o.magnitude(),l=s.magnitude();i.normalize(),o.normalize(),s.normalize();var c=0,h;return h=Math.abs(n.dot(i))-u,h>0&&(c+=h*h),h=Math.abs(n.dot(o))-f,h>0&&(c+=h*h),h=Math.abs(n.dot(s))-l,h>0&&(c+=h*h),c}},{key:"computePlaneDistances",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[-0,-0],i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,s=this.center,u=this.halfAxes,f=u.getColumn(0,Rs),l=u.getColumn(1,Fs),c=u.getColumn(2,Ls),h=lR.copy(f).add(l).add(c).add(s),d=cR.copy(h).subtract(t),p=n.dot(d);return i=Math.min(p,i),o=Math.max(p,o),h.copy(s).add(f).add(l).subtract(c),d.copy(h).subtract(t),p=n.dot(d),i=Math.min(p,i),o=Math.max(p,o),h.copy(s).add(f).subtract(l).add(c),d.copy(h).subtract(t),p=n.dot(d),i=Math.min(p,i),o=Math.max(p,o),h.copy(s).add(f).subtract(l).subtract(c),d.copy(h).subtract(t),p=n.dot(d),i=Math.min(p,i),o=Math.max(p,o),s.copy(h).subtract(f).add(l).add(c),d.copy(h).subtract(t),p=n.dot(d),i=Math.min(p,i),o=Math.max(p,o),s.copy(h).subtract(f).add(l).subtract(c),d.copy(h).subtract(t),p=n.dot(d),i=Math.min(p,i),o=Math.max(p,o),s.copy(h).subtract(f).subtract(l).add(c),d.copy(h).subtract(t),p=n.dot(d),i=Math.min(p,i),o=Math.max(p,o),s.copy(h).subtract(f).subtract(l).subtract(c),d.copy(h).subtract(t),p=n.dot(d),i=Math.min(p,i),o=Math.max(p,o),a[0]=i,a[1]=o,a}},{key:"transform",value:function(t){this.center.transformAsPoint(t);var n=this.halfAxes.getColumn(0,Rs);n.transformAsPoint(t);var a=this.halfAxes.getColumn(1,Fs);a.transformAsPoint(t);var i=this.halfAxes.getColumn(2,Ls);return i.transformAsPoint(t),this.halfAxes=new _e([].concat(zr(n),zr(a),zr(i))),this}},{key:"getTransform",value:function(){throw new Error("not implemented")}}]),e}();var BA=new S,MA=new S,Ue=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,1],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;lt(this,e),J(this,"normal",void 0),J(this,"distance",void 0),this.normal=new S,this.distance=-0,this.fromNormalDistance(r,t)}return ct(e,[{key:"fromNormalDistance",value:function(t,n){return le(Number.isFinite(n)),this.normal.from(t).normalize(),this.distance=n,this}},{key:"fromPointNormal",value:function(t,n){t=BA.from(t),this.normal.from(n).normalize();var a=-this.normal.dot(t);return this.distance=a,this}},{key:"fromCoefficients",value:function(t,n,a,i){return this.normal.set(t,n,a),le(Ze(this.normal.len(),1)),this.distance=i,this}},{key:"clone",value:function(){return new e(this.normal,this.distance)}},{key:"equals",value:function(t){return Ze(this.distance,t.distance)&&Ze(this.normal,t.normal)}},{key:"getPointDistance",value:function(t){return this.normal.dot(t)+this.distance}},{key:"transform",value:function(t){var n=MA.copy(this.normal).transformAsVector(t).normalize(),a=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(a,n)}},{key:"projectPointOntoPlane",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];t=BA.from(t);var a=this.getPointDistance(t),i=MA.copy(this.normal).scale(a);return t.subtract(i).to(n)}}]),e}();function OA(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=hR(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function hR(e,r){if(e){if(typeof e=="string")return PA(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return PA(e,r)}}function PA(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var IA=[new S([1,0,0]),new S([0,1,0]),new S([0,0,1])],RA=new S,dR=new S,VW=new Ue(new S(1,0,0),0),yt=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];lt(this,e),J(this,"planes",void 0),this.planes=r}return ct(e,[{key:"fromBoundingSphere",value:function(t){this.planes.length=2*IA.length;var n=t.center,a=t.radius,i=0,o=OA(IA),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,f=this.planes[i],l=this.planes[i+1];f||(f=this.planes[i]=new Ue),l||(l=this.planes[i+1]=new Ue);var c=RA.copy(u).scale(-a).add(n),h=-u.dot(c);f.fromPointNormal(c,u);var d=RA.copy(u).scale(a).add(n),p=dR.copy(u).negate(),v=-p.dot(d);l.fromPointNormal(d,p),i+=2}}catch(y){o.e(y)}finally{o.f()}return this}},{key:"computeVisibility",value:function(t){var n=Ne.INSIDE,a=OA(this.planes),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t.intersectPlane(o);switch(s){case Ne.OUTSIDE:return Ne.OUTSIDE;case Ne.INTERSECTING:n=Ne.INTERSECTING;break;default:}}}catch(u){a.e(u)}finally{a.f()}return n}},{key:"computeVisibilityWithPlaneMask",value:function(t,n){if(le(Number.isFinite(n),"parentPlaneMask is required."),n===e.MASK_OUTSIDE||n===e.MASK_INSIDE)return n;for(var a=e.MASK_INSIDE,i=this.planes,o=0;o<this.planes.length;++o){var s=o<31?1<<o:0;if(!(o<31&&!(n&s))){var u=i[o],f=t.intersectPlane(u);if(f===Ne.OUTSIDE)return e.MASK_OUTSIDE;f===Ne.INTERSECTING&&(a|=s)}}return a}}]),e}();J(yt,"MASK_OUTSIDE",4294967295);J(yt,"MASK_INSIDE",0);J(yt,"MASK_INDETERMINATE",2147483647);var pR=new S,mR=new S,vR=new S,gR=new S,yR=new S,Yc=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};lt(this,e),J(this,"left",void 0),J(this,"_left",void 0),J(this,"right",void 0),J(this,"_right",void 0),J(this,"top",void 0),J(this,"_top",void 0),J(this,"bottom",void 0),J(this,"_bottom",void 0),J(this,"near",void 0),J(this,"_near",void 0),J(this,"far",void 0),J(this,"_far",void 0),J(this,"_cullingVolume",new yt([new Ue,new Ue,new Ue,new Ue,new Ue,new Ue])),J(this,"_perspectiveMatrix",new ee),J(this,"_infinitePerspective",new ee);var t=r.near,n=t===void 0?1:t,a=r.far,i=a===void 0?5e8:a;this.left=r.left,this._left=void 0,this.right=r.right,this._right=void 0,this.top=r.top,this._top=void 0,this.bottom=r.bottom,this._bottom=void 0,this.near=n,this._near=n,this.far=i,this._far=i}return ct(e,[{key:"clone",value:function(){return new e({right:this.right,left:this.left,top:this.top,bottom:this.bottom,near:this.near,far:this.far})}},{key:"equals",value:function(t){return t&&t instanceof e&&this.right===t.right&&this.left===t.left&&this.top===t.top&&this.bottom===t.bottom&&this.near===t.near&&this.far===t.far}},{key:"projectionMatrix",get:function(){return this._update(),this._perspectiveMatrix}},{key:"infiniteProjectionMatrix",get:function(){return this._update(),this._infinitePerspective}},{key:"computeCullingVolume",value:function(t,n,a){le(t,"position is required."),le(n,"direction is required."),le(a,"up is required.");var i=this._cullingVolume.planes;a=pR.copy(a).normalize();var o=mR.copy(n).cross(a).normalize(),s=vR.copy(n).multiplyByScalar(this.near).add(t),u=gR.copy(n).multiplyByScalar(this.far).add(t),f=yR;return f.copy(o).multiplyByScalar(this.left).add(s).subtract(t).cross(a),i[0].fromPointNormal(t,f),f.copy(o).multiplyByScalar(this.right).add(s).subtract(t).cross(a).negate(),i[1].fromPointNormal(t,f),f.copy(a).multiplyByScalar(this.bottom).add(s).subtract(t).cross(o).negate(),i[2].fromPointNormal(t,f),f.copy(a).multiplyByScalar(this.top).add(s).subtract(t).cross(o),i[3].fromPointNormal(t,f),f=new S().copy(n),i[4].fromPointNormal(s,f),f.negate(),i[5].fromPointNormal(u,f),this._cullingVolume}},{key:"getPixelDimensions",value:function(t,n,a,i){this._update(),le(Number.isFinite(t)&&Number.isFinite(n)),le(t>0),le(n>0),le(a>0),le(i);var o=1/this.near,s=this.top*o,u=2*a*s/n;s=this.right*o;var f=2*a*s/t;return i.x=f,i.y=u,i}},{key:"_update",value:function(){le(Number.isFinite(this.right)&&Number.isFinite(this.left)&&Number.isFinite(this.top)&&Number.isFinite(this.bottom)&&Number.isFinite(this.near)&&Number.isFinite(this.far));var t=this.top,n=this.bottom,a=this.right,i=this.left,o=this.near,s=this.far;(t!==this._top||n!==this._bottom||i!==this._left||a!==this._right||o!==this._near||s!==this._far)&&(le(this.near>0&&this.near<this.far,"near must be greater than zero and less than far."),this._left=i,this._right=a,this._top=t,this._bottom=n,this._near=o,this._far=s,this._perspectiveMatrix=new ee().frustum({left:i,right:a,bottom:n,top:t,near:o,far:s}),this._infinitePerspective=new ee().frustum({left:i,right:a,bottom:n,top:t,near:o,far:1/0}))}}]),e}();var AR=function(r){return r!==null&&typeof r<"u"},_R=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};lt(this,e),J(this,"_offCenterFrustum",new Yc),J(this,"fov",void 0),J(this,"_fov",void 0),J(this,"_fovy",void 0),J(this,"_sseDenominator",void 0),J(this,"aspectRatio",void 0),J(this,"_aspectRatio",void 0),J(this,"near",void 0),J(this,"_near",void 0),J(this,"far",void 0),J(this,"_far",void 0),J(this,"xOffset",void 0),J(this,"_xOffset",void 0),J(this,"yOffset",void 0),J(this,"_yOffset",void 0);var t=r.fov,n=r.aspectRatio,a=r.near,i=a===void 0?1:a,o=r.far,s=o===void 0?5e8:o,u=r.xOffset,f=u===void 0?0:u,l=r.yOffset,c=l===void 0?0:l;this.fov=t,this.aspectRatio=n,this.near=i,this.far=s,this.xOffset=f,this.yOffset=c}return ct(e,[{key:"clone",value:function(){return new e({aspectRatio:this.aspectRatio,fov:this.fov,near:this.near,far:this.far})}},{key:"equals",value:function(t){return!AR(t)||!(t instanceof e)?!1:(this._update(),t._update(),this.fov===t.fov&&this.aspectRatio===t.aspectRatio&&this.near===t.near&&this.far===t.far&&this._offCenterFrustum.equals(t._offCenterFrustum))}},{key:"projectionMatrix",get:function(){return this._update(),this._offCenterFrustum.projectionMatrix}},{key:"infiniteProjectionMatrix",get:function(){return this._update(),this._offCenterFrustum.infiniteProjectionMatrix}},{key:"fovy",get:function(){return this._update(),this._fovy}},{key:"sseDenominator",get:function(){return this._update(),this._sseDenominator}},{key:"computeCullingVolume",value:function(t,n,a){return this._update(),this._offCenterFrustum.computeCullingVolume(t,n,a)}},{key:"getPixelDimensions",value:function(t,n,a,i){return this._update(),this._offCenterFrustum.getPixelDimensions(t,n,a,i||new Cn)}},{key:"_update",value:function(){le(Number.isFinite(this.fov)&&Number.isFinite(this.aspectRatio)&&Number.isFinite(this.near)&&Number.isFinite(this.far));var t=this._offCenterFrustum;(this.fov!==this._fov||this.aspectRatio!==this._aspectRatio||this.near!==this._near||this.far!==this._far||this.xOffset!==this._xOffset||this.yOffset!==this._yOffset)&&(le(this.fov>=0&&this.fov<Math.PI),le(this.aspectRatio>0),le(this.near>=0&&this.near<this.far),this._aspectRatio=this.aspectRatio,this._fov=this.fov,this._fovy=this.aspectRatio<=1?this.fov:Math.atan(Math.tan(this.fov*.5)/this.aspectRatio)*2,this._near=this.near,this._far=this.far,this._sseDenominator=2*Math.tan(.5*this._fovy),this._xOffset=this.xOffset,this._yOffset=this.yOffset,t.top=this.near*Math.tan(.5*this._fovy),t.bottom=-t.top,t.right=this.aspectRatio*t.top,t.left=-t.right,t.near=this.near,t.far=this.far,t.right+=this.xOffset,t.left+=this.xOffset,t.top+=this.yOffset,t.bottom+=this.yOffset)}}]),e}();var oq=new S,sq=new S,uq=new S,fq=new S,lq=new S,cq=new S,hq=new S,dq=new S,pq=new S,mq=new S,vq=new S,gq=new S,yq=4/3*Math.PI;var nr=new _e,bR=new _e,TR=new _e,ks=new _e,FA=new _e;function Ds(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=rr.EPSILON20,n=10,a=0,i=0,o=bR,s=TR;o.identity(),s.copy(e);for(var u=t*xR(s);i<n&&ER(s)>u;)SR(s,ks),FA.copy(ks).transpose(),s.multiplyRight(ks),s.multiplyLeft(FA),o.multiplyRight(ks),++a>2&&(++i,a=0);return r.unitary=o.toTarget(r.unitary),r.diagonal=s.toTarget(r.diagonal),r}function xR(e){for(var r=0,t=0;t<9;++t){var n=e[t];r+=n*n}return Math.sqrt(r)}var Zc=[1,0,0],$c=[2,2,1];function ER(e){for(var r=0,t=0;t<3;++t){var n=e[nr.getElementIndex($c[t],Zc[t])];r+=2*n*n}return Math.sqrt(r)}function SR(e,r){for(var t=rr.EPSILON15,n=0,a=1,i=0;i<3;++i){var o=Math.abs(e[nr.getElementIndex($c[i],Zc[i])]);o>n&&(a=i,n=o)}var s=Zc[a],u=$c[a],f=1,l=0;if(Math.abs(e[nr.getElementIndex(u,s)])>t){var c=e[nr.getElementIndex(u,u)],h=e[nr.getElementIndex(s,s)],d=e[nr.getElementIndex(u,s)],p=(c-h)/2/d,v;p<0?v=-1/(-p+Math.sqrt(1+p*p)):v=1/(p+Math.sqrt(1+p*p)),f=1/Math.sqrt(1+v*v),l=v*f}return _e.IDENTITY.to(r),r[nr.getElementIndex(s,s)]=r[nr.getElementIndex(u,u)]=f,r[nr.getElementIndex(u,s)]=l,r[nr.getElementIndex(s,u)]=-l,r}function Qc(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=wR(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function wR(e,r){if(e){if(typeof e=="string")return LA(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return LA(e,r)}}function LA(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Wr=new S,CR=new S,BR=new S,MR=new S,OR=new S,PR=new _e,IR={diagonal:new _e,unitary:new _e};function Di(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Bn;if(!e||e.length===0)return r.halfAxes=new _e([0,0,0,0,0,0,0,0,0]),r.center=new S,r;var t=e.length,n=new S(0,0,0),a=Qc(e),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;n.add(o)}}catch(V){a.e(V)}finally{a.f()}var s=1/t;n.multiplyByScalar(s);var u=0,f=0,l=0,c=0,h=0,d=0,p=Qc(e),v;try{for(p.s();!(v=p.n()).done;){var y=v.value,A=Wr.copy(y).subtract(n);u+=A.x*A.x,f+=A.x*A.y,l+=A.x*A.z,c+=A.y*A.y,h+=A.y*A.z,d+=A.z*A.z}}catch(V){p.e(V)}finally{p.f()}u*=s,f*=s,l*=s,c*=s,h*=s,d*=s;var _=PR;_[0]=u,_[1]=f,_[2]=l,_[3]=f,_[4]=c,_[5]=h,_[6]=l,_[7]=h,_[8]=d;var E=Ds(_,IR),x=E.unitary,C=r.halfAxes.copy(x),B=C.getColumn(0,BR),F=C.getColumn(1,MR),M=C.getColumn(2,OR),w=-Number.MAX_VALUE,b=-Number.MAX_VALUE,I=-Number.MAX_VALUE,L=Number.MAX_VALUE,k=Number.MAX_VALUE,D=Number.MAX_VALUE,O=Qc(e),P;try{for(O.s();!(P=O.n()).done;){var R=P.value;Wr.copy(R),w=Math.max(Wr.dot(B),w),b=Math.max(Wr.dot(F),b),I=Math.max(Wr.dot(M),I),L=Math.min(Wr.dot(B),L),k=Math.min(Wr.dot(F),k),D=Math.min(Wr.dot(M),D)}}catch(V){O.e(V)}finally{O.f()}B=B.multiplyByScalar(.5*(L+w)),F=F.multiplyByScalar(.5*(k+b)),M=M.multiplyByScalar(.5*(D+I)),r.center.copy(B).add(F).add(M);var j=CR.set(w-L,b-k,I-D).multiplyByScalar(.5),G=new _e([j[0],0,0,0,j[1],0,0,0,j[2]]);return r.halfAxes.multiplyRight(G),r}function eh(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=RR(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function RR(e,r){if(e){if(typeof e=="string")return kA(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return kA(e,r)}}function kA(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Ea=512,DA=3,UA=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],jA=UA.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),FR=jA.concat([[.25,.5],[.75,.5]]),LR=function(){function e(r,t,n){(0,GA.default)(this,e),(0,Mn.default)(this,"x",void 0),(0,Mn.default)(this,"y",void 0),(0,Mn.default)(this,"z",void 0),(0,Mn.default)(this,"childVisible",void 0),(0,Mn.default)(this,"selected",void 0),(0,Mn.default)(this,"_children",void 0),this.x=r,this.y=t,this.z=n}return(0,NA.default)(e,[{key:"children",get:function(){if(!this._children){var t=this.x*2,n=this.y*2,a=this.z+1;this._children=[new e(t,n,a),new e(t,n+1,a),new e(t+1,n,a),new e(t+1,n+1,a)]}return this._children}},{key:"update",value:function(t){var n=t.viewport,a=t.cullingVolume,i=t.elevationBounds,o=t.minZ,s=t.maxZ,u=t.bounds,f=t.offset,l=t.project,c=this.getBoundingVolume(i,f,l);if(u&&!this.insideBounds(u))return!1;var h=a.computeVisibility(c);if(h<0)return!1;if(!this.childVisible){var d=this.z;if(d<s&&d>=o){var p=c.distanceTo(n.cameraPosition)*n.scale/n.height;d+=Math.floor(Math.log2(p))}if(d>=s)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;var v=eh(this.children),y;try{for(v.s();!(y=v.n()).done;){var A=y.value;A.update(t)}}catch(_){v.e(_)}finally{v.f()}return!0}},{key:"getSelected",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(this.selected&&t.push(this),this._children){var n=eh(this._children),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;i.getSelected(t)}}catch(o){n.e(o)}finally{n.f()}}return t}},{key:"insideBounds",value:function(t){var n=(0,th.default)(t,4),a=n[0],i=n[1],o=n[2],s=n[3],u=Math.pow(2,this.z),f=Ea/u;return this.x*f<o&&this.y*f<s&&(this.x+1)*f>a&&(this.y+1)*f>i}},{key:"getBoundingVolume",value:function(t,n,a){if(a){var i=this.z<1?FR:this.z<2?jA:UA,o=[],s=eh(i),u;try{for(s.s();!(u=s.n()).done;){var f=u.value,l=Gs(this.x+f[0],this.y+f[1],this.z);l[2]=t[0],o.push(a(l)),t[0]!==t[1]&&(l[2]=t[1],o.push(a(l)))}}catch(v){s.e(v)}finally{s.f()}return Di(o)}var c=Math.pow(2,this.z),h=Ea/c,d=this.x*h+n*Ea,p=Ea-(this.y+1)*h;return new Is([d,p,t[0]],[d+h,p+h,t[1]])}}]),e}();function HA(e,r,t,n){var a=e instanceof Gi._GlobeViewport&&e.resolution?e.projectPosition:null,i=Object.values(e.getFrustumPlanes()).map(function(C){var B=C.normal,F=C.distance;return new Ue(B.clone().negate(),F)}),o=new yt(i),s=e.distanceScales.unitsPerMeter[2],u=t&&t[0]*s||0,f=t&&t[1]*s||0,l=e instanceof Gi.WebMercatorViewport&&e.pitch<=60?r:0;if(n){var c=n,h=(0,th.default)(c,4),d=h[0],p=h[1],v=h[2],y=h[3],A=ut([d,y]),_=ut([v,p]);n=[A[0],Ea-A[1],_[0],Ea-_[1]]}var E=new LR(0,0,0),x={viewport:e,project:a,cullingVolume:o,elevationBounds:[u,f],minZ:l,maxZ:r,bounds:n,offset:0};if(E.update(x),e instanceof Gi.WebMercatorViewport&&e.subViewports&&e.subViewports.length>1){for(x.offset=-1;E.update(x)&&!(--x.offset<-DA););for(x.offset=1;E.update(x)&&!(++x.offset>DA););}return E.getSelected()}var gr=512,kR=[-1/0,-1/0,1/0,1/0],qr={type:"object",value:null,validate:function(r,t){return t.optional&&r===null||typeof r=="string"||Array.isArray(r)&&r.every(function(n){return typeof n=="string"})},equal:function(r,t){if(r===t)return!0;if(!Array.isArray(r)||!Array.isArray(t))return!1;var n=r.length;if(n!==t.length)return!1;for(var a=0;a<n;a++)if(r[a]!==t[a])return!1;return!0}};function zA(e,r){var t=[r.transformAsPoint([e[0],e[1]]),r.transformAsPoint([e[2],e[1]]),r.transformAsPoint([e[0],e[3]]),r.transformAsPoint([e[2],e[3]])],n=[Math.min.apply(Math,(0,Ni.default)(t.map(function(a){return a[0]}))),Math.min.apply(Math,(0,Ni.default)(t.map(function(a){return a[1]}))),Math.max.apply(Math,(0,Ni.default)(t.map(function(a){return a[0]}))),Math.max.apply(Math,(0,Ni.default)(t.map(function(a){return a[1]})))];return n}function DR(e){return Math.abs(e.split("").reduce(function(r,t){return(r<<5)-r+t.charCodeAt(0)|0},0))}function ar(e,r){if(!e||!e.length)return null;var t=r.index,n=r.id;if(Array.isArray(e)){var a=DR(n)%e.length;e=e[a]}for(var i=e,o=0,s=Object.keys(t);o<s.length;o++){var u=s[o],f=new RegExp("{".concat(u,"}"),"g");i=i.replace(f,String(t[u]))}return Number.isInteger(t.y)&&Number.isInteger(t.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,t.z)-t.y-1))),i}function GR(e,r,t){var n;if(r&&r.length===2){var a=(0,On.default)(r,2),i=a[0],o=a[1],s=e.getBounds({z:i}),u=e.getBounds({z:o});n=[Math.min(s[0],u[0]),Math.min(s[1],u[1]),Math.max(s[2],u[2]),Math.max(s[3],u[3])]}else n=e.getBounds();return e.isGeospatial?[Math.max(n[0],t[0]),Math.max(n[1],t[1]),Math.min(n[2],t[2]),Math.min(n[3],t[3])]:[Math.max(Math.min(n[0],t[2]),t[0]),Math.max(Math.min(n[1],t[3]),t[1]),Math.min(Math.max(n[2],t[0]),t[2]),Math.min(Math.max(n[3],t[1]),t[3])]}function WA(e){var r=e.viewport,t=e.z,n=t===void 0?0:t,a=e.cullRect,i=r.subViewports||[r];return i.map(function(o){return rh(o,n,a)})}function rh(e,r,t){if(!Array.isArray(r)){var n=t.x-e.x,a=t.y-e.y,i=t.width,o=t.height,s={targetZ:r},u=e.unproject([n,a],s),f=e.unproject([n+i,a],s),l=e.unproject([n,a+o],s),c=e.unproject([n+i,a+o],s);return[Math.min(u[0],f[0],l[0],c[0]),Math.min(u[1],f[1],l[1],c[1]),Math.max(u[0],f[0],l[0],c[0]),Math.max(u[1],f[1],l[1],c[1])]}var h=rh(e,r[0],t),d=rh(e,r[1],t);return[Math.min(h[0],d[0]),Math.min(h[1],d[1]),Math.max(h[2],d[2]),Math.max(h[3],d[3])]}function NR(e,r,t){if(t){var n=zA(e,t).map(function(a){return a*r/gr});return n}return e.map(function(a){return a*r/gr})}function nh(e,r){return Math.pow(2,e)*gr/r}function Gs(e,r,t){var n=nh(t,gr),a=e/n*360-180,i=Math.PI-2*Math.PI*r/n,o=180/Math.PI*Math.atan(.5*(Math.exp(i)-Math.exp(-i)));return[a,o]}function VA(e,r,t,n){var a=nh(t,n);return[e/a*gr,r/a*gr]}function ah(e,r,t,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:gr;if(e.isGeospatial){var i=Gs(r,t,n),o=(0,On.default)(i,2),s=o[0],u=o[1],f=Gs(r+1,t+1,n),l=(0,On.default)(f,2),c=l[0],h=l[1];return{west:s,north:u,east:c,south:h}}var d=VA(r,t,n,a),p=(0,On.default)(d,2),v=p[0],y=p[1],A=VA(r+1,t+1,n,a),_=(0,On.default)(A,2),E=_[0],x=_[1];return{left:v,top:y,right:E,bottom:x}}function UR(e,r,t,n,a){for(var i=GR(e,null,n),o=nh(r,t),s=NR(i,o,a),u=(0,On.default)(s,4),f=u[0],l=u[1],c=u[2],h=u[3],d=[],p=Math.floor(f);p<c;p++)for(var v=Math.floor(l);v<h;v++)d.push({x:p,y:v,z:r});return d}function ih(e){var r=e.viewport,t=e.maxZoom,n=e.minZoom,a=e.zRange,i=e.extent,o=e.tileSize,s=o===void 0?gr:o,u=e.modelMatrix,f=e.modelMatrixInverse,l=e.zoomOffset,c=l===void 0?0:l,h=r.isGeospatial?Math.round(r.zoom+Math.log2(gr/s))+c:Math.ceil(r.zoom)+c;if(typeof n=="number"&&Number.isFinite(n)&&h<n){if(!i)return[];h=n}typeof t=="number"&&Number.isFinite(t)&&h>t&&(h=t);var d=i;return u&&f&&i&&!r.isGeospatial&&(d=zA(i,u)),r.isGeospatial?HA(r,h,a,i):UR(r,h,s,d||kR,f)}function oh(e){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(e)}function sh(e){return Number.isFinite(e.west)&&Number.isFinite(e.north)&&Number.isFinite(e.east)&&Number.isFinite(e.south)}function qA(e){var r={},t;return function(n){for(var a in n)if(!jR(n[a],r[a])){t=e(n),r=n;break}return t}}function jR(e,r){if(e===r)return!0;if(Array.isArray(e)){var t=e.length;if(!r||r.length!==t)return!1;for(var n=0;n<t;n++)if(e[n]!==r[n])return!1;return!0}return!1}var Ui;function Qe(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=HR(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function HR(e,r){if(e){if(typeof e=="string")return JA(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return JA(e,r)}}function JA(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function XA(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function KA(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?XA(Object(t),!0).forEach(function(n){(0,je.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):XA(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var YA=1,Ns=2,VR="never",zR="no-overlap",ji="best-available",WR=5,qR=(Ui={},(0,je.default)(Ui,ji,XR),(0,je.default)(Ui,zR,KR),(0,je.default)(Ui,VR,function(){}),Ui),JR={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:function(){},onTileUnload:function(){},onTileError:function(){}},Hi=function(){function e(r){var t=this;(0,ZA.default)(this,e),(0,je.default)(this,"opts",void 0),(0,je.default)(this,"_requestScheduler",void 0),(0,je.default)(this,"_cache",void 0),(0,je.default)(this,"_dirty",void 0),(0,je.default)(this,"_tiles",void 0),(0,je.default)(this,"_cacheByteSize",void 0),(0,je.default)(this,"_viewport",void 0),(0,je.default)(this,"_zRange",void 0),(0,je.default)(this,"_selectedTiles",void 0),(0,je.default)(this,"_frameNumber",void 0),(0,je.default)(this,"_modelMatrix",void 0),(0,je.default)(this,"_modelMatrixInverse",void 0),(0,je.default)(this,"_maxZoom",void 0),(0,je.default)(this,"_minZoom",void 0),(0,je.default)(this,"onTileLoad",void 0),(0,je.default)(this,"_getCullBounds",qA(WA)),this.opts=KA(KA({},JR),r),this.onTileLoad=function(n){var a,i;(a=(i=t.opts).onTileLoad)===null||a===void 0||a.call(i,n),t.opts.maxCacheByteSize&&(t._cacheByteSize+=n.byteLength,t._resizeCache())},this._requestScheduler=new di({maxRequests:r.maxRequests,throttleRequests:Boolean(r.maxRequests&&r.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new ee,this._modelMatrixInverse=new ee,this.setOptions(r)}return(0,$A.default)(e,[{key:"tiles",get:function(){return this._tiles}},{key:"selectedTiles",get:function(){return this._selectedTiles}},{key:"isLoaded",get:function(){return this._selectedTiles!==null&&this._selectedTiles.every(function(t){return t.isLoaded})}},{key:"needsReload",get:function(){return this._selectedTiles!==null&&this._selectedTiles.some(function(t){return t.needsReload})}},{key:"setOptions",value:function(t){Object.assign(this.opts,t),Number.isFinite(t.maxZoom)&&(this._maxZoom=Math.floor(t.maxZoom)),Number.isFinite(t.minZoom)&&(this._minZoom=Math.ceil(t.minZoom))}},{key:"finalize",value:function(){var t=Qe(this._cache.values()),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;a.isLoading&&a.abort()}}catch(i){t.e(i)}finally{t.f()}this._cache.clear(),this._tiles=[],this._selectedTiles=null}},{key:"reloadAll",value:function(){var t=Qe(this._cache.keys()),n;try{for(t.s();!(n=t.n()).done;){var a=n.value,i=this._cache.get(a);!this._selectedTiles||!this._selectedTiles.includes(i)?this._cache.delete(a):i.setNeedsReload()}}catch(o){t.e(o)}finally{t.f()}}},{key:"update",value:function(t){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=a.zRange,o=a.modelMatrix,s=new ee(o),u=!s.equals(this._modelMatrix);if(!this._viewport||!t.equals(this._viewport)||!Ze(this._zRange,i)||u){u&&(this._modelMatrixInverse=s.clone().invert(),this._modelMatrix=s),this._viewport=t,this._zRange=i;var f=this.getTileIndices({viewport:t,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:i,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=f.map(function(c){return n._getTile(c,!0)}),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(function(c){return n._getTile(c.index,!0)}));var l=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),l&&this._frameNumber++,this._frameNumber}},{key:"isTileVisible",value:function(t,n){if(!t.isVisible)return!1;if(n&&this._viewport){var a=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:n}),i=t.bbox,o=Qe(a),s;try{for(o.s();!(s=o.n()).done;){var u=(0,uh.default)(s.value,4),f=u[0],l=u[1],c=u[2],h=u[3],d=void 0;if("west"in i)d=i.west<c&&i.east>f&&i.south<h&&i.north>l;else{var p=Math.min(i.top,i.bottom),v=Math.max(i.top,i.bottom);d=i.left<c&&i.right>f&&p<h&&v>l}if(d)return!0}}catch(y){o.e(y)}finally{o.f()}return!1}return!0}},{key:"getTileIndices",value:function(t){var n=t.viewport,a=t.maxZoom,i=t.minZoom,o=t.zRange,s=t.modelMatrix,u=t.modelMatrixInverse,f=this.opts,l=f.tileSize,c=f.extent,h=f.zoomOffset;return ih({viewport:n,maxZoom:a,minZoom:i,zRange:o,tileSize:l,extent:c,modelMatrix:s,modelMatrixInverse:u,zoomOffset:h})}},{key:"getTileId",value:function(t){return"".concat(t.x,"-").concat(t.y,"-").concat(t.z)}},{key:"getTileZoom",value:function(t){return t.z}},{key:"getTileMetadata",value:function(t){var n=this.opts.tileSize;return{bbox:ah(this._viewport,t.x,t.y,t.z,n)}}},{key:"getParentIndex",value:function(t){var n=Math.floor(t.x/2),a=Math.floor(t.y/2),i=t.z-1;return{x:n,y:a,z:i}}},{key:"updateTileStates",value:function(){var t=this.opts.refinementStrategy||ji,n=new Array(this._cache.size),a=0,i=Qe(this._cache.values()),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;n[a++]=s.isVisible,s.isSelected=!1,s.isVisible=!1}}catch(p){i.e(p)}finally{i.f()}var u=Qe(this._selectedTiles),f;try{for(u.s();!(f=u.n()).done;){var l=f.value;l.isSelected=!0,l.isVisible=!0}}catch(p){u.e(p)}finally{u.f()}(typeof t=="function"?t:qR[t])(Array.from(this._cache.values())),a=0;var c=Qe(this._cache.values()),h;try{for(c.s();!(h=c.n()).done;){var d=h.value;if(n[a++]!==d.isVisible)return!0}}catch(p){c.e(p)}finally{c.f()}return!1}},{key:"_pruneRequests",value:function(){var t=this.opts.maxRequests,n=t===void 0?0:t,a=[],i=0,o=Qe(this._cache.values()),s;try{for(o.s();!(s=o.n()).done;){var u=s.value;u.isLoading&&(i++,!u.isSelected&&!u.isVisible&&a.push(u))}}catch(l){o.e(l)}finally{o.f()}for(;n>0&&i>n&&a.length>0;){var f=a.shift();f.abort(),i--}}},{key:"_rebuildTree",value:function(){var t=this._cache,n=Qe(t.values()),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;i.parent=null,i.children&&(i.children.length=0)}}catch(l){n.e(l)}finally{n.f()}var o=Qe(t.values()),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,f=this._getNearestAncestor(u);u.parent=f,f!=null&&f.children&&f.children.push(u)}}catch(l){o.e(l)}finally{o.f()}}},{key:"_resizeCache",value:function(){var t=this._cache,n=this.opts,a=n.maxCacheSize||(n.maxCacheByteSize?1/0:WR*this.selectedTiles.length),i=n.maxCacheByteSize||1/0,o=t.size>a||this._cacheByteSize>i;if(o){var s=Qe(t),u;try{for(s.s();!(u=s.n()).done;){var f=(0,uh.default)(u.value,2),l=f[0],c=f[1];if(!c.isVisible&&!c.isSelected){var h,d;this._cacheByteSize-=n.maxCacheByteSize?c.byteLength:0,t.delete(l),(h=(d=this.opts).onTileUnload)===null||h===void 0||h.call(d,c)}if(t.size<=a&&this._cacheByteSize<=i)break}}catch(p){s.e(p)}finally{s.f()}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort(function(p,v){return p.zoom-v.zoom}),this._dirty=!1)}},{key:"_getTile",value:function(t,n){var a=this.getTileId(t),i=this._cache.get(a),o=!1;return!i&&n?(i=new Li(t),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:a,zoom:this.getTileZoom(i.index)}),o=!0,this._cache.set(a,i),this._dirty=!0):i&&i.needsReload&&(o=!0),i&&o&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}},{key:"_getNearestAncestor",value:function(t){for(var n=this._minZoom,a=n===void 0?0:n,i=t.index;this.getTileZoom(i)>a;){i=this.getParentIndex(i);var o=this._getTile(i);if(o)return o}return null}}]),e}();function XR(e){var r=Qe(e),t;try{for(r.s();!(t=r.n()).done;){var n=t.value;n.state=0}}catch(l){r.e(l)}finally{r.f()}var a=Qe(e),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;o.isSelected&&!QA(o)&&fh(o)}}catch(l){a.e(l)}finally{a.f()}var s=Qe(e),u;try{for(s.s();!(u=s.n()).done;){var f=u.value;f.isVisible=Boolean(f.state&Ns)}}catch(l){s.e(l)}finally{s.f()}}function KR(e){var r=Qe(e),t;try{for(r.s();!(t=r.n()).done;){var n=t.value;n.state=0}}catch(p){r.e(p)}finally{r.f()}var a=Qe(e),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;o.isSelected&&QA(o)}}catch(p){a.e(p)}finally{a.f()}var s=Array.from(e).sort(function(p,v){return p.zoom-v.zoom}),u=Qe(s),f;try{for(u.s();!(f=u.n()).done;){var l=f.value;if(l.isVisible=Boolean(l.state&Ns),l.children&&(l.isVisible||l.state&YA)){var c=Qe(l.children),h;try{for(c.s();!(h=c.n()).done;){var d=h.value;d.state=YA}}catch(p){c.e(p)}finally{c.f()}}else l.isSelected&&fh(l)}}catch(p){u.e(p)}finally{u.f()}}function QA(e){for(var r=e;r;){if(r.isLoaded||r.content)return r.state|=Ns,!0;r=r.parent}return!1}function fh(e){var r=Qe(e.children),t;try{for(r.s();!(t=r.n()).done;){var n=t.value;n.isLoaded||n.content?n.state|=Ns:fh(n)}}catch(a){r.e(a)}finally{r.f()}}function e_(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function lh(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?e_(Object(t),!0).forEach(function(n){(0,Us.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):e_(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function YR(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=ZR(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function ZR(e,r){if(e){if(typeof e=="string")return t_(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return t_(e,r)}}function t_(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function $R(e){var r=QR();return function(){var n=(0,ch.default)(e),a;if(r){var i=(0,ch.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,i_.default)(this,a)}}function QR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var eF={TilesetClass:Hi,data:{type:"data",value:[]},dataComparator:qr.equal,renderSubLayers:{type:"function",value:function(r){return new o_.GeoJsonLayer(r)}},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:function(r){}},onTileUnload:{type:"function",value:function(r){}},onTileError:{type:"function",value:function(r){return console.error(r)}},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:ji,zRange:null,maxRequests:6,zoomOffset:0},yr=function(e){(0,a_.default)(t,e);var r=$R(t);function t(){return(0,r_.default)(this,t),r.apply(this,arguments)}return(0,n_.default)(t,[{key:"initializeState",value:function(){this.state={tileset:null,isLoaded:!1}}},{key:"finalizeState",value:function(){var a,i;(a=this.state)===null||a===void 0||(i=a.tileset)===null||i===void 0||i.finalize()}},{key:"isLoaded",get:function(){var a,i;return(a=this.state)===null||a===void 0||(i=a.tileset)===null||i===void 0?void 0:i.selectedTiles.every(function(o){return o.isLoaded&&o.layers&&o.layers.every(function(s){return s.isLoaded})})}},{key:"shouldUpdateState",value:function(a){var i=a.changeFlags;return i.somethingChanged}},{key:"updateState",value:function(a){var i=a.changeFlags,o=this.state.tileset,s=i.propsOrDataChanged||i.updateTriggersChanged,u=i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getTileData);o?s&&(o.setOptions(this._getTilesetOptions()),u?o.reloadAll():this.state.tileset.tiles.forEach(function(f){f.layers=null})):(o=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:o})),this._updateTileset()}},{key:"_getTilesetOptions",value:function(){var a=this.props,i=a.tileSize,o=a.maxCacheSize,s=a.maxCacheByteSize,u=a.refinementStrategy,f=a.extent,l=a.maxZoom,c=a.minZoom,h=a.maxRequests,d=a.zoomOffset;return{maxCacheSize:o,maxCacheByteSize:s,maxZoom:l,minZoom:c,tileSize:i,refinementStrategy:u,extent:f,maxRequests:h,zoomOffset:d,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}},{key:"_updateTileset",value:function(){var a=this.state.tileset,i=this.props,o=i.zRange,s=i.modelMatrix,u=a.update(this.context.viewport,{zRange:o,modelMatrix:s}),f=a.isLoaded,l=this.state.isLoaded!==f,c=this.state.frameNumber!==u;f&&(l||c)&&this._onViewportLoad(),c&&this.setState({frameNumber:u}),this.state.isLoaded=f}},{key:"_onViewportLoad",value:function(){var a=this.state.tileset,i=this.props.onViewportLoad;i&&i(a.selectedTiles)}},{key:"_onTileLoad",value:function(a){this.props.onTileLoad(a),a.layers=null,this.setNeedsUpdate()}},{key:"_onTileError",value:function(a,i){this.props.onTileError(a),i.layers=null,this.setNeedsUpdate()}},{key:"_onTileUnload",value:function(a){this.props.onTileUnload(a)}},{key:"getTileData",value:function(a){var i=this.props,o=i.data,s=i.getTileData,u=i.fetch,f=a.signal;return a.url=typeof o=="string"||Array.isArray(o)?ar(o,a):null,s?s(a):u&&a.url?u(a.url,{propName:"data",layer:this,signal:f}):null}},{key:"renderSubLayers",value:function(a){return this.props.renderSubLayers(a)}},{key:"getSubLayerPropsByTile",value:function(a){return null}},{key:"getPickingInfo",value:function(a){var i=a.info,o=a.sourceLayer,s=o.props.tile;return i.picked&&(i.tile=s),i.sourceTile=s,i}},{key:"_updateAutoHighlight",value:function(a){var i=a.sourceTile;if(i&&i.layers){var o=YR(i.layers),s;try{for(o.s();!(s=o.n()).done;){var u=s.value;u.updateAutoHighlight(a)}}catch(f){o.e(f)}finally{o.f()}}}},{key:"renderLayers",value:function(){var a=this;return this.state.tileset.tiles.map(function(i){var o=a.getSubLayerPropsByTile(i);if(!(!i.isLoaded&&!i.content))if(i.layers)o&&i.layers[0]&&Object.keys(o).some(function(u){return i.layers[0].props[u]!==o[u]})&&(i.layers=i.layers.map(function(u){return u.clone(o)}));else{var s=a.renderSubLayers(lh(lh({},a.props),{},{id:"".concat(a.id,"-").concat(i.id),data:i.content,_offset:0,tile:i}));i.layers=(0,js._flatten)(s,Boolean).map(function(u){return u.clone(lh({tile:i},o))})}return i.layers})}},{key:"filterSubLayer",value:function(a){var i=a.layer,o=a.cullRect,s=i.props.tile;return this.state.tileset.isTileVisible(s,o)}}]),t}(js.CompositeLayer);(0,Us.default)(yr,"defaultProps",eF);(0,Us.default)(yr,"layerName","TileLayer");var f_=m(H()),l_=m(z()),Hs=m(dn()),c_=m(Te()),h_=m(xe()),Sa=m(be()),Vs=m(W()),d_=m(Nt());function s_(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function u_(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?s_(Object(t),!0).forEach(function(n){(0,Vs.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s_(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function tF(e){var r=rF();return function(){var n=(0,Sa.default)(e),a;if(r){var i=(0,Sa.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,h_.default)(this,a)}}function rF(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var nF={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:function(r){return r.timestamps}}},zs=function(e){(0,c_.default)(t,e);var r=tF(t);function t(){return(0,f_.default)(this,t),r.apply(this,arguments)}return(0,l_.default)(t,[{key:"getShaders",value:function(){var a=(0,Hs.default)((0,Sa.default)(t.prototype),"getShaders",this).call(this);return a.inject={"vs:#decl":`uniform float trailLength;
attribute float instanceTimestamps;
attribute float instanceNextTimestamps;
varying float vTime;
`,"vs:#main-end":`vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;
`,"fs:#decl":`uniform bool fadeTrail;
uniform float trailLength;
uniform float currentTime;
varying float vTime;
`,"fs:#main-start":`if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {
  discard;
}
`,"fs:DECKGL_FILTER_COLOR":`if(fadeTrail) {
  color.a *= 1.0 - (currentTime - vTime) / trailLength;
}
`},a}},{key:"initializeState",value:function(){(0,Hs.default)((0,Sa.default)(t.prototype),"initializeState",this).call(this);var a=this.getAttributeManager();a.addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}},{key:"draw",value:function(a){var i=this.props,o=i.fadeTrail,s=i.trailLength,u=i.currentTime;a.uniforms=u_(u_({},a.uniforms),{},{fadeTrail:o,trailLength:s,currentTime:u}),(0,Hs.default)((0,Sa.default)(t.prototype),"draw",this).call(this,a)}}]),t}(d_.PathLayer);(0,Vs.default)(zs,"layerName","TripsLayer");(0,Vs.default)(zs,"defaultProps",nF);var C_=m(H()),B_=m(z()),M_=m(Te()),O_=m(xe()),mh=m(be()),vh=m(W()),P_=m(hh()),I_=m(Ut());var y_=m(H()),A_=m(z()),__=m(wt()),b_=m(Te()),T_=m(xe()),dh=m(be()),wa=m(W()),x_=m(Ge()),Vi=m(ie()),nt=m(hh());var qs=m(Ut()),zi=m(Nt());function aF(e){var r=iF();return function(){var n=(0,dh.default)(e),a;if(r){var i=(0,dh.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,T_.default)(this,a)}}function iF(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function m_(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Ws(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?m_(Object(t),!0).forEach(function(n){(0,wa.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m_(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function ph(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=oF(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function oF(e,r){if(e){if(typeof e=="string")return v_(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return v_(e,r)}}function v_(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var sF=10;function E_(e,r){r=r===void 0?e[0][0]:r;var t=ph(e),n;try{for(t.s();!(n=t.n()).done;){var a=n.value,i=a[0]-r;i>180?a[0]-=360:i<-180&&(a[0]+=360)}}catch(o){t.e(o)}finally{t.f()}}function uF(e,r,t){var n=(0,nt.h3ToGeo)(e),a=(0,Vi.default)(n,2),i=a[0],o=a[1],s=r.length;E_(r,o);for(var u=r[0]===r[s-1]?s-1:s,f=0;f<u;f++)r[f][0]=Ur(o,r[f][0],t),r[f][1]=Ur(i,r[f][1],t)}function fF(e,r,t){var n=e(r,t),a=(0,nt.h3ToGeo)(n),i=(0,Vi.default)(a,2),o=i[0],s=i[1];return[s,o]}function g_(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,t=(0,nt.h3ToGeoBoundary)(e,!0);return r!==1?uF(e,t,r):E_(t),t}function lF(e){var r=new Float64Array(e.length*2),t=0,n=ph(e),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;r[t++]=i[0],r[t++]=i[1]}}catch(o){n.e(o)}finally{n.f()}return r}function cF(e,r){var t;return e==null?t=r:(0,x_.default)(e)==="object"?t=Ws(Ws({},e),{},{coverage:r}):t={getHexagon:e,coverage:r},t}var hF=Ws(Ws({},zi.PolygonLayer.defaultProps),{},{highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:function(r){return r.hexagon}},extruded:!0}),Pn=function(e){(0,b_.default)(t,e);var r=aF(t);function t(){var n;(0,y_.default)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=r.call.apply(r,[this].concat(i)),(0,wa.default)((0,__.default)(n),"state",void 0),n}return(0,A_.default)(t,[{key:"initializeState",value:function(){t._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}},{key:"shouldUpdateState",value:function(a){var i=a.changeFlags;return this._shouldUseHighPrecision()?i.propsOrDataChanged:i.somethingChanged}},{key:"updateState",value:function(a){var i=a.props,o=a.changeFlags;if(i.highPrecision!==!0&&(o.dataChanged||o.updateTriggersChanged&&o.updateTriggersChanged.getHexagon)){var s=this._calculateH3DataProps();this.setState(s)}this._updateVertices(this.context.viewport)}},{key:"_calculateH3DataProps",value:function(){var a=-1,i=!1,o=!1,s=(0,qs.createIterable)(this.props.data),u=s.iterable,f=s.objectInfo,l=ph(u),c;try{for(l.s();!(c=l.n()).done;){var h=c.value;f.index++;var d=this.props.getHexagon(h,f),p=(0,nt.h3GetResolution)(d);if(a<0){if(a=p,!this.props.highPrecision)break}else if(a!==p){o=!0;break}if((0,nt.h3IsPentagon)(d)){i=!0;break}}}catch(v){l.e(v)}finally{l.f()}return{resolution:a,edgeLengthKM:a>=0?(0,nt.edgeLength)(a,"km"):0,hasMultipleRes:o,hasPentagon:i}}},{key:"_shouldUseHighPrecision",value:function(){if(this.props.highPrecision==="auto"){var a=this.state,i=a.resolution,o=a.hasPentagon,s=a.hasMultipleRes,u=this.context.viewport;return Boolean(u?.resolution)||s||o||i>=0&&i<=5}return this.props.highPrecision}},{key:"_updateVertices",value:function(a){if(!this._shouldUseHighPrecision()){var i=this.state,o=i.resolution,s=i.edgeLengthKM,u=i.centerHex;if(!(o<0)){var f=this.props.centerHexagon||(0,nt.geoToH3)(a.latitude,a.longitude,o);if(u!==f){if(u){var l=(0,nt.h3Distance)(u,f);if(l>=0&&l*s<sF)return}var c=a.distanceScales.unitsPerMeter,h=g_(f),d=(0,nt.h3ToGeo)(f),p=(0,Vi.default)(d,2),v=p[0],y=p[1],A=a.projectFlat([y,v]),_=(0,Vi.default)(A,2),E=_[0],x=_[1];h=h.map(function(C){var B=a.projectFlat(C);return[(B[0]-E)/c[0],(B[1]-x)/c[1]]}),this.setState({centerHex:f,vertices:h})}}}}},{key:"renderLayers",value:function(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}},{key:"_getForwardProps",value:function(){var a=this.props,i=a.elevationScale,o=a.material,s=a.coverage,u=a.extruded,f=a.wireframe,l=a.stroked,c=a.filled,h=a.lineWidthUnits,d=a.lineWidthScale,p=a.lineWidthMinPixels,v=a.lineWidthMaxPixels,y=a.getFillColor,A=a.getElevation,_=a.getLineColor,E=a.getLineWidth,x=a.transitions,C=a.updateTriggers;return{elevationScale:i,extruded:u,coverage:s,wireframe:f,stroked:l,filled:c,lineWidthUnits:h,lineWidthScale:d,lineWidthMinPixels:p,lineWidthMaxPixels:v,material:o,getElevation:A,getFillColor:y,getLineColor:_,getLineWidth:E,transitions:x,updateTriggers:{getFillColor:C.getFillColor,getElevation:C.getElevation,getLineColor:C.getLineColor,getLineWidth:C.getLineWidth}}}},{key:"_renderPolygonLayer",value:function(){var a=this.props,i=a.data,o=a.getHexagon,s=a.updateTriggers,u=a.coverage,f=this.getSubLayerClass("hexagon-cell-hifi",zi.PolygonLayer),l=this._getForwardProps();return l.updateTriggers.getPolygon=cF(s.getHexagon,u),new f(l,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:l.updateTriggers}),{data:i,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:function(h,d){var p=o(h,d);return lF(g_(p,u))}})}},{key:"_renderColumnLayer",value:function(){var a=this.props,i=a.data,o=a.getHexagon,s=a.updateTriggers,u=this.getSubLayerClass("hexagon-cell",zi.ColumnLayer),f=this._getForwardProps();return f.updateTriggers.getPosition=s.getHexagon,new u(f,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:f.updateTriggers}),{data:i,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:fF.bind(null,o)})}}]),t}(qs.CompositeLayer);(0,wa.default)(Pn,"defaultProps",hF);(0,wa.default)(Pn,"layerName","H3HexagonLayer");(0,wa.default)(Pn,"_checkH3Lib",function(){});function S_(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=dF(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function dF(e,r){if(e){if(typeof e=="string")return w_(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return w_(e,r)}}function w_(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function pF(e){var r=mF();return function(){var n=(0,mh.default)(e),a;if(r){var i=(0,mh.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,O_.default)(this,a)}}function mF(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vF={getHexagons:{type:"accessor",value:function(r){return r.hexagons}}},Js=function(e){(0,M_.default)(t,e);var r=pF(t);function t(){return(0,C_.default)(this,t),r.apply(this,arguments)}return(0,B_.default)(t,[{key:"initializeState",value:function(){Pn._checkH3Lib()}},{key:"updateState",value:function(a){var i=a.props,o=a.changeFlags;if(o.dataChanged||o.updateTriggersChanged&&o.updateTriggersChanged.getHexagons){var s=i.data,u=i.getHexagons,f=[],l=(0,I_.createIterable)(s),c=l.iterable,h=l.objectInfo,d=S_(c),p;try{for(d.s();!(p=d.n()).done;){var v=p.value;h.index++;var y=u(v,h),A=(0,P_.h3SetToMultiPolygon)(y,!0),_=S_(A),E;try{for(_.s();!(E=_.n()).done;){var x=E.value;f.push(this.getSubLayerRow({polygon:x},v,h.index))}}catch(C){_.e(C)}finally{_.f()}}}catch(C){d.e(C)}finally{d.f()}this.setState({polygons:f})}}},{key:"indexToBounds",value:function(){var a=this.props,i=a.getElevation,o=a.getFillColor,s=a.getLineColor,u=a.getLineWidth;return{data:this.state.polygons,getPolygon:function(l){return l.polygon},getElevation:this.getSubLayerAccessor(i),getFillColor:this.getSubLayerAccessor(o),getLineColor:this.getSubLayerAccessor(s),getLineWidth:this.getSubLayerAccessor(u)}}}]),t}(Pt);(0,vh.default)(Js,"layerName","H3ClusterLayer");(0,vh.default)(Js,"defaultProps",vF);var u2=m(K()),f2=m(H()),l2=m(z()),c2=m(wt()),h2=m(Te()),d2=m(xe()),jm=m(be()),xo=m(W()),Hm=m(Y()),p2=m(gh()),un=m(Ut()),m2=m(Nt()),v2=m(Xs());var kT=m(H()),DT=m(z()),Fa=m(dn()),GT=m(Te()),NT=m(xe()),Qr=m(be()),vu=m(W());var Qs=m(Ge()),Wi=m(st()),K_=m(W()),Y_=m(H()),Z_=m(z());var L_=m(Ge());var Ks=m(Ge());function yh(e){if(typeof window<"u"&&(0,Ks.default)(window.process)==="object"&&window.process.type==="renderer"||typeof process<"u"&&(0,Ks.default)(process.versions)==="object"&&Boolean(process.versions.electron))return!0;var r=(typeof navigator>"u"?"undefined":(0,Ks.default)(navigator))==="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,t=e||r;return!!(t&&t.indexOf("Electron")>=0)}function ht(){var e=(typeof process>"u"?"undefined":(0,L_.default)(process))==="object"&&String(process)==="[object process]"&&!process.browser;return!e||yh()}var k_=m(Ge()),Jr={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:(typeof process>"u"?"undefined":(0,k_.default)(process))==="object"&&process};var gF=Jr.self||Jr.window||Jr.global,Ca=Jr.window||Jr.self||Jr.global,yF=Jr.document||{},In=Jr.process||{};var Ys="8.9.19",bJ=ht();var D_=m(H()),G_=m(z());function AF(e){try{var r=window[e],t="__storage_test__";return r.setItem(t,t),r.removeItem(t),r}catch{return null}}var N_=function(){function e(r){(0,D_.default)(this,e);var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";g(this,"storage",void 0),g(this,"id",void 0),g(this,"config",{}),this.storage=AF(n),this.id=r,this.config={},Object.assign(this.config,t),this._loadConfiguration()}return(0,G_.default)(e,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(t){return this.config={},this.updateConfiguration(t)}},{key:"updateConfiguration",value:function(t){if(Object.assign(this.config,t),this.storage){var n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}return this}},{key:"_loadConfiguration",value:function(){var t={};if(this.storage){var n=this.storage.getItem(this.id);t=n?JSON.parse(n):{}}return Object.assign(this.config,t),this}}]),e}();function U_(e){var r;return e<10?r="".concat(e.toFixed(2),"ms"):e<100?r="".concat(e.toFixed(1),"ms"):e<1e3?r="".concat(e.toFixed(0),"ms"):r="".concat((e/1e3).toFixed(2),"s"),r}function j_(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,t=Math.max(r-e.length,0);return"".concat(" ".repeat(t)).concat(e)}function Zs(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,a=e.src.replace(/\(/g,"%28").replace(/\)/g,"%29");e.width>n&&(t=Math.min(t,n/e.width));var i=e.width*t,o=e.height*t,s=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(i/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(a,");"),"background-size:".concat(i,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(r," %c+"),s]}var $s;(function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"})($s||($s={}));function H_(e){return typeof e=="string"?$s[e.toUpperCase()]||$s.WHITE:e}function V_(e,r,t){return!ht&&typeof e=="string"&&(r&&(r=H_(r),e="\x1B[".concat(r,"m").concat(e,"\x1B[39m")),t&&(r=H_(t),e="\x1B[".concat(t+10,"m").concat(e,"\x1B[49m"))),e}function _F(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=bF(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function bF(e,r){if(e){if(typeof e=="string")return z_(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return z_(e,r)}}function z_(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function W_(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"],t=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(t),a=_F(n),i;try{var o=function(){var u=i.value;typeof e[u]=="function"&&(r.find(function(f){return u===f})||(e[u]=e[u].bind(e)))};for(a.s();!(i=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}}function Ba(e,r){if(!e)throw new Error(r||"Assertion failed")}function Rn(){var e;if(ht&&"performance"in Ca){var r,t;e=Ca===null||Ca===void 0||(r=Ca.performance)===null||r===void 0||(t=r.now)===null||t===void 0?void 0:t.call(r)}else if("hrtime"in In){var n,a=In===null||In===void 0||(n=In.hrtime)===null||n===void 0?void 0:n.call(In);e=a[0]*1e3+a[1]/1e6}else e=Date.now();return e}var Ma={debug:ht&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},TF={enabled:!0,level:0};function It(){}var q_={},J_={once:!0},Oa=function(){function e(){(0,Y_.default)(this,e);var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""},t=r.id;g(this,"id",void 0),g(this,"VERSION",Ys),g(this,"_startTs",Rn()),g(this,"_deltaTs",Rn()),g(this,"_storage",void 0),g(this,"userData",{}),g(this,"LOG_THROTTLE_TIMEOUT",0),this.id=t,this._storage=new N_("__probe-".concat(this.id,"__"),TF),this.userData={},this.timeStamp("".concat(this.id," started")),W_(this),Object.seal(this)}return(0,Z_.default)(e,[{key:"level",get:function(){return this.getLevel()},set:function(t){this.setLevel(t)}},{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((Rn()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((Rn()-this._deltaTs).toPrecision(10))}},{key:"priority",get:function(){return this.level},set:function(t){this.level=t}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:t}),this}},{key:"setLevel",value:function(t){return this._storage.updateConfiguration({level:t}),this}},{key:"get",value:function(t){return this._storage.config[t]}},{key:"set",value:function(t,n){this._storage.updateConfiguration((0,K_.default)({},t,n))}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"assert",value:function(t,n){Ba(t,n)}},{key:"warn",value:function(t){return this._getLogFunction(0,t,Ma.warn,arguments,J_)}},{key:"error",value:function(t){return this._getLogFunction(0,t,Ma.error,arguments)}},{key:"deprecated",value:function(t,n){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}},{key:"removed",value:function(t,n){return this.error("`".concat(t,"` has been removed. Use `").concat(n,"` instead"))}},{key:"probe",value:function(t,n){return this._getLogFunction(t,n,Ma.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(t,n){return this._getLogFunction(t,n,Ma.debug,arguments)}},{key:"info",value:function(t,n){return this._getLogFunction(t,n,console.info,arguments)}},{key:"once",value:function(t,n){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return this._getLogFunction(t,n,Ma.debug||Ma.info,arguments,J_)}},{key:"table",value:function(t,n,a){return n?this._getLogFunction(t,n,console.table||It,a&&[a],{tag:wF(n)}):It}},{key:"image",value:function(t){var n=t.logLevel,a=t.priority,i=t.image,o=t.message,s=o===void 0?"":o,u=t.scale,f=u===void 0?1:u;return this._shouldLog(n||a)?ht?SF({image:i,message:s,scale:f}):EF({image:i,message:s,scale:f}):It}},{key:"time",value:function(t,n){return this._getLogFunction(t,n,console.time?console.time:console.info)}},{key:"timeEnd",value:function(t,n){return this._getLogFunction(t,n,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(t,n){return this._getLogFunction(t,n,console.timeStamp||It)}},{key:"group",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1},i=X_({logLevel:t,message:n,opts:a}),o=a.collapsed;return i.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}},{key:"groupCollapsed",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(t,n,Object.assign({},a,{collapsed:!0}))}},{key:"groupEnd",value:function(t){return this._getLogFunction(t,"",console.groupEnd||It)}},{key:"withGroup",value:function(t,n,a){this.group(t,n)();try{a()}finally{this.groupEnd(t)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(t){return this.isEnabled()&&this.getLevel()>=$_(t)}},{key:"_getLogFunction",value:function(t,n,a,i,o){if(this._shouldLog(t)){var s;o=X_({logLevel:t,message:n,args:i,opts:o}),a=a||o.method,Ba(a),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=Rn();var u=o.tag||o.message;if(o.once)if(!q_[u])q_[u]=Rn();else return It;return n=xF(this.id,o.message,o),(s=a).bind.apply(s,[console,n].concat((0,Wi.default)(o.args)))}return It}}]),e}();g(Oa,"VERSION",Ys);function $_(e){if(!e)return 0;var r;switch((0,Qs.default)(e)){case"number":r=e;break;case"object":r=e.logLevel||e.priority||0;break;default:return 0}return Ba(Number.isFinite(r)&&r>=0),r}function X_(e){var r=e.logLevel,t=e.message;e.logLevel=$_(r);for(var n=e.args?Array.from(e.args):[];n.length&&n.shift()!==t;);switch((0,Qs.default)(r)){case"string":case"function":t!==void 0&&n.unshift(t),e.message=r;break;case"object":Object.assign(e,r);break;default:}typeof e.message=="function"&&(e.message=e.message());var a=(0,Qs.default)(e.message);return Ba(a==="string"||a==="object"),Object.assign(e,{args:n},e.opts)}function xF(e,r,t){if(typeof r=="string"){var n=t.time?j_(U_(t.total)):"";r=t.time?"".concat(e,": ").concat(n,"  ").concat(r):"".concat(e,": ").concat(r),r=V_(r,t.color,t.background)}return r}function EF(e){var r=e.image,t=e.message,n=t===void 0?"":t,a=e.scale,i=a===void 0?1:a,o=null;try{o=module.require("asciify-image")}catch{}return o?function(){return o(r,{fit:"box",width:"".concat(Math.round(80*i),"%")}).then(function(s){return console.log(s)})}:It}function SF(e){var r=e.image,t=e.message,n=t===void 0?"":t,a=e.scale,i=a===void 0?1:a;if(typeof r=="string"){var o=new Image;return o.onload=function(){var l,c=Zs(o,n,i);(l=console).log.apply(l,(0,Wi.default)(c))},o.src=r,It}var s=r.nodeName||"";if(s.toLowerCase()==="img"){var u;return(u=console).log.apply(u,(0,Wi.default)(Zs(r,n,i))),It}if(s.toLowerCase()==="canvas"){var f=new Image;return f.onload=function(){var l;return(l=console).log.apply(l,(0,Wi.default)(Zs(f,n,i)))},f.src=r.toDataURL(),It}return It}function wF(e){for(var r in e)for(var t in e[r])return t||"untitled";return"empty"}var KJ=new Oa({id:"@probe.gl/log"});var ue=new Oa({id:"luma.gl"});function We(e,r){if(!e)throw new Error(r||"luma.gl: assertion failed.")}var CF="Invalid WebGLRenderingContext";var BF="Requires WebGL2";function eu(e){return typeof WebGLRenderingContext<"u"&&e instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:Boolean(e&&Number.isFinite(e._version))}function he(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:Boolean(e&&e._version===2)}function Ah(e){return he(e)?e:null}function qi(e){return We(eu(e),CF),e}function et(e){return We(he(e),BF),e}var Ji={};function MF(e){globalThis.console&&globalThis.console.error&&globalThis.console.error(e)}function OF(e){globalThis.console&&globalThis.console.log&&globalThis.console.log(e)}function PF(e,r){Ji[e]=!0,r!==void 0&&MF(r)}function IF(e){var r=e.getError;e.getError=function(){var n;do n=r.apply(e),n!==0&&(Ji[n]=!0);while(n!==0);for(n in Ji)if(Ji[n])return delete Ji[n],parseInt(n,10);return 0}}var Xi=function e(r){var t=r.gl;this.ext=r,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(r.maxVertexAttribs);for(var n=0;n<this.attribs.length;n++){var a=new e.VertexAttrib(t);this.attribs[n]=a}this.maxAttrib=0};Xi.VertexAttrib=function(r){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Xi.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};var Fn=function(r){var t=this;this.gl=r,IF(r);var n=this.original={getParameter:r.getParameter,enableVertexAttribArray:r.enableVertexAttribArray,disableVertexAttribArray:r.disableVertexAttribArray,bindBuffer:r.bindBuffer,getVertexAttrib:r.getVertexAttrib,vertexAttribPointer:r.vertexAttribPointer};r.getParameter=function(i){return i===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:n.getParameter.apply(this,arguments)},r.enableVertexAttribArray=function(i){var o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,i);var s=o.attribs[i];return s.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},r.disableVertexAttribArray=function(i){var o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,i);var s=o.attribs[i];return s.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},r.bindBuffer=function(i,o){switch(i){case 34962:t.currentArrayBuffer=o;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=o;break;default:}return n.bindBuffer.apply(this,arguments)},r.getVertexAttrib=function(i,o){var s=t.currentVertexArrayObject,u=s.attribs[i];switch(o){case 34975:return u.buffer;case 34338:return u.enabled;case 34339:return u.size;case 34340:return u.stride;case 34341:return u.type;case 34922:return u.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},r.vertexAttribPointer=function(i,o,s,u,f,l){var c=t.currentVertexArrayObject;c.maxAttrib=Math.max(c.maxAttrib,i);var h=c.attribs[i];return h.buffer=t.currentArrayBuffer,h.size=o,h.type=s,h.normalized=u,h.stride=f,h.offset=l,h.recache(),n.vertexAttribPointer.apply(this,arguments)},r.instrumentExtension&&r.instrumentExtension(this,"OES_vertex_array_object"),r.canvas&&r.canvas.addEventListener("webglcontextrestored",function(){OF("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};Fn.prototype.VERTEX_ARRAY_BINDING_OES=34229;Fn.prototype.reset_=function(){var r=this.vertexArrayObjects!==void 0;if(r)for(var t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;var n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Xi(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};Fn.prototype.createVertexArrayOES=function(){var r=new Xi(this);return this.vertexArrayObjects.push(r),r};Fn.prototype.deleteVertexArrayOES=function(r){r.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(r),1),this.currentVertexArrayObject===r&&this.bindVertexArrayOES(null)};Fn.prototype.isVertexArrayOES=function(r){return!!(r&&r instanceof Xi&&r.hasBeenBound&&r.ext===this)};Fn.prototype.bindVertexArrayOES=function(r){var t=this.gl;if(r&&!r.isAlive){PF(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}var n=this.original,a=this.currentVertexArrayObject;this.currentVertexArrayObject=r||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;var i=this.currentVertexArrayObject;if(a!==i){(!a||i.elementArrayBuffer!==a.elementArrayBuffer)&&n.bindBuffer.call(t,34963,i.elementArrayBuffer);for(var o=this.currentArrayBuffer,s=Math.max(a?a.maxAttrib:0,i.maxAttrib),u=0;u<=s;u++){var f=i.attribs[u],l=a?a.attribs[u]:null;if((!a||f.enabled!==l.enabled)&&(f.enabled?n.enableVertexAttribArray.call(t,u):n.disableVertexAttribArray.call(t,u)),f.enabled){var c=!1;(!a||f.buffer!==l.buffer)&&(o!==f.buffer&&(n.bindBuffer.call(t,34962,f.buffer),o=f.buffer),c=!0),(c||f.cached!==l.cached)&&n.vertexAttribPointer.call(t,u,f.size,f.type,f.normalized,f.stride,f.offset)}}this.currentArrayBuffer!==o&&n.bindBuffer.call(t,34962,this.currentArrayBuffer)}};function Q_(e){if(typeof e.createVertexArray!="function"){var r=e.getSupportedExtensions;e.getSupportedExtensions=function(){var a=r.call(this)||[];return a.indexOf("OES_vertex_array_object")<0&&a.push("OES_vertex_array_object"),a};var t=e.getExtension;e.getExtension=function(a){var i=t.call(this,a);return i||(a!=="OES_vertex_array_object"?null:(e.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Fn(this)),this.__OESVertexArrayObject))}}}var Ki=m(W());var ae=m(W());var re,eb="OES_element_index",tb="WEBGL_draw_buffers",RF="EXT_disjoint_timer_query",FF="EXT_disjoint_timer_query_webgl2",LF="EXT_texture_filter_anisotropic",rb="WEBGL_debug_renderer_info",kF=35723,DF=4352,GF=36795,NF=34047,UF=37445,jF=37446,Ce=function(r){return he(r)?void 0:0},HF=(re={},(0,ae.default)(re,3074,function(r){return he(r)?void 0:36064}),(0,ae.default)(re,kF,function(e){return he(e)?void 0:DF}),(0,ae.default)(re,35977,Ce),(0,ae.default)(re,32937,Ce),(0,ae.default)(re,GF,function(e,r){var t=he(e)?e.getExtension(FF):e.getExtension(RF);return t&&t.GPU_DISJOINT_EXT?r(t.GPU_DISJOINT_EXT):0}),(0,ae.default)(re,UF,function(e,r){var t=e.getExtension(rb);return r(t&&t.UNMASKED_VENDOR_WEBGL||7936)}),(0,ae.default)(re,jF,function(e,r){var t=e.getExtension(rb);return r(t&&t.UNMASKED_RENDERER_WEBGL||7937)}),(0,ae.default)(re,NF,function(e,r){var t=e.luma.extensions[LF];return t?r(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1}),(0,ae.default)(re,32883,Ce),(0,ae.default)(re,35071,Ce),(0,ae.default)(re,37447,Ce),(0,ae.default)(re,36063,function(r,t){if(!he(r)){var n=r.getExtension(tb);return n?t(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}}),(0,ae.default)(re,35379,Ce),(0,ae.default)(re,35374,Ce),(0,ae.default)(re,35377,Ce),(0,ae.default)(re,34852,function(r){if(!he(r)){var t=r.getExtension(tb);return t?t.MAX_DRAW_BUFFERS_WEBGL:0}}),(0,ae.default)(re,36203,function(r){return r.getExtension(eb)?2147483647:65535}),(0,ae.default)(re,33001,function(r){return r.getExtension(eb)?16777216:65535}),(0,ae.default)(re,33e3,function(r){return 16777216}),(0,ae.default)(re,37157,Ce),(0,ae.default)(re,35373,Ce),(0,ae.default)(re,35657,Ce),(0,ae.default)(re,36183,Ce),(0,ae.default)(re,37137,Ce),(0,ae.default)(re,34045,Ce),(0,ae.default)(re,35978,Ce),(0,ae.default)(re,35979,Ce),(0,ae.default)(re,35968,Ce),(0,ae.default)(re,35376,Ce),(0,ae.default)(re,35375,Ce),(0,ae.default)(re,35659,Ce),(0,ae.default)(re,37154,Ce),(0,ae.default)(re,35371,Ce),(0,ae.default)(re,35658,Ce),(0,ae.default)(re,35076,Ce),(0,ae.default)(re,35077,Ce),(0,ae.default)(re,35380,Ce),re);function nb(e,r,t){var n=HF[t],a=typeof n=="function"?n(e,r,t):n,i=a!==void 0?a:r(t);return i}var Pa,VF="OES_vertex_array_object",ab="ANGLE_instanced_arrays",zF="WEBGL_draw_buffers",WF="EXT_disjoint_timer_query",qF="EXT_texture_filter_anisotropic",JF="VertexArray requires WebGL2 or OES_vertex_array_object extension";function XF(e,r){return{webgl2:he(e),ext:e.getExtension(r)}}var _h=(Pa={},(0,Ki.default)(Pa,VF,{meta:{suffix:"OES"},createVertexArray:function(){We(!1,JF)},deleteVertexArray:function(){},bindVertexArray:function(){},isVertexArray:function(){return!1}}),(0,Ki.default)(Pa,ab,{meta:{suffix:"ANGLE"},vertexAttribDivisor:function(r,t){We(t===0,"WebGL instanced rendering not supported")},drawElementsInstanced:function(){},drawArraysInstanced:function(){}}),(0,Ki.default)(Pa,zF,{meta:{suffix:"WEBGL"},drawBuffers:function(){We(!1)}}),(0,Ki.default)(Pa,WF,{meta:{suffix:"EXT"},createQuery:function(){We(!1)},deleteQuery:function(){We(!1)},beginQuery:function(){We(!1)},endQuery:function(){},getQuery:function(r,t){return this.getQueryObject(r,t)},getQueryParameter:function(r,t){return this.getQueryObject(r,t)},getQueryObject:function(){}}),Pa),tu={readBuffer:function(r,t,n){he(r)&&t(n)},getVertexAttrib:function(r,t,n,a){var i=XF(r,ab),o=i.webgl2,s=i.ext,u;switch(a){case 35069:u=o?void 0:!1;break;case 35070:u=!o&&!s?0:void 0;break;default:}return u!==void 0?u:t(n,a)},getProgramParameter:function(r,t,n,a){if(!he(r))switch(a){case 35967:return 35981;case 35971:return 0;case 35382:return 0;default:}return t(n,a)},getInternalformatParameter:function(r,t,n,a,i){if(!he(r))switch(i){case 32937:return new Int32Array([0]);default:}return r.getInternalformatParameter(n,a,i)},getTexParameter:function(r,t,n,a){switch(a){case 34046:var i=r.luma.extensions,o=i[qF];a=o&&o.TEXTURE_MAX_ANISOTROPY_EXT||34046;break;default:}return t(n,a)},getParameter:nb,hint:function(r,t,n,a){return t(n,a)}};function ob(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=KF(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function KF(e,r){if(e){if(typeof e=="string")return ib(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ib(e,r)}}function ib(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function sb(e){e.luma=e.luma||{};var r=e.luma;return r.polyfilled||(Q_(e),YF(e),$F(e,_h),ZF(e,{target:r,target2:e}),r.polyfilled=!0),e}globalThis.polyfillContext=sb;function YF(e){e.luma.extensions={};var r=e.getSupportedExtensions()||[],t=ob(r),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;e.luma[a]=e.getExtension(a)}}catch(i){t.e(i)}finally{t.f()}}function ZF(e,r){var t=r.target,n=r.target2;Object.keys(tu).forEach(function(a){if(typeof tu[a]=="function"){var i=e[a]?e[a].bind(e):function(){},o=tu[a].bind(null,e,i);t[a]=o,n[a]=o}})}function $F(e,r){var t=ob(Object.getOwnPropertyNames(r)),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;a!=="overrides"&&QF(e,{extension:a,target:e.luma,target2:e})}}catch(i){t.e(i)}finally{t.f()}}function QF(e,r){var t=r.extension,n=r.target,a=r.target2,i=_h[t];We(i);for(var o=i.meta,s=o===void 0?{}:o,u=s.suffix,f=u===void 0?"":u,l=e.getExtension(t),c=function(){var v=d[h],y="".concat(v).concat(f),A=null;v==="meta"||typeof e[v]=="function"||(l&&typeof l[y]=="function"?A=function(){return l[y].apply(l,arguments)}:typeof i[v]=="function"&&(A=i[v].bind(n))),A&&(n[v]=A,a[v]=A)},h=0,d=Object.keys(i);h<d.length;h++)c()}var ru=m(ie()),Fe=m(st()),T=m(W());var q,N,Rt,nu=(q={},(0,T.default)(q,3042,!1),(0,T.default)(q,32773,new Float32Array([0,0,0,0])),(0,T.default)(q,32777,32774),(0,T.default)(q,34877,32774),(0,T.default)(q,32969,1),(0,T.default)(q,32968,0),(0,T.default)(q,32971,1),(0,T.default)(q,32970,0),(0,T.default)(q,3106,new Float32Array([0,0,0,0])),(0,T.default)(q,3107,[!0,!0,!0,!0]),(0,T.default)(q,2884,!1),(0,T.default)(q,2885,1029),(0,T.default)(q,2929,!1),(0,T.default)(q,2931,1),(0,T.default)(q,2932,513),(0,T.default)(q,2928,new Float32Array([0,1])),(0,T.default)(q,2930,!0),(0,T.default)(q,3024,!0),(0,T.default)(q,36006,null),(0,T.default)(q,2886,2305),(0,T.default)(q,33170,4352),(0,T.default)(q,2849,1),(0,T.default)(q,32823,!1),(0,T.default)(q,32824,0),(0,T.default)(q,10752,0),(0,T.default)(q,32938,1),(0,T.default)(q,32939,!1),(0,T.default)(q,3089,!1),(0,T.default)(q,3088,new Int32Array([0,0,1024,1024])),(0,T.default)(q,2960,!1),(0,T.default)(q,2961,0),(0,T.default)(q,2968,4294967295),(0,T.default)(q,36005,4294967295),(0,T.default)(q,2962,519),(0,T.default)(q,2967,0),(0,T.default)(q,2963,4294967295),(0,T.default)(q,34816,519),(0,T.default)(q,36003,0),(0,T.default)(q,36004,4294967295),(0,T.default)(q,2964,7680),(0,T.default)(q,2965,7680),(0,T.default)(q,2966,7680),(0,T.default)(q,34817,7680),(0,T.default)(q,34818,7680),(0,T.default)(q,34819,7680),(0,T.default)(q,2978,[0,0,1024,1024]),(0,T.default)(q,3333,4),(0,T.default)(q,3317,4),(0,T.default)(q,37440,!1),(0,T.default)(q,37441,!1),(0,T.default)(q,37443,37444),(0,T.default)(q,35723,4352),(0,T.default)(q,36010,null),(0,T.default)(q,35977,!1),(0,T.default)(q,3330,0),(0,T.default)(q,3332,0),(0,T.default)(q,3331,0),(0,T.default)(q,3314,0),(0,T.default)(q,32878,0),(0,T.default)(q,3316,0),(0,T.default)(q,3315,0),(0,T.default)(q,32877,0),q),Xr=function(r,t,n){return t?r.enable(n):r.disable(n)},ub=function(r,t,n){return r.hint(n,t)},Ct=function(r,t,n){return r.pixelStorei(n,t)},eL=function(r,t){var n=he(r)?36009:36160;return r.bindFramebuffer(n,t)},tL=function(r,t){return r.bindFramebuffer(36008,t)};function Yi(e){return Array.isArray(e)||ArrayBuffer.isView(e)}var fb=(N={},(0,T.default)(N,3042,Xr),(0,T.default)(N,32773,function(r,t){return r.blendColor.apply(r,(0,Fe.default)(t))}),(0,T.default)(N,32777,"blendEquation"),(0,T.default)(N,34877,"blendEquation"),(0,T.default)(N,32969,"blendFunc"),(0,T.default)(N,32968,"blendFunc"),(0,T.default)(N,32971,"blendFunc"),(0,T.default)(N,32970,"blendFunc"),(0,T.default)(N,3106,function(r,t){return r.clearColor.apply(r,(0,Fe.default)(t))}),(0,T.default)(N,3107,function(r,t){return r.colorMask.apply(r,(0,Fe.default)(t))}),(0,T.default)(N,2884,Xr),(0,T.default)(N,2885,function(r,t){return r.cullFace(t)}),(0,T.default)(N,2929,Xr),(0,T.default)(N,2931,function(r,t){return r.clearDepth(t)}),(0,T.default)(N,2932,function(r,t){return r.depthFunc(t)}),(0,T.default)(N,2928,function(r,t){return r.depthRange.apply(r,(0,Fe.default)(t))}),(0,T.default)(N,2930,function(r,t){return r.depthMask(t)}),(0,T.default)(N,3024,Xr),(0,T.default)(N,35723,ub),(0,T.default)(N,36006,eL),(0,T.default)(N,2886,function(r,t){return r.frontFace(t)}),(0,T.default)(N,33170,ub),(0,T.default)(N,2849,function(r,t){return r.lineWidth(t)}),(0,T.default)(N,32823,Xr),(0,T.default)(N,32824,"polygonOffset"),(0,T.default)(N,10752,"polygonOffset"),(0,T.default)(N,35977,Xr),(0,T.default)(N,32938,"sampleCoverage"),(0,T.default)(N,32939,"sampleCoverage"),(0,T.default)(N,3089,Xr),(0,T.default)(N,3088,function(r,t){return r.scissor.apply(r,(0,Fe.default)(t))}),(0,T.default)(N,2960,Xr),(0,T.default)(N,2961,function(r,t){return r.clearStencil(t)}),(0,T.default)(N,2968,function(r,t){return r.stencilMaskSeparate(1028,t)}),(0,T.default)(N,36005,function(r,t){return r.stencilMaskSeparate(1029,t)}),(0,T.default)(N,2962,"stencilFuncFront"),(0,T.default)(N,2967,"stencilFuncFront"),(0,T.default)(N,2963,"stencilFuncFront"),(0,T.default)(N,34816,"stencilFuncBack"),(0,T.default)(N,36003,"stencilFuncBack"),(0,T.default)(N,36004,"stencilFuncBack"),(0,T.default)(N,2964,"stencilOpFront"),(0,T.default)(N,2965,"stencilOpFront"),(0,T.default)(N,2966,"stencilOpFront"),(0,T.default)(N,34817,"stencilOpBack"),(0,T.default)(N,34818,"stencilOpBack"),(0,T.default)(N,34819,"stencilOpBack"),(0,T.default)(N,2978,function(r,t){return r.viewport.apply(r,(0,Fe.default)(t))}),(0,T.default)(N,3333,Ct),(0,T.default)(N,3317,Ct),(0,T.default)(N,37440,Ct),(0,T.default)(N,37441,Ct),(0,T.default)(N,37443,Ct),(0,T.default)(N,3330,Ct),(0,T.default)(N,3332,Ct),(0,T.default)(N,3331,Ct),(0,T.default)(N,36010,tL),(0,T.default)(N,3314,Ct),(0,T.default)(N,32878,Ct),(0,T.default)(N,3316,Ct),(0,T.default)(N,3315,Ct),(0,T.default)(N,32877,Ct),(0,T.default)(N,"framebuffer",function(r,t){var n=t&&"handle"in t?t.handle:t;return r.bindFramebuffer(36160,n)}),(0,T.default)(N,"blend",function(r,t){return t?r.enable(3042):r.disable(3042)}),(0,T.default)(N,"blendColor",function(r,t){return r.blendColor.apply(r,(0,Fe.default)(t))}),(0,T.default)(N,"blendEquation",function(r,t){t=Yi(t)?t:[t,t],r.blendEquationSeparate.apply(r,(0,Fe.default)(t))}),(0,T.default)(N,"blendFunc",function(r,t){t=Yi(t)&&t.length===2?[].concat((0,Fe.default)(t),(0,Fe.default)(t)):t,r.blendFuncSeparate.apply(r,(0,Fe.default)(t))}),(0,T.default)(N,"clearColor",function(r,t){return r.clearColor.apply(r,(0,Fe.default)(t))}),(0,T.default)(N,"clearDepth",function(r,t){return r.clearDepth(t)}),(0,T.default)(N,"clearStencil",function(r,t){return r.clearStencil(t)}),(0,T.default)(N,"colorMask",function(r,t){return r.colorMask.apply(r,(0,Fe.default)(t))}),(0,T.default)(N,"cull",function(r,t){return t?r.enable(2884):r.disable(2884)}),(0,T.default)(N,"cullFace",function(r,t){return r.cullFace(t)}),(0,T.default)(N,"depthTest",function(r,t){return t?r.enable(2929):r.disable(2929)}),(0,T.default)(N,"depthFunc",function(r,t){return r.depthFunc(t)}),(0,T.default)(N,"depthMask",function(r,t){return r.depthMask(t)}),(0,T.default)(N,"depthRange",function(r,t){return r.depthRange.apply(r,(0,Fe.default)(t))}),(0,T.default)(N,"dither",function(r,t){return t?r.enable(3024):r.disable(3024)}),(0,T.default)(N,"derivativeHint",function(r,t){r.hint(35723,t)}),(0,T.default)(N,"frontFace",function(r,t){return r.frontFace(t)}),(0,T.default)(N,"mipmapHint",function(r,t){return r.hint(33170,t)}),(0,T.default)(N,"lineWidth",function(r,t){return r.lineWidth(t)}),(0,T.default)(N,"polygonOffsetFill",function(r,t){return t?r.enable(32823):r.disable(32823)}),(0,T.default)(N,"polygonOffset",function(r,t){return r.polygonOffset.apply(r,(0,Fe.default)(t))}),(0,T.default)(N,"sampleCoverage",function(r,t){return r.sampleCoverage.apply(r,(0,Fe.default)(t))}),(0,T.default)(N,"scissorTest",function(r,t){return t?r.enable(3089):r.disable(3089)}),(0,T.default)(N,"scissor",function(r,t){return r.scissor.apply(r,(0,Fe.default)(t))}),(0,T.default)(N,"stencilTest",function(r,t){return t?r.enable(2960):r.disable(2960)}),(0,T.default)(N,"stencilMask",function(r,t){t=Yi(t)?t:[t,t];var n=t,a=(0,ru.default)(n,2),i=a[0],o=a[1];r.stencilMaskSeparate(1028,i),r.stencilMaskSeparate(1029,o)}),(0,T.default)(N,"stencilFunc",function(r,t){t=Yi(t)&&t.length===3?[].concat((0,Fe.default)(t),(0,Fe.default)(t)):t;var n=t,a=(0,ru.default)(n,6),i=a[0],o=a[1],s=a[2],u=a[3],f=a[4],l=a[5];r.stencilFuncSeparate(1028,i,o,s),r.stencilFuncSeparate(1029,u,f,l)}),(0,T.default)(N,"stencilOp",function(r,t){t=Yi(t)&&t.length===3?[].concat((0,Fe.default)(t),(0,Fe.default)(t)):t;var n=t,a=(0,ru.default)(n,6),i=a[0],o=a[1],s=a[2],u=a[3],f=a[4],l=a[5];r.stencilOpSeparate(1028,i,o,s),r.stencilOpSeparate(1029,u,f,l)}),(0,T.default)(N,"viewport",function(r,t){return r.viewport.apply(r,(0,Fe.default)(t))}),N);function De(e,r,t){return r[e]!==void 0?r[e]:t[e]}var lb={blendEquation:function(r,t,n){return r.blendEquationSeparate(De(32777,t,n),De(34877,t,n))},blendFunc:function(r,t,n){return r.blendFuncSeparate(De(32969,t,n),De(32968,t,n),De(32971,t,n),De(32970,t,n))},polygonOffset:function(r,t,n){return r.polygonOffset(De(32824,t,n),De(10752,t,n))},sampleCoverage:function(r,t,n){return r.sampleCoverage(De(32938,t,n),De(32939,t,n))},stencilFuncFront:function(r,t,n){return r.stencilFuncSeparate(1028,De(2962,t,n),De(2967,t,n),De(2963,t,n))},stencilFuncBack:function(r,t,n){return r.stencilFuncSeparate(1029,De(34816,t,n),De(36003,t,n),De(36004,t,n))},stencilOpFront:function(r,t,n){return r.stencilOpSeparate(1028,De(2964,t,n),De(2965,t,n),De(2966,t,n))},stencilOpBack:function(r,t,n){return r.stencilOpSeparate(1029,De(34817,t,n),De(34818,t,n),De(34819,t,n))}},bh={enable:function(r,t){return r((0,T.default)({},t,!0))},disable:function(r,t){return r((0,T.default)({},t,!1))},pixelStorei:function(r,t,n){return r((0,T.default)({},t,n))},hint:function(r,t,n){return r((0,T.default)({},t,n))},bindFramebuffer:function(r,t,n){var a;switch(t){case 36160:return r((a={},(0,T.default)(a,36006,n),(0,T.default)(a,36010,n),a));case 36009:return r((0,T.default)({},36006,n));case 36008:return r((0,T.default)({},36010,n));default:return null}},blendColor:function(r,t,n,a,i){return r((0,T.default)({},32773,new Float32Array([t,n,a,i])))},blendEquation:function(r,t){var n;return r((n={},(0,T.default)(n,32777,t),(0,T.default)(n,34877,t),n))},blendEquationSeparate:function(r,t,n){var a;return r((a={},(0,T.default)(a,32777,t),(0,T.default)(a,34877,n),a))},blendFunc:function(r,t,n){var a;return r((a={},(0,T.default)(a,32969,t),(0,T.default)(a,32968,n),(0,T.default)(a,32971,t),(0,T.default)(a,32970,n),a))},blendFuncSeparate:function(r,t,n,a,i){var o;return r((o={},(0,T.default)(o,32969,t),(0,T.default)(o,32968,n),(0,T.default)(o,32971,a),(0,T.default)(o,32970,i),o))},clearColor:function(r,t,n,a,i){return r((0,T.default)({},3106,new Float32Array([t,n,a,i])))},clearDepth:function(r,t){return r((0,T.default)({},2931,t))},clearStencil:function(r,t){return r((0,T.default)({},2961,t))},colorMask:function(r,t,n,a,i){return r((0,T.default)({},3107,[t,n,a,i]))},cullFace:function(r,t){return r((0,T.default)({},2885,t))},depthFunc:function(r,t){return r((0,T.default)({},2932,t))},depthRange:function(r,t,n){return r((0,T.default)({},2928,new Float32Array([t,n])))},depthMask:function(r,t){return r((0,T.default)({},2930,t))},frontFace:function(r,t){return r((0,T.default)({},2886,t))},lineWidth:function(r,t){return r((0,T.default)({},2849,t))},polygonOffset:function(r,t,n){var a;return r((a={},(0,T.default)(a,32824,t),(0,T.default)(a,10752,n),a))},sampleCoverage:function(r,t,n){var a;return r((a={},(0,T.default)(a,32938,t),(0,T.default)(a,32939,n),a))},scissor:function(r,t,n,a,i){return r((0,T.default)({},3088,new Int32Array([t,n,a,i])))},stencilMask:function(r,t){var n;return r((n={},(0,T.default)(n,2968,t),(0,T.default)(n,36005,t),n))},stencilMaskSeparate:function(r,t,n){return r((0,T.default)({},t===1028?2968:36005,n))},stencilFunc:function(r,t,n,a){var i;return r((i={},(0,T.default)(i,2962,t),(0,T.default)(i,2967,n),(0,T.default)(i,2963,a),(0,T.default)(i,34816,t),(0,T.default)(i,36003,n),(0,T.default)(i,36004,a),i))},stencilFuncSeparate:function(r,t,n,a,i){var o;return r((o={},(0,T.default)(o,t===1028?2962:34816,n),(0,T.default)(o,t===1028?2967:36003,a),(0,T.default)(o,t===1028?2963:36004,i),o))},stencilOp:function(r,t,n,a){var i;return r((i={},(0,T.default)(i,2964,t),(0,T.default)(i,2965,n),(0,T.default)(i,2966,a),(0,T.default)(i,34817,t),(0,T.default)(i,34818,n),(0,T.default)(i,34819,a),i))},stencilOpSeparate:function(r,t,n,a,i){var o;return r((o={},(0,T.default)(o,t===1028?2964:34817,n),(0,T.default)(o,t===1028?2965:34818,a),(0,T.default)(o,t===1028?2966:34819,i),o))},viewport:function(r,t,n,a,i){return r((0,T.default)({},2978,[t,n,a,i]))}},ir=function(r,t){return r.isEnabled(t)},Th=(Rt={},(0,T.default)(Rt,3042,ir),(0,T.default)(Rt,2884,ir),(0,T.default)(Rt,2929,ir),(0,T.default)(Rt,3024,ir),(0,T.default)(Rt,32823,ir),(0,T.default)(Rt,32926,ir),(0,T.default)(Rt,32928,ir),(0,T.default)(Rt,3089,ir),(0,T.default)(Rt,2960,ir),(0,T.default)(Rt,35977,ir),Rt);var db=m(H()),pb=m(z());function xh(e){for(var r in e)return!1;return!0}function cb(e,r){if(e===r)return!0;var t=Array.isArray(e)||ArrayBuffer.isView(e),n=Array.isArray(r)||ArrayBuffer.isView(r);if(t&&n&&e.length===r.length){for(var a=0;a<e.length;++a)if(e[a]!==r[a])return!1;return!0}return!1}function hb(e,r){var t=e[r].bind(e);e[r]=function(){var a=arguments.length<=0?void 0:arguments[0];return a in e.state.cache&&e.state.enable?e.state.cache[a]:t.apply(void 0,arguments)},Object.defineProperty(e[r],"name",{value:"".concat(r,"-from-cache"),configurable:!1})}function rL(e,r,t){var n=e[r].bind(e);e[r]=function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];var u=t.apply(void 0,[e.state._updateCache].concat(o)),f=u.valueChanged,l=u.oldValue;return f&&n.apply(void 0,o),l},Object.defineProperty(e[r],"name",{value:"".concat(r,"-to-cache"),configurable:!1})}function nL(e){var r=e.useProgram.bind(e);e.useProgram=function(n){e.state.program!==n&&(r(n),e.state.program=n)}}var aL=function(){function e(r){(0,db.default)(this,e);var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.copyState,a=n===void 0?!1:n,i=t.log,o=i===void 0?function(){}:i;this.gl=r,this.program=null,this.stateStack=[],this.enable=!0,this.cache=a?wh(r):Object.assign({},nu),this.log=o,this._updateCache=this._updateCache.bind(this),Object.seal(this)}return(0,pb.default)(e,[{key:"push",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.stateStack.push({})}},{key:"pop",value:function(){We(this.stateStack.length>0);var t=this.stateStack[this.stateStack.length-1];iu(this.gl,t),this.stateStack.pop()}},{key:"_updateCache",value:function(t){var n=!1,a,i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(var o in t){We(o!==void 0);var s=t[o],u=this.cache[o];cb(s,u)||(n=!0,a=u,i&&!(o in i)&&(i[o]=u),this.cache[o]=s)}return{valueChanged:n,oldValue:a}}}]),e}();function Eh(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.enable,n=t===void 0?!0:t,a=r.copyState;if(We(a!==void 0),!e.state){var i=globalThis.polyfillContext;i&&i(e),e.state=new aL(e,{copyState:a}),nL(e);for(var o in bh){var s=bh[o];rL(e,o,s)}hb(e,"getParameter"),hb(e,"isEnabled")}return e.state.enable=n,e}function Sh(e){e.state||Eh(e,{copyState:!1}),e.state.push()}function au(e){We(e.state),e.state.pop()}function iL(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=oL(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function oL(e,r){if(e){if(typeof e=="string")return mb(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return mb(e,r)}}function mb(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function iu(e,r){if(We(eu(e),"setParameters requires a WebGL context"),!xh(r)){var t={};for(var n in r){var a=Number(n),i=fb[n];i&&(typeof i=="string"?t[i]=!0:i(e,r[n],a))}var o=e.state&&e.state.cache;if(o)for(var s in t){var u=lb[s];u(e,r,o)}}}function wh(e,r){if(r=r||nu,typeof r=="number"){var t=r,n=Th[t];return n?n(e,t):e.getParameter(t)}var a=Array.isArray(r)?r:Object.keys(r),i={},o=iL(a),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,f=Th[u];i[u]=f?f(e,Number(u)):e.getParameter(Number(u))}}catch(l){o.e(l)}finally{o.f()}return i}function Ar(e,r,t){if(xh(r))return t(e);var n=r.nocatch,a=n===void 0?!0:n;Sh(e),iu(e,r);var i;if(a)i=t(e),au(e);else try{i=t(e)}finally{au(e)}return i}var kX=ht();var _b=m(H()),bb=m(z());var yb=m(H()),Ab=m(z());var vb=m(H()),gb=m(z());function Zi(){var e;if(typeof window<"u"&&window.performance)e=window.performance.now();else if(typeof process<"u"&&process.hrtime){var r=process.hrtime();e=r[0]*1e3+r[1]/1e6}else e=Date.now();return e}var ou=function(){function e(r,t){(0,vb.default)(this,e),g(this,"name",void 0),g(this,"type",void 0),g(this,"sampleSize",1),g(this,"time",void 0),g(this,"count",void 0),g(this,"samples",void 0),g(this,"lastTiming",void 0),g(this,"lastSampleTime",void 0),g(this,"lastSampleCount",void 0),g(this,"_count",0),g(this,"_time",0),g(this,"_samples",0),g(this,"_startTime",0),g(this,"_timerPending",!1),this.name=r,this.type=t,this.reset()}return(0,gb.default)(e,[{key:"setSampleSize",value:function(t){return this.sampleSize=t,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(t){return this._count+=t,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(t){return this._count-=t,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=Zi(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(Zi()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),e}();var Ch=function(){function e(r){(0,yb.default)(this,e),g(this,"id",void 0),g(this,"stats",{}),this.id=r.id,this.stats={},this._initializeStats(r.stats),Object.seal(this)}return(0,Ab.default)(e,[{key:"get",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:t,type:n})}},{key:"size",get:function(){return Object.keys(this.stats).length}},{key:"reset",value:function(){for(var t in this.stats)this.stats[t].reset();return this}},{key:"forEach",value:function(t){for(var n in this.stats)t(this.stats[n])}},{key:"getTable",value:function(){var t={};return this.forEach(function(n){t[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),t}},{key:"_initializeStats",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];n.forEach(function(a){return t._getOrCreate(a)})}},{key:"_getOrCreate",value:function(t){if(!t||!t.name)return null;var n=t.name,a=t.type;return this.stats[n]||(t instanceof ou?this.stats[n]=t:this.stats[n]=new ou(n,a)),this.stats[n]}}]),e}();var $i="8.5.20",sL="set luma.log.level=1 (or higher) to trace rendering",uL=function(){function e(){(0,_b.default)(this,e),this.stats=new Map}return(0,bb.default)(e,[{key:"get",value:function(t){return this.stats.has(t)||this.stats.set(t,new Ch({id:t})),this.stats.get(t)}}]),e}(),Ia=new uL;if(globalThis.luma&&globalThis.luma.VERSION!==$i)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat($i));globalThis.luma||(ht()&&ue.log(1,"luma.gl ".concat($i," - ").concat(sL))(),globalThis.luma=globalThis.luma||{VERSION:$i,version:$i,log:ue,stats:Ia,globals:{modules:{},nodeIO:{}}});var d7=globalThis.luma;var MT=m(W());var Zb=m(H()),$b=m(z()),Qb=m(wt()),eT=m(Te()),tT=m(xe()),Fh=m(be());var Wb=m(ie()),qb=m(H()),Jb=m(z()),Xb=m(Te()),Kb=m(xe()),Ih=m(be());var Eb=m(H()),Sb=m(z());function $(e,r){if(!e)throw new Error(r||"luma.gl: assertion failed.")}function su(e,r){if(typeof r!="string")return r;var t=Number(r);if(!isNaN(t))return t;r=r.replace(/^.*\./,"");var n=e[r];return $(n!==void 0,"Accessing undefined constant GL.".concat(r)),n}function Ln(e,r){r=Number(r);for(var t in e)if(e[t]===r)return"GL.".concat(t);return String(r)}var Bh={};function uu(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";Bh[e]=Bh[e]||1;var r=Bh[e]++;return"".concat(e,"-").concat(r)}function Mh(e){return $(typeof e=="number","Input must be a number"),e&&(e&e-1)===0}function Tb(e,r,t,n){var a="See luma.gl ".concat(t," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),i=Object.getPrototypeOf(e);n.forEach(function(o){i.methodName||(i[o]=function(){throw ue.removed("Calling removed method ".concat(r,".").concat(o,": "),a)(),new Error(o)})})}function fL(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=lL(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function lL(e,r){if(e){if(typeof e=="string")return xb(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return xb(e,r)}}function xb(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Ra="Resource subclass must define virtual methods",Kr=function(e){function r(t){(0,Eb.default)(this,r);var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};qi(t);var a=n.id,i=n.userData,o=i===void 0?{}:i;this.gl=t,this.gl2=t,this.id=a||uu(this[Symbol.toStringTag]),this.userData=o,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}return(0,Sb.default)(r,[{key:e,get:function(){return"Resource"}},{key:"toString",value:function(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}},{key:"handle",get:function(){return this._handle}},{key:"delete",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=n.deleteChildren,i=a===void 0?!1:a,o=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,o&&i&&o.filter(Boolean).forEach(function(s){return s.delete()}),this}},{key:"bind",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof n!="function")return this._bindHandle(n),this;var a;return this._bound?a=n():(this._bindHandle(this.handle),this._bound=!0,a=n(),this._bound=!1,this._bindHandle(null)),a}},{key:"unbind",value:function(){this.bind(null)}},{key:"getParameter",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};n=su(this.gl,n),$(n);var i=this.constructor.PARAMETERS||{},o=i[n];if(o){var s=he(this.gl),u=(!("webgl2"in o)||s)&&(!("extension"in o)||this.gl.getExtension(o.extension));if(!u){var f=o.webgl1,l="webgl2"in o?o.webgl2:o.webgl1,c=s?l:f;return c}}return this._getParameter(n,a)}},{key:"getParameters",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=n.parameters,i=n.keys,o=this.constructor.PARAMETERS||{},s=he(this.gl),u={},f=a||Object.keys(o),l=fL(f),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,d=o[h],p=d&&(!("webgl2"in d)||s)&&(!("extension"in d)||this.gl.getExtension(d.extension));if(p){var v=i?Ln(this.gl,h):h;u[v]=this.getParameter(h,n),i&&d.type==="GLenum"&&(u[v]=Ln(this.gl,u[v]))}}}catch(y){l.e(y)}finally{l.f()}return u}},{key:"setParameter",value:function(n,a){n=su(this.gl,n),$(n);var i=this.constructor.PARAMETERS||{},o=i[n];if(o){var s=he(this.gl),u=(!("webgl2"in o)||s)&&(!("extension"in o)||this.gl.getExtension(o.extension));if(!u)throw new Error("Parameter not available on this platform");o.type==="GLenum"&&(a=su(a))}return this._setParameter(n,a),this}},{key:"setParameters",value:function(n){for(var a in n)this.setParameter(a,n[a]);return this}},{key:"stubRemovedMethods",value:function(n,a,i){return Tb(this,n,a,i)}},{key:"initialize",value:function(n){}},{key:"_createHandle",value:function(){throw new Error(Ra)}},{key:"_deleteHandle",value:function(){throw new Error(Ra)}},{key:"_bindHandle",value:function(n){throw new Error(Ra)}},{key:"_getOptsFromHandle",value:function(){throw new Error(Ra)}},{key:"_getParameter",value:function(n,a){throw new Error(Ra)}},{key:"_setParameter",value:function(n,a){throw new Error(Ra)}},{key:"_context",value:function(){return this.gl.luma=this.gl.luma||{},this.gl.luma}},{key:"_addStats",value:function(){var n=this[Symbol.toStringTag],a=Ia.get("Resource Counts");a.get("Resources Created").incrementCount(),a.get("".concat(n,"s Created")).incrementCount(),a.get("".concat(n,"s Active")).incrementCount()}},{key:"_removeStats",value:function(){var n=this[Symbol.toStringTag],a=Ia.get("Resource Counts");a.get("".concat(n,"s Active")).decrementCount()}},{key:"_trackAllocatedMemory",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(n,a),this._trackAllocatedMemoryForContext(n,a,this.gl.canvas&&this.gl.canvas.id),this.byteLength=n}},{key:"_trackAllocatedMemoryForContext",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",o=Ia.get("Memory Usage".concat(i));o.get("GPU Memory").addCount(n),o.get("".concat(a," Memory")).addCount(n)}},{key:"_trackDeallocatedMemory",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(n),this._trackDeallocatedMemoryForContext(n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}},{key:"_trackDeallocatedMemoryForContext",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=Ia.get("Memory Usage".concat(a));i.get("GPU Memory").subtractCount(this.byteLength),i.get("".concat(n," Memory")).subtractCount(this.byteLength)}}]),r}(Symbol.toStringTag);var Rb=m(H()),Fb=m(z()),Lb=m(wt()),kb=m(Te()),Db=m(xe()),Oh=m(be());var Mb=m(wb()),Ob=m(H()),Pb=m(z());var dL="Failed to deduce GL constant from typed array";function Qi(e){var r=ArrayBuffer.isView(e)?e.constructor:e;switch(r){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(dL)}}function Yr(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.clamped,n=t===void 0?!0:t;switch(e){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Cb(e){var r=e.data,t=e.width,n=e.height,a=e.bytesPerPixel,i=a===void 0?4:a,o=e.temp,s=t*i;o=o||new Uint8Array(s);for(var u=0;u<n/2;++u){var f=u*s,l=(n-u-1)*s;o.set(r.subarray(f,f+s)),r.copyWithin(f,l,l+s),r.set(o,l)}}function Bb(e){for(var r=e.data,t=e.width,n=e.height,a=Math.round(t/2),i=Math.round(n/2),o=new Uint8Array(a*i*4),s=0;s<i;s++)for(var u=0;u<a;u++)for(var f=0;f<4;f++)o[(s*a+u)*4+f]=r[(s*2*t+u*2)*4+f];return{data:o,width:a,height:i}}function eo(e,r,t){var n=t.removedProps,a=n===void 0?{}:n,i=t.deprecatedProps,o=i===void 0?{}:i,s=t.replacedProps,u=s===void 0?{}:s;for(var f in a)if(f in r){var l=a[f],c=l?"".concat(e,".").concat(a[f]):"N/A";ue.removed("".concat(e,".").concat(f),c)()}for(var h in o)if(h in r){var d=o[h];ue.deprecated("".concat(e,".").concat(h),"".concat(e,".").concat(d))()}var p=null;for(var v in u)if(v in r){var y=u[v];ue.deprecated("".concat(e,".").concat(v),"".concat(e,".").concat(y))(),p=p||Object.assign({},r),p[y]=r[v],delete p[v]}return p||r}var pL={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},mL={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}},kn=function(){function e(){var r=this;(0,Ob.default)(this,e);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];n.forEach(function(i){return r._assign(i)}),Object.freeze(this)}return(0,Pb.default)(e,[{key:"toString",value:function(){return JSON.stringify(this)}},{key:"BYTES_PER_ELEMENT",get:function(){return e.getBytesPerElement(this)}},{key:"BYTES_PER_VERTEX",get:function(){return e.getBytesPerVertex(this)}},{key:"_assign",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t=eo("Accessor",t,mL),t.type!==void 0&&(this.type=t.type,(t.type===5124||t.type===5125)&&(this.integer=!0)),t.size!==void 0&&(this.size=t.size),t.offset!==void 0&&(this.offset=t.offset),t.stride!==void 0&&(this.stride=t.stride),t.normalized!==void 0&&(this.normalized=t.normalized),t.integer!==void 0&&(this.integer=t.integer),t.divisor!==void 0&&(this.divisor=t.divisor),t.buffer!==void 0&&(this.buffer=t.buffer),t.index!==void 0&&(typeof t.index=="boolean"?this.index=t.index?1:0:this.index=t.index),t.instanced!==void 0&&(this.divisor=t.instanced?1:0),t.isInstanced!==void 0&&(this.divisor=t.isInstanced?1:0),this}}],[{key:"getBytesPerElement",value:function(t){var n=Yr(t.type||5126);return n.BYTES_PER_ELEMENT}},{key:"getBytesPerVertex",value:function(t){$(t.size);var n=Yr(t.type||5126);return n.BYTES_PER_ELEMENT*t.size}},{key:"resolve",value:function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(0,Mb.default)(e,[pL].concat(n))}}]),e}();function vL(e){var r=gL();return function(){var n=(0,Oh.default)(e),a;if(r){var i=(0,Oh.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,Db.default)(this,a)}}function gL(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ib=10,Gb={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},yL={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:Gb},AL={removedProps:Gb},Ph=function(e,r){(0,kb.default)(n,e);var t=vL(n);function n(a){var i;(0,Rb.default)(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return i=t.call(this,a,o),i.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),i.target=o.target||(i.gl.webgl2?36662:34962),i.initialize(o),Object.seal((0,Lb.default)(i)),i}return(0,Fb.default)(n,[{key:r,get:function(){return"Buffer"}},{key:"getElementCount",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/kn.getBytesPerElement(i))}},{key:"getVertexCount",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/kn.getBytesPerVertex(i))}},{key:"initialize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(i)&&(i={data:i}),Number.isFinite(i)&&(i={byteLength:i}),i=eo("Buffer",i,yL),this.usage=i.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},i,i.accessor)),i.data?this._setData(i.data,i.offset,i.byteLength):this._setByteLength(i.byteLength||0),this}},{key:"setProps",value:function(i){return i=eo("Buffer",i,AL),"accessor"in i&&this.setAccessor(i.accessor),this}},{key:"setAccessor",value:function(i){return i=Object.assign({},i),delete i.buffer,this.accessor=new kn(i),this}},{key:"reallocate",value:function(i){return i>this.byteLength?(this._setByteLength(i),!0):(this.bytesUsed=i,!1)}},{key:"setData",value:function(i){return this.initialize(i)}},{key:"subData",value:function(i){ArrayBuffer.isView(i)&&(i={data:i});var o=i,s=o.data,u=o.offset,f=u===void 0?0:u,l=o.srcOffset,c=l===void 0?0:l,h=i.byteLength||i.length;$(s);var d=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(d,this.handle),c!==0||h!==void 0?(et(this.gl),this.gl.bufferSubData(this.target,f,s,c,h)):this.gl.bufferSubData(d,f,s),this.gl.bindBuffer(d,null),this.debugData=null,this._inferType(s),this}},{key:"copyData",value:function(i){var o=i.sourceBuffer,s=i.readOffset,u=s===void 0?0:s,f=i.writeOffset,l=f===void 0?0:f,c=i.size,h=this.gl;return et(h),h.bindBuffer(36662,o.handle),h.bindBuffer(36663,this.handle),h.copyBufferSubData(36662,36663,u,l,c),h.bindBuffer(36662,null),h.bindBuffer(36663,null),this.debugData=null,this}},{key:"getData",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.dstData,s=o===void 0?null:o,u=i.srcByteOffset,f=u===void 0?0:u,l=i.dstOffset,c=l===void 0?0:l,h=i.length,d=h===void 0?0:h;et(this.gl);var p=Yr(this.accessor.type||5126,{clamped:!1}),v=this._getAvailableElementCount(f),y=c,A,_;s?(_=s.length,A=_-y):(A=Math.min(v,d||v),_=y+A);var E=Math.min(v,A);return d=d||E,$(d<=E),s=s||new p(_),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,f,s,c,d),this.gl.bindBuffer(36662,null),s}},{key:"bind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.target,s=o===void 0?this.target:o,u=i.index,f=u===void 0?this.accessor&&this.accessor.index:u,l=i.offset,c=l===void 0?0:l,h=i.size;return s===35345||s===35982?h!==void 0?this.gl.bindBufferRange(s,f,this.handle,c,h):($(c===0),this.gl.bindBufferBase(s,f,this.handle)):this.gl.bindBuffer(s,this.handle),this}},{key:"unbind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.target,s=o===void 0?this.target:o,u=i.index,f=u===void 0?this.accessor&&this.accessor.index:u,l=s===35345||s===35982;return l?this.gl.bindBufferBase(s,f,null):this.gl.bindBuffer(s,null),this}},{key:"getDebugData",value:function(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(Ib,this.byteLength)}),{data:this.debugData,changed:!0})}},{key:"invalidateDebugData",value:function(){this.debugData=null}},{key:"_setData",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i.byteLength+o;$(ArrayBuffer.isView(i)),this._trackDeallocatedMemory();var u=this._getTarget();this.gl.bindBuffer(u,this.handle),this.gl.bufferData(u,s,this.usage),this.gl.bufferSubData(u,o,i),this.gl.bindBuffer(u,null),this.debugData=i.slice(0,Ib),this.bytesUsed=s,this._trackAllocatedMemory(s);var f=Qi(i);return $(f),this.setAccessor(new kn(this.accessor,{type:f})),this}},{key:"_setByteLength",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;$(i>=0),this._trackDeallocatedMemory();var s=i;i===0&&(s=new Float32Array(0));var u=this._getTarget();return this.gl.bindBuffer(u,this.handle),this.gl.bufferData(u,s,o),this.gl.bindBuffer(u,null),this.usage=o,this.debugData=null,this.bytesUsed=i,this._trackAllocatedMemory(i),this}},{key:"_getTarget",value:function(){return this.gl.webgl2?36663:this.target}},{key:"_getAvailableElementCount",value:function(i){var o=Yr(this.accessor.type||5126,{clamped:!1}),s=i/o.BYTES_PER_ELEMENT;return this.getElementCount()-s}},{key:"_inferType",value:function(i){this.accessor.type||this.setAccessor(new kn(this.accessor,{type:Qi(i)}))}},{key:"_createHandle",value:function(){return this.gl.createBuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}},{key:"_getParameter",value:function(i){this.gl.bindBuffer(this.target,this.handle);var o=this.gl.getBufferParameter(this.target,i);return this.gl.bindBuffer(this.target,null),o}},{key:"type",get:function(){return ue.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}},{key:"bytes",get:function(){return ue.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}},{key:"setByteLength",value:function(i){return ue.deprecated("setByteLength","reallocate")(),this.reallocate(i)}},{key:"updateAccessor",value:function(i){return ue.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new kn(this.accessor,i),this}}]),n}(Kr,Symbol.toStringTag);var ge=m(W());var zt,dt,or,cu=(zt={},(0,ge.default)(zt,6407,{dataFormat:6407,types:[5121,33635]}),(0,ge.default)(zt,6408,{dataFormat:6408,types:[5121,32819,32820]}),(0,ge.default)(zt,6406,{dataFormat:6406,types:[5121]}),(0,ge.default)(zt,6409,{dataFormat:6409,types:[5121]}),(0,ge.default)(zt,6410,{dataFormat:6410,types:[5121]}),(0,ge.default)(zt,33326,{dataFormat:6403,types:[5126],gl2:!0}),(0,ge.default)(zt,33328,{dataFormat:33319,types:[5126],gl2:!0}),(0,ge.default)(zt,34837,{dataFormat:6407,types:[5126],gl2:!0}),(0,ge.default)(zt,34836,{dataFormat:6408,types:[5126],gl2:!0}),zt),Nb=(dt={},(0,ge.default)(dt,6403,1),(0,ge.default)(dt,36244,1),(0,ge.default)(dt,33319,2),(0,ge.default)(dt,33320,2),(0,ge.default)(dt,6407,3),(0,ge.default)(dt,36248,3),(0,ge.default)(dt,6408,4),(0,ge.default)(dt,36249,4),(0,ge.default)(dt,6402,1),(0,ge.default)(dt,34041,1),(0,ge.default)(dt,6406,1),(0,ge.default)(dt,6409,1),(0,ge.default)(dt,6410,2),dt),Ub=(or={},(0,ge.default)(or,5126,4),(0,ge.default)(or,5125,4),(0,ge.default)(or,5124,4),(0,ge.default)(or,5123,2),(0,ge.default)(or,5122,2),(0,ge.default)(or,5131,2),(0,ge.default)(or,5120,1),(0,ge.default)(or,5121,1),or);function jb(e,r){var t=cu[r];if(!t)return!1;if(t.gl1===void 0&&t.gl2===void 0)return!0;var n=he(e)&&t.gl2||t.gl1;return typeof n=="string"?e.getExtension(n):n}function Hb(e,r){var t=cu[r];switch(t&&t.types[0]){case 5126:return e.getExtension("OES_texture_float_linear");case 5131:return e.getExtension("OES_texture_half_float_linear");default:return!0}}function _L(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=bL(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function bL(e,r){if(e){if(typeof e=="string")return Vb(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Vb(e,r)}}function Vb(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function TL(e){var r=xL();return function(){var n=(0,Ih.default)(e),a;if(r){var i=(0,Ih.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,Kb.default)(this,a)}}function xL(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var EL=[9729,9728],zb=globalThis.WebGLBuffer||function(){},Rh=function(e,r){(0,Xb.default)(n,e);var t=TL(n);function n(a,i){var o;(0,qb.default)(this,n);var s=i.id,u=s===void 0?uu("texture"):s,f=i.handle,l=i.target;return o=t.call(this,a,{id:u,handle:f}),o.target=l,o.textureUnit=void 0,o.loaded=!1,o.width=void 0,o.height=void 0,o.depth=void 0,o.format=void 0,o.type=void 0,o.dataFormat=void 0,o.border=void 0,o.textureUnit=void 0,o.mipmaps=void 0,o}return(0,Jb.default)(n,[{key:r,get:function(){return"Texture"}},{key:"toString",value:function(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}},{key:"initialize",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=o.data;if(s instanceof Promise)return s.then(function(j){return i.initialize(Object.assign({},o,{pixels:j,data:j}))}),this;var u=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement;if(u&&s.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,s.addEventListener("loadeddata",function(){return i.initialize(o)}),this;var f=o.pixels,l=f===void 0?null:f,c=o.format,h=c===void 0?6408:c,d=o.border,p=d===void 0?0:d,v=o.recreate,y=v===void 0?!1:v,A=o.parameters,_=A===void 0?{}:A,E=o.pixelStore,x=E===void 0?{}:E,C=o.textureUnit,B=C===void 0?void 0:C;s||(s=l);var F=o.width,M=o.height,w=o.dataFormat,b=o.type,I=o.compressed,L=I===void 0?!1:I,k=o.mipmaps,D=k===void 0?!0:k,O=o.depth,P=O===void 0?0:O,R=this._deduceParameters({format:h,type:b,dataFormat:w,compressed:L,data:s,width:F,height:M});return F=R.width,M=R.height,L=R.compressed,w=R.dataFormat,b=R.type,this.width=F,this.height=M,this.depth=P,this.format=h,this.type=b,this.dataFormat=w,this.border=p,this.textureUnit=B,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),D&&this._isNPOT()&&(ue.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),D=!1,this._updateForNPOT(_)),this.mipmaps=D,this.setImageData({data:s,width:F,height:M,depth:P,format:h,type:b,dataFormat:w,border:p,mipmaps:D,parameters:x,compressed:L}),D&&this.generateMipmap(),this.setParameters(_),y&&(this.data=s),u&&(this._video={video:s,parameters:_,lastTime:s.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?s.currentTime:-1}),this}},{key:"update",value:function(){if(this._video){var i=this._video,o=i.video,s=i.parameters,u=i.lastTime;if(u===o.currentTime||o.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:o,parameters:s}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=o.currentTime}}},{key:"resize",value:function(i){var o=i.height,s=i.width,u=i.mipmaps,f=u===void 0?!1:u;return s!==this.width||o!==this.height?this.initialize({width:s,height:o,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:f}):this}},{key:"generateMipmap",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(ue.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Ar(this.gl,o,function(){i.gl.generateMipmap(i.target)}),this.gl.bindTexture(this.target,null),this)}},{key:"setImageData",value:function(i){this._trackDeallocatedMemory("Texture");var o=i.target,s=o===void 0?this.target:o,u=i.pixels,f=u===void 0?null:u,l=i.level,c=l===void 0?0:l,h=i.format,d=h===void 0?this.format:h,p=i.border,v=p===void 0?this.border:p,y=i.offset,A=y===void 0?0:y,_=i.parameters,E=_===void 0?{}:_,x=i.data,C=x===void 0?null:x,B=i.type,F=B===void 0?this.type:B,M=i.width,w=M===void 0?this.width:M,b=i.height,I=b===void 0?this.height:b,L=i.dataFormat,k=L===void 0?this.dataFormat:L,D=i.compressed,O=D===void 0?!1:D;C||(C=f);var P=this._deduceParameters({format:d,type:F,dataFormat:k,compressed:O,data:C,width:w,height:I});F=P.type,k=P.dataFormat,O=P.compressed,w=P.width,I=P.height;var R=this.gl;R.bindTexture(this.target,this.handle);var j=null,G=this._getDataType({data:C,compressed:O});C=G.data,j=G.dataType;var V,X=0;if(Ar(this.gl,E,function(){switch(j){case"null":R.texImage2D(s,c,d,w,I,v,k,F,C);break;case"typed-array":R.texImage2D(s,c,d,w,I,v,k,F,C,A);break;case"buffer":V=et(R),V.bindBuffer(35052,C.handle||C),V.texImage2D(s,c,d,w,I,v,k,F,A),V.bindBuffer(35052,null);break;case"browser-object":he(R)?R.texImage2D(s,c,d,w,I,v,k,F,C):R.texImage2D(s,c,d,k,F,C);break;case"compressed":var Oe=_L(C.entries()),Et;try{for(Oe.s();!(Et=Oe.n()).done;){var He=(0,Wb.default)(Et.value,2),Rr=He[0],mt=He[1];R.compressedTexImage2D(s,Rr,mt.format,mt.width,mt.height,v,mt.data),X+=mt.levelSize}}catch(sa){Oe.e(sa)}finally{Oe.f()}break;default:$(!1,"Unknown image data type")}}),j==="compressed")this._trackAllocatedMemory(X,"Texture");else if(C&&C.byteLength)this._trackAllocatedMemory(C.byteLength,"Texture");else{var ne=Nb[this.dataFormat]||4,ke=Ub[this.type]||1;this._trackAllocatedMemory(this.width*this.height*ne*ke,"Texture")}return this.loaded=!0,this}},{key:"setSubImageData",value:function(i){var o=this,s=i.target,u=s===void 0?this.target:s,f=i.pixels,l=f===void 0?null:f,c=i.data,h=c===void 0?null:c,d=i.x,p=d===void 0?0:d,v=i.y,y=v===void 0?0:v,A=i.width,_=A===void 0?this.width:A,E=i.height,x=E===void 0?this.height:E,C=i.level,B=C===void 0?0:C,F=i.format,M=F===void 0?this.format:F,w=i.type,b=w===void 0?this.type:w,I=i.dataFormat,L=I===void 0?this.dataFormat:I,k=i.compressed,D=k===void 0?!1:k,O=i.offset,P=O===void 0?0:O,R=i.border,j=R===void 0?this.border:R,G=i.parameters,V=G===void 0?{}:G,X=this._deduceParameters({format:M,type:b,dataFormat:L,compressed:D,data:h,width:_,height:x});if(b=X.type,L=X.dataFormat,D=X.compressed,_=X.width,x=X.height,$(this.depth===0,"texSubImage not supported for 3D textures"),h||(h=l),h&&h.data){var ne=h;h=ne.data,_=ne.shape[0],x=ne.shape[1]}h instanceof Ph&&(h=h.handle),this.gl.bindTexture(this.target,this.handle),Ar(this.gl,V,function(){if(D)o.gl.compressedTexSubImage2D(u,B,p,y,_,x,M,h);else if(h===null)o.gl.texSubImage2D(u,B,p,y,_,x,L,b,null);else if(ArrayBuffer.isView(h))o.gl.texSubImage2D(u,B,p,y,_,x,L,b,h,P);else if(h instanceof zb){var ke=et(o.gl);ke.bindBuffer(35052,h),ke.texSubImage2D(u,B,p,y,_,x,L,b,P),ke.bindBuffer(35052,null)}else if(he(o.gl)){var Oe=et(o.gl);Oe.texSubImage2D(u,B,p,y,_,x,L,b,h)}else o.gl.texSubImage2D(u,B,p,y,L,b,h)}),this.gl.bindTexture(this.target,null)}},{key:"copyFramebuffer",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ue.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}},{key:"getActiveUnit",value:function(){return this.gl.getParameter(34016)-33984}},{key:"bind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit,o=this.gl;return i!==void 0&&(this.textureUnit=i,o.activeTexture(33984+i)),o.bindTexture(this.target,this.handle),i}},{key:"unbind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit,o=this.gl;return i!==void 0&&(this.textureUnit=i,o.activeTexture(33984+i)),o.bindTexture(this.target,null),i}},{key:"_getDataType",value:function(i){var o=i.data,s=i.compressed,u=s===void 0?!1:s;return u?{data:o,dataType:"compressed"}:o===null?{data:o,dataType:"null"}:ArrayBuffer.isView(o)?{data:o,dataType:"typed-array"}:o instanceof Ph?{data:o.handle,dataType:"buffer"}:o instanceof zb?{data:o,dataType:"buffer"}:{data:o,dataType:"browser-object"}}},{key:"_deduceParameters",value:function(i){var o=i.format,s=i.data,u=i.width,f=i.height,l=i.dataFormat,c=i.type,h=i.compressed,d=cu[o];l=l||d&&d.dataFormat,c=c||d&&d.types[0],h=h||d&&d.compressed;var p=this._deduceImageSize(s,u,f);return u=p.width,f=p.height,{dataFormat:l,type:c,compressed:h,width:u,height:f,format:o,data:s}}},{key:"_deduceImageSize",value:function(i,o,s){var u;return typeof ImageData<"u"&&i instanceof ImageData?u={width:i.width,height:i.height}:typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement?u={width:i.naturalWidth,height:i.naturalHeight}:typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement?u={width:i.width,height:i.height}:typeof ImageBitmap<"u"&&i instanceof ImageBitmap?u={width:i.width,height:i.height}:typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement?u={width:i.videoWidth,height:i.videoHeight}:i?u={width:o,height:s}:u={width:o>=0?o:1,height:s>=0?s:1},$(u,"Could not deduced texture size"),$(o===void 0||u.width===o,"Deduced texture width does not match supplied width"),$(s===void 0||u.height===s,"Deduced texture height does not match supplied height"),u}},{key:"_createHandle",value:function(){return this.gl.createTexture()}},{key:"_deleteHandle",value:function(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}},{key:"_getParameter",value:function(i){switch(i){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);var o=this.gl.getTexParameter(this.target,i);return this.gl.bindTexture(this.target,null),o}}},{key:"_setParameter",value:function(i,o){switch(this.gl.bindTexture(this.target,this.handle),o=this._getNPOTParam(i,o),i){case 33082:case 33083:this.gl.texParameterf(this.handle,i,o);break;case 4096:case 4097:$(!1);break;default:this.gl.texParameteri(this.target,i,o);break}return this.gl.bindTexture(this.target,null),this}},{key:"_isNPOT",value:function(){return he(this.gl)||!this.width||!this.height?!1:!Mh(this.width)||!Mh(this.height)}},{key:"_updateForNPOT",value:function(i){i[this.gl.TEXTURE_MIN_FILTER]===void 0&&(i[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),i[this.gl.TEXTURE_WRAP_S]===void 0&&(i[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),i[this.gl.TEXTURE_WRAP_T]===void 0&&(i[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}},{key:"_getNPOTParam",value:function(i,o){if(this._isNPOT())switch(i){case 10241:EL.indexOf(o)===-1&&(o=9729);break;case 10242:case 10243:o!==33071&&(o=33071);break;default:break}return o}}],[{key:"isSupported",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=o.format,u=o.linearFiltering,f=!0;return s&&(f=f&&jb(i,s),f=f&&(!u||Hb(i,s))),f}}]),n}(Kr,Symbol.toStringTag);var SL="";function Yb(e,r){return $(typeof e=="string"),e=SL+e,new Promise(function(t,n){try{var a=new Image;a.onload=function(){return t(a)},a.onerror=function(){return n(new Error("Could not load image ".concat(e,".")))},a.crossOrigin=r&&r.crossOrigin||"anonymous",a.src=e}catch(i){n(i)}})}function wL(e){var r=CL();return function(){var n=(0,Fh.default)(e),a;if(r){var i=(0,Fh.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,tT.default)(this,a)}}function CL(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Dn=function(e,r){(0,eT.default)(n,e);var t=wL(n);function n(a){var i;(0,Zb.default)(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return qi(a),(o instanceof Promise||typeof o=="string")&&(o={data:o}),typeof o.data=="string"&&(o=Object.assign({},o,{data:Yb(o.data)})),i=t.call(this,a,Object.assign({},o,{target:3553})),i.initialize(o),Object.seal((0,Qb.default)(i)),i}return(0,$b.default)(n,[{key:r,get:function(){return"Texture2D"}}],[{key:"isSupported",value:function(i,o){return Rh.isSupported(i,o)}}]),n}(Rh,Symbol.toStringTag);var ro=m(W()),TT=m(ie()),xT=m(H()),ET=m(z()),ST=m(wt()),wT=m(dn()),CT=m(Te()),BT=m(xe()),pu=m(be());var rT=m(H()),nT=m(z()),aT=m(wt()),iT=m(Te()),oT=m(xe()),kh=m(be());var te=m(W()),Q,Gn="EXT_color_buffer_float",Lh=(Q={},(0,te.default)(Q,33189,{bpp:2}),(0,te.default)(Q,33190,{gl2:!0,bpp:3}),(0,te.default)(Q,36012,{gl2:!0,bpp:4}),(0,te.default)(Q,36168,{bpp:1}),(0,te.default)(Q,34041,{bpp:4}),(0,te.default)(Q,35056,{gl2:!0,bpp:4}),(0,te.default)(Q,36013,{gl2:!0,bpp:5}),(0,te.default)(Q,32854,{bpp:2}),(0,te.default)(Q,36194,{bpp:2}),(0,te.default)(Q,32855,{bpp:2}),(0,te.default)(Q,33321,{gl2:!0,bpp:1}),(0,te.default)(Q,33330,{gl2:!0,bpp:1}),(0,te.default)(Q,33329,{gl2:!0,bpp:1}),(0,te.default)(Q,33332,{gl2:!0,bpp:2}),(0,te.default)(Q,33331,{gl2:!0,bpp:2}),(0,te.default)(Q,33334,{gl2:!0,bpp:4}),(0,te.default)(Q,33333,{gl2:!0,bpp:4}),(0,te.default)(Q,33323,{gl2:!0,bpp:2}),(0,te.default)(Q,33336,{gl2:!0,bpp:2}),(0,te.default)(Q,33335,{gl2:!0,bpp:2}),(0,te.default)(Q,33338,{gl2:!0,bpp:4}),(0,te.default)(Q,33337,{gl2:!0,bpp:4}),(0,te.default)(Q,33340,{gl2:!0,bpp:8}),(0,te.default)(Q,33339,{gl2:!0,bpp:8}),(0,te.default)(Q,32849,{gl2:!0,bpp:3}),(0,te.default)(Q,32856,{gl2:!0,bpp:4}),(0,te.default)(Q,32857,{gl2:!0,bpp:4}),(0,te.default)(Q,36220,{gl2:!0,bpp:4}),(0,te.default)(Q,36238,{gl2:!0,bpp:4}),(0,te.default)(Q,36975,{gl2:!0,bpp:4}),(0,te.default)(Q,36214,{gl2:!0,bpp:8}),(0,te.default)(Q,36232,{gl2:!0,bpp:8}),(0,te.default)(Q,36226,{gl2:!0,bpp:16}),(0,te.default)(Q,36208,{gl2:!0,bpp:16}),(0,te.default)(Q,33325,{gl2:Gn,bpp:2}),(0,te.default)(Q,33327,{gl2:Gn,bpp:4}),(0,te.default)(Q,34842,{gl2:Gn,bpp:8}),(0,te.default)(Q,33326,{gl2:Gn,bpp:4}),(0,te.default)(Q,33328,{gl2:Gn,bpp:8}),(0,te.default)(Q,34836,{gl2:Gn,bpp:16}),(0,te.default)(Q,35898,{gl2:Gn,bpp:4}),Q);function BL(e){var r=ML();return function(){var n=(0,kh.default)(e),a;if(r){var i=(0,kh.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,oT.default)(this,a)}}function ML(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function OL(e,r,t){var n=t[r];if(!n)return!1;var a=he(e)&&n.gl2||n.gl1;return typeof a=="string"?e.getExtension(a):a}var to=function(e,r){(0,iT.default)(n,e);var t=BL(n);function n(a){var i;(0,rT.default)(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return i=t.call(this,a,o),i.initialize(o),Object.seal((0,aT.default)(i)),i}return(0,nT.default)(n,[{key:r,get:function(){return"Renderbuffer"}},{key:"initialize",value:function(i){var o=i.format,s=i.width,u=s===void 0?1:s,f=i.height,l=f===void 0?1:f,c=i.samples,h=c===void 0?0:c;return $(o,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),h!==0&&he(this.gl)?this.gl.renderbufferStorageMultisample(36161,h,o,u,l):this.gl.renderbufferStorage(36161,o,u,l),this.format=o,this.width=u,this.height=l,this.samples=h,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Lh[this.format].bpp),this}},{key:"resize",value:function(i){var o=i.width,s=i.height;return o!==this.width||s!==this.height?this.initialize({width:o,height:s,format:this.format,samples:this.samples}):this}},{key:"_createHandle",value:function(){return this.gl.createRenderbuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}},{key:"_bindHandle",value:function(i){this.gl.bindRenderbuffer(36161,i)}},{key:"_syncHandle",value:function(i){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}},{key:"_getParameter",value:function(i){this.gl.bindRenderbuffer(36161,this.handle);var o=this.gl.getRenderbufferParameter(36161,i);return o}}],[{key:"isSupported",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null},s=o.format;return!s||OL(i,s,Lh)}},{key:"getSamplesForFormat",value:function(i,o){var s=o.format;return i.getInternalformatParameter(36161,s,32937)}}]),n}(Kr,Symbol.toStringTag);var cT=m(ie());var PL=256,IL=1024,RL=16384,sT=6144,uT=6145,fT=6146,lT=34041,hT="clear: bad arguments";function dT(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.framebuffer,n=t===void 0?null:t,a=r.color,i=a===void 0?null:a,o=r.depth,s=o===void 0?null:o,u=r.stencil,f=u===void 0?null:u,l={};n&&(l.framebuffer=n);var c=0;i&&(c|=RL,i!==!0&&(l.clearColor=i)),s&&(c|=PL,s!==!0&&(l.clearDepth=s)),f&&(c|=IL,s!==!0&&(l.clearStencil=s)),$(c!==0,hT),Ar(e,l,function(){e.clear(c)})}function pT(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.framebuffer,n=t===void 0?null:t,a=r.buffer,i=a===void 0?sT:a,o=r.drawBuffer,s=o===void 0?0:o,u=r.value,f=u===void 0?[0,0,0,0]:u;et(e),Ar(e,{framebuffer:n},function(){switch(i){case sT:switch(f.constructor){case Int32Array:e.clearBufferiv(i,s,f);break;case Uint32Array:e.clearBufferuiv(i,s,f);break;case Float32Array:default:e.clearBufferfv(i,s,f)}break;case uT:e.clearBufferfv(uT,0,[f]);break;case fT:e.clearBufferiv(fT,0,[f]);break;case lT:var l=(0,cT.default)(f,2),c=l[0],h=l[1];e.clearBufferfi(lT,0,c,h);break;default:$(!1,hT)}})}function mT(e){switch(e){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return $(!1),0}}function FL(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.sourceX,n=t===void 0?0:t,a=r.sourceY,i=a===void 0?0:a,o=r.sourceFormat,s=o===void 0?6408:o,u=r.sourceAttachment,f=u===void 0?36064:u,l=r.target,c=l===void 0?null:l,h=r.sourceWidth,d=r.sourceHeight,p=r.sourceType,v=LL(e),y=v.framebuffer,A=v.deleteFramebuffer;$(y);var _=y.gl,E=y.handle,x=y.attachments;h=h||y.width,d=d||y.height,f===36064&&E===null&&(f=1028),$(x[f]),p=p||x[f].type,c=kL(c,p,s,h,d),p=p||Qi(c);var C=_.bindFramebuffer(36160,E);return _.readPixels(n,i,h,d,s,p,c),_.bindFramebuffer(36160,C||null),A&&y.delete(),c}function Dh(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.sourceAttachment,n=t===void 0?36064:t,a=r.targetMaxHeight,i=a===void 0?Number.MAX_SAFE_INTEGER:a,o=FL(e,{sourceAttachment:n}),s=e.width,u=e.height;u>i;){var f=Bb({data:o,width:s,height:u});o=f.data,s=f.width,u=f.height}Cb({data:o,width:s,height:u});var l=document.createElement("canvas");l.width=s,l.height=u;var c=l.getContext("2d"),h=c.createImageData(s,u);return h.data.set(o),c.putImageData(h,0,0),l.toDataURL()}function LL(e){return e instanceof Zr?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:vT(e),deleteFramebuffer:!0}}function kL(e,r,t,n,a){if(e)return e;r=r||5121;var i=Yr(r,{clamped:!1}),o=mT(t);return new i(n*a*o)}var Ie=m(W());var Pe,Me={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function DL(e){var r=new Dn(e,{format:6408,type:5126,dataFormat:6408}),t=new Zr(e,{id:"test-framebuffer",check:!1,attachments:(0,Ie.default)({},36064,r)}),n=t.getStatus();return r.delete(),t.delete(),n===36053}var Gh=(Pe={},(0,Ie.default)(Pe,Me.WEBGL2,[!1,!0]),(0,Ie.default)(Pe,Me.VERTEX_ARRAY_OBJECT,["OES_vertex_array_object",!0]),(0,Ie.default)(Pe,Me.TIMER_QUERY,["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"]),(0,Ie.default)(Pe,Me.INSTANCED_RENDERING,["ANGLE_instanced_arrays",!0]),(0,Ie.default)(Pe,Me.MULTIPLE_RENDER_TARGETS,["WEBGL_draw_buffers",!0]),(0,Ie.default)(Pe,Me.ELEMENT_INDEX_UINT32,["OES_element_index_uint",!0]),(0,Ie.default)(Pe,Me.BLEND_EQUATION_MINMAX,["EXT_blend_minmax",!0]),(0,Ie.default)(Pe,Me.FLOAT_BLEND,["EXT_float_blend"]),(0,Ie.default)(Pe,Me.COLOR_ENCODING_SRGB,["EXT_sRGB",!0]),(0,Ie.default)(Pe,Me.TEXTURE_DEPTH,["WEBGL_depth_texture",!0]),(0,Ie.default)(Pe,Me.TEXTURE_FLOAT,["OES_texture_float",!0]),(0,Ie.default)(Pe,Me.TEXTURE_HALF_FLOAT,["OES_texture_half_float",!0]),(0,Ie.default)(Pe,Me.TEXTURE_FILTER_LINEAR_FLOAT,["OES_texture_float_linear"]),(0,Ie.default)(Pe,Me.TEXTURE_FILTER_LINEAR_HALF_FLOAT,["OES_texture_half_float_linear"]),(0,Ie.default)(Pe,Me.TEXTURE_FILTER_ANISOTROPIC,["EXT_texture_filter_anisotropic"]),(0,Ie.default)(Pe,Me.COLOR_ATTACHMENT_RGBA32F,[DL,"EXT_color_buffer_float"]),(0,Ie.default)(Pe,Me.COLOR_ATTACHMENT_FLOAT,[!1,"EXT_color_buffer_float"]),(0,Ie.default)(Pe,Me.COLOR_ATTACHMENT_HALF_FLOAT,["EXT_color_buffer_half_float"]),(0,Ie.default)(Pe,Me.GLSL_FRAG_DATA,["WEBGL_draw_buffers",!0]),(0,Ie.default)(Pe,Me.GLSL_FRAG_DEPTH,["EXT_frag_depth",!0]),(0,Ie.default)(Pe,Me.GLSL_DERIVATIVES,["OES_standard_derivatives",!0]),(0,Ie.default)(Pe,Me.GLSL_TEXTURE_LOD,["EXT_shader_texture_lod",!0]),Pe);function GL(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=NL(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function NL(e,r){if(e){if(typeof e=="string")return gT(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return gT(e,r)}}function gT(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var UL=2;function hu(e,r){return Nh(e,r)}function Nh(e,r){return r=Array.isArray(r)?r:[r],r.every(function(t){return yT(e,t)})}function du(e){e.luma=e.luma||{},e.luma.caps=e.luma.caps||{};for(var r in Gh)e.luma.caps[r]===void 0&&(e.luma.caps[r]=yT(e,r));return e.luma.caps}function yT(e,r){return e.luma=e.luma||{},e.luma.caps=e.luma.caps||{},e.luma.caps[r]===void 0&&(e.luma.caps[r]=jL(e,r)),e.luma.caps[r]||ue.log(UL,"Feature: ".concat(r," not supported"))(),e.luma.caps[r]}function jL(e,r){var t=Gh[r];$(t,r);var n,a=he(e)&&t[1]||t[0];if(typeof a=="function")n=a(e);else if(Array.isArray(a)){n=!0;var i=GL(a),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;n=n&&Boolean(e.getExtension(s))}}catch(u){i.e(u)}finally{i.f()}}else typeof a=="string"?n=Boolean(e.getExtension(a)):typeof a=="boolean"?n=a:$(!1);return n}function AT(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=HL(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function HL(e,r){if(e){if(typeof e=="string")return _T(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _T(e,r)}}function _T(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function VL(e){var r=zL();return function(){var n=(0,pu.default)(e),a;if(r){var i=(0,pu.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,BT.default)(this,a)}}function zL(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var bT="Multiple render targets not supported",Zr=function(e,r){(0,CT.default)(n,e);var t=VL(n);function n(a){var i;(0,xT.default)(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return i=t.call(this,a,o),i.width=null,i.height=null,i.attachments={},i.readBuffer=36064,i.drawBuffers=[36064],i.ownResources=[],i.initialize(o),Object.seal((0,ST.default)(i)),i}return(0,ET.default)(n,[{key:r,get:function(){return"Framebuffer"}},{key:"MAX_COLOR_ATTACHMENTS",get:function(){var i=et(this.gl);return i.getParameter(i.MAX_COLOR_ATTACHMENTS)}},{key:"MAX_DRAW_BUFFERS",get:function(){var i=et(this.gl);return i.getParameter(i.MAX_DRAW_BUFFERS)}},{key:"color",get:function(){return this.attachments[36064]||null}},{key:"texture",get:function(){return this.attachments[36064]||null}},{key:"depth",get:function(){return this.attachments[36096]||this.attachments[33306]||null}},{key:"stencil",get:function(){return this.attachments[36128]||this.attachments[33306]||null}},{key:"initialize",value:function(i){var o=i.width,s=o===void 0?1:o,u=i.height,f=u===void 0?1:u,l=i.attachments,c=l===void 0?null:l,h=i.color,d=h===void 0?!0:h,p=i.depth,v=p===void 0?!0:p,y=i.stencil,A=y===void 0?!1:y,_=i.check,E=_===void 0?!0:_,x=i.readBuffer,C=x===void 0?void 0:x,B=i.drawBuffers,F=B===void 0?void 0:B;if($(s>=0&&f>=0,"Width and height need to be integers"),this.width=s,this.height=f,c)for(var M in c){var w=c[M],b=Array.isArray(w)?w[0]:w;b.resize({width:s,height:f})}else c=this._createDefaultAttachments(d,v,A,s,f);this.update({clearAttachments:!0,attachments:c,readBuffer:C,drawBuffers:F}),c&&E&&this.checkStatus()}},{key:"delete",value:function(){var i=AT(this.ownResources),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;s.delete()}}catch(u){i.e(u)}finally{i.f()}return(0,wT.default)((0,pu.default)(n.prototype),"delete",this).call(this),this}},{key:"update",value:function(i){var o=i.attachments,s=o===void 0?{}:o,u=i.readBuffer,f=i.drawBuffers,l=i.clearAttachments,c=l===void 0?!1:l,h=i.resizeAttachments,d=h===void 0?!0:h;this.attach(s,{clearAttachments:c,resizeAttachments:d});var p=this.gl,v=p.bindFramebuffer(36160,this.handle);return u&&this._setReadBuffer(u),f&&this._setDrawBuffers(f),p.bindFramebuffer(36160,v||null),this}},{key:"resize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.width,s=i.height;if(this.handle===null)return $(o===void 0&&s===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;o===void 0&&(o=this.gl.drawingBufferWidth),s===void 0&&(s=this.gl.drawingBufferHeight),o!==this.width&&s!==this.height&&ue.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(o,"x").concat(s))();for(var u in this.attachments)this.attachments[u].resize({width:o,height:s});return this.width=o,this.height=s,this}},{key:"attach",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=s.clearAttachments,f=u===void 0?!1:u,l=s.resizeAttachments,c=l===void 0?!0:l,h={};f&&Object.keys(this.attachments).forEach(function(M){h[M]=null}),Object.assign(h,i);var d=this.gl.bindFramebuffer(36160,this.handle);for(var p in h){$(p!==void 0,"Misspelled framebuffer binding point?");var v=Number(p),y=h[v],A=y;if(!A)this._unattach(v);else if(A instanceof to)this._attachRenderbuffer({attachment:v,renderbuffer:A});else if(Array.isArray(y)){var _=(0,TT.default)(y,3),E=_[0],x=_[1],C=x===void 0?0:x,B=_[2],F=B===void 0?0:B;A=E,this._attachTexture({attachment:v,texture:E,layer:C,level:F})}else this._attachTexture({attachment:v,texture:A,layer:0,level:0});c&&A&&A.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,d||null),Object.assign(this.attachments,i),Object.keys(this.attachments).filter(function(M){return!o.attachments[M]}).forEach(function(M){delete o.attachments[M]})}},{key:"checkStatus",value:function(){var i=this.gl,o=this.getStatus();if(o!==36053)throw new Error(qL(o));return this}},{key:"getStatus",value:function(){var i=this.gl,o=i.bindFramebuffer(36160,this.handle),s=i.checkFramebufferStatus(36160);return i.bindFramebuffer(36160,o||null),s}},{key:"clear",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=o.color,u=o.depth,f=o.stencil,l=o.drawBuffers,c=l===void 0?[]:l,h=this.gl.bindFramebuffer(36160,this.handle);return(s||u||f)&&dT(this.gl,{color:s,depth:u,stencil:f}),c.forEach(function(d,p){pT(i.gl,{drawBuffer:p,value:d})}),this.gl.bindFramebuffer(36160,h||null),this}},{key:"readPixels",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ue.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}},{key:"readPixelsToBuffer",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ue.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}},{key:"copyToDataUrl",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ue.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}},{key:"copyToImage",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ue.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}},{key:"copyToTexture",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ue.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}},{key:"blit",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ue.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}},{key:"invalidate",value:function(i){var o=i.attachments,s=o===void 0?[]:o,u=i.x,f=u===void 0?0:u,l=i.y,c=l===void 0?0:l,h=i.width,d=i.height,p=et(this.gl),v=p.bindFramebuffer(36008,this.handle),y=f===0&&c===0&&h===void 0&&d===void 0;return y?p.invalidateFramebuffer(36008,s):p.invalidateFramebuffer(36008,s,f,c,h,d),p.bindFramebuffer(36008,v),this}},{key:"getAttachmentParameter",value:function(i,o,s){var u=this._getAttachmentParameterFallback(o);return u===null&&(this.gl.bindFramebuffer(36160,this.handle),u=this.gl.getFramebufferAttachmentParameter(36160,i,o),this.gl.bindFramebuffer(36160,null)),s&&u>1e3&&(u=Ln(this.gl,u)),u}},{key:"getAttachmentParameters",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,o=arguments.length>1?arguments[1]:void 0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[],u={},f=AT(s),l;try{for(f.s();!(l=f.n()).done;){var c=l.value,h=o?Ln(this.gl,c):c;u[h]=this.getAttachmentParameter(i,c,o)}}catch(d){f.e(d)}finally{f.f()}return u}},{key:"getParameters",value:function(){for(var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,o=Object.keys(this.attachments),s={},u=0,f=o;u<f.length;u++){var l=f[u],c=Number(l),h=i?Ln(this.gl,c):c;s[h]=this.getAttachmentParameters(c,i)}return s}},{key:"show",value:function(){return typeof window<"u"&&window.open(Dh(this),"luma-debug-texture"),this}},{key:"log",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(i>ue.level||typeof window>"u")return this;o=o||"Framebuffer ".concat(this.id);var s=Dh(this,{targetMaxHeight:100});return ue.image({logLevel:i,message:o,image:s},o)(),this}},{key:"bind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.target,s=o===void 0?36160:o;return this.gl.bindFramebuffer(s,this.handle),this}},{key:"unbind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.target,s=o===void 0?36160:o;return this.gl.bindFramebuffer(s,null),this}},{key:"_createDefaultAttachments",value:function(i,o,s,u,f){var l=null;if(i){var c;l=l||{},l[36064]=new Dn(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:u,height:f,mipmaps:!1,parameters:(c={},(0,ro.default)(c,10241,9729),(0,ro.default)(c,10240,9729),(0,ro.default)(c,10242,33071),(0,ro.default)(c,10243,33071),c)}),this.ownResources.push(l[36064])}return o&&s?(l=l||{},l[33306]=new to(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:u,height:111}),this.ownResources.push(l[33306])):o?(l=l||{},l[36096]=new to(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:u,height:f}),this.ownResources.push(l[36096])):s&&$(!1),l}},{key:"_unattach",value:function(i){var o=this.attachments[i];o&&(o instanceof to?this.gl.framebufferRenderbuffer(36160,i,36161,null):this.gl.framebufferTexture2D(36160,i,3553,null,0),delete this.attachments[i])}},{key:"_attachRenderbuffer",value:function(i){var o=i.attachment,s=o===void 0?36064:o,u=i.renderbuffer,f=this.gl;f.framebufferRenderbuffer(36160,s,36161,u.handle),this.attachments[s]=u}},{key:"_attachTexture",value:function(i){var o=i.attachment,s=o===void 0?36064:o,u=i.texture,f=i.layer,l=i.level,c=this.gl;switch(c.bindTexture(u.target,u.handle),u.target){case 35866:case 32879:var h=et(c);h.framebufferTextureLayer(36160,s,u.target,l,f);break;case 34067:var d=WL(f);c.framebufferTexture2D(36160,s,d,u.handle,l);break;case 3553:c.framebufferTexture2D(36160,s,3553,u.handle,l);break;default:$(!1,"Illegal texture type")}c.bindTexture(u.target,null),this.attachments[s]=u}},{key:"_setReadBuffer",value:function(i){var o=Ah(this.gl);o?o.readBuffer(i):$(i===36064||i===1029,bT),this.readBuffer=i}},{key:"_setDrawBuffers",value:function(i){var o=this.gl,s=et(o);if(s)s.drawBuffers(i);else{var u=o.getExtension("WEBGL_draw_buffers");u?u.drawBuffersWEBGL(i):$(i.length===1&&(i[0]===36064||i[0]===1029),bT)}this.drawBuffers=i}},{key:"_getAttachmentParameterFallback",value:function(i){var o=du(this.gl);switch(i){case 36052:return o.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return o.WEBGL2?null:8;case 33297:return o.WEBGL2?null:5125;case 33296:return!o.WEBGL2&&!o.EXT_sRGB?9729:null;default:return null}}},{key:"_createHandle",value:function(){return this.gl.createFramebuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteFramebuffer(this.handle)}},{key:"_bindHandle",value:function(i){return this.gl.bindFramebuffer(36160,i)}}],[{key:"isSupported",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=o.colorBufferFloat,u=o.colorBufferHalfFloat,f=!0;return s&&(f=Boolean(i.getExtension("EXT_color_buffer_float")||i.getExtension("WEBGL_color_buffer_float")||i.getExtension("OES_texture_float"))),u&&(f=f&&Boolean(i.getExtension("EXT_color_buffer_float")||i.getExtension("EXT_color_buffer_half_float"))),f}},{key:"getDefaultFramebuffer",value:function(i){return i.luma=i.luma||{},i.luma.defaultFramebuffer=i.luma.defaultFramebuffer||new n(i,{id:"default-framebuffer",handle:null,attachments:{}}),i.luma.defaultFramebuffer}}]),n}(Kr,Symbol.toStringTag);function WL(e){return e<34069?e+34069:e}function qL(e){var r=Zr.STATUS||{};return r[e]||"Framebuffer error ".concat(e)}var JL=[36049,36048,33296,33298,33299,33300,33301,33302,33303];Zr.ATTACHMENT_PARAMETERS=JL;function vT(e,r){var t=e.gl,n=e.width,a=e.height,i=e.id,o=new Zr(t,Object.assign({},r,{id:"framebuffer-for-".concat(i),width:n,height:a,attachments:(0,MT.default)({},36064,e)}));return o}var mu=m(W()),PT=m(H()),IT=m(z());function OT(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Uh(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?OT(Object(t),!0).forEach(function(n){(0,mu.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):OT(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var jh=function(){function e(r,t){(0,PT.default)(this,e);var n=t.attributes,a=t.material,i=t.pbrDebug,o=t.imageBasedLightingEnvironment,s=t.lights,u=t.useTangents;this.gl=r,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},hu(r,Me.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],o&&(this.uniforms.u_DiffuseEnvSampler=o.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=o.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=o.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),i&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(n.NORMAL,"HAS_NORMALS"),this.defineIfPresent(n.TANGENT&&u,"HAS_TANGENTS"),this.defineIfPresent(n.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(o,"USE_IBL"),this.defineIfPresent(s,"USE_LIGHTS"),this.defineIfPresent(i,"PBR_DEBUG"),a&&this.parseMaterial(a)}return(0,IT.default)(e,[{key:"defineIfPresent",value:function(t,n){t&&(this.defines[n]=1)}},{key:"parseTexture",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=t.texture&&t.texture.sampler&&t.texture.sampler.parameters||{},o=t.texture.source.image,s,u={};o.compressed?(s=o,u=(0,mu.default)({},this.gl.TEXTURE_MIN_FILTER,o.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR)):s={data:o};var f=new Dn(this.gl,Uh({id:t.name||t.id,parameters:Uh(Uh({},i),u),pixelStore:(0,mu.default)({},this.gl.UNPACK_FLIP_Y_WEBGL,!1)},s));this.uniforms[n]=f,this.defineIfPresent(a,a),this.generatedTextures.push(f)}},{key:"parsePbrMetallicRoughness",value:function(t){t.baseColorTexture&&this.parseTexture(t.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=t.baseColorFactor||[1,1,1,1],t.metallicRoughnessTexture&&this.parseTexture(t.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");var n=t.metallicFactor,a=n===void 0?1:n,i=t.roughnessFactor,o=i===void 0?1:i;this.uniforms.u_MetallicRoughnessValues=[a,o]}},{key:"parseMaterial",value:function(t){if(this.uniforms.pbr_uUnlit=Boolean(t.unlit),t.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(t.pbrMetallicRoughness),t.normalTexture){this.parseTexture(t.normalTexture,"u_NormalSampler","HAS_NORMALMAP");var n=t.normalTexture.scale,a=n===void 0?1:n;this.uniforms.u_NormalScale=a}if(t.occlusionTexture){this.parseTexture(t.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");var i=t.occlusionTexture.strength,o=i===void 0?1:i;this.uniforms.u_OcclusionStrength=o}if(t.emissiveTexture&&(this.parseTexture(t.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=t.emissiveFactor||[0,0,0]),t.alphaMode==="MASK"){var s=t.alphaCutoff,u=s===void 0?.5:s;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=u}else t.alphaMode==="BLEND"&&(ue.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}},{key:"delete",value:function(){this.generatedTextures.forEach(function(t){return t.delete()})}}]),e}();var gu=m(gh()),UT=m(Xs());var RT=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
uniform bool pickFeatureIds;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec4 uvRegions;
in vec3 featureIdsPickingColors;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

vec2 applyUVRegion(vec2 uv) {
  #ifdef HAS_UV_REGIONS
    return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;
  #else
    return uv;
  #endif
}

void main(void) {
  vec2 uv = applyUVRegion(texCoords);
  geometry.uv = uv;

  if (pickFeatureIds) {
    geometry.pickingColor = featureIdsPickingColors;
  } else {
    geometry.pickingColor = instancePickingColors;
  }

  vTexCoord = uv;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale;
  vec3 projectedPosition = project_position(positions);
  position_commonspace = vec4(projectedPosition, 1.0);
  gl_Position = project_common_position_to_clipspace(position_commonspace);

  geometry.position = position_commonspace;
  normals_commonspace = project_normal(instanceModelMatrix * normals);
  geometry.normal = normals_commonspace;

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = uv;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var FT=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  
#ifdef MODULE_PBR

  fragColor = vColor * pbr_filterColor(vec4(0));
  geometry.uv = pbr_vUV;
  fragColor.a *= opacity;

#else

  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);

#endif

  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function LT(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function $r(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?LT(Object(t),!0).forEach(function(n){(0,vu.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):LT(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function XL(e){var r=KL();return function(){var n=(0,Qr.default)(e),a;if(r){var i=(0,Qr.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,NT.default)(this,a)}}function KL(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function YL(e){var r=e.COLOR_0||e.colors;r||(e.colors={constant:!0,value:new Float32Array([1,1,1])})}var ZL={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}},yu=function(e){(0,GT.default)(t,e);var r=XL(t);function t(){return(0,kT.default)(this,t),r.apply(this,arguments)}return(0,DT.default)(t,[{key:"getShaders",value:function(){var a=(0,Fa.default)((0,Qr.default)(t.prototype),"getShaders",this).call(this),i=a.modules;return i.push(gu.pbr),$r($r({},a),{},{vs:RT,fs:FT})}},{key:"initializeState",value:function(){var a=this.props.featureIds;(0,Fa.default)((0,Qr.default)(t.prototype),"initializeState",this).call(this);var i=this.getAttributeManager();a&&i.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}},{key:"updateState",value:function(a){(0,Fa.default)((0,Qr.default)(t.prototype),"updateState",this).call(this,a);var i=a.props,o=a.oldProps;i.pbrMaterial!==o.pbrMaterial&&this.updatePbrMaterialUniforms(i.pbrMaterial)}},{key:"draw",value:function(a){var i=this.props.featureIds;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,pickFeatureIds:Boolean(i)}),(0,Fa.default)((0,Qr.default)(t.prototype),"draw",this).call(this,a))}},{key:"getModel",value:function(a){var i=this.props,o=i.id,s=i.pbrMaterial,u=this.parseMaterial(s,a);this.setState({materialParser:u});var f=this.getShaders();YL(a.attributes);var l=new gu.Model(this.context.gl,$r($r({},this.getShaders()),{},{id:o,geometry:a,defines:$r($r($r({},f.defines),u?.defines),{},{HAS_UV_REGIONS:a.attributes.uvRegions}),parameters:u?.parameters,isInstanced:!0}));return l}},{key:"updatePbrMaterialUniforms",value:function(a){var i=this.state.model;if(i){var o=this.props.mesh,s=this.parseMaterial(a,o);this.setState({materialParser:s}),i.setUniforms(s.uniforms)}}},{key:"parseMaterial",value:function(a,i){var o,s=Boolean(a.pbrMetallicRoughness&&a.pbrMetallicRoughness.baseColorTexture);return(o=this.state.materialParser)===null||o===void 0||o.delete(),new jh(this.context.gl,{attributes:{NORMAL:i.attributes.normals,TEXCOORD_0:i.attributes.texCoords},material:$r({unlit:s},a),pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}},{key:"calculateFeatureIdsPickingColors",value:function(a){for(var i=this.props.featureIds,o=new Uint8ClampedArray(i.length*a.size),s=[],u=0;u<i.length;u++)this.encodePickingColor(i[u],s),o[u*3]=s[0],o[u*3+1]=s[1],o[u*3+2]=s[2];a.value=o}},{key:"finalizeState",value:function(a){var i;(0,Fa.default)((0,Qr.default)(t.prototype),"finalizeState",this).call(this,a),(i=this.state.materialParser)===null||i===void 0||i.delete(),this.setState({materialParser:null})}}]),t}(UT.SimpleMeshLayer);(0,vu.default)(yu,"layerName","MeshLayer");(0,vu.default)(yu,"defaultProps",ZL);var g2=m(La());var md=m(ie()),Iu=m(K()),mE=m(W()),vE=m(H()),gE=m(z()),Hn=m(Y());function Hh(e){if(Array.isArray(e))return e}function Vh(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],a=!0,i=!1,o,s;try{for(t=t.call(e);!(a=(o=t.next()).done)&&(n.push(o.value),!(r&&n.length===r));a=!0);}catch(u){i=!0,s=u}finally{try{!a&&t.return!=null&&t.return()}finally{if(i)throw s}}return n}}function Au(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function zh(e,r){if(e){if(typeof e=="string")return Au(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Au(e,r)}}function Wh(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qh(e,r){return Hh(e)||Vh(e,r)||zh(e,r)||Wh()}function Jh(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function HT(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xh(e,r,t){return r&&HT(e.prototype,r),t&&HT(e,t),e}function Ft(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var _r=6378137,br=6378137,Tr=6356752314245179e-9,$L={radii:[_r,br,Tr],radiiSquared:[_r*_r,br*br,Tr*Tr],oneOverRadii:[1/_r,1/br,1/Tr],oneOverRadiiSquared:[1/(_r*_r),1/(br*br),1/(Tr*Tr)],maximumRadius:Math.max(_r,br,Tr),centerToleranceSquared:.1};function _u(e){return e}var SY=new S;function QL(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_u;return"longitude"in e?(r[0]=t(e.longitude),r[1]=t(e.latitude),r[2]=e.height):"x"in e?(r[0]=t(e.x),r[1]=t(e.y),r[2]=e.z):(r[0]=t(e[0]),r[1]=t(e[1]),r[2]=e[2]),r}function VT(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return QL(e,r,Se._cartographicRadians?_u:Ic)}function ek(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_u;return"longitude"in r?(r.longitude=t(e[0]),r.latitude=t(e[1]),r.height=e[2]):"x"in r?(r.x=t(e[0]),r.y=t(e[1]),r.z=e[2]):(r[0]=t(e[0]),r[1]=t(e[1]),r[2]=e[2]),r}function zT(e,r){return ek(e,r,Se._cartographicRadians?_u:Rc)}var ka=new S,tk=new S,rk=new S;function Kh(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],n=r.oneOverRadii,a=r.oneOverRadiiSquared,i=r.centerToleranceSquared;ka.from(e);var o=ka.x,s=ka.y,u=ka.z,f=n.x,l=n.y,c=n.z,h=o*o*f*f,d=s*s*l*l,p=u*u*c*c,v=h+d+p,y=Math.sqrt(1/v);if(Number.isFinite(y)){var A=tk;if(A.copy(e).scale(y),v<i)return A.to(t);var _=a.x,E=a.y,x=a.z,C=rk;C.set(A.x*_*2,A.y*E*2,A.z*x*2);var B=(1-y)*ka.len()/(.5*C.len()),F=0,M,w,b,I;do{B-=F,M=1/(1+B*_),w=1/(1+B*E),b=1/(1+B*x);var L=M*M,k=w*w,D=b*b,O=L*M,P=k*w,R=D*b;I=h*L+d*k+p*D-1;var j=h*O*_+d*P*E+p*R*x,G=-2*j;F=I/G}while(Math.abs(I)>rr.EPSILON12);return ka.scale([M,w,b]).to(t)}}var WT=1e-14,nk=new S,qT={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Yh={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},xr={east:new S,north:new S,up:new S,west:new S,south:new S,down:new S},ak=new S,ik=new S,ok=new S;function bu(e,r,t,n,a,i){var o=qT[r]&&qT[r][t];le(o&&(!n||n===o));var s,u,f,l=nk.copy(a),c=Ze(l.x,0,WT)&&Ze(l.y,0,WT);if(c){var h=Math.sign(l.z);s=ak.fromArray(Yh[r]),r!=="east"&&r!=="west"&&s.scale(h),u=ik.fromArray(Yh[t]),t!=="east"&&t!=="west"&&u.scale(h),f=ok.fromArray(Yh[n]),n!=="east"&&n!=="west"&&f.scale(h)}else{var d=xr.up,p=xr.east,v=xr.north;p.set(-l.y,l.x,0).normalize(),e.geodeticSurfaceNormal(l,d),v.copy(d).cross(p);var y=xr.down,A=xr.west,_=xr.south;y.copy(d).scale(-1),A.copy(p).scale(-1),_.copy(v).scale(-1),s=xr[r],u=xr[t],f=xr[n]}return i[0]=s.x,i[1]=s.y,i[2]=s.z,i[3]=0,i[4]=u.x,i[5]=u.y,i[6]=u.z,i[7]=0,i[8]=f.x,i[9]=f.y,i[10]=f.z,i[11]=0,i[12]=l.x,i[13]=l.y,i[14]=l.z,i[15]=1,i}var Tu=new S,JT=new S,sk=new S,Wt=new S,uk=new S,xu=new S;var pe=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;Jh(this,e),Ft(this,"radii",void 0),Ft(this,"radiiSquared",void 0),Ft(this,"radiiToTheFourth",void 0),Ft(this,"oneOverRadii",void 0),Ft(this,"oneOverRadiiSquared",void 0),Ft(this,"minimumRadius",void 0),Ft(this,"maximumRadius",void 0),Ft(this,"centerToleranceSquared",rr.EPSILON1),Ft(this,"squaredXOverSquaredZ",void 0),le(r>=0),le(t>=0),le(n>=0),this.radii=new S(r,t,n),this.radiiSquared=new S(r*r,t*t,n*n),this.radiiToTheFourth=new S(r*r*r*r,t*t*t*t,n*n*n*n),this.oneOverRadii=new S(r===0?0:1/r,t===0?0:1/t,n===0?0:1/n),this.oneOverRadiiSquared=new S(r===0?0:1/(r*r),t===0?0:1/(t*t),n===0?0:1/(n*n)),this.minimumRadius=Math.min(r,t,n),this.maximumRadius=Math.max(r,t,n),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}return Xh(e,[{key:"equals",value:function(t){return this===t||Boolean(t&&this.radii.equals(t.radii))}},{key:"toString",value:function(){return this.radii.toString()}},{key:"cartographicToCartesian",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],a=JT,i=sk,o=qh(t,3),s=o[2];this.geodeticSurfaceNormalCartographic(t,a),i.copy(this.radiiSquared).scale(a);var u=Math.sqrt(a.dot(i));return i.scale(1/u),a.scale(s),i.add(a),i.to(n)}},{key:"cartesianToCartographic",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];xu.from(t);var a=this.scaleToGeodeticSurface(xu,Wt);if(a){var i=this.geodeticSurfaceNormal(a,JT),o=uk;o.copy(xu).subtract(a);var s=Math.atan2(i.y,i.x),u=Math.asin(i.z),f=Math.sign(Mi(o,xu))*fc(o);return zT([s,u,f],n)}}},{key:"eastNorthUpToFixedFrame",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new ee;return bu(this,"east","north","up",t,n)}},{key:"localFrameToFixedFrame",value:function(t,n,a,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:new ee;return bu(this,t,n,a,i,o)}},{key:"geocentricSurfaceNormal",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return Tu.from(t).normalize().to(n)}},{key:"geodeticSurfaceNormalCartographic",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],a=VT(t),i=a[0],o=a[1],s=Math.cos(o);return Tu.set(s*Math.cos(i),s*Math.sin(i),Math.sin(o)).normalize(),Tu.to(n)}},{key:"geodeticSurfaceNormal",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return Tu.from(t).scale(this.oneOverRadiiSquared).normalize().to(n)}},{key:"scaleToGeodeticSurface",value:function(t,n){return Kh(t,this,n)}},{key:"scaleToGeocentricSurface",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];Wt.from(t);var a=Wt.x,i=Wt.y,o=Wt.z,s=this.oneOverRadiiSquared,u=1/Math.sqrt(a*a*s.x+i*i*s.y+o*o*s.z);return Wt.multiplyScalar(u).to(n)}},{key:"transformPositionToScaledSpace",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return Wt.from(t).scale(this.oneOverRadii).to(n)}},{key:"transformPositionFromScaledSpace",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return Wt.from(t).scale(this.radii).to(n)}},{key:"getSurfaceNormalIntersectionWithZAxis",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,0];le(Ze(this.radii.x,this.radii.y,rr.EPSILON15)),le(this.radii.z>0),Wt.from(t);var i=Wt.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-n))return Wt.set(0,0,i).to(a)}}]),e}();Ft(pe,"WGS84",new pe(_r,br,Tr));function no(){let e;if(typeof window<"u"&&window.performance)e=window.performance.now();else if(typeof process<"u"&&process.hrtime){let r=process.hrtime();e=r[0]*1e3+r[1]/1e6}else e=Date.now();return e}var Nn=class{constructor(r,t){g(this,"name",void 0),g(this,"type",void 0),g(this,"sampleSize",1),g(this,"time",0),g(this,"count",0),g(this,"samples",0),g(this,"lastTiming",0),g(this,"lastSampleTime",0),g(this,"lastSampleCount",0),g(this,"_count",0),g(this,"_time",0),g(this,"_samples",0),g(this,"_startTime",0),g(this,"_timerPending",!1),this.name=r,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(r){return this.sampleSize=r,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(r){return this._count+=r,this._samples++,this._checkSampling(),this}subtractCount(r){return this._count-=r,this._samples++,this._checkSampling(),this}addTime(r){return this._time+=r,this.lastTiming=r,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=no(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(no()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}};var Da=class{constructor(r){g(this,"id",void 0),g(this,"stats",{}),this.id=r.id,this.stats={},this._initializeStats(r.stats),Object.seal(this)}get(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:r,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(let r of Object.values(this.stats))r.reset();return this}forEach(r){for(let t of Object.values(this.stats))r(t)}getTable(){let r={};return this.forEach(t=>{r[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),r}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(t=>this._getOrCreate(t))}_getOrCreate(r){let{name:t,type:n}=r,a=this.stats[t];return a||(r instanceof Nn?a=r:a=new Nn(t,n),this.stats[t]=a),a}};var QT=m(H()),ex=m(z());var YT=m(H()),ZT=m(z());var XT=m(H());var KT=function e(r,t,n){(0,XT.default)(this,e),g(this,"item",void 0),g(this,"previous",void 0),g(this,"next",void 0),this.item=r,this.previous=t,this.next=n};var $T=function(){function e(){(0,YT.default)(this,e),g(this,"head",null),g(this,"tail",null),g(this,"_length",0)}return(0,ZT.default)(e,[{key:"length",get:function(){return this._length}},{key:"add",value:function(t){var n=new KT(t,this.tail,null);return this.tail?(this.tail.next=n,this.tail=n):(this.head=n,this.tail=n),++this._length,n}},{key:"remove",value:function(t){t&&(t.previous&&t.next?(t.previous.next=t.next,t.next.previous=t.previous):t.previous?(t.previous.next=null,this.tail=t.previous):t.next?(t.next.previous=null,this.head=t.next):(this.head=null,this.tail=null),t.next=null,t.previous=null,--this._length)}},{key:"splice",value:function(t,n){t!==n&&(this.remove(n),this._insert(t,n))}},{key:"_insert",value:function(t,n){var a=t.next;t.next=n,this.tail===t?this.tail=n:a.previous=n,n.next=a,n.previous=t,++this._length}}]),e}();var tx=function(){function e(){(0,QT.default)(this,e),g(this,"_list",void 0),g(this,"_sentinel",void 0),g(this,"_trimTiles",void 0),this._list=new $T,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}return(0,ex.default)(e,[{key:"reset",value:function(){this._list.splice(this._list.tail,this._sentinel)}},{key:"touch",value:function(t){var n=t._cacheNode;n&&this._list.splice(this._sentinel,n)}},{key:"add",value:function(t,n,a){n._cacheNode||(n._cacheNode=this._list.add(n),a&&a(t,n))}},{key:"unloadTile",value:function(t,n,a){var i=n._cacheNode;i&&(this._list.remove(i),n._cacheNode=null,a&&a(t,n))}},{key:"unloadTiles",value:function(t,n){var a=this._trimTiles;this._trimTiles=!1;for(var i=this._list,o=t.maximumMemoryUsage*1024*1024,s=this._sentinel,u=i.head;u!==s&&(t.gpuMemoryUsageInBytes>o||a);){var f=u.item;u=u.next,this.unloadTile(t,f,n)}}},{key:"trim",value:function(){this._trimTiles=!0}}]),e}();function rx(e,r){se(e),se(r);var t=r.rtcCenter,n=r.gltfUpAxis,a=e.computedTransform,i=e.boundingVolume.center,o=new ee(a);switch(t&&o.translate(t),n){case"Z":break;case"Y":var s=new ee().rotateX(Math.PI/2);o=o.multiplyRight(s);break;case"X":var u=new ee().rotateY(-Math.PI/2);o=o.multiplyRight(u);break;default:break}r.isQuantized&&o.translate(r.quantizedVolumeOffset).scale(r.quantizedVolumeScale);var f=new S(i);r.cartesianModelMatrix=o,r.cartesianOrigin=f;var l=pe.WGS84.cartesianToCartographic(f,new S),c=pe.WGS84.eastNorthUpToFixedFrame(f),h=c.invert();r.cartographicModelMatrix=h.multiplyRight(o),r.cartographicOrigin=l,r.coordinateSystem||(r.modelMatrix=r.cartographicModelMatrix)}var $h=m(ie());function fk(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=lk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function lk(e,r){if(e){if(typeof e=="string")return nx(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return nx(e,r)}}function nx(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var ax=new S,Zh=new S,Qh=new yt([new Ue,new Ue,new Ue,new Ue,new Ue,new Ue]);function ox(e,r){var t=e.cameraDirection,n=e.cameraUp,a=e.height,i=e.distanceScales.metersPerUnit,o=Eu(e,e.center),s=pe.WGS84.eastNorthUpToFixedFrame(o),u=e.unprojectPosition(e.cameraPosition),f=pe.WGS84.cartographicToCartesian(u,new S),l=new S(s.transformAsVector(new S(t).scale(i))).normalize(),c=new S(s.transformAsVector(new S(n).scale(i))).normalize();ck(e);var h=e.constructor,d=e.longitude,p=e.latitude,v=e.width,y=e.bearing,A=e.zoom,_=new h({longitude:d,latitude:p,height:a,width:v,bearing:y,zoom:A,pitch:0});return{camera:{position:f,direction:l,up:c},viewport:e,topDownViewport:_,height:a,cullingVolume:Qh,frameNumber:r,sseDenominator:1.15}}function sx(e,r,t){if(t===0||e.length<=t)return[e,[]];var n=[],a=r.viewport,i=a.longitude,o=a.latitude,s=fk(e.entries()),u;try{for(s.s();!(u=s.n()).done;){var f=(0,$h.default)(u.value,2),l=f[0],c=f[1],h=(0,$h.default)(c.header.mbs,2),d=h[0],p=h[1],v=Math.abs(i-d),y=Math.abs(o-p),A=Math.sqrt(y*y+v*v);n.push([l,A])}}catch(F){s.e(F)}finally{s.f()}for(var _=n.sort(function(F,M){return F[1]-M[1]}),E=[],x=0;x<t;x++)E.push(e[_[x][0]]);for(var C=[],B=t;B<_.length;B++)C.push(e[_[B][0]]);return[E,C]}function ck(e){var r=e.getFrustumPlanes(),t=ix(r.near,e.cameraPosition),n=Eu(e,t),a=Eu(e,e.cameraPosition,Zh),i=0;Qh.planes[i++].fromPointNormal(n,ax.copy(n).subtract(a));for(var o in r)if(o!=="near"){var s=r[o],u=ix(s,t,Zh),f=Eu(e,u,Zh);Qh.planes[i++].fromPointNormal(f,ax.copy(n).subtract(f))}}function ix(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new S,n=e.normal.dot(r);return t.copy(e.normal).scale(e.distance-n).add(r),t}function Eu(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new S,n=e.unprojectPosition(r);return pe.WGS84.cartographicToCartesian(n,t)}var fx=m(ie());var hk=6378137,dk=6378137,ed=6356752314245179e-9,ux=new S;function lx(e,r){if(e instanceof Bn){var t=e.halfAxes,n=pk(t);return Math.log2(ed/(n+r[2]))}else if(e instanceof Vr){var a=e.radius;return Math.log2(ed/(a+r[2]))}else if(e.width&&e.height){var i=e.width,o=e.height,s=Math.log2(hk/i),u=Math.log2(dk/o);return(s+u)/2}return 1}function td(e,r,t){var n=pe.WGS84.cartographicToCartesian([e.xmax,e.ymax,e.zmax],new S),a=Math.sqrt(Math.pow(n[0]-t[0],2)+Math.pow(n[1]-t[1],2)+Math.pow(n[2]-t[2],2));return Math.log2(ed/(a+r[2]))}function cx(e,r,t){var n=(0,fx.default)(e,4),a=n[0],i=n[1],o=n[2],s=n[3];return td({xmin:a,xmax:o,ymin:i,ymax:s,zmin:0,zmax:0},r,t)}function pk(e){e.getColumn(0,ux);var r=e.getColumn(1),t=e.getColumn(2),n=ux.add(r).add(t),a=n.len();return a}var ud=m(W()),Fx=m(K()),Lx=m(H()),kx=m(z()),sd=m(Y());var Dx=m(La());var pt={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},At={ADD:1,REPLACE:2},Er={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},at={I3S:"I3S",TILES3D:"TILES3D"},Un={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},hx={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};var jn=m(st()),rd=m(ie());function px(e){return e!=null}var it=new S,Su=new S,mk=new S,vk=new S;function wu(e,r,t){if(se(e,"3D Tile: boundingVolume must be defined"),e.box)return gk(e.box,r,t);if(e.region){var n=(0,rd.default)(e.region,6),a=n[0],i=n[1],o=n[2],s=n[3],u=n[4],f=n[5],l=pe.WGS84.cartographicToCartesian([Vt(a),Vt(s),u],mk),c=pe.WGS84.cartographicToCartesian([Vt(o),Vt(i),f],vk),h=new S().addVectors(l,c).multiplyScalar(.5),d=new S().subVectors(l,c).len()/2;return dx([h[0],h[1],h[2],d],new ee)}if(e.sphere)return dx(e.sphere,r,t);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function mx(e,r){if(e.box)return yk(r);if(e.region){var t=(0,rd.default)(e.region,6),n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5];return[[Vt(n),Vt(a),s],[Vt(i),Vt(o),u]]}if(e.sphere)return Ak(r);throw new Error("Unkown boundingVolume type")}function gk(e,r,t){var n=new S(e[0],e[1],e[2]);r.transform(n,n);var a=[];if(e.length===10){var i=e.slice(3,6),o=new Hr;o.fromArray(e,6);var s=new S([1,0,0]),u=new S([0,1,0]),f=new S([0,0,1]);s.transformByQuaternion(o),s.scale(i[0]),u.transformByQuaternion(o),u.scale(i[1]),f.transformByQuaternion(o),f.scale(i[2]),a=[].concat((0,jn.default)(s.toArray()),(0,jn.default)(u.toArray()),(0,jn.default)(f.toArray()))}else a=[].concat((0,jn.default)(e.slice(3,6)),(0,jn.default)(e.slice(6,9)),(0,jn.default)(e.slice(9,12)));var l=r.transformAsVector(a.slice(0,3)),c=r.transformAsVector(a.slice(3,6)),h=r.transformAsVector(a.slice(6,9)),d=new _e([l[0],l[1],l[2],c[0],c[1],c[2],h[0],h[1],h[2]]);return px(t)?(t.center=n,t.halfAxes=d,t):new Bn(n,d)}function dx(e,r,t){var n=new S(e[0],e[1],e[2]);r.transform(n,n);var a=r.getScale(Su),i=Math.max(Math.max(a[0],a[1]),a[2]),o=e[3]*i;return px(t)?(t.center=n,t.radius=o,t):new Vr(n,o)}function yk(e){for(var r=vx(),t=e.halfAxes,n=new S(t.getColumn(0)),a=new S(t.getColumn(1)),i=new S(t.getColumn(2)),o=0;o<2;o++){for(var s=0;s<2;s++){for(var u=0;u<2;u++)it.copy(e.center),it.add(n),it.add(a),it.add(i),gx(r,it),i.negate();a.negate()}n.negate()}return r}function Ak(e){var r=vx(),t=e.center,n=e.radius,a=pe.WGS84.scaleToGeodeticSurface(t,it),i;a?i=pe.WGS84.geodeticSurfaceNormal(a):i=new S(0,0,1);var o=new S(i[2],-i[1],0);o.len()>0?o.normalize():o=new S(0,1,0);for(var s=o.clone().cross(i),u=0,f=[o,s,i];u<f.length;u++){var l=f[u];Su.copy(l).scale(n);for(var c=0;c<2;c++)it.copy(t),it.add(Su),gx(r,it),Su.negate()}return r}function vx(){return[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]]}function gx(e,r){pe.WGS84.cartesianToCartographic(r,it),e[0][0]=Math.min(e[0][0],it[0]),e[0][1]=Math.min(e[0][1],it[1]),e[0][2]=Math.min(e[0][2],it[2]),e[1][0]=Math.max(e[1][0],it[0]),e[1][1]=Math.max(e[1][1],it[1]),e[1][2]=Math.max(e[1][2],it[2])}var MZ=new S,OZ=new S,PZ=new ee,IZ=new S,RZ=new S,FZ=new S;function _k(e,r){var t=e*r;return 1-Math.exp(-(t*t))}function bk(e,r){if(e.dynamicScreenSpaceError&&e.dynamicScreenSpaceErrorComputedDensity){var t=e.dynamicScreenSpaceErrorComputedDensity,n=e.dynamicScreenSpaceErrorFactor,a=_k(r,t)*n;return a}return 0}function yx(e,r,t){var n=e.tileset,a=e.parent&&e.parent.lodMetricValue||e.lodMetricValue,i=t?a:e.lodMetricValue;if(i===0)return 0;var o=Math.max(e._distanceToCamera,1e-7),s=r.height,u=r.sseDenominator,f=n.options.viewDistanceScale,l=i*s*(f||1)/(o*u);return l-=bk(n,o),l}var Tx=m(st());var nd=new S,Ax=new S,en=new S,_x=new S,Tk=new S,ad=new ee,bx=new ee;function xx(e,r){if(e.lodMetricValue===0||isNaN(e.lodMetricValue))return"DIG";var t=2*id(e,r);return t<2?"OUT":!e.header.children||t<=e.lodMetricValue?"DRAW":e.header.children?"DIG":"OUT"}function id(e,r){var t=r.topDownViewport,n=e.header.mbs[1],a=e.header.mbs[0],i=e.header.mbs[2],o=e.header.mbs[3],s=(0,Tx.default)(e.boundingVolume.center),u=t.unprojectPosition(t.cameraPosition);pe.WGS84.cartographicToCartesian(u,nd),Ax.copy(nd).subtract(s).normalize(),pe.WGS84.eastNorthUpToFixedFrame(s,ad),bx.copy(ad).invert(),en.copy(nd).transform(bx);var f=Math.sqrt(en[0]*en[0]+en[1]*en[1]),l=f*f/en[2];_x.copy([en[0],en[1],l]);var c=_x.transform(ad),h=c.subtract(s).normalize(),d=Ax.cross(h).normalize().scale(o),p=d.add(s),v=pe.WGS84.cartesianToCartographic(p),y=t.project([a,n,i]),A=t.project(v),_=Tk.copy(y).subtract(A).magnitude();return _}function Ex(e){return{assetGltfUpAxis:e.asset&&e.asset.gltfUpAxis||"Y"}}var Mx=m(W()),Ox=m(H()),Px=m(z());var Sx=m(H()),wx=m(z());var od=function(){function e(){(0,Sx.default)(this,e);var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;g(this,"_map",new Map),g(this,"_array",void 0),g(this,"_length",void 0),this._array=new Array(r),this._length=r}return(0,wx.default)(e,[{key:"length",get:function(){return this._length},set:function(t){this._length=t,t>this._array.length&&(this._array.length=t)}},{key:"values",get:function(){return this._array}},{key:"get",value:function(t){return se(t<this._array.length),this._array[t]}},{key:"set",value:function(t,n){se(t>=0),t>=this.length&&(this.length=t+1),this._map.has(this._array[t])&&this._map.delete(this._array[t]),this._array[t]=n,this._map.set(n,t)}},{key:"delete",value:function(t){var n=this._map.get(t);n>=0&&(this._array.splice(n,1),this._map.delete(t),this.length--)}},{key:"peek",value:function(){return this._array[this._length-1]}},{key:"push",value:function(t){if(!this._map.has(t)){var n=this.length++;this._array[n]=t,this._map.set(t,n)}}},{key:"pop",value:function(){var t=this._array[--this.length];return this._map.delete(t),t}},{key:"reserve",value:function(t){se(t>=0),t>this._array.length&&(this._array.length=t)}},{key:"resize",value:function(t){se(t>=0),this.length=t}},{key:"trim",value:function(t){t==null&&(t=this.length),this._array.length=t}},{key:"reset",value:function(){this._array=[],this._map=new Map,this._length=0}},{key:"find",value:function(t){return this._map.has(t)}}]),e}();function Cu(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=xk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function xk(e,r){if(e){if(typeof e=="string")return Cx(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Cx(e,r)}}function Cx(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Bx(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Bu(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Bx(Object(t),!0).forEach(function(n){(0,Mx.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Bx(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Ek={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:function(){},viewportTraversersMap:{},basePath:""},tn=function(){function e(r){(0,Ox.default)(this,e),g(this,"options",void 0),g(this,"root",null),g(this,"selectedTiles",{}),g(this,"requestedTiles",{}),g(this,"emptyTiles",{}),g(this,"lastUpdate",new Date().getTime()),g(this,"updateDebounceTime",1e3),g(this,"_traversalStack",new od),g(this,"_emptyTraversalStack",new od),g(this,"_frameNumber",null),this.options=Bu(Bu({},Ek),r)}return(0,Px.default)(e,[{key:"traversalFinished",value:function(t){return!0}},{key:"traverse",value:function(t,n,a){this.root=t,this.options=Bu(Bu({},this.options),a),this.reset(),this.updateTile(t,n),this._frameNumber=n.frameNumber,this.executeTraversal(t,n)}},{key:"reset",value:function(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}},{key:"executeTraversal",value:function(t,n){var a=this._traversalStack;for(t._selectionDepth=1,a.push(t);a.length>0;){var i=a.pop(),o=!1;this.canTraverse(i,n)&&(this.updateChildTiles(i,n),o=this.updateAndPushChildren(i,n,a,i.hasRenderContent?i._selectionDepth+1:i._selectionDepth));var s=i.parent,u=Boolean(!s||s._shouldRefine),f=!o;i.hasRenderContent?i.refine===At.ADD?(this.loadTile(i,n),this.selectTile(i,n)):i.refine===At.REPLACE&&(this.loadTile(i,n),f&&this.selectTile(i,n)):(this.emptyTiles[i.id]=i,this.loadTile(i,n),f&&this.selectTile(i,n)),this.touchTile(i,n),i._shouldRefine=o&&u}var l=new Date().getTime();(this.traversalFinished(n)||l-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=l,this.options.onTraversalEnd(n))}},{key:"updateChildTiles",value:function(t,n){var a=t.children,i=Cu(a),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;this.updateTile(s,n)}}catch(u){i.e(u)}finally{i.f()}}},{key:"updateAndPushChildren",value:function(t,n,a,i){var o=this.options,s=o.loadSiblings,u=o.skipLevelOfDetail,f=t.children;f.sort(this.compareDistanceToCamera.bind(this));var l=t.refine===At.REPLACE&&t.hasRenderContent&&!u,c=!1,h=!0,d=Cu(f),p;try{for(d.s();!(p=d.n()).done;){var v=p.value;if(v._selectionDepth=i,v.isVisibleAndInRequestVolume?(a.find(v)&&a.delete(v),a.push(v),c=!0):(l||s)&&(this.loadTile(v,n),this.touchTile(v,n)),l){var y=void 0;if(v._inRequestVolume?v.hasRenderContent?y=v.contentAvailable:y=this.executeEmptyTraversal(v,n):y=!1,h=h&&y,!h)return!1}}}catch(A){d.e(A)}finally{d.f()}return c||(h=!1),h}},{key:"updateTile",value:function(t,n){this.updateTileVisibility(t,n)}},{key:"selectTile",value:function(t,n){this.shouldSelectTile(t)&&(t._selectedFrame=n.frameNumber,this.selectedTiles[t.id]=t)}},{key:"loadTile",value:function(t,n){this.shouldLoadTile(t)&&(t._requestedFrame=n.frameNumber,t._priority=t._getPriority(),this.requestedTiles[t.id]=t)}},{key:"touchTile",value:function(t,n){t.tileset._cache.touch(t),t._touchedFrame=n.frameNumber}},{key:"canTraverse",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return t.hasChildren?t.hasTilesetContent?!t.contentExpired:!i&&!t.isVisibleAndInRequestVolume?!1:this.shouldRefine(t,n,a):!1}},{key:"shouldLoadTile",value:function(t){return t.hasUnloadedContent||t.contentExpired}},{key:"shouldSelectTile",value:function(t){return t.contentAvailable&&!this.options.skipLevelOfDetail}},{key:"shouldRefine",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=t._screenSpaceError;return a&&(i=t.getScreenSpaceError(n,!0)),i>this.options.maximumScreenSpaceError}},{key:"updateTileVisibility",value:function(t,n){var a=[];if(this.options.viewportTraversersMap)for(var i in this.options.viewportTraversersMap){var o=this.options.viewportTraversersMap[i];o===n.viewport.id&&a.push(i)}else a.push(n.viewport.id);t.updateVisibility(n,a)}},{key:"compareDistanceToCamera",value:function(t,n){return t._distanceToCamera-n._distanceToCamera}},{key:"anyChildrenVisible",value:function(t,n){var a=!1,i=Cu(t.children),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;s.updateVisibility(n),a=a||s.isVisibleAndInRequestVolume}}catch(u){i.e(u)}finally{i.f()}return a}},{key:"executeEmptyTraversal",value:function(t,n){var a=!0,i=this._emptyTraversalStack;for(i.push(t);i.length>0&&a;){var o=i.pop();this.updateTile(o,n),o.isVisibleAndInRequestVolume||this.loadTile(o,n),this.touchTile(o,n);var s=!o.hasRenderContent&&this.canTraverse(o,n,!1,!0);if(s){var u=o.children,f=Cu(u),l;try{for(f.s();!(l=f.n()).done;){var c=l.value;i.find(c)&&i.delete(c),i.push(c)}}catch(h){f.e(h)}finally{f.f()}}else o.contentAvailable||(a=!1)}return a}}]),e}();function Ix(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Ga(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Ix(Object(t),!0).forEach(function(n){(0,ud.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ix(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Rx=new S;function Sk(e){return e!=null}var ao=function(){function e(r,t,n){(0,Lx.default)(this,e);var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"";g(this,"tileset",void 0),g(this,"header",void 0),g(this,"id",void 0),g(this,"url",void 0),g(this,"parent",void 0),g(this,"refine",void 0),g(this,"type",void 0),g(this,"contentUrl",void 0),g(this,"lodMetricType","geometricError"),g(this,"lodMetricValue",0),g(this,"boundingVolume",null),g(this,"content",null),g(this,"contentState",pt.UNLOADED),g(this,"gpuMemoryUsageInBytes",0),g(this,"children",[]),g(this,"depth",0),g(this,"viewportIds",[]),g(this,"transform",new ee),g(this,"extensions",null),g(this,"implicitTiling",null),g(this,"userData",{}),g(this,"computedTransform",void 0),g(this,"hasEmptyContent",!1),g(this,"hasTilesetContent",!1),g(this,"traverser",new tn({})),g(this,"_cacheNode",null),g(this,"_frameNumber",null),g(this,"_expireDate",null),g(this,"_expiredContent",null),g(this,"_boundingBox",void 0),g(this,"_distanceToCamera",0),g(this,"_screenSpaceError",0),g(this,"_visibilityPlaneMask",void 0),g(this,"_visible",void 0),g(this,"_contentBoundingVolume",void 0),g(this,"_viewerRequestVolume",void 0),g(this,"_initialTransform",new ee),g(this,"_priority",0),g(this,"_selectedFrame",0),g(this,"_requestedFrame",0),g(this,"_selectionDepth",0),g(this,"_touchedFrame",0),g(this,"_centerZDepth",0),g(this,"_shouldRefine",!1),g(this,"_stackLength",0),g(this,"_visitedFrame",0),g(this,"_inRequestVolume",!1),g(this,"_lodJudge",null),this.header=t,this.tileset=r,this.id=a||t.id,this.url=t.url,this.parent=n,this.refine=this._getRefine(t.refine),this.type=t.type,this.contentUrl=t.contentUrl,this._initializeLodMetric(t),this._initializeTransforms(t),this._initializeBoundingVolumes(t),this._initializeContent(t),this._initializeRenderingState(t),Object.seal(this)}return(0,kx.default)(e,[{key:"destroy",value:function(){this.header=null}},{key:"isDestroyed",value:function(){return this.header===null}},{key:"selected",get:function(){return this._selectedFrame===this.tileset._frameNumber}},{key:"isVisible",get:function(){return this._visible}},{key:"isVisibleAndInRequestVolume",get:function(){return this._visible&&this._inRequestVolume}},{key:"hasRenderContent",get:function(){return!this.hasEmptyContent&&!this.hasTilesetContent}},{key:"hasChildren",get:function(){return this.children.length>0||this.header.children&&this.header.children.length>0}},{key:"contentReady",get:function(){return this.contentState===pt.READY||this.hasEmptyContent}},{key:"contentAvailable",get:function(){return Boolean(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}},{key:"hasUnloadedContent",get:function(){return this.hasRenderContent&&this.contentUnloaded}},{key:"contentUnloaded",get:function(){return this.contentState===pt.UNLOADED}},{key:"contentExpired",get:function(){return this.contentState===pt.EXPIRED}},{key:"contentFailed",get:function(){return this.contentState===pt.FAILED}},{key:"distanceToCamera",get:function(){return this._distanceToCamera}},{key:"screenSpaceError",get:function(){return this._screenSpaceError}},{key:"boundingBox",get:function(){return this._boundingBox||(this._boundingBox=mx(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}},{key:"getScreenSpaceError",value:function(t,n){switch(this.tileset.type){case at.I3S:return id(this,t);case at.TILES3D:return yx(this,t,n);default:throw new Error("Unsupported tileset type")}}},{key:"unselect",value:function(){this._selectedFrame=0}},{key:"_getGpuMemoryUsageInBytes",value:function(){return this.content.gpuMemoryUsageInBytes||this.content.byteLength||0}},{key:"_getPriority",value:function(){var t=this.tileset._traverser,n=t.options.skipLevelOfDetail,a=this.refine===At.ADD||n;if(a&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===pt.UNLOADED)return-1;var i=this.parent,o=i&&(!a||this._screenSpaceError===0||i.hasTilesetContent),s=o?i._screenSpaceError:this._screenSpaceError,u=t.root?t.root._screenSpaceError:0;return Math.max(u-s,0)}},{key:"loadContent",value:function(){var r=(0,Fx.default)(sd.default.mark(function n(){var a,i,o,s,u;return sd.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!this.hasEmptyContent){l.next=2;break}return l.abrupt("return",!1);case 2:if(!this.content){l.next=4;break}return l.abrupt("return",!0);case 4:return a=this.contentExpired,a&&(this._expireDate=null),this.contentState=pt.LOADING,l.next=9,this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));case 9:if(i=l.sent,i){l.next=13;break}return this.contentState=pt.UNLOADED,l.abrupt("return",!1);case 13:return l.prev=13,o=this.tileset.getTileUrl(this.contentUrl),s=this.tileset.loader,u=Ga(Ga({},this.tileset.loadOptions),{},(0,ud.default)({},s.id,Ga(Ga({},this.tileset.loadOptions[s.id]),{},{isTileset:this.type==="json"},this._getLoaderSpecificOptions(s.id)))),l.next=19,(0,Dx.load)(o,s,u);case 19:if(this.content=l.sent,!this.tileset.options.contentLoader){l.next=23;break}return l.next=23,this.tileset.options.contentLoader(this);case 23:return this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=pt.READY,this._onContentLoaded(),l.abrupt("return",!0);case 29:throw l.prev=29,l.t0=l.catch(13),this.contentState=pt.FAILED,l.t0;case 33:return l.prev=33,i.done(),l.finish(33);case 36:case"end":return l.stop()}},n,this,[[13,29,33,36]])}));function t(){return r.apply(this,arguments)}return t}()},{key:"unloadContent",value:function(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=pt.UNLOADED,!0}},{key:"updateVisibility",value:function(t,n){if(this._frameNumber!==t.frameNumber){var a=this.parent,i=a?a._visibilityPlaneMask:yt.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){var o=a?a.computedTransform:this.tileset.modelMatrix;this._updateTransform(o)}this._distanceToCamera=this.distanceToTile(t),this._screenSpaceError=this.getScreenSpaceError(t,!1),this._visibilityPlaneMask=this.visibility(t,i),this._visible=this._visibilityPlaneMask!==yt.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(t),this._frameNumber=t.frameNumber,this.viewportIds=n}}},{key:"visibility",value:function(t,n){var a=t.cullingVolume,i=this.boundingVolume;return a.computeVisibilityWithPlaneMask(i,n)}},{key:"contentVisibility",value:function(){return!0}},{key:"distanceToTile",value:function(t){var n=this.boundingVolume;return Math.sqrt(Math.max(n.distanceSquaredTo(t.camera.position),0))}},{key:"cameraSpaceZDepth",value:function(t){var n=t.camera,a=this.boundingVolume;return Rx.subVectors(a.center,n.position),n.direction.dot(Rx)}},{key:"insideViewerRequestVolume",value:function(t){var n=this._viewerRequestVolume;return!n||n.distanceSquaredTo(t.camera.position)<=0}},{key:"updateExpiration",value:function(){if(Sk(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){var t=Date.now();Date.lessThan(this._expireDate,t)&&(this.contentState=pt.EXPIRED,this._expiredContent=this.content)}}},{key:"extras",get:function(){return this.header.extras}},{key:"_initializeLodMetric",value:function(t){"lodMetricType"in t?this.lodMetricType=t.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in t?this.lodMetricValue=t.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}},{key:"_initializeTransforms",value:function(t){this.transform=t.transform?new ee(t.transform):new ee;var n=this.parent,a=this.tileset,i=n&&n.computedTransform?n.computedTransform.clone():a.modelMatrix.clone();this.computedTransform=new ee(i).multiplyRight(this.transform);var o=n&&n._initialTransform?n._initialTransform.clone():new ee;this._initialTransform=new ee(o).multiplyRight(this.transform)}},{key:"_initializeBoundingVolumes",value:function(t){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(t)}},{key:"_initializeContent",value:function(t){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=pt.UNLOADED,this.hasTilesetContent=!1,t.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}},{key:"_initializeRenderingState",value:function(t){this.depth=t.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=yt.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}},{key:"_getRefine",value:function(t){return t||this.parent&&this.parent.refine||At.REPLACE}},{key:"_isTileset",value:function(){return this.contentUrl.indexOf(".json")!==-1}},{key:"_onContentLoaded",value:function(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break;default:}this._isTileset()?this.hasTilesetContent=!0:this.gpuMemoryUsageInBytes=this._getGpuMemoryUsageInBytes()}},{key:"_updateBoundingVolume",value:function(t){this.boundingVolume=wu(t.boundingVolume,this.computedTransform,this.boundingVolume);var n=t.content;n&&(n.boundingVolume&&(this._contentBoundingVolume=wu(n.boundingVolume,this.computedTransform,this._contentBoundingVolume)),t.viewerRequestVolume&&(this._viewerRequestVolume=wu(t.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}},{key:"_updateTransform",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new ee,n=t.clone().multiplyRight(this.transform),a=!n.equals(this.computedTransform);a&&(this.computedTransform=n,this._updateBoundingVolume(this.header))}},{key:"_getLoaderSpecificOptions",value:function(t){switch(t){case"i3s":return Ga(Ga({},this.tileset.options.i3s),{},{_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1});case"3d-tiles":case"cesium-ion":default:return Ex(this.tileset.tileset)}}}]),e}();var Gx=m(H()),Nx=m(z()),Ux=m(dn()),jx=m(Te()),Hx=m(xe()),Mu=m(be());function wk(e){var r=Ck();return function(){var n=(0,Mu.default)(e),a;if(r){var i=(0,Mu.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,Hx.default)(this,a)}}function Ck(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Vx=function(e){(0,jx.default)(t,e);var r=wk(t);function t(){return(0,Gx.default)(this,t),r.apply(this,arguments)}return(0,Nx.default)(t,[{key:"compareDistanceToCamera",value:function(a,i){return i._distanceToCamera===0&&a._distanceToCamera===0?i._centerZDepth-a._centerZDepth:i._distanceToCamera-a._distanceToCamera}},{key:"updateTileVisibility",value:function(a,i){if((0,Ux.default)((0,Mu.default)(t.prototype),"updateTileVisibility",this).call(this,a,i),!!a.isVisibleAndInRequestVolume){var o=a.children.length>0;if(a.hasTilesetContent&&o){var s=a.children[0];this.updateTileVisibility(s,i),a._visible=s._visible;return}if(this.meetsScreenSpaceErrorEarly(a,i)){a._visible=!1;return}var u=a.refine===At.REPLACE,f=a._optimChildrenWithinParent===hx.USE_OPTIMIZATION;if(u&&f&&o&&!this.anyChildrenVisible(a,i)){a._visible=!1;return}}}},{key:"meetsScreenSpaceErrorEarly",value:function(a,i){var o=a.parent;return!o||o.hasTilesetContent||o.refine!==At.ADD?!1:!this.shouldRefine(a,i,!0)}}]),t}(tn);var $x=m(W()),Qx=m(K()),eE=m(H()),tE=m(z()),rE=m(wt()),nE=m(Te()),aE=m(xe()),ld=m(be()),cd=m(Y());var iE=m(La());var Jx=m(H()),Xx=m(z());var zx=m(H()),Wx=m(z());var qx=function(){function e(){(0,zx.default)(this,e),g(this,"frameNumberMap",new Map)}return(0,Wx.default)(e,[{key:"register",value:function(t,n){var a=this.frameNumberMap.get(t)||new Map,i=a.get(n)||0;a.set(n,i+1),this.frameNumberMap.set(t,a)}},{key:"deregister",value:function(t,n){var a=this.frameNumberMap.get(t);if(a){var i=a.get(n)||1;a.set(n,i-1)}}},{key:"isZero",value:function(t,n){var a,i=((a=this.frameNumberMap.get(t))===null||a===void 0?void 0:a.get(n))||0;return i===0}}]),e}();var fd={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"},Kx=function(){function e(){(0,Jx.default)(this,e),g(this,"_statusMap",void 0),g(this,"pendingTilesRegister",new qx),this._statusMap={}}return(0,Xx.default)(e,[{key:"add",value:function(t,n,a,i){var o=this;if(!this._statusMap[n]){var s=i.frameNumber,u=i.viewport.id;this._statusMap[n]={request:t,callback:a,key:n,frameState:i,status:fd.REQUESTED},this.pendingTilesRegister.register(u,s),t().then(function(f){o._statusMap[n].status=fd.COMPLETED;var l=o._statusMap[n].frameState,c=l.frameNumber,h=l.viewport.id;o.pendingTilesRegister.deregister(h,c),o._statusMap[n].callback(f,i)}).catch(function(f){o._statusMap[n].status=fd.ERROR;var l=o._statusMap[n].frameState,c=l.frameNumber,h=l.viewport.id;o.pendingTilesRegister.deregister(h,c),a(f)})}}},{key:"update",value:function(t,n){if(this._statusMap[t]){var a=this._statusMap[t].frameState,i=a.frameNumber,o=a.viewport.id;this.pendingTilesRegister.deregister(o,i);var s=n.frameNumber,u=n.viewport.id;this.pendingTilesRegister.register(u,s),this._statusMap[t].frameState=n}}},{key:"find",value:function(t){return this._statusMap[t]}},{key:"hasPendingTiles",value:function(t,n){return!this.pendingTilesRegister.isZero(t,n)}}]),e}();function Yx(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Ou(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Yx(Object(t),!0).forEach(function(n){(0,$x.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Yx(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Bk(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Mk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function Mk(e,r){if(e){if(typeof e=="string")return Zx(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Zx(e,r)}}function Zx(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Ok(e){var r=Pk();return function(){var n=(0,ld.default)(e),a;if(r){var i=(0,ld.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,aE.default)(this,a)}}function Pk(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var oE=function(e){(0,nE.default)(t,e);var r=Ok(t);function t(n){var a;return(0,eE.default)(this,t),a=r.call(this,n),g((0,rE.default)(a),"_tileManager",void 0),a._tileManager=new Kx,a}return(0,tE.default)(t,[{key:"traversalFinished",value:function(a){return!this._tileManager.hasPendingTiles(a.viewport.id,this._frameNumber||0)}},{key:"shouldRefine",value:function(a,i){return a._lodJudge=xx(a,i),a._lodJudge==="DIG"}},{key:"updateChildTiles",value:function(a,i){var o=this,s=a.header.children||[],u=a.children,f=a.tileset,l=Bk(s),c;try{var h=function(){var p=c.value,v="".concat(p.id,"-").concat(i.viewport.id),y=u&&u.find(function(E){return E.id===v});if(y)y&&o.updateTile(y,i);else{var A=function(){return o._loadTile(p.id,f)},_=o._tileManager.find(v);_?o._tileManager.update(v,i):(f.tileset.nodePages&&(A=function(){return f.tileset.nodePagesTile.formTileFromNodePages(p.id)}),o._tileManager.add(A,v,function(E){return o._onTileLoad(E,a,v)},i))}};for(l.s();!(c=l.n()).done;)h()}catch(d){l.e(d)}finally{l.f()}return!1}},{key:"_loadTile",value:function(){var n=(0,Qx.default)(cd.default.mark(function i(o,s){var u,f,l;return cd.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return u=s.loader,f=s.getTileUrl("".concat(s.url,"/nodes/").concat(o)),l=Ou(Ou({},s.loadOptions),{},{i3s:Ou(Ou({},s.loadOptions.i3s),{},{isTileHeader:!0})}),h.next=5,(0,iE.load)(f,u,l);case 5:return h.abrupt("return",h.sent);case 6:case"end":return h.stop()}},i)}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"_onTileLoad",value:function(a,i,o){var s=new ao(i.tileset,a,i,o);i.children.push(s);var u=this._tileManager.find(s.id).frameState;this.updateTile(s,u),this._frameNumber===u.frameNumber&&(this.traversalFinished(u)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(s,u)}}]),t}(tn);function Sr(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Ik(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function Ik(e,r){if(e){if(typeof e=="string")return sE(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return sE(e,r)}}function sE(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function uE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function rn(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?uE(Object(t),!0).forEach(function(n){(0,mE.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):uE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Rk={description:"",ellipsoid:pe.WGS84,modelMatrix:new ee,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,maximumTilesSelected:0,debounceTime:0,onTileLoad:function(){},onTileUnload:function(){},onTileError:function(){},onTraversalComplete:function(r){return r},contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},Pu="Tiles In Tileset(s)",hd="Tiles In Memory",fE="Tiles In View",lE="Tiles To Render",cE="Tiles Loaded",dd="Tiles Loading",hE="Tiles Unloaded",dE="Failed Tile Loads",pE="Points/Vertices",pd="Tile Memory Use",vd=function(){function e(r,t){(0,vE.default)(this,e),g(this,"options",void 0),g(this,"loadOptions",void 0),g(this,"type",void 0),g(this,"tileset",void 0),g(this,"loader",void 0),g(this,"url",void 0),g(this,"basePath",void 0),g(this,"modelMatrix",void 0),g(this,"ellipsoid",void 0),g(this,"lodMetricType",void 0),g(this,"lodMetricValue",void 0),g(this,"refine",void 0),g(this,"root",null),g(this,"roots",{}),g(this,"asset",{}),g(this,"description",""),g(this,"properties",void 0),g(this,"extras",null),g(this,"attributions",{}),g(this,"credits",{}),g(this,"stats",void 0),g(this,"contentFormats",{draco:!1,meshopt:!1,dds:!1,ktx2:!1}),g(this,"cartographicCenter",null),g(this,"cartesianCenter",null),g(this,"zoom",1),g(this,"boundingVolume",null),g(this,"dynamicScreenSpaceErrorComputedDensity",0),g(this,"maximumMemoryUsage",32),g(this,"gpuMemoryUsageInBytes",0),g(this,"_frameNumber",0),g(this,"_queryParams",{}),g(this,"_extensionsUsed",[]),g(this,"_tiles",{}),g(this,"_pendingCount",0),g(this,"selectedTiles",[]),g(this,"traverseCounter",0),g(this,"geometricError",0),g(this,"lastUpdatedVieports",null),g(this,"_requestedTiles",[]),g(this,"_emptyTiles",[]),g(this,"frameStateData",{}),g(this,"_traverser",void 0),g(this,"_cache",new tx),g(this,"_requestScheduler",void 0),g(this,"updatePromise",null),g(this,"tilesetInitializationPromise",void 0),this.options=rn(rn({},Rk),t),this.tileset=r,this.loader=r.loader,this.type=r.type,this.url=r.url,this.basePath=r.basePath||fa.dirname(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=r.lodMetricType,this.lodMetricValue=r.lodMetricValue,this.refine=r.root.refine,this.loadOptions=this.options.loadOptions||{},this._traverser=this._initializeTraverser(),this._requestScheduler=new di({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this.stats=new Da({id:this.url}),this._initializeStats(),this.tilesetInitializationPromise=this._initializeTileSet(r)}return(0,gE.default)(e,[{key:"destroy",value:function(){this._destroy()}},{key:"isLoaded",value:function(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}},{key:"tiles",get:function(){return Object.values(this._tiles)}},{key:"frameNumber",get:function(){return this._frameNumber}},{key:"queryParams",get:function(){return new URLSearchParams(this._queryParams).toString()}},{key:"setProps",value:function(t){this.options=rn(rn({},this.options),t)}},{key:"setOptions",value:function(t){this.options=rn(rn({},this.options),t)}},{key:"getTileUrl",value:function(t){var n=t.startsWith("data:");return n?t:"".concat(t).concat(t.includes("?")?"&":"?").concat(this.queryParams)}},{key:"hasExtension",value:function(t){return Boolean(this._extensionsUsed.indexOf(t)>-1)}},{key:"update",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.tilesetInitializationPromise.then(function(){!n&&t.lastUpdatedVieports?n=t.lastUpdatedVieports:t.lastUpdatedVieports=n,n&&t.doUpdate(n)})}},{key:"selectTiles",value:function(){var r=(0,Iu.default)(Hn.default.mark(function n(){var a=this,i,o=arguments;return Hn.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return i=o.length>0&&o[0]!==void 0?o[0]:null,u.next=3,this.tilesetInitializationPromise;case 3:return i&&(this.lastUpdatedVieports=i),this.updatePromise||(this.updatePromise=new Promise(function(f){setTimeout(function(){a.lastUpdatedVieports&&a.doUpdate(a.lastUpdatedVieports),f(a._frameNumber),a.updatePromise=null},a.options.debounceTime)})),u.abrupt("return",this.updatePromise);case 6:case"end":return u.stop()}},n,this)}));function t(){return r.apply(this,arguments)}return t}()},{key:"doUpdate",value:function(t){if(!("loadTiles"in this.options&&!this.options.loadTiles)&&!(this.traverseCounter>0)){var n=t instanceof Array?t:[t];this._cache.reset(),this._frameNumber++,this.traverseCounter=n.length;var a=[],i=Sr(n),o;try{for(i.s();!(o=i.n()).done;){var s=o.value,u=s.id;this._needTraverse(u)?a.push(u):this.traverseCounter--}}catch(p){i.e(p)}finally{i.f()}var f=Sr(n),l;try{for(f.s();!(l=f.n()).done;){var c=l.value,h=c.id;if(this.roots[h]||(this.roots[h]=this._initializeTileHeaders(this.tileset,null)),!!a.includes(h)){var d=ox(c,this._frameNumber);this._traverser.traverse(this.roots[h],d,this.options)}}}catch(p){f.e(p)}finally{f.f()}}}},{key:"_needTraverse",value:function(t){var n=t;return this.options.viewportTraversersMap&&(n=this.options.viewportTraversersMap[t]),n===t}},{key:"_onTraversalEnd",value:function(t){var n=t.viewport.id;this.frameStateData[n]||(this.frameStateData[n]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});var a=this.frameStateData[n],i=Object.values(this._traverser.selectedTiles),o=sx(i,t,this.options.maximumTilesSelected),s=(0,md.default)(o,2),u=s[0],f=s[1];a.selectedTiles=u;var l=Sr(f),c;try{for(l.s();!(c=l.n()).done;){var h=c.value;h.unselect()}}catch(d){l.e(d)}finally{l.f()}a._requestedTiles=Object.values(this._traverser.requestedTiles),a._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}},{key:"_updateTiles",value:function(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(var t in this.frameStateData){var n=this.frameStateData[t];this.selectedTiles=this.selectedTiles.concat(n.selectedTiles),this._requestedTiles=this._requestedTiles.concat(n._requestedTiles),this._emptyTiles=this._emptyTiles.concat(n._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);var a=Sr(this.selectedTiles),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;this._tiles[o.id]=o}}catch(s){a.e(s)}finally{a.f()}this._loadTiles(),this._unloadTiles(),this._updateStats()}},{key:"_tilesChanged",value:function(t,n){if(t.length!==n.length)return!0;var a=new Set(t.map(function(s){return s.id})),i=new Set(n.map(function(s){return s.id})),o=t.filter(function(s){return!i.has(s.id)}).length>0;return o=o||n.filter(function(s){return!a.has(s.id)}).length>0,o}},{key:"_loadTiles",value:function(){var t=Sr(this._requestedTiles),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;a.contentUnloaded&&this._loadTile(a)}}catch(i){t.e(i)}finally{t.f()}}},{key:"_unloadTiles",value:function(){this._cache.unloadTiles(this,function(t,n){return t._unloadTile(n)})}},{key:"_updateStats",value:function(){var t=0,n=0,a=Sr(this.selectedTiles),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;o.contentAvailable&&o.content&&(t++,o.content.pointCount?n+=o.content.pointCount:n+=o.content.vertexCount)}}catch(s){a.e(s)}finally{a.f()}this.stats.get(fE).count=this.selectedTiles.length,this.stats.get(lE).count=t,this.stats.get(pE).count=n}},{key:"_initializeTileSet",value:function(){var r=(0,Iu.default)(Hn.default.mark(function n(a){return Hn.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.type!==at.I3S){o.next=5;break}return this.calculateViewPropsI3S(),o.next=4,a.root;case 4:a.root=o.sent;case 5:this.root=this._initializeTileHeaders(a,null),this.type===at.TILES3D&&(this._initializeTiles3DTileset(a),this.calculateViewPropsTiles3D()),this.type===at.I3S&&this._initializeI3STileset();case 8:case"end":return o.stop()}},n,this)}));function t(n){return r.apply(this,arguments)}return t}()},{key:"calculateViewPropsI3S",value:function(){var t,n=this.tileset.fullExtent;if(n){var a=n.xmin,i=n.xmax,o=n.ymin,s=n.ymax,u=n.zmin,f=n.zmax;this.cartographicCenter=new S(a+(i-a)/2,o+(s-o)/2,u+(f-u)/2),this.cartesianCenter=pe.WGS84.cartographicToCartesian(this.cartographicCenter,new S),this.zoom=td(n,this.cartographicCenter,this.cartesianCenter);return}var l=(t=this.tileset.store)===null||t===void 0?void 0:t.extent;if(l){var c=(0,md.default)(l,4),h=c[0],d=c[1],p=c[2],v=c[3];this.cartographicCenter=new S(h+(p-h)/2,d+(v-d)/2,0),this.cartesianCenter=pe.WGS84.cartographicToCartesian(this.cartographicCenter,new S),this.zoom=cx(l,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new S,this.zoom=1}},{key:"calculateViewPropsTiles3D",value:function(){var t=this.root,n=t.boundingVolume.center;if(!n){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new S,this.zoom=1;return}n[0]!==0||n[1]!==0||n[2]!==0?this.cartographicCenter=pe.WGS84.cartesianToCartographic(n,new S):this.cartographicCenter=new S(0,0,-pe.WGS84.radii[0]),this.cartesianCenter=n,this.zoom=lx(t.boundingVolume,this.cartographicCenter)}},{key:"_initializeStats",value:function(){this.stats.get(Pu),this.stats.get(dd),this.stats.get(hd),this.stats.get(fE),this.stats.get(lE),this.stats.get(cE),this.stats.get(hE),this.stats.get(dE),this.stats.get(pE),this.stats.get(pd,"memory")}},{key:"_initializeTileHeaders",value:function(t,n){var a=new ao(this,t.root,n);if(n&&(n.children.push(a),a.depth=n.depth+1),this.type===at.TILES3D){var i=[];for(i.push(a);i.length>0;){var o=i.pop();this.stats.get(Pu).incrementCount();var s=o.header.children||[],u=Sr(s),f;try{for(u.s();!(f=u.n()).done;){var l=f.value,c,h=new ao(this,l,o);if((c=h.contentUrl)!==null&&c!==void 0&&c.includes("?session=")){var d=new URL(h.contentUrl),p=d.searchParams.get("session");p&&(this._queryParams.session=p)}o.children.push(h),h.depth=o.depth+1,i.push(h)}}catch(v){u.e(v)}finally{u.f()}}}return a}},{key:"_initializeTraverser",value:function(){var t,n=this.type;switch(n){case at.TILES3D:t=Vx;break;case at.I3S:t=oE;break;default:t=tn}return new t({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}},{key:"_destroyTileHeaders",value:function(t){this._destroySubtree(t)}},{key:"_loadTile",value:function(){var r=(0,Iu.default)(Hn.default.mark(function n(a){var i;return Hn.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,this._onStartTileLoading(),s.next=4,a.loadContent();case 4:i=s.sent,s.next=10;break;case 7:s.prev=7,s.t0=s.catch(0),this._onTileLoadError(a,s.t0 instanceof Error?s.t0:new Error("load failed"));case 10:return s.prev=10,this._onEndTileLoading(),this._onTileLoad(a,i),s.finish(10);case 14:case"end":return s.stop()}},n,this,[[0,7,10,14]])}));function t(n){return r.apply(this,arguments)}return t}()},{key:"_onTileLoadError",value:function(t,n){this.stats.get(dE).incrementCount();var a=n.message||n.toString(),i=t.url;console.error("A 3D tile failed to load: ".concat(t.url," ").concat(a)),this.options.onTileError(t,a,i)}},{key:"_onTileLoad",value:function(t,n){if(n){if(this.type===at.I3S){var a,i,o=((a=this.tileset)===null||a===void 0||(i=a.nodePagesTile)===null||i===void 0?void 0:i.nodesInNodePages)||0;this.stats.get(Pu).reset(),this.stats.get(Pu).addCount(o)}t&&t.content&&rx(t,t.content),this.updateContentTypes(t),this._addTileToCache(t),this.options.onTileLoad(t)}}},{key:"updateContentTypes",value:function(t){if(this.type===at.I3S)switch(t.header.isDracoGeometry&&(this.contentFormats.draco=!0),t.header.textureFormat){case"dds":this.contentFormats.dds=!0;break;case"ktx2":this.contentFormats.ktx2=!0;break;default:}else if(this.type===at.TILES3D){var n,a=((n=t.content)===null||n===void 0?void 0:n.gltf)||{},i=a.extensionsRemoved,o=i===void 0?[]:i;o.includes("KHR_draco_mesh_compression")&&(this.contentFormats.draco=!0),o.includes("EXT_meshopt_compression")&&(this.contentFormats.meshopt=!0),o.includes("KHR_texture_basisu")&&(this.contentFormats.ktx2=!0)}}},{key:"_onStartTileLoading",value:function(){this._pendingCount++,this.stats.get(dd).incrementCount()}},{key:"_onEndTileLoading",value:function(){this._pendingCount--,this.stats.get(dd).decrementCount()}},{key:"_addTileToCache",value:function(t){this._cache.add(this,t,function(n){return n._updateCacheStats(t)})}},{key:"_updateCacheStats",value:function(t){this.stats.get(cE).incrementCount(),this.stats.get(hd).incrementCount(),this.gpuMemoryUsageInBytes+=t.gpuMemoryUsageInBytes||0,this.stats.get(pd).count=this.gpuMemoryUsageInBytes}},{key:"_unloadTile",value:function(t){this.gpuMemoryUsageInBytes-=t.gpuMemoryUsageInBytes||0,this.stats.get(hd).decrementCount(),this.stats.get(hE).incrementCount(),this.stats.get(pd).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(t),t.unloadContent()}},{key:"_destroy",value:function(){var t=[];for(this.root&&t.push(this.root);t.length>0;){var n=t.pop(),a=Sr(n.children),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;t.push(o)}}catch(s){a.e(s)}finally{a.f()}this._destroyTile(n)}this.root=null}},{key:"_destroySubtree",value:function(t){var n=t,a=[];for(a.push(n);a.length>0;){t=a.pop();var i=Sr(t.children),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;a.push(s)}}catch(u){i.e(u)}finally{i.f()}t!==n&&this._destroyTile(t)}n.children=[]}},{key:"_destroyTile",value:function(t){this._cache.unloadTile(this,t),this._unloadTile(t),t.destroy()}},{key:"_initializeTiles3DTileset",value:function(t){if(t.queryString){var n=new URLSearchParams(t.queryString),a=Object.fromEntries(n.entries());this._queryParams=rn(rn({},this._queryParams),a)}if(this.asset=t.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0")throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=t.properties,this.geometricError=t.geometricError,this._extensionsUsed=t.extensionsUsed||[],this.extras=t.extras}},{key:"_initializeI3STileset",value:function(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}]),e}();var pf=m(K()),ra=m(Y());var Ru="3.4.2";var OC=m(K()),sm=m(Y());var Vn={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"},k$=Object.keys(Vn);function gd(e,r,t){se(e instanceof ArrayBuffer);var n=new TextDecoder("utf8"),a=new Uint8Array(e,r,t),i=n.decode(a);return i}function yE(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=new DataView(e);return"".concat(String.fromCharCode(t.getUint8(r+0))).concat(String.fromCharCode(t.getUint8(r+1))).concat(String.fromCharCode(t.getUint8(r+2))).concat(String.fromCharCode(t.getUint8(r+3)))}var zS=m(W()),Ku=m(K()),qn=m(Y());var xS=m(K()),ES=m(W()),Od=m(Y());var _E=m(Ge());var AE="3.4.2";var Fk={draco:{decoderType:(typeof WebAssembly>"u"?"undefined":(0,_E.default)(WebAssembly))==="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}},bE={name:"Draco",id:hr?"draco":"draco-nodejs",module:"draco",shapes:["mesh"],version:AE,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:Fk};var Sd=m(st()),cS=m(ie()),hS=m(W()),dS=m(H()),pS=m(z());function zn(e){for(var r=1/0,t=1/0,n=1/0,a=-1/0,i=-1/0,o=-1/0,s=e.POSITION?e.POSITION.value:[],u=s&&s.length,f=0;f<u;f+=3){var l=s[f],c=s[f+1],h=s[f+2];r=l<r?l:r,t=c<t?c:t,n=h<n?h:n,a=l>a?l:a,i=c>i?c:i,o=h>o?h:o}return[[r,t,n],[a,i,o]]}var yd=m(st()),SE=m(H()),wE=m(z());function TE(e,r){if(!e)throw new Error(r||"loader assertion failed.")}function Ad(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Lk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function Lk(e,r){if(e){if(typeof e=="string")return xE(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return xE(e,r)}}function xE(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var io=function(){function e(r,t){(0,SE.default)(this,e),g(this,"fields",void 0),g(this,"metadata",void 0),TE(Array.isArray(r)),kk(r),this.fields=r,this.metadata=t||new Map}return(0,wE.default)(e,[{key:"compareTo",value:function(t){if(this.metadata!==t.metadata||this.fields.length!==t.fields.length)return!1;for(var n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(t.fields[n]))return!1;return!0}},{key:"select",value:function(){for(var t=Object.create(null),n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];for(var o=0,s=a;o<s.length;o++){var u=s[o];t[u]=!0}var f=this.fields.filter(function(l){return t[l.name]});return new e(f,this.metadata)}},{key:"selectAt",value:function(){for(var t=this,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=a.map(function(s){return t.fields[s]}).filter(Boolean);return new e(o,this.metadata)}},{key:"assign",value:function(t){var n,a=this.metadata;if(t instanceof e){var i=t;n=i.fields,a=EE(EE(new Map,this.metadata),i.metadata)}else n=t;var o=Object.create(null),s=Ad(this.fields),u;try{for(s.s();!(u=s.n()).done;){var f=u.value;o[f.name]=f}}catch(p){s.e(p)}finally{s.f()}var l=Ad(n),c;try{for(l.s();!(c=l.n()).done;){var h=c.value;o[h.name]=h}}catch(p){l.e(p)}finally{l.f()}var d=Object.values(o);return new e(d,a)}}]),e}();function kk(e){var r={},t=Ad(e),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;r[a.name]&&console.warn("Schema: duplicated field name",a.name,a),r[a.name]=!0}}catch(i){t.e(i)}finally{t.f()}}function EE(e,r){return new Map([].concat((0,yd.default)(e||new Map),(0,yd.default)(r||new Map)))}var CE=m(H()),BE=m(z());var oo=function(){function e(r,t){(0,CE.default)(this,e);var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;g(this,"name",void 0),g(this,"type",void 0),g(this,"nullable",void 0),g(this,"metadata",void 0),this.name=r,this.type=t,this.nullable=n,this.metadata=a}return(0,BE.default)(e,[{key:"typeId",get:function(){return this.type&&this.type.typeId}},{key:"clone",value:function(){return new e(this.name,this.type,this.nullable,this.metadata)}},{key:"compareTo",value:function(t){return this.name===t.name&&this.type===t.type&&this.nullable===t.nullable&&this.metadata===t.metadata}},{key:"toString",value:function(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}]),e}();var Bt=m(wt()),ce=m(Te()),ME=m(xe()),_d=m(be()),fe=m(H()),_t=m(z());var me=function(e){return e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct=13]="Struct",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Dictionary=-1]="Dictionary",e[e.Int8=-2]="Int8",e[e.Int16=-3]="Int16",e[e.Int32=-4]="Int32",e[e.Int64=-5]="Int64",e[e.Uint8=-6]="Uint8",e[e.Uint16=-7]="Uint16",e[e.Uint32=-8]="Uint32",e[e.Uint64=-9]="Uint64",e[e.Float16=-10]="Float16",e[e.Float32=-11]="Float32",e[e.Float64=-12]="Float64",e[e.DateDay=-13]="DateDay",e[e.DateMillisecond=-14]="DateMillisecond",e[e.TimestampSecond=-15]="TimestampSecond",e[e.TimestampMillisecond=-16]="TimestampMillisecond",e[e.TimestampMicrosecond=-17]="TimestampMicrosecond",e[e.TimestampNanosecond=-18]="TimestampNanosecond",e[e.TimeSecond=-19]="TimeSecond",e[e.TimeMillisecond=-20]="TimeMillisecond",e[e.TimeMicrosecond=-21]="TimeMicrosecond",e[e.TimeNanosecond=-22]="TimeNanosecond",e[e.DenseUnion=-23]="DenseUnion",e[e.SparseUnion=-24]="SparseUnion",e[e.IntervalDayTime=-25]="IntervalDayTime",e[e.IntervalYearMonth=-26]="IntervalYearMonth",e}({});function de(e){var r=Dk();return function(){var n=(0,_d.default)(e),a;if(r){var i=(0,_d.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,ME.default)(this,a)}}function Dk(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var OE,PE,IE,RE,FE,LE,kE,DE,bt=function(){function e(){(0,fe.default)(this,e)}return(0,_t.default)(e,[{key:"typeId",get:function(){return me.NONE}},{key:"compareTo",value:function(t){return this===t}}],[{key:"isNull",value:function(t){return t&&t.typeId===me.Null}},{key:"isInt",value:function(t){return t&&t.typeId===me.Int}},{key:"isFloat",value:function(t){return t&&t.typeId===me.Float}},{key:"isBinary",value:function(t){return t&&t.typeId===me.Binary}},{key:"isUtf8",value:function(t){return t&&t.typeId===me.Utf8}},{key:"isBool",value:function(t){return t&&t.typeId===me.Bool}},{key:"isDecimal",value:function(t){return t&&t.typeId===me.Decimal}},{key:"isDate",value:function(t){return t&&t.typeId===me.Date}},{key:"isTime",value:function(t){return t&&t.typeId===me.Time}},{key:"isTimestamp",value:function(t){return t&&t.typeId===me.Timestamp}},{key:"isInterval",value:function(t){return t&&t.typeId===me.Interval}},{key:"isList",value:function(t){return t&&t.typeId===me.List}},{key:"isStruct",value:function(t){return t&&t.typeId===me.Struct}},{key:"isUnion",value:function(t){return t&&t.typeId===me.Union}},{key:"isFixedSizeBinary",value:function(t){return t&&t.typeId===me.FixedSizeBinary}},{key:"isFixedSizeList",value:function(t){return t&&t.typeId===me.FixedSizeList}},{key:"isMap",value:function(t){return t&&t.typeId===me.Map}},{key:"isDictionary",value:function(t){return t&&t.typeId===me.Dictionary}}]),e}(),GE=function(e,r){(0,ce.default)(n,e);var t=de(n);function n(){return(0,fe.default)(this,n),t.apply(this,arguments)}return(0,_t.default)(n,[{key:"typeId",get:function(){return me.Null}},{key:r,get:function(){return"Null"}},{key:"toString",value:function(){return"Null"}}]),n}(bt,Symbol.toStringTag),NE=function(e,r){(0,ce.default)(n,e);var t=de(n);function n(){return(0,fe.default)(this,n),t.apply(this,arguments)}return(0,_t.default)(n,[{key:"typeId",get:function(){return me.Bool}},{key:r,get:function(){return"Bool"}},{key:"toString",value:function(){return"Bool"}}]),n}(bt,Symbol.toStringTag);OE=Symbol.toStringTag;var sr=function(e,r){(0,ce.default)(n,e);var t=de(n);function n(a,i){var o;return(0,fe.default)(this,n),o=t.call(this),g((0,Bt.default)(o),"isSigned",void 0),g((0,Bt.default)(o),"bitWidth",void 0),o.isSigned=a,o.bitWidth=i,o}return(0,_t.default)(n,[{key:"typeId",get:function(){return me.Int}},{key:r,get:function(){return"Int"}},{key:"toString",value:function(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}]),n}(bt,OE),Fu=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,!0,8)}return t}(sr),Lu=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,!0,16)}return t}(sr),ku=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,!0,32)}return t}(sr),UE=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,!0,64)}return t}(sr),Du=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,!1,8)}return t}(sr),Gu=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,!1,16)}return t}(sr),Nu=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,!1,32)}return t}(sr),jE=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,!1,64)}return t}(sr),bd={HALF:16,SINGLE:32,DOUBLE:64};PE=Symbol.toStringTag;var so=function(e,r){(0,ce.default)(n,e);var t=de(n);function n(a){var i;return(0,fe.default)(this,n),i=t.call(this),g((0,Bt.default)(i),"precision",void 0),i.precision=a,i}return(0,_t.default)(n,[{key:"typeId",get:function(){return me.Float}},{key:r,get:function(){return"Float"}},{key:"toString",value:function(){return"Float".concat(this.precision)}}]),n}(bt,PE),HE=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,bd.HALF)}return t}(so),Uu=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,bd.SINGLE)}return t}(so),ju=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,bd.DOUBLE)}return t}(so),VE=function(e,r){(0,ce.default)(n,e);var t=de(n);function n(){return(0,fe.default)(this,n),t.call(this)}return(0,_t.default)(n,[{key:"typeId",get:function(){return me.Binary}},{key:"toString",value:function(){return"Binary"}},{key:r,get:function(){return"Binary"}}]),n}(bt,Symbol.toStringTag),zE=function(e,r){(0,ce.default)(n,e);var t=de(n);function n(){return(0,fe.default)(this,n),t.apply(this,arguments)}return(0,_t.default)(n,[{key:"typeId",get:function(){return me.Utf8}},{key:r,get:function(){return"Utf8"}},{key:"toString",value:function(){return"Utf8"}}]),n}(bt,Symbol.toStringTag),Td={DAY:0,MILLISECOND:1};IE=Symbol.toStringTag;var Hu=function(e,r){(0,ce.default)(n,e);var t=de(n);function n(a){var i;return(0,fe.default)(this,n),i=t.call(this),g((0,Bt.default)(i),"unit",void 0),i.unit=a,i}return(0,_t.default)(n,[{key:"typeId",get:function(){return me.Date}},{key:r,get:function(){return"Date"}},{key:"toString",value:function(){return"Date".concat((this.unit+1)*32,"<").concat(Td[this.unit],">")}}]),n}(bt,IE),WE=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,Td.DAY)}return t}(Hu),qE=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,Td.MILLISECOND)}return t}(Hu),nn={SECOND:1,MILLISECOND:1e3,MICROSECOND:1e6,NANOSECOND:1e9};RE=Symbol.toStringTag;var Vu=function(e,r){(0,ce.default)(n,e);var t=de(n);function n(a,i){var o;return(0,fe.default)(this,n),o=t.call(this),g((0,Bt.default)(o),"unit",void 0),g((0,Bt.default)(o),"bitWidth",void 0),o.unit=a,o.bitWidth=i,o}return(0,_t.default)(n,[{key:"typeId",get:function(){return me.Time}},{key:"toString",value:function(){return"Time".concat(this.bitWidth,"<").concat(nn[this.unit],">")}},{key:r,get:function(){return"Time"}}]),n}(bt,RE),JE=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,nn.SECOND,32)}return t}(Vu),XE=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,nn.MILLISECOND,32)}return t}(Vu);FE=Symbol.toStringTag;var Na=function(e,r){(0,ce.default)(n,e);var t=de(n);function n(a){var i;(0,fe.default)(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return i=t.call(this),g((0,Bt.default)(i),"unit",void 0),g((0,Bt.default)(i),"timezone",void 0),i.unit=a,i.timezone=o,i}return(0,_t.default)(n,[{key:"typeId",get:function(){return me.Timestamp}},{key:r,get:function(){return"Timestamp"}},{key:"toString",value:function(){return"Timestamp<".concat(nn[this.unit]).concat(this.timezone?", ".concat(this.timezone):"",">")}}]),n}(bt,FE),KE=function(e){(0,ce.default)(t,e);var r=de(t);function t(){(0,fe.default)(this,t);var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r.call(this,nn.SECOND,n)}return t}(Na),YE=function(e){(0,ce.default)(t,e);var r=de(t);function t(){(0,fe.default)(this,t);var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r.call(this,nn.MILLISECOND,n)}return t}(Na),ZE=function(e){(0,ce.default)(t,e);var r=de(t);function t(){(0,fe.default)(this,t);var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r.call(this,nn.MICROSECOND,n)}return t}(Na),$E=function(e){(0,ce.default)(t,e);var r=de(t);function t(){(0,fe.default)(this,t);var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r.call(this,nn.NANOSECOND,n)}return t}(Na),xd={DAY_TIME:0,YEAR_MONTH:1};LE=Symbol.toStringTag;var zu=function(e,r){(0,ce.default)(n,e);var t=de(n);function n(a){var i;return(0,fe.default)(this,n),i=t.call(this),g((0,Bt.default)(i),"unit",void 0),i.unit=a,i}return(0,_t.default)(n,[{key:"typeId",get:function(){return me.Interval}},{key:r,get:function(){return"Interval"}},{key:"toString",value:function(){return"Interval<".concat(xd[this.unit],">")}}]),n}(bt,LE),QE=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,xd.DAY_TIME)}return t}(zu),eS=function(e){(0,ce.default)(t,e);var r=de(t);function t(){return(0,fe.default)(this,t),r.call(this,xd.YEAR_MONTH)}return t}(zu);kE=Symbol.toStringTag;var Wu=function(e,r){(0,ce.default)(n,e);var t=de(n);function n(a,i){var o;return(0,fe.default)(this,n),o=t.call(this),g((0,Bt.default)(o),"listSize",void 0),g((0,Bt.default)(o),"children",void 0),o.listSize=a,o.children=[i],o}return(0,_t.default)(n,[{key:"typeId",get:function(){return me.FixedSizeList}},{key:"valueType",get:function(){return this.children[0].type}},{key:"valueField",get:function(){return this.children[0]}},{key:r,get:function(){return"FixedSizeList"}},{key:"toString",value:function(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}]),n}(bt,kE);DE=Symbol.toStringTag;var tS=function(e,r){(0,ce.default)(n,e);var t=de(n);function n(a){var i;return(0,fe.default)(this,n),i=t.call(this),g((0,Bt.default)(i),"children",void 0),i.children=a,i}return(0,_t.default)(n,[{key:"typeId",get:function(){return me.Struct}},{key:"toString",value:function(){return"Struct<{".concat(this.children.map(function(i){return"".concat(i.name,":").concat(i.type)}).join(", "),"}>")}},{key:r,get:function(){return"Struct"}}]),n}(bt,DE);function rS(e){switch(e.constructor){case Int8Array:return new Fu;case Uint8Array:return new Du;case Int16Array:return new Lu;case Uint16Array:return new Gu;case Int32Array:return new ku;case Uint32Array:return new Nu;case Float32Array:return new Uu;case Float64Array:return new ju;default:throw new Error("array type not supported")}}function Ed(e,r,t){var n=rS(r.value),a=t||nS(r),i=new oo(e,new Wu(r.size,new oo("value",n)),!1,a);return i}function nS(e){var r=new Map;return"byteOffset"in e&&r.set("byteOffset",e.byteOffset.toString(10)),"byteStride"in e&&r.set("byteStride",e.byteStride.toString(10)),"normalized"in e&&r.set("normalized",e.normalized.toString()),r}function iS(e,r,t){var n=oS(r.metadata),a=[],i=Gk(r.attributes);for(var o in e){var s=e[o],u=aS(o,s,i[o]);a.push(u)}if(t){var f=aS("indices",t);a.push(f)}return new io(a,n)}function Gk(e){var r={};for(var t in e){var n=e[t];r[n.name||"undefined"]=n}return r}function aS(e,r,t){var n=t?oS(t.metadata):void 0,a=Ed(e,r,n);return a}function oS(e){var r=new Map;for(var t in e)r.set("".concat(t,".string"),JSON.stringify(e[t]));return r}function Nk(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Uk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function Uk(e,r){if(e){if(typeof e=="string")return sS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return sS(e,r)}}function sS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function uS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function fS(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?uS(Object(t),!0).forEach(function(n){(0,hS.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):uS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var lS={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},jk={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},Hk=4,mS=function(){function e(r){(0,dS.default)(this,e),g(this,"draco",void 0),g(this,"decoder",void 0),g(this,"metadataQuerier",void 0),this.draco=r,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}return(0,pS.default)(e,[{key:"destroy",value:function(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}},{key:"parseSync",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=new this.draco.DecoderBuffer;a.Init(new Int8Array(t),t.byteLength),this._disableAttributeTransforms(n);var i=this.decoder.GetEncodedGeometryType(a),o=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{var s;switch(i){case this.draco.TRIANGULAR_MESH:s=this.decoder.DecodeBufferToMesh(a,o);break;case this.draco.POINT_CLOUD:s=this.decoder.DecodeBufferToPointCloud(a,o);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!s.ok()||!o.ptr){var u="DRACO decompression failed: ".concat(s.error_msg());throw new Error(u)}var f=this._getDracoLoaderData(o,i,n),l=this._getMeshData(o,f,n),c=zn(l.attributes),h=iS(l.attributes,f,l.indices),d=fS(fS({loader:"draco",loaderData:f,header:{vertexCount:o.num_points(),boundingBox:c}},l),{},{schema:h});return d}finally{this.draco.destroy(a),o&&this.draco.destroy(o)}}},{key:"_getDracoLoaderData",value:function(t,n,a){var i=this._getTopLevelMetadata(t),o=this._getDracoAttributes(t,a);return{geometry_type:n,num_attributes:t.num_attributes(),num_points:t.num_points(),num_faces:t instanceof this.draco.Mesh?t.num_faces():0,metadata:i,attributes:o}}},{key:"_getDracoAttributes",value:function(t,n){for(var a={},i=0;i<t.num_attributes();i++){var o=this.decoder.GetAttribute(t,i),s=this._getAttributeMetadata(t,i);a[o.unique_id()]={unique_id:o.unique_id(),attribute_type:o.attribute_type(),data_type:o.data_type(),num_components:o.num_components(),byte_offset:o.byte_offset(),byte_stride:o.byte_stride(),normalized:o.normalized(),attribute_index:i,metadata:s};var u=this._getQuantizationTransform(o,n);u&&(a[o.unique_id()].quantization_transform=u);var f=this._getOctahedronTransform(o,n);f&&(a[o.unique_id()].octahedron_transform=f)}return a}},{key:"_getMeshData",value:function(t,n,a){var i=this._getMeshAttributes(n,t,a),o=i.POSITION;if(!o)throw new Error("DRACO: No position attribute found.");if(t instanceof this.draco.Mesh)switch(a.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(t),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(t),size:1}}}return{topology:"point-list",mode:0,attributes:i}}},{key:"_getMeshAttributes",value:function(t,n,a){for(var i={},o=0,s=Object.values(t.attributes);o<s.length;o++){var u=s[o],f=this._deduceAttributeName(u,a);u.name=f;var l=this._getAttributeValues(n,u),c=l.value,h=l.size;i[f]={value:c,size:h,byteOffset:u.byte_offset,byteStride:u.byte_stride,normalized:u.normalized}}return i}},{key:"_getTriangleListIndices",value:function(t){var n=t.num_faces(),a=n*3,i=a*Hk,o=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(t,i,o),new Uint32Array(this.draco.HEAPF32.buffer,o,a).slice()}finally{this.draco._free(o)}}},{key:"_getTriangleStripIndices",value:function(t){var n=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(t,n),Wk(n)}finally{this.draco.destroy(n)}}},{key:"_getAttributeValues",value:function(t,n){var a=jk[n.data_type],i=n.num_components,o=t.num_points(),s=o*i,u=s*a.BYTES_PER_ELEMENT,f=Vk(this.draco,a),l,c=this.draco._malloc(u);try{var h=this.decoder.GetAttribute(t,n.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(t,h,f,u,c),l=new a(this.draco.HEAPF32.buffer,c,s).slice()}finally{this.draco._free(c)}return{value:l,size:i}}},{key:"_deduceAttributeName",value:function(t,n){for(var a=t.unique_id,i=0,o=Object.entries(n.extraAttributes||{});i<o.length;i++){var s=(0,cS.default)(o[i],2),u=s[0],f=s[1];if(f===a)return u}var l=t.attribute_type;for(var c in lS){var h=this.draco[c];if(h===l)return lS[c]}var d=n.attributeNameEntry||"name";return t.metadata[d]?t.metadata[d].string:"CUSTOM_ATTRIBUTE_".concat(a)}},{key:"_getTopLevelMetadata",value:function(t){var n=this.decoder.GetMetadata(t);return this._getDracoMetadata(n)}},{key:"_getAttributeMetadata",value:function(t,n){var a=this.decoder.GetAttributeMetadata(t,n);return this._getDracoMetadata(a)}},{key:"_getDracoMetadata",value:function(t){if(!t||!t.ptr)return{};for(var n={},a=this.metadataQuerier.NumEntries(t),i=0;i<a;i++){var o=this.metadataQuerier.GetEntryName(t,i);n[o]=this._getDracoMetadataField(t,o)}return n}},{key:"_getDracoMetadataField",value:function(t,n){var a=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(t,n,a);var i=zk(a);return{int:this.metadataQuerier.GetIntEntry(t,n),string:this.metadataQuerier.GetStringEntry(t,n),double:this.metadataQuerier.GetDoubleEntry(t,n),intArray:i}}finally{this.draco.destroy(a)}}},{key:"_disableAttributeTransforms",value:function(t){var n=t.quantizedAttributes,a=n===void 0?[]:n,i=t.octahedronAttributes,o=i===void 0?[]:i,s=[].concat((0,Sd.default)(a),(0,Sd.default)(o)),u=Nk(s),f;try{for(u.s();!(f=u.n()).done;){var l=f.value;this.decoder.SkipAttributeTransform(this.draco[l])}}catch(c){u.e(c)}finally{u.f()}}},{key:"_getQuantizationTransform",value:function(t,n){var a=this,i=n.quantizedAttributes,o=i===void 0?[]:i,s=t.attribute_type(),u=o.map(function(l){return a.decoder[l]}).includes(s);if(u){var f=new this.draco.AttributeQuantizationTransform;try{if(f.InitFromAttribute(t))return{quantization_bits:f.quantization_bits(),range:f.range(),min_values:new Float32Array([1,2,3]).map(function(l){return f.min_value(l)})}}finally{this.draco.destroy(f)}}return null}},{key:"_getOctahedronTransform",value:function(t,n){var a=this,i=n.octahedronAttributes,o=i===void 0?[]:i,s=t.attribute_type(),u=o.map(function(l){return a.decoder[l]}).includes(s);if(u){var f=new this.draco.AttributeQuantizationTransform;try{if(f.InitFromAttribute(t))return{quantization_bits:f.quantization_bits()}}finally{this.draco.destroy(f)}}return null}}]),e}();function Vk(e,r){switch(r){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32;default:return e.DT_INVALID}}function zk(e){for(var r=e.size(),t=new Int32Array(r),n=0;n<r;n++)t[n]=e.GetValue(n);return t}function Wk(e){for(var r=e.size(),t=new Int32Array(r),n=0;n<r;n++)t[n]=e.GetValue(n);return t}var yS=m(ie()),AS=m(W()),Bd=m(K()),fo=m(Y());function vS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function gS(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?vS(Object(t),!0).forEach(function(n){(0,AS.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):vS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var qk="1.5.5",Jk="1.4.1",Md="https://www.gstatic.com/draco/versioned/decoders/".concat(qk),Xk="".concat(Md,"/draco_decoder.js"),Kk="".concat(Md,"/draco_wasm_wrapper.js"),Yk="".concat(Md,"/draco_decoder.wasm"),EQ="https://raw.githubusercontent.com/google/draco/".concat(Jk,"/javascript/draco_encoder.js"),uo;function _S(e){return wd.apply(this,arguments)}function wd(){return wd=(0,Bd.default)(fo.default.mark(function e(r){var t;return fo.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=r.modules||{},t.draco3d?uo=uo||t.draco3d.createDecoderModule({}).then(function(i){return{draco:i}}):uo=uo||Zk(r),a.next=4,uo;case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},e)})),wd.apply(this,arguments)}function Zk(e){return Cd.apply(this,arguments)}function Cd(){return Cd=(0,Bd.default)(fo.default.mark(function e(r){var t,n,a,i;return fo.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:s.t0=r.draco&&r.draco.decoderType,s.next=s.t0==="js"?3:(s.t0==="wasm",7);break;case 3:return s.next=5,Zt(Xk,"draco",r);case 5:return t=s.sent,s.abrupt("break",21);case 7:return s.t1=Promise,s.next=10,Zt(Kk,"draco",r);case 10:return s.t2=s.sent,s.next=13,Zt(Yk,"draco",r);case 13:return s.t3=s.sent,s.t4=[s.t2,s.t3],s.next=17,s.t1.all.call(s.t1,s.t4);case 17:a=s.sent,i=(0,yS.default)(a,2),t=i[0],n=i[1];case 21:return t=t||globalThis.DracoDecoderModule,s.next=24,$k(t,n);case 24:return s.abrupt("return",s.sent);case 25:case"end":return s.stop()}},e)})),Cd.apply(this,arguments)}function $k(e,r){var t={};return r&&(t.wasmBinary=r),new Promise(function(n){e(gS(gS({},t),{},{onModuleLoaded:function(i){return n({draco:i})}}))})}function bS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function TS(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?bS(Object(t),!0).forEach(function(n){(0,ES.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):bS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var qu=TS(TS({},bE),{},{parse:Qk});function Qk(e,r){return Pd.apply(this,arguments)}function Pd(){return Pd=(0,xS.default)(Od.default.mark(function e(r,t){var n,a,i;return Od.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,_S(t);case 2:return n=s.sent,a=n.draco,i=new mS(a),s.prev=5,s.abrupt("return",i.parseSync(r,t?.draco));case 7:return s.prev=7,i.destroy(),s.finish(7);case 10:case"end":return s.stop()}},e,null,[[5,,7,10]])})),Pd.apply(this,arguments)}var SS=m(H()),wS=m(z()),wr=m(W());var ur,Id=(ur={},(0,wr.default)(ur,5130,Float64Array),(0,wr.default)(ur,5126,Float32Array),(0,wr.default)(ur,5123,Uint16Array),(0,wr.default)(ur,5125,Uint32Array),(0,wr.default)(ur,5121,Uint8Array),(0,wr.default)(ur,5120,Int8Array),(0,wr.default)(ur,5122,Int16Array),(0,wr.default)(ur,5124,Int32Array),ur),eD={DOUBLE:5130,FLOAT:5126,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,UNSIGNED_BYTE:5121,BYTE:5120,SHORT:5122,INT:5124},Rd="Failed to convert GL type",an=function(){function e(){(0,SS.default)(this,e)}return(0,wS.default)(e,null,[{key:"fromTypedArray",value:function(t){t=ArrayBuffer.isView(t)?t.constructor:t;for(var n in Id){var a=Id[n];if(a===t)return n}throw new Error(Rd)}},{key:"fromName",value:function(t){var n=eD[t];if(!n)throw new Error(Rd);return n}},{key:"getArrayType",value:function(t){switch(t){case 33635:case 32819:case 32820:return Uint16Array;default:var n=Id[t];if(!n)throw new Error(Rd);return n}}},{key:"getByteSize",value:function(t){var n=e.getArrayType(t);return n.BYTES_PER_ELEMENT}},{key:"validate",value:function(t){return Boolean(e.getArrayType(t))}},{key:"createTypedArray",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;i===void 0&&(i=(n.byteLength-a)/e.getByteSize(t));var o=e.getArrayType(t);return new o(n,a,i)}}]),e}();function CS(e,r){if(!e)throw new Error("math.gl assertion failed. ".concat(r))}function Fd(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],t=e>>11&31,n=e>>5&63,a=e&31;return r[0]=t<<3,r[1]=n<<2,r[2]=a<<3,r}var LQ=1/256;var kQ=new Cn,DQ=new S,GQ=new Cn,NQ=new Cn,UQ=new Uint8Array(1);function BS(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:255;return bs(e,0,r)/r*2-1}function MS(e){return e<0?-1:1}function OS(e,r,t,n){if(CS(n),e<0||e>t||r<0||r>t)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(t));if(n.x=BS(e,t),n.y=BS(r,t),n.z=1-(Math.abs(n.x)+Math.abs(n.y)),n.z<0){var a=n.x;n.x=(1-Math.abs(n.y))*MS(a),n.y=(1-Math.abs(a))*MS(n.y)}return n.normalize()}function Ld(e,r,t){return OS(e,r,255,t)}var PS=m(H()),IS=m(z());var Ua=function(){function e(r,t){(0,PS.default)(this,e),g(this,"json",void 0),g(this,"buffer",void 0),g(this,"featuresLength",0),g(this,"_cachedTypedArrays",{}),this.json=r,this.buffer=t}return(0,IS.default)(e,[{key:"getExtension",value:function(t){return this.json.extensions&&this.json.extensions[t]}},{key:"hasProperty",value:function(t){return Boolean(this.json[t])}},{key:"getGlobalProperty",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5125,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=this.json[t];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(t,n,a,1,i.byteOffset):i}},{key:"getPropertyArray",value:function(t,n,a){var i=this.json[t];return i&&Number.isFinite(i.byteOffset)?("componentType"in i&&(n=an.fromName(i.componentType)),this._getTypedArrayFromBinary(t,n,a,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(t,n,i)}},{key:"getProperty",value:function(t,n,a,i,o){var s=this.json[t];if(!s)return s;var u=this.getPropertyArray(t,n,a);if(a===1)return u[i];for(var f=0;f<a;++f)o[f]=u[a*i+f];return o}},{key:"_getTypedArrayFromBinary",value:function(t,n,a,i,o){var s=this._cachedTypedArrays,u=s[t];return u||(u=an.createTypedArray(n,this.buffer.buffer,this.buffer.byteOffset+o,i*a),s[t]=u),u}},{key:"_getTypedArrayFromArray",value:function(t,n,a){var i=this._cachedTypedArrays,o=i[t];return o||(o=an.createTypedArray(n,a),i[t]=o),o}}]),e}();var kS=m(st()),DS=m(H()),GS=m(z());var tD={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},rD={SCALAR:function(r,t){return r[t]},VEC2:function(r,t){return[r[2*t+0],r[2*t+1]]},VEC3:function(r,t){return[r[3*t+0],r[3*t+1],r[3*t+2]]},VEC4:function(r,t){return[r[4*t+0],r[4*t+1],r[4*t+2],r[4*t+3]]},MAT2:function(r,t){return[r[4*t+0],r[4*t+1],r[4*t+2],r[4*t+3]]},MAT3:function(r,t){return[r[9*t+0],r[9*t+1],r[9*t+2],r[9*t+3],r[9*t+4],r[9*t+5],r[9*t+6],r[9*t+7],r[9*t+8]]},MAT4:function(r,t){return[r[16*t+0],r[16*t+1],r[16*t+2],r[16*t+3],r[16*t+4],r[16*t+5],r[16*t+6],r[16*t+7],r[16*t+8],r[16*t+9],r[16*t+10],r[16*t+11],r[16*t+12],r[16*t+13],r[16*t+14],r[16*t+15]]}},nD={SCALAR:function(r,t,n){t[n]=r},VEC2:function(r,t,n){t[2*n+0]=r[0],t[2*n+1]=r[1]},VEC3:function(r,t,n){t[3*n+0]=r[0],t[3*n+1]=r[1],t[3*n+2]=r[2]},VEC4:function(r,t,n){t[4*n+0]=r[0],t[4*n+1]=r[1],t[4*n+2]=r[2],t[4*n+3]=r[3]},MAT2:function(r,t,n){t[4*n+0]=r[0],t[4*n+1]=r[1],t[4*n+2]=r[2],t[4*n+3]=r[3]},MAT3:function(r,t,n){t[9*n+0]=r[0],t[9*n+1]=r[1],t[9*n+2]=r[2],t[9*n+3]=r[3],t[9*n+4]=r[4],t[9*n+5]=r[5],t[9*n+6]=r[6],t[9*n+7]=r[7],t[9*n+8]=r[8],t[9*n+9]=r[9]},MAT4:function(r,t,n){t[16*n+0]=r[0],t[16*n+1]=r[1],t[16*n+2]=r[2],t[16*n+3]=r[3],t[16*n+4]=r[4],t[16*n+5]=r[5],t[16*n+6]=r[6],t[16*n+7]=r[7],t[16*n+8]=r[8],t[16*n+9]=r[9],t[16*n+10]=r[10],t[16*n+11]=r[11],t[16*n+12]=r[12],t[16*n+13]=r[13],t[16*n+14]=r[14],t[16*n+15]=r[15]}};function RS(e,r,t,n){var a=e.componentType;se(e.componentType);var i=typeof a=="string"?an.fromName(a):a,o=tD[e.type],s=rD[e.type],u=nD[e.type];t+=e.byteOffset;var f=an.createTypedArray(i,r,t,o*n);return{values:f,type:i,size:o,unpacker:s,packer:u}}var fr=function(r){return r!==void 0};function FS(e,r,t){if(!r)return null;var n=e.getExtension("3DTILES_batch_table_hierarchy"),a=r.HIERARCHY;return a&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),r.extensions=r.extensions||{},r.extensions["3DTILES_batch_table_hierarchy"]=a,n=a),n?aD(n,t):null}function aD(e,r){var t,n,a,i=e.instancesLength,o=e.classes,s=e.classIds,u=e.parentCounts,f=e.parentIds,l=i;fr(s.byteOffset)&&(s.componentType=defaultValue(s.componentType,5123),s.type=AttributeType.SCALAR,a=getBinaryAccessor(s),s=a.createArrayBufferView(r.buffer,r.byteOffset+s.byteOffset,i));var c;if(fr(u))for(fr(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,5123),u.type=AttributeType.SCALAR,a=getBinaryAccessor(u),u=a.createArrayBufferView(r.buffer,r.byteOffset+u.byteOffset,i)),c=new Uint16Array(i),l=0,t=0;t<i;++t)c[t]=l,l+=u[t];fr(f)&&fr(f.byteOffset)&&(f.componentType=defaultValue(f.componentType,5123),f.type=AttributeType.SCALAR,a=getBinaryAccessor(f),f=a.createArrayBufferView(r.buffer,r.byteOffset+f.byteOffset,l));var h=o.length;for(t=0;t<h;++t){var d=o[t].length,p=o[t].instances,v=getBinaryProperties(d,p,r);o[t].instances=combine(v,p)}var y=new Array(h).fill(0),A=new Uint16Array(i);for(t=0;t<i;++t)n=s[t],A[t]=y[n],++y[n];var _={classes:o,classIds:s,classIndexes:A,parentCounts:u,parentIndexes:c,parentIds:f};return sD(_),_}function ja(e,r,t){if(e){var n=e.parentCounts,a=e.parentIds;return a?t(e,r):n>0?iD(e,r,t):oD(e,r,t)}}function iD(e,r,t){var n=e.classIds,a=e.parentCounts,i=e.parentIds,o=e.parentIndexes,s=n.length,u=scratchVisited;u.length=Math.max(u.length,s);var f=++marker,l=scratchStack;for(l.length=0,l.push(r);l.length>0;)if(r=l.pop(),u[r]!==f){u[r]=f;var c=t(e,r);if(fr(c))return c;for(var h=a[r],d=o[r],p=0;p<h;++p){var v=i[d+p];v!==r&&l.push(v)}}return null}function oD(e,r,t){for(var n=!0;n;){var a=t(e,r);if(fr(a))return a;var i=e.parentIds[r];n=i!==r,r=i}throw new Error("traverseHierarchySingleParent")}function sD(e){for(var r=[],t=e.classIds,n=t.length,a=0;a<n;++a)LS(e,a,stack)}function LS(e,r,t){var n=e.parentCounts,a=e.parentIds,i=e.parentIndexes,o=e.classIds,s=o.length;if(fr(a)){assert(r<s,"Parent index ".concat(r," exceeds the total number of instances: ").concat(s)),assert(t.indexOf(r)===-1,"Circular dependency detected in the batch table hierarchy."),t.push(r);for(var u=fr(n)?n[r]:1,f=fr(n)?i[r]:r,l=0;l<u;++l){var c=a[f+l];c!==r&&LS(e,c,t)}t.pop(r)}}function Tt(e){return e!=null}var Ju=function(r,t){return r},uD={HIERARCHY:!0,extensions:!0,extras:!0},Xu=function(){function e(r,t,n){(0,DS.default)(this,e);var a,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};g(this,"json",void 0),g(this,"binary",void 0),g(this,"featureCount",void 0),g(this,"_extensions",void 0),g(this,"_properties",void 0),g(this,"_binaryProperties",void 0),g(this,"_hierarchy",void 0),se(n>=0),this.json=r||{},this.binary=t,this.featureCount=n,this._extensions=((a=this.json)===null||a===void 0?void 0:a.extensions)||{},this._properties={};for(var o in this.json)uD[o]||(this._properties[o]=this.json[o]);this._binaryProperties=this._initializeBinaryProperties(),i["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=FS(this,this.json,this.binary))}return(0,GS.default)(e,[{key:"getExtension",value:function(t){return this.json&&this.json.extensions&&this.json.extensions[t]}},{key:"memorySizeInBytes",value:function(){return 0}},{key:"isClass",value:function(t,n){if(this._checkBatchId(t),se(typeof n=="string",n),this._hierarchy){var a=ja(this._hierarchy,t,function(i,o){var s=i.classIds[o],u=i.classes[s];return u.name===n});return Tt(a)}return!1}},{key:"isExactClass",value:function(t,n){return se(typeof n=="string",n),this.getExactClassName(t)===n}},{key:"getExactClassName",value:function(t){if(this._checkBatchId(t),this._hierarchy){var n=this._hierarchy.classIds[t],a=this._hierarchy.classes[n];return a.name}}},{key:"hasProperty",value:function(t,n){return this._checkBatchId(t),se(typeof n=="string",n),Tt(this._properties[n])||this._hasPropertyInHierarchy(t,n)}},{key:"getPropertyNames",value:function(t,n){var a;this._checkBatchId(t),n=Tt(n)?n:[],n.length=0;var i=Object.keys(this._properties);return(a=n).push.apply(a,(0,kS.default)(i)),this._hierarchy&&this._getPropertyNamesInHierarchy(t,n),n}},{key:"getProperty",value:function(t,n){if(this._checkBatchId(t),se(typeof n=="string",n),this._binaryProperties){var a=this._binaryProperties[n];if(Tt(a))return this._getBinaryProperty(a,t)}var i=this._properties[n];if(Tt(i))return Ju(i[t],!0);if(this._hierarchy){var o=this._getHierarchyProperty(t,n);if(Tt(o))return o}}},{key:"setProperty",value:function(t,n,a){var i=this.featureCount;if(this._checkBatchId(t),se(typeof n=="string",n),this._binaryProperties){var o=this._binaryProperties[n];if(o){this._setBinaryProperty(o,t,a);return}}if(!(this._hierarchy&&this._setHierarchyProperty(this,t,n,a))){var s=this._properties[n];Tt(s)||(this._properties[n]=new Array(i),s=this._properties[n]),s[t]=Ju(a,!0)}}},{key:"_checkBatchId",value:function(t){var n=t>=0&&t<this.featureCount;if(!n)throw new Error("batchId not in range [0, featureCount - 1].")}},{key:"_getBinaryProperty",value:function(t,n){return t.unpack(t.typedArray,n)}},{key:"_setBinaryProperty",value:function(t,n,a){t.pack(a,t.typedArray,n)}},{key:"_initializeBinaryProperties",value:function(){var t=null;for(var n in this._properties){var a=this._properties[n],i=this._initializeBinaryProperty(n,a);i&&(t=t||{},t[n]=i)}return t}},{key:"_initializeBinaryProperty",value:function(t,n){if("byteOffset"in n){var a=n;se(this.binary,"Property ".concat(t," requires a batch table binary.")),se(a.type,"Property ".concat(t," requires a type."));var i=RS(a,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}},{key:"_hasPropertyInHierarchy",value:function(t,n){if(!this._hierarchy)return!1;var a=ja(this._hierarchy,t,function(i,o){var s=i.classIds[o],u=i.classes[s].instances;return Tt(u[n])});return Tt(a)}},{key:"_getPropertyNamesInHierarchy",value:function(t,n){ja(this._hierarchy,t,function(a,i){var o=a.classIds[i],s=a.classes[o].instances;for(var u in s)s.hasOwnProperty(u)&&n.indexOf(u)===-1&&n.push(u)})}},{key:"_getHierarchyProperty",value:function(t,n){var a=this;return ja(this._hierarchy,t,function(i,o){var s=i.classIds[o],u=i.classes[s],f=i.classIndexes[o],l=u.instances[n];return Tt(l)?Tt(l.typedArray)?a._getBinaryProperty(l,f):Ju(l[f],!0):null})}},{key:"_setHierarchyProperty",value:function(t,n,a,i){var o=this,s=ja(this._hierarchy,n,function(u,f){var l=u.classIds[f],c=u.classes[l],h=u.classIndexes[f],d=c.instances[a];return Tt(d)?(se(f===n,'Inherited property "'.concat(a,'" is read-only.')),Tt(d.typedArray)?o._setBinaryProperty(d,h,i):d[h]=Ju(i,!0),!0):!1});return Tt(s)}}]),e}();var kd=4;function on(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=new DataView(r);if(e.magic=n.getUint32(t,!0),t+=kd,e.version=n.getUint32(t,!0),t+=kd,e.byteLength=n.getUint32(t,!0),t+=kd,e.version!==1)throw new Error("3D Tile Version ".concat(e.version," not supported"));return t}var Ha=4,NS="b3dm tile in legacy format.";function Va(e,r,t){var n=new DataView(r),a;e.header=e.header||{};var i=n.getUint32(t,!0);t+=Ha;var o=n.getUint32(t,!0);t+=Ha;var s=n.getUint32(t,!0);t+=Ha;var u=n.getUint32(t,!0);return t+=Ha,s>=570425344?(t-=Ha*2,a=i,s=o,u=0,i=0,o=0,console.warn(NS)):u>=570425344&&(t-=Ha,a=s,s=i,u=o,i=0,o=0,console.warn(NS)),e.header.featureTableJsonByteLength=i,e.header.featureTableBinaryByteLength=o,e.header.batchTableJsonByteLength=s,e.header.batchTableBinaryByteLength=u,e.header.batchLength=a,t}function za(e,r,t,n){return t=fD(e,r,t,n),t=lD(e,r,t,n),t}function fD(e,r,t,n){var a=e.header,i=a.featureTableJsonByteLength,o=a.featureTableBinaryByteLength,s=a.batchLength;if(e.featureTableJson={BATCH_LENGTH:s||0},i>0){var u=gd(r,t,i);e.featureTableJson=JSON.parse(u)}return t+=i,e.featureTableBinary=new Uint8Array(r,t,o),t+=o,t}function lD(e,r,t,n){var a=e.header,i=a.batchTableJsonByteLength,o=a.batchTableBinaryByteLength;if(i>0){var s=gd(r,t,i);e.batchTableJson=JSON.parse(s),t+=i,o>0&&(e.batchTableBinary=new Uint8Array(r,t,o),e.batchTableBinary=new Uint8Array(e.batchTableBinary),t+=o)}return t}function Dd(e,r,t){if(!r&&(!e||!e.batchIds||!t))return null;var n=e.batchIds,a=e.isRGB565,i=e.pointCount;if(n&&t){for(var o=new Uint8ClampedArray(i*3),s=0;s<i;s++){var u=n[s],f=t.getProperty(u,"dimensions"),l=f.map(function(p){return p*255});o[s*3]=l[0],o[s*3+1]=l[1],o[s*3+2]=l[2]}return{type:5121,value:o,size:3,normalized:!0}}if(a){for(var c=new Uint8ClampedArray(i*3),h=0;h<i;h++){var d=Fd(r[h]);c[h*3]=d[0],c[h*3+1]=d[1],c[h*3+2]=d[2]}return{type:5121,value:c,size:3,normalized:!0}}return r&&r.length===i*3?{type:5121,value:r,size:3,normalized:!0}:{type:5121,value:r,size:4,normalized:!0}}var US=new S;function jS(e,r){if(!r)return null;if(e.isOctEncoded16P){for(var t=new Float32Array(e.pointsLength*3),n=0;n<e.pointsLength;n++)Ld(r[n*2],r[n*2+1],US),US.toArray(t,n*3);return{type:5126,size:2,value:t}}return{type:5126,size:2,value:r}}function HS(e,r,t){return e.isQuantized?t["3d-tiles"]&&t["3d-tiles"].decodeQuantizedPositions?(e.isQuantized=!1,cD(e,r)):{type:5123,value:r,size:3,normalized:!0}:r}function cD(e,r){for(var t=new S,n=new Float32Array(e.pointCount*3),a=0;a<e.pointCount;a++)t.set(r[a*3],r[a*3+1],r[a*3+2]).scale(1/e.quantizedRange).multiply(e.quantizedVolumeScale).add(e.quantizedVolumeOffset).toArray(n,a*3);return n}function VS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Wn(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?VS(Object(t),!0).forEach(function(n){(0,zS.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):VS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function WS(e,r,t,n,a){return Gd.apply(this,arguments)}function Gd(){return Gd=(0,Ku.default)(qn.default.mark(function e(r,t,n,a,i){var o,s,u;return qn.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return n=on(r,t,n),n=Va(r,t,n),n=za(r,t,n,a),hD(r),o=dD(r),s=o.featureTable,u=o.batchTable,l.next=7,yD(r,s,u,a,i);case 7:return pD(r,s,a),mD(r,s,u),vD(r,s),l.abrupt("return",n);case 11:case"end":return l.stop()}},e)})),Gd.apply(this,arguments)}function hD(e){e.attributes={positions:null,colors:null,normals:null,batchIds:null},e.isQuantized=!1,e.isTranslucent=!1,e.isRGB565=!1,e.isOctEncoded16P=!1}function dD(e){var r=new Ua(e.featureTableJson,e.featureTableBinary),t=r.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(t))throw new Error("POINTS_LENGTH must be defined");r.featuresLength=t,e.featuresLength=t,e.pointsLength=t,e.pointCount=t,e.rtcCenter=r.getGlobalProperty("RTC_CENTER",5126,3);var n=gD(e,r);return{featureTable:r,batchTable:n}}function pD(e,r,t){if(!e.attributes.positions){if(r.hasProperty("POSITION"))e.attributes.positions=r.getPropertyArray("POSITION",5126,3);else if(r.hasProperty("POSITION_QUANTIZED")){var n=r.getPropertyArray("POSITION_QUANTIZED",5123,3);if(e.isQuantized=!0,e.quantizedRange=(1<<16)-1,e.quantizedVolumeScale=r.getGlobalProperty("QUANTIZED_VOLUME_SCALE",5126,3),!e.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(e.quantizedVolumeOffset=r.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",5126,3),!e.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");e.attributes.positions=HS(e,n,t)}}if(!e.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function mD(e,r,t){if(!e.attributes.colors){var n=null;r.hasProperty("RGBA")?(n=r.getPropertyArray("RGBA",5121,4),e.isTranslucent=!0):r.hasProperty("RGB")?n=r.getPropertyArray("RGB",5121,3):r.hasProperty("RGB565")&&(n=r.getPropertyArray("RGB565",5123,1),e.isRGB565=!0),e.attributes.colors=Dd(e,n,t)}r.hasProperty("CONSTANT_RGBA")&&(e.constantRGBA=r.getGlobalProperty("CONSTANT_RGBA",5121,4))}function vD(e,r){if(!e.attributes.normals){var t=null;r.hasProperty("NORMAL")?t=r.getPropertyArray("NORMAL",5126,3):r.hasProperty("NORMAL_OCT16P")&&(t=r.getPropertyArray("NORMAL_OCT16P",5121,2),e.isOctEncoded16P=!0),e.attributes.normals=jS(e,t)}}function gD(e,r){var t=null;if(!e.batchIds&&r.hasProperty("BATCH_ID")&&(e.batchIds=r.getPropertyArray("BATCH_ID",5123,1),e.batchIds)){var n=r.getGlobalProperty("BATCH_LENGTH");if(!n)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");var a=e.batchTableJson,i=e.batchTableBinary;t=new Xu(a,i,n)}return t}function yD(e,r,t,n,a){return Nd.apply(this,arguments)}function Nd(){return Nd=(0,Ku.default)(qn.default.mark(function e(r,t,n,a,i){var o,s,u,f,l,c,h,d;return qn.default.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(f=r.batchTableJson&&r.batchTableJson.extensions&&r.batchTableJson.extensions["3DTILES_draco_point_compression"],f&&(u=f.properties),l=t.getExtension("3DTILES_draco_point_compression"),!l){v.next=15;break}if(s=l.properties,c=l.byteOffset,h=l.byteLength,!(!s||!Number.isFinite(c)||!h)){v.next=9;break}throw new Error("Draco properties, byteOffset, and byteLength must be defined");case 9:o=r.featureTableBinary.slice(c,c+h),r.hasPositions=Number.isFinite(s.POSITION),r.hasColors=Number.isFinite(s.RGB)||Number.isFinite(s.RGBA),r.hasNormals=Number.isFinite(s.NORMAL),r.hasBatchIds=Number.isFinite(s.BATCH_ID),r.isTranslucent=Number.isFinite(s.RGBA);case 15:if(o){v.next=17;break}return v.abrupt("return",!0);case 17:return d={buffer:o,properties:Wn(Wn({},s),u),featureTableProperties:s,batchTableProperties:u,dequantizeInShader:!1},v.next=20,AD(r,d,a,i);case 20:return v.abrupt("return",v.sent);case 21:case"end":return v.stop()}},e)})),Nd.apply(this,arguments)}function AD(e,r,t,n){return Ud.apply(this,arguments)}function Ud(){return Ud=(0,Ku.default)(qn.default.mark(function e(r,t,n,a){var i,o,s,u,f,l,c,h,d,p,v,y,A,_,E;return qn.default.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return i=a.parse,o=Wn(Wn({},n),{},{draco:Wn(Wn({},n.draco),{},{extraAttributes:t.batchTableProperties||{}})}),delete o["3d-tiles"],C.next=5,i(t.buffer,qu,o);case 5:if(s=C.sent,u=s.attributes.POSITION&&s.attributes.POSITION.value,f=s.attributes.COLOR_0&&s.attributes.COLOR_0.value,l=s.attributes.NORMAL&&s.attributes.NORMAL.value,c=s.attributes.BATCH_ID&&s.attributes.BATCH_ID.value,h=u&&s.attributes.POSITION.value.quantization,d=l&&s.attributes.NORMAL.value.quantization,h&&(p=s.POSITION.data.quantization,v=p.range,r.quantizedVolumeScale=new S(v,v,v),r.quantizedVolumeOffset=new S(p.minValues),r.quantizedRange=(1<<p.quantizationBits)-1,r.isQuantizedDraco=!0),d&&(r.octEncodedRange=(1<<s.NORMAL.data.quantization.quantizationBits)-1,r.isOctEncodedDraco=!0),y={},t.batchTableProperties)for(A=0,_=Object.keys(t.batchTableProperties);A<_.length;A++)E=_[A],s.attributes[E]&&s.attributes[E].value&&(y[E.toLowerCase()]=s.attributes[E].value);r.attributes=Wn({positions:u,colors:Dd(r,f,void 0),normals:l,batchIds:c},y);case 17:case"end":return C.stop()}},e)})),Ud.apply(this,arguments)}var TC=m(K()),Qp=m(Y());var bC=m(K()),Zp=m(Y());var AC=m(W()),_C=m(K()),Kp=m(Y());var qS="3.4.2";var _o=m(K()),Mr=m(Y());var JS="3.4.2";var dw=m(W());var uw=m(Ge()),fw=m(K()),Zd=m(Y());var Jd=m(ie()),lo=m(K()),Cr=m(Y());var XS="3.4.2",_D="https://unpkg.com/@loaders.gl/textures@".concat(XS,"/dist/libs/basis_encoder.wasm"),bD="https://unpkg.com/@loaders.gl/textures@".concat(XS,"/dist/libs/basis_encoder.js"),jd;function Xd(e){return Vd.apply(this,arguments)}function Vd(){return Vd=(0,lo.default)(Cr.default.mark(function e(r){var t;return Cr.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t=r.modules||{},!t.basis){a.next=3;break}return a.abrupt("return",t.basis);case 3:return jd=jd||TD(r),a.next=6,jd;case 6:return a.abrupt("return",a.sent);case 7:case"end":return a.stop()}},e)})),Vd.apply(this,arguments)}function TD(e){return zd.apply(this,arguments)}function zd(){return zd=(0,lo.default)(Cr.default.mark(function e(r){var t,n,a,i;return Cr.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=null,n=null,s.t0=Promise,s.next=5,Zt("basis_transcoder.js","textures",r);case 5:return s.t1=s.sent,s.next=8,Zt("basis_transcoder.wasm","textures",r);case 8:return s.t2=s.sent,s.t3=[s.t1,s.t2],s.next=12,s.t0.all.call(s.t0,s.t3);case 12:return a=s.sent,i=(0,Jd.default)(a,2),t=i[0],n=i[1],t=t||globalThis.BASIS,s.next=19,xD(t,n);case 19:return s.abrupt("return",s.sent);case 20:case"end":return s.stop()}},e)})),zd.apply(this,arguments)}function xD(e,r){var t={};return r&&(t.wasmBinary=r),new Promise(function(n){e(t).then(function(a){var i=a.BasisFile,o=a.initializeBasis;o(),n({BasisFile:i})})})}var Hd;function Kd(e){return Wd.apply(this,arguments)}function Wd(){return Wd=(0,lo.default)(Cr.default.mark(function e(r){var t;return Cr.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t=r.modules||{},!t.basisEncoder){a.next=3;break}return a.abrupt("return",t.basisEncoder);case 3:return Hd=Hd||ED(r),a.next=6,Hd;case 6:return a.abrupt("return",a.sent);case 7:case"end":return a.stop()}},e)})),Wd.apply(this,arguments)}function ED(e){return qd.apply(this,arguments)}function qd(){return qd=(0,lo.default)(Cr.default.mark(function e(r){var t,n,a,i;return Cr.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=null,n=null,s.t0=Promise,s.next=5,Zt(bD,"textures",r);case 5:return s.t1=s.sent,s.next=8,Zt(_D,"textures",r);case 8:return s.t2=s.sent,s.t3=[s.t1,s.t2],s.next=12,s.t0.all.call(s.t0,s.t3);case 12:return a=s.sent,i=(0,Jd.default)(a,2),t=i[0],n=i[1],t=t||globalThis.BASIS,s.next=19,SD(t,n);case 19:return s.abrupt("return",s.sent);case 20:case"end":return s.stop()}},e)})),qd.apply(this,arguments)}function SD(e,r){var t={};return r&&(t.wasmBinary=r),new Promise(function(n){e(t).then(function(a){var i=a.BasisFile,o=a.KTX2File,s=a.initializeBasis,u=a.BasisEncoder;s(),n({BasisFile:i,KTX2File:o,BasisEncoder:u})})})}var Jn={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919};function wD(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=CD(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function CD(e,r){if(e){if(typeof e=="string")return KS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return KS(e,r)}}function KS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var BD=["","WEBKIT_","MOZ_"],YS={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"},Yu=null;function ZS(e){if(!Yu){e=e||MD()||void 0,Yu=new Set;var r=wD(BD),t;try{for(r.s();!(t=r.n()).done;){var n=t.value;for(var a in YS)if(e&&e.getExtension("".concat(n).concat(a))){var i=YS[a];Yu.add(i)}}}catch(o){r.e(o)}finally{r.f()}}return Yu}function MD(){try{var e=document.createElement("canvas");return e.getContext("webgl")}catch{return null}}var qee=new Uint8Array([0]);var $S,QS,ew,tw,rw,nw,aw,iw;(function(e){e[e.NONE=0]="NONE",e[e.BASISLZ=1]="BASISLZ",e[e.ZSTD=2]="ZSTD",e[e.ZLIB=3]="ZLIB"})($S||($S={})),function(e){e[e.BASICFORMAT=0]="BASICFORMAT"}(QS||(QS={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.ETC1S=163]="ETC1S",e[e.UASTC=166]="UASTC"}(ew||(ew={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.SRGB=1]="SRGB"}(tw||(tw={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LINEAR=1]="LINEAR",e[e.SRGB=2]="SRGB",e[e.ITU=3]="ITU",e[e.NTSC=4]="NTSC",e[e.SLOG=5]="SLOG",e[e.SLOG2=6]="SLOG2"}(rw||(rw={})),function(e){e[e.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",e[e.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(nw||(nw={})),function(e){e[e.RGB=0]="RGB",e[e.RRR=3]="RRR",e[e.GGG=4]="GGG",e[e.AAA=15]="AAA"}(aw||(aw={})),function(e){e[e.RGB=0]="RGB",e[e.RGBA=3]="RGBA",e[e.RRR=4]="RRR",e[e.RRRG=5]="RRRG"}(iw||(iw={}));var Mt=[171,75,84,88,32,50,48,187,13,10,26,10];function ow(e){var r=new Uint8Array(e),t=r.byteLength<Mt.length||r[0]!==Mt[0]||r[1]!==Mt[1]||r[2]!==Mt[2]||r[3]!==Mt[3]||r[4]!==Mt[4]||r[5]!==Mt[5]||r[6]!==Mt[6]||r[7]!==Mt[7]||r[8]!==Mt[8]||r[9]!==Mt[9]||r[10]!==Mt[10]||r[11]!==Mt[11];return!t}var OD={etc1:{basisFormat:0,compressed:!0,format:Jn.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:Jn.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:Jn.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:Jn.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:Jn.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:Jn.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};function Qd(e,r){return $d.apply(this,arguments)}function $d(){return $d=(0,fw.default)(Zd.default.mark(function e(r,t){var n,a,i,o,s,u;return Zd.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(t.basis.containerFormat!=="auto"){l.next=11;break}if(!ow(r)){l.next=6;break}return l.next=4,Kd(t);case 4:return n=l.sent,l.abrupt("return",sw(n.KTX2File,r,t));case 6:return l.next=8,Xd(t);case 8:return a=l.sent,i=a.BasisFile,l.abrupt("return",Yd(i,r,t));case 11:l.t0=t.basis.module,l.next=l.t0==="encoder"?14:(l.t0==="transcoder",22);break;case 14:return l.next=16,Kd(t);case 16:o=l.sent,l.t1=t.basis.containerFormat,l.next=l.t1==="ktx2"?20:(l.t1==="basis",21);break;case 20:return l.abrupt("return",sw(o.KTX2File,r,t));case 21:return l.abrupt("return",Yd(o.BasisFile,r,t));case 22:return l.next=24,Xd(t);case 24:return s=l.sent,u=s.BasisFile,l.abrupt("return",Yd(u,r,t));case 27:case"end":return l.stop()}},e)})),$d.apply(this,arguments)}function Yd(e,r,t){var n=new e(new Uint8Array(r));try{if(!n.startTranscoding())throw new Error("Failed to start basis transcoding");for(var a=n.getNumImages(),i=[],o=0;o<a;o++){for(var s=n.getNumLevels(o),u=[],f=0;f<s;f++)u.push(PD(n,o,f,t));i.push(u)}return i}finally{n.close(),n.delete()}}function PD(e,r,t,n){var a=e.getImageWidth(r,t),i=e.getImageHeight(r,t),o=e.getHasAlpha(),s=lw(n,o),u=s.compressed,f=s.format,l=s.basisFormat,c=e.getImageTranscodedSizeInBytes(r,t,l),h=new Uint8Array(c);if(!e.transcodeImage(h,r,t,l,0,0))throw new Error("failed to start Basis transcoding");return{width:a,height:i,data:h,compressed:u,format:f,hasAlpha:o}}function sw(e,r,t){var n=new e(new Uint8Array(r));try{if(!n.startTranscoding())throw new Error("failed to start KTX2 transcoding");for(var a=n.getLevels(),i=[],o=0;o<a;o++){i.push(ID(n,o,t));break}return[i]}finally{n.close(),n.delete()}}function ID(e,r,t){var n=e.getImageLevelInfo(r,0,0),a=n.alphaFlag,i=n.height,o=n.width,s=lw(t,a),u=s.compressed,f=s.format,l=s.basisFormat,c=e.getImageTranscodedSizeInBytes(r,0,0,l),h=new Uint8Array(c);if(!e.transcodeImage(h,r,0,0,l,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:o,height:i,data:h,compressed:u,levelSize:c,hasAlpha:a,format:f}}function lw(e,r){var t=e&&e.basis&&e.basis.format;return t==="auto"&&(t=Zu()),(0,uw.default)(t)==="object"&&(t=r?t.alpha:t.noAlpha),t=t.toLowerCase(),OD[t]}function Zu(){var e=ZS();return e.has("astc")?"astc-4x4":e.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:e.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:e.has("etc1")?"etc1":e.has("etc2")?"etc2":"rgb565"}function cw(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function hw(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?cw(Object(t),!0).forEach(function(n){(0,dw.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):cw(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var pw={name:"Basis",id:hr?"basis":"basis-nodejs",module:"textures",version:JS,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},ep=hw(hw({},pw),{},{parse:Qd});function $e(e,r){if(!e)throw new Error(r||"assert failed: gltf")}function tp(e,r){var t=e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:");if(t)return e;var n=r.baseUri||r.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url ".concat(e));return n.substr(0,n.lastIndexOf("/")+1)+e}function mw(e,r,t){var n=e.bufferViews[t];$e(n);var a=n.buffer,i=r[a];$e(i);var o=(n.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,o,n.byteLength)}var Kw=m(K()),Gp=m(Y());var lp={};Gt(lp,{decode:()=>eG,name:()=>QD});var up=m(K()),ho=m(Y());var _w=m(Ge()),bw=m(W()),Tw=m(H()),xw=m(z());var vw=["SCALAR","VEC2","VEC3","VEC4"],RD=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],FD=new Map(RD),LD={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},kD={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},DD={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function $u(e){var r=vw[e-1];return r||vw[0]}function Qu(e){var r=FD.get(e.constructor);if(!r)throw new Error("Illegal typed array");return r}function Wa(e,r){var t=DD[e.componentType],n=LD[e.type],a=kD[e.componentType],i=e.count*n,o=e.count*n*a;return $e(o>=0&&o<=r.byteLength),{ArrayType:t,length:i,byteLength:o}}function co(e){var r=e.images,t=e.bufferViews;r=r||[],t=t||[];var n=r.map(function(o){return o.bufferView});t=t.filter(function(o){return!n.includes(o)});var a=t.reduce(function(o,s){return o+s.byteLength},0),i=r.reduce(function(o,s){var u=s.image,f=u.width,l=u.height;return o+f*l},0);return a+Math.ceil(4*i*1.33)}function gw(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=GD(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function GD(e,r){if(e){if(typeof e=="string")return yw(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return yw(e,r)}}function yw(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Aw(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function ND(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Aw(Object(t),!0).forEach(function(n){(0,bw.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Aw(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var UD={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]},Re=function(){function e(r){(0,Tw.default)(this,e),g(this,"gltf",void 0),g(this,"sourceBuffers",void 0),g(this,"byteLength",void 0),this.gltf=r||{json:ND({},UD),buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}return(0,xw.default)(e,[{key:"json",get:function(){return this.gltf.json}},{key:"getApplicationData",value:function(t){var n=this.json[t];return n}},{key:"getExtraData",value:function(t){var n=this.json.extras||{};return n[t]}},{key:"getExtension",value:function(t){var n=this.getUsedExtensions().find(function(i){return i===t}),a=this.json.extensions||{};return n?a[t]||!0:null}},{key:"getRequiredExtension",value:function(t){var n=this.getRequiredExtensions().find(function(a){return a===t});return n?this.getExtension(t):null}},{key:"getRequiredExtensions",value:function(){return this.json.extensionsRequired||[]}},{key:"getUsedExtensions",value:function(){return this.json.extensionsUsed||[]}},{key:"getRemovedExtensions",value:function(){return this.json.extensionsRemoved||[]}},{key:"getObjectExtension",value:function(t,n){var a=t.extensions||{};return a[n]}},{key:"getScene",value:function(t){return this.getObject("scenes",t)}},{key:"getNode",value:function(t){return this.getObject("nodes",t)}},{key:"getSkin",value:function(t){return this.getObject("skins",t)}},{key:"getMesh",value:function(t){return this.getObject("meshes",t)}},{key:"getMaterial",value:function(t){return this.getObject("materials",t)}},{key:"getAccessor",value:function(t){return this.getObject("accessors",t)}},{key:"getTexture",value:function(t){return this.getObject("textures",t)}},{key:"getSampler",value:function(t){return this.getObject("samplers",t)}},{key:"getImage",value:function(t){return this.getObject("images",t)}},{key:"getBufferView",value:function(t){return this.getObject("bufferViews",t)}},{key:"getBuffer",value:function(t){return this.getObject("buffers",t)}},{key:"getObject",value:function(t,n){if((0,_w.default)(n)==="object")return n;var a=this.json[t]&&this.json[t][n];if(!a)throw new Error("glTF file error: Could not find ".concat(t,"[").concat(n,"]"));return a}},{key:"getTypedArrayForBufferView",value:function(t){t=this.getBufferView(t);var n=t.buffer,a=this.gltf.buffers[n];$e(a);var i=(t.byteOffset||0)+a.byteOffset;return new Uint8Array(a.arrayBuffer,i,t.byteLength)}},{key:"getTypedArrayForAccessor",value:function(t){t=this.getAccessor(t);var n=this.getBufferView(t.bufferView),a=this.getBuffer(n.buffer),i=a.data,o=Wa(t,n),s=o.ArrayType,u=o.length,f=n.byteOffset+t.byteOffset;return new s(i,f,u)}},{key:"getTypedArrayForImageData",value:function(t){t=this.getAccessor(t);var n=this.getBufferView(t.bufferView),a=this.getBuffer(n.buffer),i=a.data,o=n.byteOffset||0;return new Uint8Array(i,o,n.byteLength)}},{key:"addApplicationData",value:function(t,n){return this.json[t]=n,this}},{key:"addExtraData",value:function(t,n){return this.json.extras=this.json.extras||{},this.json.extras[t]=n,this}},{key:"addObjectExtension",value:function(t,n,a){return t.extensions=t.extensions||{},t.extensions[n]=a,this.registerUsedExtension(n),this}},{key:"setObjectExtension",value:function(t,n,a){var i=t.extensions||{};i[n]=a}},{key:"removeObjectExtension",value:function(t,n){var a=t.extensions||{},i=a[n];return delete a[n],i}},{key:"addExtension",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return $e(n),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=n,this.registerUsedExtension(t),n}},{key:"addRequiredExtension",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return $e(n),this.addExtension(t,n),this.registerRequiredExtension(t),n}},{key:"registerUsedExtension",value:function(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(function(n){return n===t})||this.json.extensionsUsed.push(t)}},{key:"registerRequiredExtension",value:function(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(function(n){return n===t})||this.json.extensionsRequired.push(t)}},{key:"removeExtension",value:function(t){if(this.getExtension(t)){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t),this.json.extensions&&delete this.json.extensions[t],Array.isArray(this.json.extensionsRemoved)||(this.json.extensionsRemoved=[]);var n=this.json.extensionsRemoved;n.includes(t)||n.push(t)}}},{key:"setDefaultScene",value:function(t){this.json.scene=t}},{key:"addScene",value:function(t){var n=t.nodeIndices;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:n}),this.json.scenes.length-1}},{key:"addNode",value:function(t){var n=t.meshIndex,a=t.matrix;this.json.nodes=this.json.nodes||[];var i={mesh:n};return a&&(i.matrix=a),this.json.nodes.push(i),this.json.nodes.length-1}},{key:"addMesh",value:function(t){var n=t.attributes,a=t.indices,i=t.material,o=t.mode,s=o===void 0?4:o,u=this._addAttributes(n),f={primitives:[{attributes:u,mode:s}]};if(a){var l=this._addIndices(a);f.primitives[0].indices=l}return Number.isFinite(i)&&(f.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(f),this.json.meshes.length-1}},{key:"addPointCloud",value:function(t){var n=this._addAttributes(t),a={primitives:[{attributes:n,mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}},{key:"addImage",value:function(t,n){var a=bn(t),i=n||a?.mimeType,o=this.addBufferView(t),s={bufferView:o,mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(s),this.json.images.length-1}},{key:"addBufferView",value:function(t){var n=t.byteLength;$e(Number.isFinite(n)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);var a={buffer:0,byteOffset:this.byteLength,byteLength:n};return this.byteLength+=kr(n,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(a),this.json.bufferViews.length-1}},{key:"addAccessor",value:function(t,n){var a={bufferView:t,type:$u(n.size),componentType:n.componentType,count:n.count,max:n.max,min:n.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(a),this.json.accessors.length-1}},{key:"addBinaryBuffer",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{size:3},a=this.addBufferView(t),i={min:n.min,max:n.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(t,n.size));var o={size:n.size,componentType:Qu(t),count:Math.round(t.length/n.size),min:i.min,max:i.max};return this.addAccessor(a,Object.assign(o,n))}},{key:"addTexture",value:function(t){var n=t.imageIndex,a={source:n};return this.json.textures=this.json.textures||[],this.json.textures.push(a),this.json.textures.length-1}},{key:"addMaterial",value:function(t){return this.json.materials=this.json.materials||[],this.json.materials.push(t),this.json.materials.length-1}},{key:"createBinaryChunk",value:function(){var t,n;this.gltf.buffers=[];var a=this.byteLength,i=new ArrayBuffer(a),o=new Uint8Array(i),s=0,u=gw(this.sourceBuffers||[]),f;try{for(u.s();!(f=u.n()).done;){var l=f.value;s=ll(l,o,s)}}catch(c){u.e(c)}finally{u.f()}(t=this.json)!==null&&t!==void 0&&(n=t.buffers)!==null&&n!==void 0&&n[0]?this.json.buffers[0].byteLength=a:this.json.buffers=[{byteLength:a}],this.gltf.binary=i,this.sourceBuffers=[i]}},{key:"_removeStringFromArray",value:function(t,n){for(var a=!0;a;){var i=t.indexOf(n);i>-1?t.splice(i,1):a=!1}}},{key:"_addAttributes",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n={};for(var a in t){var i=t[a],o=this._getGltfAttributeName(a),s=this.addBinaryBuffer(i.value,i);n[o]=s}return n}},{key:"_addIndices",value:function(t){return this.addBinaryBuffer(t,{size:1})}},{key:"_getGltfAttributeName",value:function(t){switch(t.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return t}}},{key:"_getAccessorMinMax",value:function(t,n){var a={min:null,max:null};if(t.length<n)return a;a.min=[],a.max=[];var i=t.subarray(0,n),o=gw(i),s;try{for(o.s();!(s=o.n()).done;){var u=s.value;a.min.push(u),a.max.push(u)}}catch(c){o.e(c)}finally{o.f()}for(var f=n;f<t.length;f+=n)for(var l=0;l<n;l++)a.min[0+l]=Math.min(a.min[0+l],t[f+l]),a.max[0+l]=Math.max(a.max[0+l],t[f+l]);return a}}]),e}();var ef=m(K()),Ew=m(Ge()),Xn=m(Y()),bte=(typeof WebAssembly>"u"?"undefined":(0,Ew.default)(WebAssembly))!=="object",jD="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",HD="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",VD=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),zD=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),WD={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},qD={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};function Sw(e,r,t,n,a){return np.apply(this,arguments)}function np(){return np=(0,ef.default)(Xn.default.mark(function e(r,t,n,a,i){var o,s,u=arguments;return Xn.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return o=u.length>5&&u[5]!==void 0?u[5]:"NONE",l.next=3,JD();case 3:s=l.sent,YD(s,s.exports[qD[i]],r,t,n,a,s.exports[WD[o||"NONE"]]);case 5:case"end":return l.stop()}},e)})),np.apply(this,arguments)}var rp;function JD(){return ap.apply(this,arguments)}function ap(){return ap=(0,ef.default)(Xn.default.mark(function e(){return Xn.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return rp||(rp=XD()),t.abrupt("return",rp);case 2:case"end":return t.stop()}},e)})),ap.apply(this,arguments)}function XD(){return ip.apply(this,arguments)}function ip(){return ip=(0,ef.default)(Xn.default.mark(function e(){var r,t;return Xn.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r=jD,WebAssembly.validate(VD)&&(r=HD,console.log("Warning: meshopt_decoder is using experimental SIMD support")),a.next=4,WebAssembly.instantiate(KD(r),{});case 4:return t=a.sent,a.next=7,t.instance.exports.__wasm_call_ctors();case 7:return a.abrupt("return",t.instance);case 8:case"end":return a.stop()}},e)})),ip.apply(this,arguments)}function KD(e){for(var r=new Uint8Array(e.length),t=0;t<e.length;++t){var n=e.charCodeAt(t);r[t]=n>96?n-71:n>64?n-65:n>47?n+4:n>46?63:62}for(var a=0,i=0;i<e.length;++i)r[a++]=r[i]<60?zD[r[i]]:(r[i]-60)*64+r[++i];return r.buffer.slice(0,a)}function YD(e,r,t,n,a,i,o){var s=e.exports.sbrk,u=n+3&-4,f=s(u*a),l=s(i.length),c=new Uint8Array(e.exports.memory.buffer);c.set(i,l);var h=r(f,n,a,l,i.length);if(h===0&&o&&o(f,u,a),t.set(c.subarray(f,f+n*a)),s(f-s(0)),h!==0)throw new Error("Malformed buffer data: ".concat(h))}function ZD(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=$D(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function $D(e,r){if(e){if(typeof e=="string")return ww(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ww(e,r)}}function ww(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var fp="EXT_meshopt_compression",QD=fp;function eG(e,r){return op.apply(this,arguments)}function op(){return op=(0,up.default)(ho.default.mark(function e(r,t){var n,a,i,o,s,u;return ho.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(a=new Re(r),t!=null&&(n=t.gltf)!==null&&n!==void 0&&n.decompressMeshes){l.next=3;break}return l.abrupt("return");case 3:i=[],o=ZD(r.json.bufferViews||[]);try{for(o.s();!(s=o.n()).done;)u=s.value,i.push(tG(a,u))}catch(c){o.e(c)}finally{o.f()}return l.next=8,Promise.all(i);case 8:a.removeExtension(fp);case 9:case"end":return l.stop()}},e)})),op.apply(this,arguments)}function tG(e,r){return sp.apply(this,arguments)}function sp(){return sp=(0,up.default)(ho.default.mark(function e(r,t){var n,a,i,o,s,u,f,l,c,h,d,p,v,y;return ho.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(n=r.getObjectExtension(t,fp),!n){_.next=9;break}return a=n.byteOffset,i=a===void 0?0:a,o=n.byteLength,s=o===void 0?0:o,u=n.byteStride,f=n.count,l=n.mode,c=n.filter,h=c===void 0?"NONE":c,d=n.buffer,p=r.gltf.buffers[d],v=new Uint8Array(p.arrayBuffer,p.byteOffset+i,s),y=new Uint8Array(r.gltf.buffers[t.buffer].arrayBuffer,t.byteOffset,t.byteLength),_.next=8,Sw(y,f,u,v,l,h);case 8:return _.abrupt("return",y);case 9:return _.abrupt("return",null);case 10:case"end":return _.stop()}},e)})),sp.apply(this,arguments)}var cp={};Gt(cp,{name:()=>aG,preprocess:()=>iG});function rG(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=nG(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function nG(e,r){if(e){if(typeof e=="string")return Cw(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Cw(e,r)}}function Cw(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var qa="EXT_texture_webp",aG=qa;function iG(e,r){var t=new Re(e);if(!Vl("image/webp")){if(t.getRequiredExtensions().includes(qa))throw new Error("gltf: Required extension ".concat(qa," not supported by browser"));return}var n=t.json,a=rG(n.textures||[]),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t.getObjectExtension(o,qa);s&&(o.source=s.source),t.removeObjectExtension(o,qa)}}catch(u){a.e(u)}finally{a.f()}t.removeExtension(qa)}var hp={};Gt(hp,{name:()=>uG,preprocess:()=>fG});function oG(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=sG(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function sG(e,r){if(e){if(typeof e=="string")return Bw(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Bw(e,r)}}function Bw(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var tf="KHR_texture_basisu",uG=tf;function fG(e,r){var t=new Re(e),n=t.json,a=oG(n.textures||[]),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t.getObjectExtension(o,tf);s&&(o.source=s.source),t.removeObjectExtension(o,tf)}}catch(u){a.e(u)}finally{a.f()}t.removeExtension(tf)}var Ap={};Gt(Ap,{decode:()=>gG,encode:()=>yG,name:()=>mG,preprocess:()=>vG});var Iw=m(ie()),vp=m(W()),gp=m(K()),Kn=m(Y());function Mw(e){var r={};for(var t in e){var n=e[t];if(t!=="indices"){var a=dp(n);r[t]=a}}return r}function dp(e){var r=lG(e),t=r.buffer,n=r.size,a=r.count,i={value:t,size:n,byteOffset:0,count:a,type:$u(n),componentType:Qu(t)};return i}function lG(e){var r=e,t=1,n=0;return e&&e.value&&(r=e.value,t=e.size||1),r&&(ArrayBuffer.isView(r)||(r=cG(r,Float32Array)),n=r.length/t),{buffer:r,size:t,count:n}}function cG(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e?Array.isArray(e)?new r(e):t&&!(e instanceof r)?new r(e):e:null}function Ow(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function hG(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Ow(Object(t),!0).forEach(function(n){(0,vp.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ow(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var dG=Kn.default.mark(yp);function po(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=pG(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function pG(e,r){if(e){if(typeof e=="string")return Pw(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Pw(e,r)}}function Pw(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Yn="KHR_draco_mesh_compression",mG=Yn;function vG(e,r,t){var n=new Re(e),a=po(yp(n)),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;n.getObjectExtension(o,Yn)}}catch(s){a.e(s)}finally{a.f()}}function gG(e,r,t){return pp.apply(this,arguments)}function pp(){return pp=(0,gp.default)(Kn.default.mark(function e(r,t,n){var a,i,o,s,u,f;return Kn.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(t!=null&&(a=t.gltf)!==null&&a!==void 0&&a.decompressMeshes){c.next=2;break}return c.abrupt("return");case 2:i=new Re(r),o=[],s=po(yp(i));try{for(s.s();!(u=s.n()).done;)f=u.value,i.getObjectExtension(f,Yn)&&o.push(AG(i,f,t,n))}catch(h){s.e(h)}finally{s.f()}return c.next=8,Promise.all(o);case 8:i.removeExtension(Yn);case 9:case"end":return c.stop()}},e)})),pp.apply(this,arguments)}function yG(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=new Re(e),n=po(t.json.meshes||[]),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;_G(i,r),t.addRequiredExtension(Yn)}}catch(o){n.e(o)}finally{n.f()}}function AG(e,r,t,n){return mp.apply(this,arguments)}function mp(){return mp=(0,gp.default)(Kn.default.mark(function e(r,t,n,a){var i,o,s,u,f,l,c,h,d,p,v,y,A,_;return Kn.default.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(i=r.getObjectExtension(t,Yn),i){x.next=3;break}return x.abrupt("return");case 3:return o=r.getTypedArrayForBufferView(i.bufferView),s=vn(o.buffer,o.byteOffset),u=a.parse,f=hG({},n),delete f["3d-tiles"],x.next=10,u(s,qu,f,a);case 10:for(l=x.sent,c=Mw(l.attributes),h=0,d=Object.entries(c);h<d.length;h++)p=(0,Iw.default)(d[h],2),v=p[0],y=p[1],v in t.attributes&&(A=t.attributes[v],_=r.getAccessor(A),_!=null&&_.min&&_!==null&&_!==void 0&&_.max&&(y.min=_.min,y.max=_.max));t.attributes=c,l.indices&&(t.indices=dp(l.indices)),bG(t);case 16:case"end":return x.stop()}},e)})),mp.apply(this,arguments)}function _G(e,r){var t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:4,a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(!a.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");var o=a.DracoWriter.encodeSync({attributes:e}),s=i==null||(t=i.parseSync)===null||t===void 0?void 0:t.call(i,{attributes:e}),u=a._addFauxAttributes(s.attributes),f=a.addBufferView(o),l={primitives:[{attributes:u,mode:n,extensions:(0,vp.default)({},Yn,{bufferView:f,attributes:u})}]};return l}function bG(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function yp(e){var r,t,n,a,i,o;return Kn.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:r=po(e.json.meshes||[]),u.prev=1,r.s();case 3:if((t=r.n()).done){u.next=24;break}n=t.value,a=po(n.primitives),u.prev=6,a.s();case 8:if((i=a.n()).done){u.next=14;break}return o=i.value,u.next=12,o;case 12:u.next=8;break;case 14:u.next=19;break;case 16:u.prev=16,u.t0=u.catch(6),a.e(u.t0);case 19:return u.prev=19,a.f(),u.finish(19);case 22:u.next=3;break;case 24:u.next=29;break;case 26:u.prev=26,u.t1=u.catch(1),r.e(u.t1);case 29:return u.prev=29,r.f(),u.finish(29);case 32:case"end":return u.stop()}},dG,null,[[1,26,29,32],[6,16,19,22]])}var xp={};Gt(xp,{decode:()=>wG,name:()=>xG});var Dw=m(ie()),Gw=m(K()),_p=m(Y());var Rw={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Fw={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4};function Lw(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=TG(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function TG(e,r){if(e){if(typeof e=="string")return kw(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return kw(e,r)}}function kw(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Tp="KHR_texture_transform",xG=Tp,rf=new S,EG=new _e,SG=new _e;function wG(e,r){return bp.apply(this,arguments)}function bp(){return bp=(0,Gw.default)(_p.default.mark(function e(r,t){var n,a,i,o;return _p.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(n=new Re(r),a=n.getExtension(Tp),a){u.next=4;break}return u.abrupt("return");case 4:for(i=r.json.materials||[],o=0;o<i.length;o++)CG(o,r);case 6:case"end":return u.stop()}},e)})),bp.apply(this,arguments)}function CG(e,r){var t,n,a,i=[],o=(t=r.json.materials)===null||t===void 0?void 0:t[e],s=o==null||(n=o.pbrMetallicRoughness)===null||n===void 0?void 0:n.baseColorTexture;s&&mo(r,e,s,i);var u=o?.emissiveTexture;u&&mo(r,e,u,i);var f=o?.normalTexture;f&&mo(r,e,f,i);var l=o?.occlusionTexture;l&&mo(r,e,l,i);var c=o==null||(a=o.pbrMetallicRoughness)===null||a===void 0?void 0:a.metallicRoughnessTexture;c&&mo(r,e,c,i)}function mo(e,r,t,n){var a=BG(t,n);if(a){var i=e.json.meshes||[],o=Lw(i),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,f=Lw(u.primitives),l;try{for(f.s();!(l=f.n()).done;){var c=l.value,h=c.material;Number.isFinite(h)&&r===h&&MG(e,c,a)}}catch(d){f.e(d)}finally{f.f()}}}catch(d){o.e(d)}finally{o.f()}}}function BG(e,r){var t,n=(t=e.extensions)===null||t===void 0?void 0:t[Tp],a=e.texCoord,i=a===void 0?0:a,o=n.texCoord,s=o===void 0?i:o,u=r.findIndex(function(l){var c=(0,Dw.default)(l,2),h=c[0],d=c[1];return h===i&&d===s})!==-1;if(!u){var f=IG(n);return i!==s&&(e.texCoord=s),r.push([i,s]),{originalTexCoord:i,texCoord:s,matrix:f}}return null}function MG(e,r,t){var n=t.originalTexCoord,a=t.texCoord,i=t.matrix,o=r.attributes["TEXCOORD_".concat(n)];if(Number.isFinite(o)){var s,u=(s=e.json.accessors)===null||s===void 0?void 0:s[o];if(u&&u.bufferView){var f,l=(f=e.json.bufferViews)===null||f===void 0?void 0:f[u.bufferView];if(l){for(var c=e.buffers[l.buffer],h=c.arrayBuffer,d=c.byteOffset,p=(d||0)+(u.byteOffset||0)+(l.byteOffset||0),v=Wa(u,l),y=v.ArrayType,A=v.length,_=Fw[u.componentType],E=Rw[u.type],x=l.byteStride||_*E,C=new Float32Array(A),B=0;B<u.count;B++){var F=new y(h,p+B*x,2);rf.set(F[0],F[1],1),rf.transformByMatrix3(i),C.set([rf[0],rf[1]],B*E)}n===a?OG(u,l,e.buffers,C):PG(a,u,r,e,C)}}}}function OG(e,r,t,n){e.componentType=5126,t.push({arrayBuffer:n.buffer,byteOffset:0,byteLength:n.buffer.byteLength}),r.buffer=t.length-1,r.byteLength=n.buffer.byteLength,r.byteOffset=0,delete r.byteStride}function PG(e,r,t,n,a){n.buffers.push({arrayBuffer:a.buffer,byteOffset:0,byteLength:a.buffer.byteLength});var i=n.json.bufferViews;if(i){i.push({buffer:n.buffers.length-1,byteLength:a.buffer.byteLength,byteOffset:0});var o=n.json.accessors;o&&(o.push({bufferView:i?.length-1,byteOffset:0,componentType:5126,count:r.count,type:"VEC2"}),t.attributes["TEXCOORD_".concat(e)]=o.length-1)}}function IG(e){var r=e.offset,t=r===void 0?[0,0]:r,n=e.rotation,a=n===void 0?0:n,i=e.scale,o=i===void 0?[1,1]:i,s=new _e().set(1,0,0,0,1,0,t[0],t[1],1),u=EG.set(Math.cos(a),Math.sin(a),0,-Math.sin(a),Math.cos(a),0,0,0,1),f=SG.set(o[0],0,0,0,o[1],0,0,0,1);return s.multiplyRight(u).multiplyRight(f)}var Cp={};Gt(Cp,{decode:()=>LG,encode:()=>kG,name:()=>FG});var wp=m(K()),vo=m(Y());function Uw(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=RG(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function RG(e,r){if(e){if(typeof e=="string")return Nw(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Nw(e,r)}}function Nw(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Zn="KHR_lights_punctual",FG=Zn;function LG(e){return Ep.apply(this,arguments)}function Ep(){return Ep=(0,wp.default)(vo.default.mark(function e(r){var t,n,a,i,o,s,u;return vo.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:t=new Re(r),n=t.json,a=t.getExtension(Zn),a&&(t.json.lights=a.lights,t.removeExtension(Zn)),i=Uw(n.nodes||[]);try{for(i.s();!(o=i.n()).done;)s=o.value,u=t.getObjectExtension(s,Zn),u&&(s.light=u.light),t.removeObjectExtension(s,Zn)}catch(c){i.e(c)}finally{i.f()}case 6:case"end":return l.stop()}},e)})),Ep.apply(this,arguments)}function kG(e){return Sp.apply(this,arguments)}function Sp(){return Sp=(0,wp.default)(vo.default.mark(function e(r){var t,n,a,i,o,s,u;return vo.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(t=new Re(r),n=t.json,n.lights&&(a=t.addExtension(Zn),$e(!a.lights),a.lights=n.lights,delete n.lights),t.json.lights){i=Uw(t.json.lights);try{for(i.s();!(o=i.n()).done;)s=o.value,u=s.node,t.addObjectExtension(u,Zn,s)}catch(c){i.e(c)}finally{i.f()}delete t.json.lights}case 4:case"end":return l.stop()}},e)})),Sp.apply(this,arguments)}var Op={};Gt(Op,{decode:()=>NG,encode:()=>UG,name:()=>GG});var Hw=m(K()),Bp=m(Y());function Vw(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=DG(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function DG(e,r){if(e){if(typeof e=="string")return jw(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return jw(e,r)}}function jw(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var go="KHR_materials_unlit",GG=go;function NG(e){return Mp.apply(this,arguments)}function Mp(){return Mp=(0,Hw.default)(Bp.default.mark(function e(r){var t,n,a,i,o,s;return Bp.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:t=new Re(r),n=t.json,a=Vw(n.materials||[]);try{for(a.s();!(i=a.n()).done;)o=i.value,s=o.extensions&&o.extensions.KHR_materials_unlit,s&&(o.unlit=!0),t.removeObjectExtension(o,go)}catch(l){a.e(l)}finally{a.f()}t.removeExtension(go);case 5:case"end":return f.stop()}},e)})),Mp.apply(this,arguments)}function UG(e){var r=new Re(e),t=r.json;if(r.materials){var n=Vw(t.materials||[]),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;i.unlit&&(delete i.unlit,r.addObjectExtension(i,go,{}),r.addExtension(go))}}catch(o){n.e(o)}finally{n.f()}}}var Fp={};Gt(Fp,{decode:()=>zG,encode:()=>WG,name:()=>VG});var Ww=m(Ge()),Rp=m(K()),Ao=m(Y());function jG(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=HG(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function HG(e,r){if(e){if(typeof e=="string")return zw(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return zw(e,r)}}function zw(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var yo="KHR_techniques_webgl",VG=yo;function zG(e){return Pp.apply(this,arguments)}function Pp(){return Pp=(0,Rp.default)(Ao.default.mark(function e(r){var t,n,a,i,o,s,u,f;return Ao.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(t=new Re(r),n=t.json,a=t.getExtension(yo),a){i=qG(a,t),o=jG(n.materials||[]);try{for(o.s();!(s=o.n()).done;)u=s.value,f=t.getObjectExtension(u,yo),f&&(u.technique=Object.assign({},f,i[f.technique]),u.technique.values=JG(u.technique,t)),t.removeObjectExtension(u,yo)}catch(h){o.e(h)}finally{o.f()}t.removeExtension(yo)}case 4:case"end":return c.stop()}},e)})),Pp.apply(this,arguments)}function WG(e,r){return Ip.apply(this,arguments)}function Ip(){return Ip=(0,Rp.default)(Ao.default.mark(function e(r,t){return Ao.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:case"end":return a.stop()}},e)})),Ip.apply(this,arguments)}function qG(e,r){var t=e.programs,n=t===void 0?[]:t,a=e.shaders,i=a===void 0?[]:a,o=e.techniques,s=o===void 0?[]:o,u=new TextDecoder;return i.forEach(function(f){if(Number.isFinite(f.bufferView))f.code=u.decode(r.getTypedArrayForBufferView(f.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),n.forEach(function(f){f.fragmentShader=i[f.fragmentShader],f.vertexShader=i[f.vertexShader]}),s.forEach(function(f){f.program=n[f.program]}),s}function JG(e,r){var t=Object.assign({},e.values);return Object.keys(e.uniforms||{}).forEach(function(n){e.uniforms[n].value&&!(n in t)&&(t[n]=e.uniforms[n].value)}),Object.keys(t).forEach(function(n){(0,Ww.default)(t[n])==="object"&&t[n].index!==void 0&&(t[n].texture=r.getTexture(t[n].index))}),t}var Dp={};Gt(Dp,{decode:()=>KG,name:()=>XG});var qw=m(K()),Lp=m(Y());var Jw="EXT_feature_metadata",XG=Jw;function KG(e){return kp.apply(this,arguments)}function kp(){return kp=(0,qw.default)(Lp.default.mark(function e(r){var t;return Lp.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t=new Re(r),YG(t);case 2:case"end":return a.stop()}},e)})),kp.apply(this,arguments)}function YG(e){var r,t=e.getExtension(Jw),n=t==null||(r=t.schema)===null||r===void 0?void 0:r.classes,a=t?.featureTables,i=t?.featureTextures;if(i&&console.warn('featureTextures is not yet supported in the "EXT_feature_metadata" extension.'),n&&a)for(var o in n){var s=n[o],u=QG(a,o);u&&ZG(e,u,s)}}function ZG(e,r,t){for(var n in t.properties){var a,i=t.properties[n],o=r==null||(a=r.properties)===null||a===void 0?void 0:a[n],s=r.count;if(o){var u=$G(e,i,s,o);o.data=u}}}function $G(e,r,t,n){var a=n.bufferView,i=e.getTypedArrayForBufferView(a);switch(r.type){case"STRING":{var o=n.stringOffsetBufferView,s=e.getTypedArrayForBufferView(o);i=eN(i,s,t);break}default:}return i}function QG(e,r){for(var t in e){var n=e[t];if(n.class===r)return n}return null}function eN(e,r,t){for(var n=[],a=new TextDecoder("utf8"),i=0,o=4,s=0;s<t;s++){var u=r[(s+1)*o]-r[s*o],f=e.subarray(i,u+i),l=a.decode(f);n.push(l),i+=u}return n}function Yw(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=tN(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function tN(e,r){if(e){if(typeof e=="string")return Xw(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Xw(e,r)}}function Xw(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Zw=[lp,cp,hp,Ap,Cp,Op,Fp,xp,Dp];function $w(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0,n=Zw.filter(function(u){return eC(u.name,r)}),a=Yw(n),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,s;(s=o.preprocess)===null||s===void 0||s.call(o,e,r,t)}}catch(u){a.e(u)}finally{a.f()}}function Qw(e){return Np.apply(this,arguments)}function Np(){return Np=(0,Kw.default)(Gp.default.mark(function e(r){var t,n,a,i,o,s,u,f=arguments;return Gp.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:t=f.length>1&&f[1]!==void 0?f[1]:{},n=f.length>2?f[2]:void 0,a=Zw.filter(function(h){return eC(h.name,t)}),i=Yw(a),c.prev=4,i.s();case 6:if((o=i.n()).done){c.next=12;break}return s=o.value,c.next=10,(u=s.decode)===null||u===void 0?void 0:u.call(s,r,t,n);case 10:c.next=6;break;case 12:c.next=17;break;case 14:c.prev=14,c.t0=c.catch(4),i.e(c.t0);case 17:return c.prev=17,i.f(),c.finish(17);case 20:case"end":return c.stop()}},e,null,[[4,14,17,20]])})),Np.apply(this,arguments)}function eC(e,r){var t,n=(r==null||(t=r.gltf)===null||t===void 0?void 0:t.excludeExtensions)||{},a=e in n&&!n[e];return!a}var iC=m(H()),oC=m(z());function rN(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=nN(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function nN(e,r){if(e){if(typeof e=="string")return tC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return tC(e,r)}}function tC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Up="KHR_binary_glTF";function rC(e){var r=new Re(e),t=r.json,n=rN(t.images||[]),a;try{for(n.s();!(a=n.n()).done;){var i=a.value,o=r.getObjectExtension(i,Up);o&&Object.assign(i,o),r.removeObjectExtension(i,Up)}}catch(s){n.e(s)}finally{n.f()}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,r.removeExtension(Up)}function sn(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=iN(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function iN(e,r){if(e){if(typeof e=="string")return nC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return nC(e,r)}}function nC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var aC={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},oN={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"},sN=function(){function e(){(0,iC.default)(this,e),g(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),g(this,"json",void 0)}return(0,oC.default)(e,[{key:"normalize",value:function(t,n){this.json=t.json;var a=t.json;switch(a.asset&&a.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn("glTF: Unknown version ".concat(a.asset.version));return}if(!n.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(a),this._convertTopLevelObjectsToArrays(a),rC(t),this._convertObjectIdsToArrayIndices(a),this._updateObjects(a),this._updateMaterial(a)}},{key:"_addAsset",value:function(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}},{key:"_convertTopLevelObjectsToArrays",value:function(t){for(var n in aC)this._convertTopLevelObjectToArray(t,n)}},{key:"_convertTopLevelObjectToArray",value:function(t,n){var a=t[n];if(!(!a||Array.isArray(a))){t[n]=[];for(var i in a){var o=a[i];o.id=o.id||i;var s=t[n].length;t[n].push(o),this.idToIndexMap[n][i]=s}}}},{key:"_convertObjectIdsToArrayIndices",value:function(t){for(var n in aC)this._convertIdsToIndices(t,n);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));var a=sn(t.textures),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;this._convertTextureIds(o)}}catch(y){a.e(y)}finally{a.f()}var s=sn(t.meshes),u;try{for(s.s();!(u=s.n()).done;){var f=u.value;this._convertMeshIds(f)}}catch(y){s.e(y)}finally{s.f()}var l=sn(t.nodes),c;try{for(l.s();!(c=l.n()).done;){var h=c.value;this._convertNodeIds(h)}}catch(y){l.e(y)}finally{l.f()}var d=sn(t.scenes),p;try{for(d.s();!(p=d.n()).done;){var v=p.value;this._convertSceneIds(v)}}catch(y){d.e(y)}finally{d.f()}}},{key:"_convertTextureIds",value:function(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}},{key:"_convertMeshIds",value:function(t){var n=sn(t.primitives),a;try{for(n.s();!(a=n.n()).done;){var i=a.value,o=i.attributes,s=i.indices,u=i.material;for(var f in o)o[f]=this._convertIdToIndex(o[f],"accessor");s&&(i.indices=this._convertIdToIndex(s,"accessor")),u&&(i.material=this._convertIdToIndex(u,"material"))}}catch(l){n.e(l)}finally{n.f()}}},{key:"_convertNodeIds",value:function(t){var n=this;t.children&&(t.children=t.children.map(function(a){return n._convertIdToIndex(a,"node")})),t.meshes&&(t.meshes=t.meshes.map(function(a){return n._convertIdToIndex(a,"mesh")}))}},{key:"_convertSceneIds",value:function(t){var n=this;t.nodes&&(t.nodes=t.nodes.map(function(a){return n._convertIdToIndex(a,"node")}))}},{key:"_convertIdsToIndices",value:function(t,n){t[n]||(console.warn("gltf v1: json doesn't contain attribute ".concat(n)),t[n]=[]);var a=sn(t[n]),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;for(var s in o){var u=o[s],f=this._convertIdToIndex(u,s);o[s]=f}}}catch(l){a.e(l)}finally{a.f()}}},{key:"_convertIdToIndex",value:function(t,n){var a=oN[n];if(a in this.idToIndexMap){var i=this.idToIndexMap[a][t];if(!Number.isFinite(i))throw new Error("gltf v1: failed to resolve ".concat(n," with id ").concat(t));return i}return t}},{key:"_updateObjects",value:function(t){var n=sn(this.json.buffers),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;delete i.type}}catch(o){n.e(o)}finally{n.f()}}},{key:"_updateMaterial",value:function(t){var n=sn(t.materials),a;try{var i=function(){var l=a.value;l.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};var c=((o=l.values)===null||o===void 0?void 0:o.tex)||((s=l.values)===null||s===void 0?void 0:s.texture2d_0)||((u=l.values)===null||u===void 0?void 0:u.diffuseTex),h=t.textures.findIndex(function(d){return d.id===c});h!==-1&&(l.pbrMetallicRoughness.baseColorTexture={index:h})};for(n.s();!(a=n.n()).done;){var o,s,u;i()}}catch(f){n.e(f)}finally{n.f()}}}]),e}();function sC(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new sN().normalize(e,r)}var fC=m(Ge()),lC=m(H()),cC=m(z()),Xa=m(W());var Ja;function uC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Br(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?uC(Object(t),!0).forEach(function(n){(0,Xa.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):uC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var uN={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},fN={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Lt={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},lN={magFilter:Lt.TEXTURE_MAG_FILTER,minFilter:Lt.TEXTURE_MIN_FILTER,wrapS:Lt.TEXTURE_WRAP_S,wrapT:Lt.TEXTURE_WRAP_T},cN=(Ja={},(0,Xa.default)(Ja,Lt.TEXTURE_MAG_FILTER,Lt.LINEAR),(0,Xa.default)(Ja,Lt.TEXTURE_MIN_FILTER,Lt.NEAREST_MIPMAP_LINEAR),(0,Xa.default)(Ja,Lt.TEXTURE_WRAP_S,Lt.REPEAT),(0,Xa.default)(Ja,Lt.TEXTURE_WRAP_T,Lt.REPEAT),Ja);function hN(e){return fN[e]}function dN(e){return uN[e]}var pN=function(){function e(){(0,lC.default)(this,e),g(this,"baseUri",""),g(this,"json",{}),g(this,"buffers",[]),g(this,"images",[])}return(0,cC.default)(e,[{key:"postProcess",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=t.json,i=t.buffers,o=i===void 0?[]:i,s=t.images,u=s===void 0?[]:s,f=t.baseUri,l=f===void 0?"":f;return $e(a),this.baseUri=l,this.json=a,this.buffers=o,this.images=u,this._resolveTree(this.json,n),this.json}},{key:"_resolveTree",value:function(t){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t.bufferViews&&(t.bufferViews=t.bufferViews.map(function(i,o){return n._resolveBufferView(i,o)})),t.images&&(t.images=t.images.map(function(i,o){return n._resolveImage(i,o)})),t.samplers&&(t.samplers=t.samplers.map(function(i,o){return n._resolveSampler(i,o)})),t.textures&&(t.textures=t.textures.map(function(i,o){return n._resolveTexture(i,o)})),t.accessors&&(t.accessors=t.accessors.map(function(i,o){return n._resolveAccessor(i,o)})),t.materials&&(t.materials=t.materials.map(function(i,o){return n._resolveMaterial(i,o)})),t.meshes&&(t.meshes=t.meshes.map(function(i,o){return n._resolveMesh(i,o)})),t.nodes&&(t.nodes=t.nodes.map(function(i,o){return n._resolveNode(i,o)})),t.skins&&(t.skins=t.skins.map(function(i,o){return n._resolveSkin(i,o)})),t.scenes&&(t.scenes=t.scenes.map(function(i,o){return n._resolveScene(i,o)})),t.scene!==void 0&&(t.scene=t.scenes[this.json.scene])}},{key:"getScene",value:function(t){return this._get("scenes",t)}},{key:"getNode",value:function(t){return this._get("nodes",t)}},{key:"getSkin",value:function(t){return this._get("skins",t)}},{key:"getMesh",value:function(t){return this._get("meshes",t)}},{key:"getMaterial",value:function(t){return this._get("materials",t)}},{key:"getAccessor",value:function(t){return this._get("accessors",t)}},{key:"getCamera",value:function(t){return null}},{key:"getTexture",value:function(t){return this._get("textures",t)}},{key:"getSampler",value:function(t){return this._get("samplers",t)}},{key:"getImage",value:function(t){return this._get("images",t)}},{key:"getBufferView",value:function(t){return this._get("bufferViews",t)}},{key:"getBuffer",value:function(t){return this._get("buffers",t)}},{key:"_get",value:function(t,n){if((0,fC.default)(n)==="object")return n;var a=this.json[t]&&this.json[t][n];return a||console.warn("glTF file error: Could not find ".concat(t,"[").concat(n,"]")),a}},{key:"_resolveScene",value:function(t,n){var a=this;return t.id=t.id||"scene-".concat(n),t.nodes=(t.nodes||[]).map(function(i){return a.getNode(i)}),t}},{key:"_resolveNode",value:function(t,n){var a=this;return t.id=t.id||"node-".concat(n),t.children&&(t.children=t.children.map(function(i){return a.getNode(i)})),t.mesh!==void 0?t.mesh=this.getMesh(t.mesh):t.meshes!==void 0&&t.meshes.length&&(t.mesh=t.meshes.reduce(function(i,o){var s=a.getMesh(o);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),t.camera!==void 0&&(t.camera=this.getCamera(t.camera)),t.skin!==void 0&&(t.skin=this.getSkin(t.skin)),t}},{key:"_resolveSkin",value:function(t,n){return t.id=t.id||"skin-".concat(n),t.inverseBindMatrices=this.getAccessor(t.inverseBindMatrices),t}},{key:"_resolveMesh",value:function(t,n){var a=this;return t.id=t.id||"mesh-".concat(n),t.primitives&&(t.primitives=t.primitives.map(function(i){i=Br({},i);var o=i.attributes;i.attributes={};for(var s in o)i.attributes[s]=a.getAccessor(o[s]);return i.indices!==void 0&&(i.indices=a.getAccessor(i.indices)),i.material!==void 0&&(i.material=a.getMaterial(i.material)),i})),t}},{key:"_resolveMaterial",value:function(t,n){if(t.id=t.id||"material-".concat(n),t.normalTexture&&(t.normalTexture=Br({},t.normalTexture),t.normalTexture.texture=this.getTexture(t.normalTexture.index)),t.occlusionTexture&&(t.occlustionTexture=Br({},t.occlustionTexture),t.occlusionTexture.texture=this.getTexture(t.occlusionTexture.index)),t.emissiveTexture&&(t.emmisiveTexture=Br({},t.emmisiveTexture),t.emissiveTexture.texture=this.getTexture(t.emissiveTexture.index)),t.emissiveFactor||(t.emissiveFactor=t.emmisiveTexture?[1,1,1]:[0,0,0]),t.pbrMetallicRoughness){t.pbrMetallicRoughness=Br({},t.pbrMetallicRoughness);var a=t.pbrMetallicRoughness;a.baseColorTexture&&(a.baseColorTexture=Br({},a.baseColorTexture),a.baseColorTexture.texture=this.getTexture(a.baseColorTexture.index)),a.metallicRoughnessTexture&&(a.metallicRoughnessTexture=Br({},a.metallicRoughnessTexture),a.metallicRoughnessTexture.texture=this.getTexture(a.metallicRoughnessTexture.index))}return t}},{key:"_resolveAccessor",value:function(t,n){if(t.id=t.id||"accessor-".concat(n),t.bufferView!==void 0&&(t.bufferView=this.getBufferView(t.bufferView)),t.bytesPerComponent=hN(t.componentType),t.components=dN(t.type),t.bytesPerElement=t.bytesPerComponent*t.components,t.bufferView){var a=t.bufferView.buffer,i=Wa(t,t.bufferView),o=i.ArrayType,s=i.byteLength,u=(t.bufferView.byteOffset||0)+(t.byteOffset||0)+a.byteOffset,f=a.arrayBuffer.slice(u,u+s);t.bufferView.byteStride&&(f=this._getValueFromInterleavedBuffer(a,u,t.bufferView.byteStride,t.bytesPerElement,t.count)),t.value=new o(f)}return t}},{key:"_getValueFromInterleavedBuffer",value:function(t,n,a,i,o){for(var s=new Uint8Array(o*i),u=0;u<o;u++){var f=n+u*a;s.set(new Uint8Array(t.arrayBuffer.slice(f,f+i)),u*i)}return s.buffer}},{key:"_resolveTexture",value:function(t,n){return t.id=t.id||"texture-".concat(n),t.sampler="sampler"in t?this.getSampler(t.sampler):cN,t.source=this.getImage(t.source),t}},{key:"_resolveSampler",value:function(t,n){t.id=t.id||"sampler-".concat(n),t.parameters={};for(var a in t){var i=this._enumSamplerParameter(a);i!==void 0&&(t.parameters[i]=t[a])}return t}},{key:"_enumSamplerParameter",value:function(t){return lN[t]}},{key:"_resolveImage",value:function(t,n){t.id=t.id||"image-".concat(n),t.bufferView!==void 0&&(t.bufferView=this.getBufferView(t.bufferView));var a=this.images[n];return a&&(t.image=a),t}},{key:"_resolveBufferView",value:function(t,n){var a=t.buffer,i=Br(Br({id:"bufferView-".concat(n)},t),{},{buffer:this.buffers[a]}),o=this.buffers[a].arrayBuffer,s=this.buffers[a].byteOffset||0;return"byteOffset"in t&&(s+=t.byteOffset),i.data=new Uint8Array(o,s,t.byteLength),i}},{key:"_resolveCamera",value:function(t,n){return t.id=t.id||"camera-".concat(n),t.perspective,t.orthographic,t}}]),e}();function hC(e,r){return new pN().postProcess(e,r)}var dC=1735152710,Vp=12,nf=8,mN=1313821514,vN=5130562,gN=0,yN=1,AN=0,Ka=!0;function _N(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return"".concat(String.fromCharCode(e.getUint8(r+0))).concat(String.fromCharCode(e.getUint8(r+1))).concat(String.fromCharCode(e.getUint8(r+2))).concat(String.fromCharCode(e.getUint8(r+3)))}function pC(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=new DataView(e),a=t.magic,i=a===void 0?dC:a,o=n.getUint32(r,!1);return o===i||o===dC}function zp(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=new DataView(r),i=_N(a,t+0),o=a.getUint32(t+4,Ka),s=a.getUint32(t+8,Ka);switch(Object.assign(e,{header:{byteOffset:t,byteLength:s,hasBinChunk:!1},type:i,version:o,json:{},binChunks:[]}),t+=Vp,e.version){case 1:return bN(e,a,t);case 2:return TN(e,a,t,n={});default:throw new Error("Invalid GLB version ".concat(e.version,". Only supports v1 and v2."))}}function bN(e,r,t){se(e.header.byteLength>Vp+nf);var n=r.getUint32(t+0,Ka),a=r.getUint32(t+4,Ka);return t+=nf,se(a===AN),jp(e,r,t,n),t+=n,t+=Hp(e,r,t,e.header.byteLength),t}function TN(e,r,t,n){return se(e.header.byteLength>Vp+nf),xN(e,r,t,n),t+e.header.byteLength}function xN(e,r,t,n){for(;t+8<=e.header.byteLength;){var a=r.getUint32(t+0,Ka),i=r.getUint32(t+4,Ka);switch(t+=nf,i){case mN:jp(e,r,t,a);break;case vN:Hp(e,r,t,a);break;case gN:n.strict||jp(e,r,t,a);break;case yN:n.strict||Hp(e,r,t,a);break;default:break}t+=kr(a,4)}return t}function jp(e,r,t,n){var a=new Uint8Array(r.buffer,t,n),i=new TextDecoder("utf8"),o=i.decode(a);return e.json=JSON.parse(o),kr(n,4)}function Hp(e,r,t,n){return e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:t,byteLength:n,arrayBuffer:r.buffer}),kr(n,4)}function vC(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=EN(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function EN(e,r){if(e){if(typeof e=="string")return mC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return mC(e,r)}}function mC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function gC(e,r){return Wp.apply(this,arguments)}function Wp(){return Wp=(0,_o.default)(Mr.default.mark(function e(r,t){var n,a,i,o,s,u,f,l,c,h,d=arguments;return Mr.default.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(s=d.length>2&&d[2]!==void 0?d[2]:0,u=d.length>3?d[3]:void 0,f=d.length>4?d[4]:void 0,SN(r,t,s,u),sC(r,{normalize:u==null||(n=u.gltf)===null||n===void 0?void 0:n.normalize}),$w(r,u,f),l=[],!(u!=null&&(a=u.gltf)!==null&&a!==void 0&&a.loadBuffers&&r.json.buffers)){v.next=10;break}return v.next=10,wN(r,u,f);case 10:return u!=null&&(i=u.gltf)!==null&&i!==void 0&&i.loadImages&&(c=CN(r,u,f),l.push(c)),h=Qw(r,u,f),l.push(h),v.next=15,Promise.all(l);case 15:return v.abrupt("return",u!=null&&(o=u.gltf)!==null&&o!==void 0&&o.postProcess?hC(r,u):r);case 16:case"end":return v.stop()}},e)})),Wp.apply(this,arguments)}function SN(e,r,t,n){if(n.uri&&(e.baseUri=n.uri),r instanceof ArrayBuffer&&!pC(r,t,n)){var a=new TextDecoder;r=a.decode(r)}if(typeof r=="string")e.json=fl(r);else if(r instanceof ArrayBuffer){var i={};t=zp(i,r,t,n.glb),$e(i.type==="glTF","Invalid GLB magic string ".concat(i.type)),e._glb=i,e.json=i.json}else $e(!1,"GLTF: must be ArrayBuffer or string");var o=e.json.buffers||[];if(e.buffers=new Array(o.length).fill(null),e._glb&&e._glb.header.hasBinChunk){var s=e._glb.binChunks;e.buffers[0]={arrayBuffer:s[0].arrayBuffer,byteOffset:s[0].byteOffset,byteLength:s[0].byteLength}}var u=e.json.images||[];e.images=new Array(u.length).fill({})}function wN(e,r,t){return qp.apply(this,arguments)}function qp(){return qp=(0,_o.default)(Mr.default.mark(function e(r,t,n){var a,i,o,s,u,f,l,c,h;return Mr.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:a=r.json.buffers||[],i=0;case 2:if(!(i<a.length)){p.next=22;break}if(o=a[i],!o.uri){p.next=18;break}return f=n.fetch,$e(f),l=tp(o.uri,t),p.next=10,n==null||(s=n.fetch)===null||s===void 0?void 0:s.call(n,l);case 10:return c=p.sent,p.next=13,c==null||(u=c.arrayBuffer)===null||u===void 0?void 0:u.call(c);case 13:h=p.sent,r.buffers[i]={arrayBuffer:h,byteOffset:0,byteLength:h.byteLength},delete o.uri,p.next=19;break;case 18:r.buffers[i]===null&&(r.buffers[i]={arrayBuffer:new ArrayBuffer(o.byteLength),byteOffset:0,byteLength:o.byteLength});case 19:++i,p.next=2;break;case 22:case"end":return p.stop()}},e)})),qp.apply(this,arguments)}function CN(e,r,t){return Jp.apply(this,arguments)}function Jp(){return Jp=(0,_o.default)(Mr.default.mark(function e(r,t,n){var a,i,o,s,u,f;return Mr.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:a=BN(r),i=r.json.images||[],o=[],s=vC(a);try{for(s.s();!(u=s.n()).done;)f=u.value,o.push(MN(r,i[f],f,t,n))}catch(h){s.e(h)}finally{s.f()}return c.next=7,Promise.all(o);case 7:return c.abrupt("return",c.sent);case 8:case"end":return c.stop()}},e)})),Jp.apply(this,arguments)}function BN(e){var r=new Set,t=e.json.textures||[],n=vC(t),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;i.source!==void 0&&r.add(i.source)}}catch(o){n.e(o)}finally{n.f()}return Array.from(r).sort()}function MN(e,r,t,n,a){return Xp.apply(this,arguments)}function Xp(){return Xp=(0,_o.default)(Mr.default.mark(function e(r,t,n,a,i){var o,s,u,f,l,c,h;return Mr.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(o=i.fetch,s=i.parse,!(t.uri&&!t.hasOwnProperty("bufferView"))){p.next=10;break}return f=tp(t.uri,a),p.next=5,o(f);case 5:return l=p.sent,p.next=8,l.arrayBuffer();case 8:u=p.sent,t.bufferView={data:u};case 10:return Number.isFinite(t.bufferView)&&(c=mw(r.json,r.buffers,t.bufferView),u=vn(c.buffer,c.byteOffset,c.byteLength)),$e(u,"glTF image has no data"),p.next=14,s(u,[pr,ep],{mimeType:t.mimeType,basis:a.basis||{format:Zu()}},i);case 14:h=p.sent,h&&h[0]&&(h={compressed:!0,mipmaps:!1,width:h[0].width,height:h[0].height,data:h[0]}),r.images=r.images||[],r.images[n]=h;case 18:case"end":return p.stop()}},e)})),Xp.apply(this,arguments)}function yC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function af(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?yC(Object(t),!0).forEach(function(n){(0,AC.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):yC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var $n={name:"glTF",id:"gltf",module:"gltf",version:qS,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:ON,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function ON(e){return Yp.apply(this,arguments)}function Yp(){return Yp=(0,_C.default)(Kp.default.mark(function e(r){var t,n,a,i,o,s,u=arguments;return Kp.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=u.length>1&&u[1]!==void 0?u[1]:{},n=u.length>2?u[2]:void 0,t=af(af({},$n.options),t),t.gltf=af(af({},$n.options.gltf),t.gltf),a=t,i=a.byteOffset,o=i===void 0?0:i,s={},l.next=8,gC(s,r,o,t,n);case 8:return l.abrupt("return",l.sent);case 9:case"end":return l.stop()}},e)})),Yp.apply(this,arguments)}var of={URI:0,EMBEDDED:1};function sf(e,r,t,n){e.rotateYtoZ=!0;var a=e.byteOffset+e.byteLength-t;if(a===0)throw new Error("glTF byte length must be greater than 0.");return e.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",e.gltfArrayBuffer=vn(r,t,a),e.gltfByteOffset=0,e.gltfByteLength=a,t%4===0||console.warn("".concat(e.type,": embedded glb is not aligned to a 4-byte boundary.")),e.byteOffset+e.byteLength}function uf(e,r,t,n){return $p.apply(this,arguments)}function $p(){return $p=(0,bC.default)(Zp.default.mark(function e(r,t,n,a){var i,o,s;return Zp.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(i=n["3d-tiles"]||{},PN(r,t,n),!i.loadGLTF){f.next=17;break}if(o=a.parse,s=a.fetch,!r.gltfUrl){f.next=9;break}return f.next=7,s(r.gltfUrl,n);case 7:r.gltfArrayBuffer=f.sent,r.gltfByteOffset=0;case 9:if(!r.gltfArrayBuffer){f.next=17;break}return f.next=12,o(r.gltfArrayBuffer,$n,n,a);case 12:r.gltf=f.sent,r.gpuMemoryUsageInBytes=co(r.gltf),delete r.gltfArrayBuffer,delete r.gltfByteOffset,delete r.gltfByteLength;case 17:case"end":return f.stop()}},e)})),$p.apply(this,arguments)}function PN(e,r,t){switch(r){case of.URI:var n=new Uint8Array(e.gltfArrayBuffer,e.gltfByteOffset),a=new TextDecoder,i=a.decode(n);e.gltfUrl=i.replace(/[\s\0]+$/,""),delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength;break;case of.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}function xC(e,r,t,n,a){return em.apply(this,arguments)}function em(){return em=(0,TC.default)(Qp.default.mark(function e(r,t,n,a,i){var o,s;return Qp.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return n=IN(r,t,n,a,i),f.next=3,uf(r,of.EMBEDDED,a,i);case 3:return s=r==null||(o=r.gltf)===null||o===void 0?void 0:o.extensions,s&&s.CESIUM_RTC&&(r.rtcCenter=s.CESIUM_RTC.center),f.abrupt("return",n);case 6:case"end":return f.stop()}},e)})),em.apply(this,arguments)}function IN(e,r,t,n,a){t=on(e,r,t),t=Va(e,r,t),t=za(e,r,t,n),t=sf(e,r,t,n);var i=new Ua(e.featureTableJson,e.featureTableBinary);return e.rtcCenter=i.getGlobalProperty("RTC_CENTER",5126,3),t}var EC=m(K()),tm=m(Y());function SC(e,r,t,n,a){return rm.apply(this,arguments)}function rm(){return rm=(0,EC.default)(tm.default.mark(function e(r,t,n,a,i){return tm.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=RN(r,t,n,a,i),s.next=3,uf(r,r.gltfFormat,a,i);case 3:return s.abrupt("return",n);case 4:case"end":return s.stop()}},e)})),rm.apply(this,arguments)}function RN(e,r,t,n,a){if(t=on(e,r,t),e.version!==1)throw new Error("Instanced 3D Model version ".concat(e.version," is not supported"));t=Va(e,r,t);var i=new DataView(r);if(e.gltfFormat=i.getUint32(t,!0),t+=4,t=za(e,r,t,n),t=sf(e,r,t,n),e.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");var o=new Ua(e.featureTableJson,e.featureTableBinary),s=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=s,!Number.isFinite(s))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");e.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),e.rtcCenter=o.getGlobalProperty("RTC_CENTER",5126,3);var u=new Xu(e.batchTableJson,e.batchTableBinary,s);return FN(e,o,u,s),t}function FN(e,r,t,n){for(var a={instances:new Array(n),batchTable:e._batchTable,cull:!1,url:void 0,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,forwardAxis:[1,0,0]},i=a.instances,o=new S,s=new S,u=new S,f=new S,l=new _e,c=new Hr,h=new S,d={},p=new ee,v=[],y=[],A=new S,_=new S,E=0;E<n;E++){var x=void 0;if(r.hasProperty("POSITION"))x=r.getProperty("POSITION",5126,3,E,o);else if(r.hasProperty("POSITION_QUANTIZED")){x=r.getProperty("POSITION_QUANTIZED",5123,3,E,o);var C=r.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",5126,3,A);if(!C)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");var B=r.getGlobalProperty("QUANTIZED_VOLUME_SCALE",5126,3,_);if(!B)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(var F=65535,M=0;M<3;M++)x[M]=x[M]/F*B[M]+C[M]}if(!x)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");o.copy(x),d.translation=o,e.normalUp=r.getProperty("NORMAL_UP",5126,3,E,v),e.normalRight=r.getProperty("NORMAL_RIGHT",5126,3,E,y);var w=!1;if(e.normalUp){if(!e.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");e.hasCustomOrientation=!0}else{if(e.octNormalUp=r.getProperty("NORMAL_UP_OCT32P",5123,2,v),e.octNormalRight=r.getProperty("NORMAL_RIGHT_OCT32P",5123,2,y),e.octNormalUp)throw e.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");e.eastNorthUp?(pe.WGS84.eastNorthUpToFixedFrame(o,p),p.getRotationMatrix3(l)):l.identity()}w&&(f.copy(s).cross(u).normalize(),l.setColumn(0,s),l.setColumn(1,u),l.setColumn(2,f)),c.fromMatrix3(l),d.rotation=c,h.set(1,1,1);var b=r.getProperty("SCALE",5126,1,E);Number.isFinite(b)&&h.multiplyByScalar(b);var I=r.getProperty("SCALE_NON_UNIFORM",5126,3,E,v);I&&h.scale(I),d.scale=h;var L=r.getProperty("BATCH_ID",5123,1,E);L===void 0&&(L=E);var k=new ee().fromQuaternion(d.rotation);p.identity(),p.translate(d.translation),p.multiplyRight(k),p.scale(d.scale);var D=p.clone();i[E]={modelMatrix:D,batchId:L}}e.instances=i}var wC=m(K()),nm=m(Y());function CC(e,r,t,n,a,i){return am.apply(this,arguments)}function am(){return am=(0,wC.default)(nm.default.mark(function e(r,t,n,a,i,o){var s,u;return nm.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:n=on(r,t,n),s=new DataView(t),r.tilesLength=s.getUint32(n,!0),n+=4,r.tiles=[];case 5:if(!(r.tiles.length<r.tilesLength&&r.byteLength-n>12)){l.next=13;break}return u={},r.tiles.push(u),l.next=10,o(t,n,a,i,u);case 10:n=l.sent,l.next=5;break;case 13:return l.abrupt("return",n);case 14:case"end":return l.stop()}},e)})),am.apply(this,arguments)}var BC=m(K()),im=m(Y());function MC(e,r,t,n){return om.apply(this,arguments)}function om(){return om=(0,BC.default)(im.default.mark(function e(r,t,n,a){var i;return im.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return r.rotateYtoZ=!0,r.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",i=a.parse,s.next=5,i(t,$n,n,a);case 5:r.gltf=s.sent,r.gpuMemoryUsageInBytes=co(r.gltf);case 7:case"end":return s.stop()}},e)})),om.apply(this,arguments)}function fm(e){return um.apply(this,arguments)}function um(){return um=(0,OC.default)(sm.default.mark(function e(r){var t,n,a,i,o=arguments;return sm.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:t=o.length>1&&o[1]!==void 0?o[1]:0,n=o.length>2?o[2]:void 0,a=o.length>3?o[3]:void 0,i=o.length>4&&o[4]!==void 0?o[4]:{},i.byteOffset=t,i.type=yE(r,t),u.t0=i.type,u.next=u.t0===Vn.COMPOSITE?9:u.t0===Vn.BATCHED_3D_MODEL?12:u.t0===Vn.GLTF?15:u.t0===Vn.INSTANCED_3D_MODEL?18:u.t0===Vn.POINT_CLOUD?21:24;break;case 9:return u.next=11,CC(i,r,t,n,a,fm);case 11:return u.abrupt("return",u.sent);case 12:return u.next=14,xC(i,r,t,n,a);case 14:return u.abrupt("return",u.sent);case 15:return u.next=17,MC(i,r,n,a);case 17:return u.abrupt("return",u.sent);case 18:return u.next=20,SC(i,r,t,n,a);case 20:return u.abrupt("return",u.sent);case 21:return u.next=23,WS(i,r,t,n,a);case 23:return u.abrupt("return",u.sent);case 24:throw new Error("3DTileLoader: unknown type ".concat(i.type));case 25:case"end":return u.stop()}},e)})),um.apply(this,arguments)}var df=m(K()),ta=m(Y());var dm=m(K()),bo=m(Y()),LN=1952609651,kN=1;function pm(e,r,t){return cm.apply(this,arguments)}function cm(){return cm=(0,dm.default)(bo.default.mark(function e(r,t,n){var a,i,o,s,u,f,l,c,h;return bo.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(a=new Uint32Array(r.slice(0,4)),a[0]===LN){p.next=3;break}throw new Error("Wrong subtree file magic number");case 3:if(i=new Uint32Array(r.slice(4,8)),i[0]===kN){p.next=6;break}throw new Error("Wrong subtree file verson, must be 1");case 6:if(o=PC(r.slice(8,16)),s=new Uint8Array(r,24,o),u=new TextDecoder("utf8"),f=u.decode(s),l=JSON.parse(f),c=PC(r.slice(16,24)),h=new ArrayBuffer(0),c&&(h=r.slice(24+o)),!("bufferView"in l.tileAvailability)){p.next=18;break}return p.next=17,lm(l,"tileAvailability",h,n);case 17:l.tileAvailability.explicitBitstream=p.sent;case 18:if(!("bufferView"in l.contentAvailability)){p.next=22;break}return p.next=21,lm(l,"contentAvailability",h,n);case 21:l.contentAvailability.explicitBitstream=p.sent;case 22:if(!("bufferView"in l.childSubtreeAvailability)){p.next=26;break}return p.next=25,lm(l,"childSubtreeAvailability",h,n);case 25:l.childSubtreeAvailability.explicitBitstream=p.sent;case 26:return p.abrupt("return",l);case 27:case"end":return p.stop()}},e)})),cm.apply(this,arguments)}function DN(e,r){var t=r.startsWith("http");if(t){var n=new URL(e,r);return decodeURI(n.toString())}var a="http://".concat(r),i=new URL(e,a);return"/".concat(i.host).concat(i.pathname)}function lm(e,r,t,n){return hm.apply(this,arguments)}function hm(){return hm=(0,dm.default)(bo.default.mark(function e(r,t,n,a){var i,o,s,u,f,l;return bo.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(i=r[t].bufferView,o=r.bufferViews[i],s=r.buffers[o.buffer],!(!(a!=null&&a.url)||!a.fetch)){h.next=5;break}throw new Error("Url is not provided");case 5:if(a.fetch){h.next=7;break}throw new Error("fetch is not provided");case 7:if(!s.uri){h.next=16;break}return u=DN(s.uri,a?.url),h.next=11,a.fetch(u);case 11:return f=h.sent,h.next=14,f.arrayBuffer();case 14:return l=h.sent,h.abrupt("return",new Uint8Array(l,o.byteOffset,o.byteLength));case 16:return h.abrupt("return",new Uint8Array(n,o.byteOffset,o.byteLength));case 17:case"end":return h.stop()}},e)})),hm.apply(this,arguments)}function PC(e){var r=new DataView(e),t=r.getUint32(0,!0),n=r.getUint32(4,!0);return t+Math.pow(2,32)*n}var ff={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:Ru,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:pm,options:{}};var a2=m(La());var YC=m(ie()),ZC=m(K()),$C=m(W()),Mm=m(Y());var QC=m(La());var kt=null;try{kt=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Be(e,r,t){this.low=e|0,this.high=r|0,this.unsigned=!!t}Be.prototype.__isLong__;Object.defineProperty(Be.prototype,"__isLong__",{value:!0});function ot(e){return(e&&e.__isLong__)===!0}function IC(e){var r=Math.clz32(e&-e);return e?31-r:r}Be.isLong=ot;var RC={},FC={};function Qn(e,r){var t,n,a;return r?(e>>>=0,(a=0<=e&&e<256)&&(n=FC[e],n)?n:(t=ve(e,0,!0),a&&(FC[e]=t),t)):(e|=0,(a=-128<=e&&e<128)&&(n=RC[e],n)?n:(t=ve(e,e<0?-1:0,!1),a&&(RC[e]=t),t))}Be.fromInt=Qn;function Dt(e,r){if(isNaN(e))return r?Or:qt;if(r){if(e<0)return Or;if(e>=GC)return jC}else{if(e<=-kC)return xt;if(e+1>=kC)return UC}return e<0?Dt(-e,r).neg():ve(e%Za|0,e/Za|0,r)}Be.fromNumber=Dt;function ve(e,r,t){return new Be(e,r,t)}Be.fromBits=ve;var lf=Math.pow;function vm(e,r,t){if(e.length===0)throw Error("empty string");if(typeof r=="number"?(t=r,r=!1):r=!!r,e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return r?Or:qt;if(t=t||10,t<2||36<t)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return vm(e.substring(1),r,t).neg();for(var a=Dt(lf(t,8)),i=qt,o=0;o<e.length;o+=8){var s=Math.min(8,e.length-o),u=parseInt(e.substring(o,o+s),t);if(s<8){var f=Dt(lf(t,s));i=i.mul(f).add(Dt(u))}else i=i.mul(a),i=i.add(Dt(u))}return i.unsigned=r,i}Be.fromString=vm;function Jt(e,r){return typeof e=="number"?Dt(e,r):typeof e=="string"?vm(e,r):ve(e.low,e.high,typeof r=="boolean"?r:e.unsigned)}Be.fromValue=Jt;var LC=1<<16,GN=1<<24,Za=LC*LC,GC=Za*Za,kC=GC/2,DC=Qn(GN),qt=Qn(0);Be.ZERO=qt;var Or=Qn(0,!0);Be.UZERO=Or;var Ya=Qn(1);Be.ONE=Ya;var NC=Qn(1,!0);Be.UONE=NC;var mm=Qn(-1);Be.NEG_ONE=mm;var UC=ve(-1,2147483647,!1);Be.MAX_VALUE=UC;var jC=ve(-1,-1,!0);Be.MAX_UNSIGNED_VALUE=jC;var xt=ve(0,-2147483648,!1);Be.MIN_VALUE=xt;var U=Be.prototype;U.toInt=function(){return this.unsigned?this.low>>>0:this.low};U.toNumber=function(){return this.unsigned?(this.high>>>0)*Za+(this.low>>>0):this.high*Za+(this.low>>>0)};U.toString=function(r){if(r=r||10,r<2||36<r)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(xt)){var t=Dt(r),n=this.div(t),a=n.mul(t).sub(this);return n.toString(r)+a.toInt().toString(r)}else return"-"+this.neg().toString(r);for(var i=Dt(lf(r,6),this.unsigned),o=this,s="";;){var u=o.div(i),f=o.sub(u.mul(i)).toInt()>>>0,l=f.toString(r);if(o=u,o.isZero())return l+s;for(;l.length<6;)l="0"+l;s=""+l+s}};U.getHighBits=function(){return this.high};U.getHighBitsUnsigned=function(){return this.high>>>0};U.getLowBits=function(){return this.low};U.getLowBitsUnsigned=function(){return this.low>>>0};U.getNumBitsAbs=function(){if(this.isNegative())return this.eq(xt)?64:this.neg().getNumBitsAbs();for(var r=this.high!=0?this.high:this.low,t=31;t>0&&!(r&1<<t);t--);return this.high!=0?t+33:t+1};U.isZero=function(){return this.high===0&&this.low===0};U.eqz=U.isZero;U.isNegative=function(){return!this.unsigned&&this.high<0};U.isPositive=function(){return this.unsigned||this.high>=0};U.isOdd=function(){return(this.low&1)===1};U.isEven=function(){return(this.low&1)===0};U.equals=function(r){return ot(r)||(r=Jt(r)),this.unsigned!==r.unsigned&&this.high>>>31===1&&r.high>>>31===1?!1:this.high===r.high&&this.low===r.low};U.eq=U.equals;U.notEquals=function(r){return!this.eq(r)};U.neq=U.notEquals;U.ne=U.notEquals;U.lessThan=function(r){return this.comp(r)<0};U.lt=U.lessThan;U.lessThanOrEqual=function(r){return this.comp(r)<=0};U.lte=U.lessThanOrEqual;U.le=U.lessThanOrEqual;U.greaterThan=function(r){return this.comp(r)>0};U.gt=U.greaterThan;U.greaterThanOrEqual=function(r){return this.comp(r)>=0};U.gte=U.greaterThanOrEqual;U.ge=U.greaterThanOrEqual;U.compare=function(r){if(ot(r)||(r=Jt(r)),this.eq(r))return 0;var t=this.isNegative(),n=r.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?r.high>>>0>this.high>>>0||r.high===this.high&&r.low>>>0>this.low>>>0?-1:1:this.sub(r).isNegative()?-1:1};U.comp=U.compare;U.negate=function(){return!this.unsigned&&this.eq(xt)?xt:this.not().add(Ya)};U.neg=U.negate;U.add=function(r){ot(r)||(r=Jt(r));var t=this.high>>>16,n=this.high&65535,a=this.low>>>16,i=this.low&65535,o=r.high>>>16,s=r.high&65535,u=r.low>>>16,f=r.low&65535,l=0,c=0,h=0,d=0;return d+=i+f,h+=d>>>16,d&=65535,h+=a+u,c+=h>>>16,h&=65535,c+=n+s,l+=c>>>16,c&=65535,l+=t+o,l&=65535,ve(h<<16|d,l<<16|c,this.unsigned)};U.subtract=function(r){return ot(r)||(r=Jt(r)),this.add(r.neg())};U.sub=U.subtract;U.multiply=function(r){if(this.isZero())return this;if(ot(r)||(r=Jt(r)),kt){var t=kt.mul(this.low,this.high,r.low,r.high);return ve(t,kt.get_high(),this.unsigned)}if(r.isZero())return this.unsigned?Or:qt;if(this.eq(xt))return r.isOdd()?xt:qt;if(r.eq(xt))return this.isOdd()?xt:qt;if(this.isNegative())return r.isNegative()?this.neg().mul(r.neg()):this.neg().mul(r).neg();if(r.isNegative())return this.mul(r.neg()).neg();if(this.lt(DC)&&r.lt(DC))return Dt(this.toNumber()*r.toNumber(),this.unsigned);var n=this.high>>>16,a=this.high&65535,i=this.low>>>16,o=this.low&65535,s=r.high>>>16,u=r.high&65535,f=r.low>>>16,l=r.low&65535,c=0,h=0,d=0,p=0;return p+=o*l,d+=p>>>16,p&=65535,d+=i*l,h+=d>>>16,d&=65535,d+=o*f,h+=d>>>16,d&=65535,h+=a*l,c+=h>>>16,h&=65535,h+=i*f,c+=h>>>16,h&=65535,h+=o*u,c+=h>>>16,h&=65535,c+=n*l+a*f+i*u+o*s,c&=65535,ve(d<<16|p,c<<16|h,this.unsigned)};U.mul=U.multiply;U.divide=function(r){if(ot(r)||(r=Jt(r)),r.isZero())throw Error("division by zero");if(kt){if(!this.unsigned&&this.high===-2147483648&&r.low===-1&&r.high===-1)return this;var t=(this.unsigned?kt.div_u:kt.div_s)(this.low,this.high,r.low,r.high);return ve(t,kt.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Or:qt;var n,a,i;if(this.unsigned){if(r.unsigned||(r=r.toUnsigned()),r.gt(this))return Or;if(r.gt(this.shru(1)))return NC;i=Or}else{if(this.eq(xt)){if(r.eq(Ya)||r.eq(mm))return xt;if(r.eq(xt))return Ya;var o=this.shr(1);return n=o.div(r).shl(1),n.eq(qt)?r.isNegative()?Ya:mm:(a=this.sub(r.mul(n)),i=n.add(a.div(r)),i)}else if(r.eq(xt))return this.unsigned?Or:qt;if(this.isNegative())return r.isNegative()?this.neg().div(r.neg()):this.neg().div(r).neg();if(r.isNegative())return this.div(r.neg()).neg();i=qt}for(a=this;a.gte(r);){n=Math.max(1,Math.floor(a.toNumber()/r.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),u=s<=48?1:lf(2,s-48),f=Dt(n),l=f.mul(r);l.isNegative()||l.gt(a);)n-=u,f=Dt(n,this.unsigned),l=f.mul(r);f.isZero()&&(f=Ya),i=i.add(f),a=a.sub(l)}return i};U.div=U.divide;U.modulo=function(r){if(ot(r)||(r=Jt(r)),kt){var t=(this.unsigned?kt.rem_u:kt.rem_s)(this.low,this.high,r.low,r.high);return ve(t,kt.get_high(),this.unsigned)}return this.sub(this.div(r).mul(r))};U.mod=U.modulo;U.rem=U.modulo;U.not=function(){return ve(~this.low,~this.high,this.unsigned)};U.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};U.clz=U.countLeadingZeros;U.countTrailingZeros=function(){return this.low?IC(this.low):IC(this.high)+32};U.ctz=U.countTrailingZeros;U.and=function(r){return ot(r)||(r=Jt(r)),ve(this.low&r.low,this.high&r.high,this.unsigned)};U.or=function(r){return ot(r)||(r=Jt(r)),ve(this.low|r.low,this.high|r.high,this.unsigned)};U.xor=function(r){return ot(r)||(r=Jt(r)),ve(this.low^r.low,this.high^r.high,this.unsigned)};U.shiftLeft=function(r){return ot(r)&&(r=r.toInt()),(r&=63)===0?this:r<32?ve(this.low<<r,this.high<<r|this.low>>>32-r,this.unsigned):ve(0,this.low<<r-32,this.unsigned)};U.shl=U.shiftLeft;U.shiftRight=function(r){return ot(r)&&(r=r.toInt()),(r&=63)===0?this:r<32?ve(this.low>>>r|this.high<<32-r,this.high>>r,this.unsigned):ve(this.high>>r-32,this.high>=0?0:-1,this.unsigned)};U.shr=U.shiftRight;U.shiftRightUnsigned=function(r){return ot(r)&&(r=r.toInt()),(r&=63)===0?this:r<32?ve(this.low>>>r|this.high<<32-r,this.high>>>r,this.unsigned):r===32?ve(this.high,0,this.unsigned):ve(this.high>>>r-32,0,this.unsigned)};U.shru=U.shiftRightUnsigned;U.shr_u=U.shiftRightUnsigned;U.rotateLeft=function(r){var t;return ot(r)&&(r=r.toInt()),(r&=63)===0?this:r===32?ve(this.high,this.low,this.unsigned):r<32?(t=32-r,ve(this.low<<r|this.high>>>t,this.high<<r|this.low>>>t,this.unsigned)):(r-=32,t=32-r,ve(this.high<<r|this.low>>>t,this.low<<r|this.high>>>t,this.unsigned))};U.rotl=U.rotateLeft;U.rotateRight=function(r){var t;return ot(r)&&(r=r.toInt()),(r&=63)===0?this:r===32?ve(this.high,this.low,this.unsigned):r<32?(t=32-r,ve(this.high<<t|this.low>>>r,this.low<<t|this.high>>>r,this.unsigned)):(r-=32,t=32-r,ve(this.low<<t|this.high>>>r,this.high<<t|this.low>>>r,this.unsigned))};U.rotr=U.rotateRight;U.toSigned=function(){return this.unsigned?ve(this.low,this.high,!1):this};U.toUnsigned=function(){return this.unsigned?this:ve(this.low,this.high,!0)};U.toBytes=function(r){return r?this.toBytesLE():this.toBytesBE()};U.toBytesLE=function(){var r=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,r&255,r>>>8&255,r>>>16&255,r>>>24]};U.toBytesBE=function(){var r=this.high,t=this.low;return[r>>>24,r>>>16&255,r>>>8&255,r&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Be.fromBytes=function(r,t,n){return n?Be.fromBytesLE(r,t):Be.fromBytesBE(r,t)};Be.fromBytesLE=function(r,t){return new Be(r[0]|r[1]<<8|r[2]<<16|r[3]<<24,r[4]|r[5]<<8|r[6]<<16|r[7]<<24,t)};Be.fromBytesBE=function(r,t){return new Be(r[4]<<24|r[5]<<16|r[6]<<8|r[7],r[0]<<24|r[1]<<16|r[2]<<8|r[3],t)};var $a=Be;var NN=16;function To(e){e==="X"&&(e="");var r=e.padEnd(NN,"0");return $a.fromString(r,!0,16)}function gm(e){if(e.isZero())return"X";var r=e.countTrailingZeros(),t=r%4;r=(r-t)/4;var n=r;r*=4;var a=e.shiftRightUnsigned(r),i=a.toString(16).replace(/0+$/,""),o=Array(17-n-i.length).join("0");return o+i}function ym(e,r){var t=UN(e).shiftRightUnsigned(2),n=e.add($a.fromNumber(2*r+1-4).multiply(t));return n}function UN(e){return e.and(e.not().add(1))}var Am=m(ie());var jN=3,HN=30,VN=2*HN+1,HC=180/Math.PI;function zC(e){if(e.length===0)throw new Error("Invalid Hilbert quad key ".concat(e));for(var r=e.split("/"),t=parseInt(r[0],10),n=r[1],a=n.length,i=0,o=[0,0],s=a-1;s>=0;s--){i=a-s;var u=n[s],f=0,l=0;u==="1"?l=1:u==="2"?(f=1,l=1):u==="3"&&(f=1);var c=Math.pow(2,i-1);zN(c,o,f,l),o[0]+=c*f,o[1]+=c*l}if(t%2===1){var h=o[0];o[0]=o[1],o[1]=h}return{face:t,ij:o,level:i}}function WC(e){if(e.isZero())return"";for(var r=e.toString(2);r.length<jN+VN;)r="0"+r;var t=r.lastIndexOf("1"),n=r.substring(0,3),a=r.substring(3,t),i=a.length/2,o=$a.fromString(n,!0,2).toString(10),s="";if(i!==0)for(s=$a.fromString(a,!0,2).toString(4);s.length<i;)s="0"+s;return"".concat(o,"/").concat(s)}function _m(e,r,t){var n=1<<r;return[(e[0]+t[0])/n,(e[1]+t[1])/n]}function VC(e){return e>=.5?1/3*(4*e*e-1):1/3*(1-4*(1-e)*(1-e))}function bm(e){return[VC(e[0]),VC(e[1])]}function Tm(e,r){var t=(0,Am.default)(r,2),n=t[0],a=t[1];switch(e){case 0:return[1,n,a];case 1:return[-n,1,a];case 2:return[-n,-a,1];case 3:return[-1,-a,-n];case 4:return[a,-1,-n];case 5:return[a,n,-1];default:throw new Error("Invalid face")}}function xm(e){var r=(0,Am.default)(e,3),t=r[0],n=r[1],a=r[2],i=Math.atan2(a,Math.sqrt(t*t+n*n)),o=Math.atan2(n,t);return[o*HC,i*HC]}function zN(e,r,t,n){if(n===0){t===1&&(r[0]=e-1-r[0],r[1]=e-1-r[1]);var a=r[0];r[0]=r[1],r[1]=a}}function qC(e){var r=_m(e.ij,e.level,[.5,.5]),t=bm(r),n=Tm(e.face,t);return xm(n)}var WN=100;function Em(e){for(var r=e.face,t=e.ij,n=e.level,a=[[0,0],[0,1],[1,1],[1,0],[0,0]],i=Math.max(1,Math.ceil(WN*Math.pow(2,-n))),o=new Float64Array(4*i*2+2),s=0,u=0,f=0;f<4;f++)for(var l=a[f].slice(0),c=a[f+1],h=(c[0]-l[0])/i,d=(c[1]-l[1])/i,p=0;p<i;p++){l[0]+=h,l[1]+=d;var v=_m(t,n,l),y=bm(v),A=Tm(r,y),_=xm(A);Math.abs(_[1])>89.999&&(_[0]=u);var E=_[0]-u;_[0]+=E>180?-360:E<-180?360:0,o[s++]=_[0],o[s++]=_[1],u=_[0]}return o[s++]=o[0],o[s++]=o[1],o}function Qa(e){var r=qN(e),t=zC(r);return t}function qN(e){if(e.indexOf("/")>0)return e;var r=To(e);return WC(r)}function Sm(e){var r=Qa(e);return qC(r)}function XC(e){var r;if(e.face===2||e.face===5){for(var t=null,n=0,a=0;a<4;a++){var i="".concat(e.face,"/").concat(a),o=Qa(i),s=Em(o);(typeof t>"u"||t===null)&&(t=new Float64Array(4*s.length)),t.set(s,n),n+=s.length}r=JC(t)}else{var u=Em(e);r=JC(u)}return r}function JC(e){if(e.length%2!==0)throw new Error("Invalid corners");for(var r=[],t=[],n=0;n<e.length;n+=2)r.push(e[n]),t.push(e[n+1]);return r.sort(function(a,i){return a-i}),t.sort(function(a,i){return a-i}),{west:r[0],east:r[r.length-1],north:t[t.length-1],south:t[0]}}function wm(e,r){var t=r?.minimumHeight||0,n=r?.maximumHeight||0,a=Qa(e),i=XC(a),o=i.west,s=i.south,u=i.east,f=i.north,l=[];return l.push(new S(o,f,t)),l.push(new S(u,f,t)),l.push(new S(u,s,t)),l.push(new S(o,s,t)),l.push(new S(o,f,n)),l.push(new S(u,f,n)),l.push(new S(u,s,n)),l.push(new S(o,s,n)),l}var Cm=m(st());function cf(e){var r=e.token,t={minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight},n=wm(r,t),a=Sm(r),i=a[0],o=a[1],s=pe.WGS84.cartographicToCartesian([i,o,t.maximumHeight]),u=new S(s[0],s[1],s[2]);n.push(u);var f=Di(n),l=[].concat((0,Cm.default)(f.center),(0,Cm.default)(f.halfAxes));return l}function KC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function JN(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?KC(Object(t),!0).forEach(function(n){(0,$C.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):KC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var XN=4,KN=8,YN={QUADTREE:XN,OCTREE:KN};function ZN(e,r,t){if(e!=null&&e.box){var n=To(e.s2VolumeInfo.token),a=ym(n,r),i=gm(a),o=JN({},e.s2VolumeInfo);switch(o.token=i,t){case"OCTREE":var s=e.s2VolumeInfo,u=s.maximumHeight-s.minimumHeight,f=u/2,l=s.minimumHeight+u/2;s.minimumHeight=l-f,s.maximumHeight=l+f;break;default:break}var c=cf(o),h={box:c,s2VolumeInfo:o};return h}}function Pm(e){return Om.apply(this,arguments)}function Om(){return Om=(0,ZC.default)(Mm.default.mark(function e(r){var t,n,a,i,o,s,u,f,l,c,h,d,p,v,y,A,_,E,x,C,B,F,M,w,b,I,L,k,D,O,P,R,j,G,V,X,ne,ke,Oe,Et,He,Rr,mt,sa,Cv,Bv;return Mm.default.wrap(function(St){for(;;)switch(St.prev=St.next){case 0:if(t=r.options,n=r.parentData,a=n===void 0?{mortonIndex:0,x:0,y:0,z:0}:n,i=r.childIndex,o=i===void 0?0:i,s=r.globalData,u=s===void 0?{level:0,mortonIndex:0,x:0,y:0,z:0}:s,f=r.s2VolumeBox,l=r.subtree,c=r.level,h=c===void 0?0:c,d=t.subdivisionScheme,p=t.subtreeLevels,v=t.maximumLevel,y=t.contentUrlTemplate,A=t.subtreesUriTemplate,_=t.basePath,E={children:[],lodMetricValue:0,contentUrl:""},x=YN[d],C=o&1,B=o>>1&1,F=o>>2&1,M=(Math.pow(x,h)-1)/(x-1),w=ea(a.mortonIndex,o),b=M+w,I=ea(a.x,C),L=ea(a.y,B),k=ea(a.z,F),D=!1,h+1>p&&(D=Bm(l.childSubtreeAvailability,w)),O=ea(u.x,I),P=ea(u.y,L),R=ea(u.z,k),j=h+u.level,!D){St.next=38;break}return G="".concat(_,"/").concat(A),V=hf(G,j,O,P,R),St.next=25,(0,QC.load)(V,ff);case 25:X=St.sent,l=X,u.mortonIndex=w,u.x=I,u.y=L,u.z=k,u.level=h,w=0,b=0,I=0,L=0,k=0,h=0;case 38:if(ne=Bm(l.tileAvailability,b),!(!ne||h>v)){St.next=41;break}return St.abrupt("return",E);case 41:ke=Bm(l.contentAvailability,b),ke&&(E.contentUrl=hf(y,j,O,P,R)),Oe=h+1,Et={mortonIndex:w,x:I,y:L,z:k},He=0;case 46:if(!(He<x)){St.next=55;break}return Rr=ZN(f,He,d),St.next=50,Pm({subtree:l,options:t,parentData:Et,childIndex:He,level:Oe,globalData:u,s2VolumeBox:Rr});case 50:mt=St.sent,(mt.contentUrl||mt.children.length)&&(sa=j+1,Cv={childTileX:I,childTileY:L,childTileZ:k},Bv=$N(mt,sa,Cv,t,f),E.children.push(Bv));case 52:He++,St.next=46;break;case 55:return St.abrupt("return",E);case 56:case"end":return St.stop()}},e)})),Om.apply(this,arguments)}function Bm(e,r){return"constant"in e?Boolean(e.constant):e.explicitBitstream?tU(r,e.explicitBitstream):!1}function $N(e,r,t,n,a){var i=n.basePath,o=n.refine,s=n.getRefine,u=n.lodMetricType,f=n.getTileType,l=n.rootLodMetricValue,c=n.rootBoundingVolume,h=e.contentUrl&&e.contentUrl.replace("".concat(i,"/"),""),d=l/Math.pow(2,r),p=a!=null&&a.box?{box:a.box}:c,v=QN(r,p,t);return{children:e.children,contentUrl:e.contentUrl,content:{uri:h},id:e.contentUrl,refine:s(o),type:f(e),lodMetricType:u,lodMetricValue:d,geometricError:d,transform:e.transform,boundingVolume:v}}function QN(e,r,t){if(r.region){var n=t.childTileX,a=t.childTileY,i=t.childTileZ,o=(0,YC.default)(r.region,6),s=o[0],u=o[1],f=o[2],l=o[3],c=o[4],h=o[5],d=Math.pow(2,e),p=(f-s)/d,v=(l-u)/d,y=(h-c)/d,A=s+p*n,_=s+p*(n+1),E=u+v*a,x=u+v*(a+1),C=c+y*i,B=c+y*(i+1);return{region:[A,E,_,x,C,B]}}if(r.box)return r;throw new Error("Unsupported bounding volume type ".concat(r))}function ea(e,r){return parseInt(e.toString(2)+r.toString(2),2)}function hf(e,r,t,n,a){var i=eU({level:r,x:t,y:n,z:a});return e.replace(/{level}|{x}|{y}|{z}/gi,function(o){return i[o]})}function eU(e){var r={};for(var t in e)r["{".concat(t,"}")]=e[t];return r}function tU(e,r){var t=Math.floor(e/8),n=e%8,a=r[t]>>n&1;return a===1}function rU(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=nU(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function nU(e,r){if(e){if(typeof e=="string")return e2(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return e2(e,r)}}function e2(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function km(e){if(!e.contentUrl)return Er.EMPTY;var r=e.contentUrl.split("?")[0],t=r.split(".").pop();switch(t){case"pnts":return Er.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return Er.SCENEGRAPH;default:return t}}function Dm(e){switch(e){case"REPLACE":case"replace":return At.REPLACE;case"ADD":case"add":return At.ADD;default:return e}}function Im(e,r){var t=/^[a-z][0-9a-z+.-]*:/i;if(t.test(r)){var n=new URL(e,"".concat(r,"/"));return decodeURI(n.toString())}else if(e.startsWith("/"))return e;return"".concat(r,"/").concat(e)}function t2(e,r){if(!e)return null;if(e.content){var t=e.content.uri||e.content.url;e.contentUrl=Im(t,r.basePath)}return e.id=e.contentUrl,e.lodMetricType=Un.GEOMETRIC_ERROR,e.lodMetricValue=e.geometricError,e.transformMatrix=e.transform,e.type=km(e),e.refine=Dm(e.refine),e}function i2(e,r){return Rm.apply(this,arguments)}function Rm(){return Rm=(0,df.default)(ta.default.mark(function e(r,t){var n,a,i,o,s,u,f,l,c,h;return ta.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(n=r.basePath,i=n2(r?.root),!(i&&r.root)){p.next=8;break}return p.next=5,r2(r.root,r,i,t);case 5:a=p.sent,p.next=9;break;case 8:a=t2(r.root,r);case 9:o=[],o.push(a);case 11:if(!(o.length>0)){p.next=40;break}s=o.pop()||{},u=s.children||[],f=rU(u),p.prev=15,f.s();case 17:if((l=f.n()).done){p.next=30;break}if(c=l.value,h=n2(c),!h){p.next=26;break}return p.next=23,r2(c,r,h,t);case 23:c=p.sent,p.next=27;break;case 26:t2(c,{basePath:n});case 27:o.push(c);case 28:p.next=17;break;case 30:p.next=35;break;case 32:p.prev=32,p.t0=p.catch(15),f.e(p.t0);case 35:return p.prev=35,f.f(),p.finish(35);case 38:p.next=11;break;case 40:return p.abrupt("return",a);case 41:case"end":return p.stop()}},e,null,[[15,32,35,38]])})),Rm.apply(this,arguments)}function r2(e,r,t,n){return Fm.apply(this,arguments)}function Fm(){return Fm=(0,df.default)(ta.default.mark(function e(r,t,n,a){var i,o,s,u,f,l,c,h,d,p,v,y,A,_,E,x,C,B;return ta.default.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return s=t.basePath,u=n.subdivisionScheme,f=n.maximumLevel,l=n.subtreeLevels,c=n.subtrees.uri,h=hf(c,0,0,0,0),d=Im(h,s),M.next=6,(0,a2.load)(d,ff,a);case 6:return p=M.sent,v=Im(r.content.uri,s),y=t==null||(i=t.root)===null||i===void 0?void 0:i.refine,A=r.geometricError,_=(o=r.boundingVolume.extensions)===null||o===void 0?void 0:o["3DTILES_bounding_volume_S2"],_&&(E=cf(_),x={box:E,s2VolumeInfo:_},r.boundingVolume=x),C=r.boundingVolume,B={contentUrlTemplate:v,subtreesUriTemplate:c,subdivisionScheme:u,subtreeLevels:l,maximumLevel:f,refine:y,basePath:s,lodMetricType:Un.GEOMETRIC_ERROR,rootLodMetricValue:A,rootBoundingVolume:C,getTileType:km,getRefine:Dm},M.next=16,aU(r,p,B);case 16:return M.abrupt("return",M.sent);case 17:case"end":return M.stop()}},e)})),Fm.apply(this,arguments)}function aU(e,r,t){return Lm.apply(this,arguments)}function Lm(){return Lm=(0,df.default)(ta.default.mark(function e(r,t,n){var a,i,o;return ta.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(r){u.next=2;break}return u.abrupt("return",null);case 2:return r.lodMetricType=Un.GEOMETRIC_ERROR,r.lodMetricValue=r.geometricError,r.transformMatrix=r.transform,u.next=7,Pm({subtree:t,options:n,s2VolumeBox:r});case 7:return a=u.sent,i=a.children,o=a.contentUrl,o&&(r.contentUrl=o,r.content={uri:o.replace("".concat(n.basePath,"/"),"")}),r.refine=Dm(r.refine),r.type=km(r),r.children=i,r.id=r.contentUrl,u.abrupt("return",r);case 16:case"end":return u.stop()}},e)})),Lm.apply(this,arguments)}function n2(e){var r;return(e==null||(r=e.extensions)===null||r===void 0?void 0:r["3DTILES_implicit_tiling"])||e?.implicitTiling}var mf={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:Ru,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:uU,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};function iU(e){return fa.dirname(e.url)}function oU(e,r,t){return Gm.apply(this,arguments)}function Gm(){return Gm=(0,pf.default)(ra.default.mark(function e(r,t,n){var a,i;return ra.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a={content:{featureIds:null}},i=0,s.next=4,fm(r,i,t,n,a.content);case 4:return s.abrupt("return",a.content);case 5:case"end":return s.stop()}},e)})),Gm.apply(this,arguments)}function sU(e,r,t){return Nm.apply(this,arguments)}function Nm(){return Nm=(0,pf.default)(ra.default.mark(function e(r,t,n){var a,i;return ra.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i=JSON.parse(new TextDecoder().decode(r)),i.loader=t.loader||mf,i.url=n.url,i.queryString=n.queryString,i.basePath=iU(i),s.next=7,i2(i,t);case 7:return i.root=s.sent,i.type=at.TILES3D,i.lodMetricType=Un.GEOMETRIC_ERROR,i.lodMetricValue=((a=i.root)===null||a===void 0?void 0:a.lodMetricValue)||0,s.abrupt("return",i);case 12:case"end":return s.stop()}},e)})),Nm.apply(this,arguments)}function uU(e,r,t){return Um.apply(this,arguments)}function Um(){return Um=(0,pf.default)(ra.default.mark(function e(r,t,n){var a,i;return ra.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(a=t["3d-tiles"]||{},a.isTileset==="auto"?i=n.url&&n.url.indexOf(".json")!==-1:i=a.isTileset,!i){s.next=8;break}return s.next=5,sU(r,t,n);case 5:r=s.sent,s.next=11;break;case 8:return s.next=10,oU(r,t,n);case 10:r=s.sent;case 11:return s.abrupt("return",r);case 12:case"end":return s.stop()}},e)})),Um.apply(this,arguments)}function o2(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function ei(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?o2(Object(t),!0).forEach(function(n){(0,xo.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o2(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function fU(e){var r=lU();return function(){var n=(0,jm.default)(e),a;if(r){var i=(0,jm.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,d2.default)(this,a)}}function lU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var s2=[0],cU={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:"",loader:mf,onTilesetLoad:{type:"function",value:function(r){}},onTileLoad:{type:"function",value:function(r){}},onTileUnload:{type:"function",value:function(r){}},onTileError:{type:"function",value:function(r,t,n){}},_getMeshColor:{type:"function",value:function(r){return[255,255,255]}}},vf=function(e){(0,h2.default)(t,e);var r=fU(t);function t(){var n;(0,f2.default)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=r.call.apply(r,[this].concat(i)),(0,xo.default)((0,c2.default)(n),"state",void 0),n}return(0,l2.default)(t,[{key:"initializeState",value:function(){"onTileLoadFail"in this.props&&un.log.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}},{key:"isLoaded",get:function(){var a=this.state.tileset3d;return a!==null&&a.isLoaded()}},{key:"shouldUpdateState",value:function(a){var i=a.changeFlags;return i.somethingChanged}},{key:"updateState",value:function(a){var i=a.props,o=a.oldProps,s=a.changeFlags;if(i.data&&i.data!==o.data&&this._loadTileset(i.data),s.viewportChanged){var u=this.state.activeViewports,f=Object.keys(u).length;f&&(this._updateTileset(u),this.state.lastUpdatedViewports=u,this.state.activeViewports={})}if(s.propsChanged){var l=this.state.layerMap;for(var c in l)l[c].needsUpdate=!0}}},{key:"activateViewport",value:function(a){var i=this.state,o=i.activeViewports,s=i.lastUpdatedViewports;this.internalState.viewport=a,o[a.id]=a;var u=s?.[a.id];(!u||!a.equals(u))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}},{key:"getPickingInfo",value:function(a){var i=a.info,o=a.sourceLayer,s=o&&o.props.tile;return i.picked&&(i.object=s),i.sourceTile=s,i}},{key:"filterSubLayer",value:function(a){var i=a.layer,o=a.viewport,s=i.props,u=s.tile,f=o.id;return u.selected&&u.viewportIds.includes(f)}},{key:"_updateAutoHighlight",value:function(a){var i=a.sourceTile,o=this.state.layerMap[i?.id];o&&o.layer&&o.layer.updateAutoHighlight(a)}},{key:"_loadTileset",value:function(){var n=(0,u2.default)(Hm.default.mark(function i(o){var s,u,f,l,c,h,d;return Hm.default.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(s=this.props.loadOptions,u=s===void 0?{}:s,f=this.props.loader||this.props.loaders,Array.isArray(f)&&(f=f[0]),l={loadOptions:ei({},u)},!f.preload){v.next=10;break}return v.next=7,f.preload(o,u);case 7:c=v.sent,c.headers&&(l.loadOptions.fetch=ei(ei({},l.loadOptions.fetch),{},{headers:c.headers})),Object.assign(l,c);case 10:return v.next=12,(0,g2.load)(o,f,l.loadOptions);case 12:h=v.sent,d=new vd(h,ei({onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError},l)),this.setState({tileset3d:d,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(d);case 17:case"end":return v.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_onTileLoad",value:function(a){var i=this.state.lastUpdatedViewports;this.props.onTileLoad(a),this._updateTileset(i),this.setNeedsUpdate()}},{key:"_onTileUnload",value:function(a){delete this.state.layerMap[a.id],this.props.onTileUnload(a)}},{key:"_updateTileset",value:function(a){var i=this;if(a){var o=this.state.tileset3d,s=this.context.timeline,u=Object.keys(a).length;!s||!u||!o||o.selectTiles(Object.values(a)).then(function(f){var l=i.state.frameNumber!==f;l&&i.setState({frameNumber:f})})}}},{key:"_getSubLayer",value:function(a,i){if(!a.content)return null;switch(a.type){case Er.POINTCLOUD:return this._makePointCloudLayer(a,i);case Er.SCENEGRAPH:return this._make3DModelLayer(a);case Er.MESH:return this._makeSimpleMeshLayer(a,i);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(a.content.type))}}},{key:"_makePointCloudLayer",value:function(a,i){var o=a.content,s=o.attributes,u=o.pointCount,f=o.constantRGBA,l=o.cartographicOrigin,c=o.modelMatrix,h=s.positions,d=s.normals,p=s.colors;if(!h)return null;var v=i&&i.props.data||{header:{vertexCount:u},attributes:{POSITION:h,NORMAL:d,COLOR_0:p}},y=this.props,A=y.pointSize,_=y.getPointColor,E=this.getSubLayerClass("pointcloud",m2.PointCloudLayer);return new E({pointSize:A},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(a.id),tile:a,data:v,coordinateSystem:un.COORDINATE_SYSTEM.METER_OFFSETS,coordinateOrigin:l,modelMatrix:c,getColor:f||_,_offset:0})}},{key:"_make3DModelLayer",value:function(a){var i=a.content,o=i.gltf,s=i.instances,u=i.cartographicOrigin,f=i.modelMatrix,l=this.getSubLayerClass("scenegraph",v2.ScenegraphLayer);return new l({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(a.id),tile:a,data:s||s2,scenegraph:o,coordinateSystem:un.COORDINATE_SYSTEM.METER_OFFSETS,coordinateOrigin:u,modelMatrix:f,getTransformMatrix:function(h){return h.modelMatrix},getPosition:[0,0,0],_offset:0})}},{key:"_makeSimpleMeshLayer",value:function(a,i){var o=a.content,s=o.attributes,u=o.indices,f=o.modelMatrix,l=o.cartographicOrigin,c=o.coordinateSystem,h=c===void 0?un.COORDINATE_SYSTEM.METER_OFFSETS:c,d=o.material,p=o.featureIds,v=this.props._getMeshColor,y=i&&i.props.mesh||new p2.Geometry({drawMode:4,attributes:hU(s),indices:u}),A=this.getSubLayerClass("mesh",yu);return new A(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(a.id),tile:a,mesh:y,data:s2,getColor:v(a),pbrMaterial:d,modelMatrix:f,coordinateOrigin:l,coordinateSystem:h,featureIds:p,_offset:0})}},{key:"renderLayers",value:function(){var a=this,i=this.state,o=i.tileset3d,s=i.layerMap;return o?o.tiles.map(function(u){var f=s[u.id]=s[u.id]||{tile:u},l=f.layer;return u.selected&&(l?f.needsUpdate&&(l=a._getSubLayer(u,l),f.needsUpdate=!1):l=a._getSubLayer(u)),f.layer=l,l}).filter(Boolean):null}}]),t}(un.CompositeLayer);(0,xo.default)(vf,"defaultProps",cU);(0,xo.default)(vf,"layerName","Tile3DLayer");function hU(e){var r={};return r.positions=ei(ei({},e.positions),{},{value:new Float32Array(e.positions.value)}),e.normals&&(r.normals=e.normals),e.texCoords&&(r.texCoords=e.texCoords),e.colors&&(r.colors=e.colors),e.uvRegions&&(r.uvRegions=e.uvRegions),r}var Ym=m(st()),D2=m(ie()),G2=m(H()),N2=m(z()),U2=m(wt()),j2=m(Te()),H2=m(xe()),Zm=m(be()),Co=m(W()),Ef=m(Ut()),$m=m(Xs()),V2=m(Ut());var I2=m(K()),R2=m(W()),Km=m(Y());var _2=m(ie());var A2=m(ie());function dU(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=pU(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function pU(e,r){if(e){if(typeof e=="string")return y2(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return y2(e,r)}}function y2(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var mU=new Map([["centerX",Float64Array.BYTES_PER_ELEMENT],["centerY",Float64Array.BYTES_PER_ELEMENT],["centerZ",Float64Array.BYTES_PER_ELEMENT],["minHeight",Float32Array.BYTES_PER_ELEMENT],["maxHeight",Float32Array.BYTES_PER_ELEMENT],["boundingSphereCenterX",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterY",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterZ",Float64Array.BYTES_PER_ELEMENT],["boundingSphereRadius",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointX",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointY",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointZ",Float64Array.BYTES_PER_ELEMENT]]);function Vm(e){return e>>1^-(e&1)}function vU(e){var r=0,t={},n=dU(mU),a;try{for(n.s();!(a=n.n()).done;){var i=(0,A2.default)(a.value,2),o=i[0],s=i[1],u=s===8?e.getFloat64:e.getFloat32;t[o]=u.call(e,r,!0),r+=s}}catch(f){n.e(f)}finally{n.f()}return{header:t,headerEndPosition:r}}function gU(e,r){var t=r,n=3,a=e.getUint32(t,!0),i=new Uint16Array(a*n);t+=Uint32Array.BYTES_PER_ELEMENT;for(var o=Uint16Array.BYTES_PER_ELEMENT,s=a*o,u=t,f=u+s,l=f+s,c=0,h=0,d=0,p=0;p<a;p++)c+=Vm(e.getUint16(u+o*p,!0)),h+=Vm(e.getUint16(f+o*p,!0)),d+=Vm(e.getUint16(l+o*p,!0)),i[p]=c,i[p+a]=h,i[p+a*2]=d;return t+=s*3,{vertexData:i,vertexDataEndPosition:t}}function Eo(e,r,t,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,i;if(n===2?i=new Uint16Array(e,r,t):i=new Uint32Array(e,r,t),!a)return i;for(var o=0,s=0;s<i.length;++s){var u=i[s];i[s]=o-u,u===0&&++o}return i}function yU(e,r,t){var n=t,a=3,i=r.length/a,o=i>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT;n%o!==0&&(n+=o-n%o);var s=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;var u=s*3,f=Eo(e.buffer,n,u,o);return n+=u*o,{triangleIndicesEndPosition:n,triangleIndices:f}}function AU(e,r,t){var n=t,a=3,i=r.length/a,o=i>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT,s=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;var u=Eo(e.buffer,n,s,o,!1);n+=s*o;var f=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;var l=Eo(e.buffer,n,f,o,!1);n+=f*o;var c=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;var h=Eo(e.buffer,n,c,o,!1);n+=c*o;var d=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;var p=Eo(e.buffer,n,d,o,!1);return n+=d*o,{edgeIndicesEndPosition:n,westIndices:u,southIndices:l,eastIndices:h,northIndices:p}}function _U(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function bU(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}function TU(e,r){var t={};if(e.byteLength<=r)return{extensions:t,extensionsEndPosition:r};for(var n=r;n<e.byteLength;){var a=e.getUint8(n,!0);n+=Uint8Array.BYTES_PER_ELEMENT;var i=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;var o=new DataView(e.buffer,n,i);switch(a){case 1:{t.vertexNormals=_U(o);break}case 2:{t.waterMask=bU(o);break}default:}n+=i}return{extensions:t,extensionsEndPosition:n}}var na={header:0,vertices:1,triangleIndices:2,edgeIndices:3,extensions:4},xU={maxDecodingStep:na.extensions};function zm(e,r){var t=Object.assign({},xU,r),n=new DataView(e),a=vU(n),i=a.header,o=a.headerEndPosition;if(t.maxDecodingStep<na.vertices)return{header:i};var s=gU(n,o),u=s.vertexData,f=s.vertexDataEndPosition;if(t.maxDecodingStep<na.triangleIndices)return{header:i,vertexData:u};var l=yU(n,u,f),c=l.triangleIndices,h=l.triangleIndicesEndPosition;if(t.maxDecodingStep<na.edgeIndices)return{header:i,vertexData:u,triangleIndices:c};var d=AU(n,u,h),p=d.westIndices,v=d.southIndices,y=d.eastIndices,A=d.northIndices,_=d.edgeIndicesEndPosition;if(t.maxDecodingStep<na.extensions)return{header:i,vertexData:u,triangleIndices:c,westIndices:p,northIndices:A,eastIndices:y,southIndices:v};var E=TU(n,_),x=E.extensions;return{header:i,vertexData:u,triangleIndices:c,westIndices:p,northIndices:A,eastIndices:y,southIndices:v,extensions:x}}var So=m(st());function gf(e,r,t,n){for(var a=n?SU(n,e.POSITION.value):EU(r),i=new e.POSITION.value.constructor(a.length*6),o=new e.TEXCOORD_0.value.constructor(a.length*4),s=new r.constructor(a.length*6),u=0;u<a.length;u++){var f=a[u];wU({edge:f,edgeIndex:u,attributes:e,skirtHeight:t,newPosition:i,newTexcoord0:o,newTriangles:s})}e.POSITION.value=ci(e.POSITION.value,i),e.TEXCOORD_0.value=ci(e.TEXCOORD_0.value,o);var l=r instanceof Array?r.concat(s):ci(r,s);return{attributes:e,triangles:l}}function EU(e){for(var r=[],t=0;t<e.length;t+=3)r.push([e[t],e[t+1]]),r.push([e[t+1],e[t+2]]),r.push([e[t+2],e[t]]);r.sort(function(s,u){return Math.min.apply(Math,(0,So.default)(s))-Math.min.apply(Math,(0,So.default)(u))||Math.max.apply(Math,(0,So.default)(s))-Math.max.apply(Math,(0,So.default)(u))});for(var n=[],a=0;a<r.length;){var i,o;r[a][0]===((i=r[a+1])===null||i===void 0?void 0:i[1])&&r[a][1]===((o=r[a+1])===null||o===void 0?void 0:o[0])?a+=2:(n.push(r[a]),a++)}return n}function SU(e,r){e.westIndices.sort(function(o,s){return r[3*o+1]-r[3*s+1]}),e.eastIndices.sort(function(o,s){return r[3*s+1]-r[3*o+1]}),e.southIndices.sort(function(o,s){return r[3*s]-r[3*o]}),e.northIndices.sort(function(o,s){return r[3*o]-r[3*s]});var t=[];for(var n in e)for(var a=e[n],i=0;i<a.length-1;i++)t.push([a[i],a[i+1]]);return t}function wU(e){var r=e.edge,t=e.edgeIndex,n=e.attributes,a=e.skirtHeight,i=e.newPosition,o=e.newTexcoord0,s=e.newTriangles,u=n.POSITION.value.length,f=t*2,l=t*2+1;i.set(n.POSITION.value.subarray(r[0]*3,r[0]*3+3),f*3),i[f*3+2]=i[f*3+2]-a,i.set(n.POSITION.value.subarray(r[1]*3,r[1]*3+3),l*3),i[l*3+2]=i[l*3+2]-a,o.set(n.TEXCOORD_0.value.subarray(r[0]*2,r[0]*2+2),f*2),o.set(n.TEXCOORD_0.value.subarray(r[1]*2,r[1]*2+2),l*2);var c=t*2*3;s[c]=r[0],s[c+1]=u/3+l,s[c+2]=r[1],s[c+3]=u/3+l,s[c+4]=r[0],s[c+5]=u/3+f}function CU(e,r,t){for(var n=r.minHeight,a=r.maxHeight,i=t||[0,0,1,1],o=(0,_2.default)(i,4),s=o[0],u=o[1],f=o[2],l=o[3],c=f-s,h=l-u,d=a-n,p=e.length/3,v=new Float32Array(p*3),y=new Float32Array(p*2),A=0;A<p;A++){var _=e[A]/32767,E=e[A+p]/32767,x=e[A+p*2]/32767;v[3*A+0]=_*c+s,v[3*A+1]=E*h+u,v[3*A+2]=x*d+n,y[2*A+0]=_,y[2*A+1]=E}return{POSITION:{value:v,size:3},TEXCOORD_0:{value:y,size:2}}}function BU(e,r){if(!e)return null;var t=r.bounds,n=zm(e,na.triangleIndices),a=n.header,i=n.vertexData,o=n.triangleIndices,s=n.westIndices,u=n.northIndices,f=n.eastIndices,l=n.southIndices,c=o,h=CU(i,a,t),d=zn(h);if(r.skirtHeight){var p=gf(h,c,r.skirtHeight,{westIndices:s,northIndices:u,eastIndices:f,southIndices:l}),v=p.attributes,y=p.triangles;h=v,c=y}return{loaderData:{header:{}},header:{vertexCount:c.length,boundingBox:d},mode:4,indices:{value:c,size:1},attributes:h}}function yf(e,r){return BU(e,r["quantized-mesh"])}var C2=m(W()),B2=m(K()),M2=m(ie()),qm=m(Y());var wo=class{constructor(r=257){this.gridSize=r;let t=r-1;if(t&t-1)throw new Error(`Expected grid size to be 2^n+1, got ${r}.`);this.numTriangles=t*t*2-2,this.numParentTriangles=this.numTriangles-t*t,this.indices=new Uint32Array(this.gridSize*this.gridSize),this.coords=new Uint16Array(this.numTriangles*4);for(let n=0;n<this.numTriangles;n++){let a=n+2,i=0,o=0,s=0,u=0,f=0,l=0;for(a&1?s=u=f=t:i=o=l=t;(a>>=1)>1;){let h=i+s>>1,d=o+u>>1;a&1?(s=i,u=o,i=f,o=l):(i=s,o=u,s=f,u=l),f=h,l=d}let c=n*4;this.coords[c+0]=i,this.coords[c+1]=o,this.coords[c+2]=s,this.coords[c+3]=u}}createTile(r){return new Wm(r,this)}},Wm=class{constructor(r,t){let n=t.gridSize;if(r.length!==n*n)throw new Error(`Expected terrain data of length ${n*n} (${n} x ${n}), got ${r.length}.`);this.terrain=r,this.martini=t,this.errors=new Float32Array(r.length),this.update()}update(){let{numTriangles:r,numParentTriangles:t,coords:n,gridSize:a}=this.martini,{terrain:i,errors:o}=this;for(let s=r-1;s>=0;s--){let u=s*4,f=n[u+0],l=n[u+1],c=n[u+2],h=n[u+3],d=f+c>>1,p=l+h>>1,v=d+p-l,y=p+f-d,A=(i[l*a+f]+i[h*a+c])/2,_=p*a+d,E=Math.abs(A-i[_]);if(o[_]=Math.max(o[_],E),s<t){let x=(l+y>>1)*a+(f+v>>1),C=(h+y>>1)*a+(c+v>>1);o[_]=Math.max(o[_],o[x],o[C])}}}getMesh(r=0){let{gridSize:t,indices:n}=this.martini,{errors:a}=this,i=0,o=0,s=t-1;n.fill(0);function u(d,p,v,y,A,_){let E=d+v>>1,x=p+y>>1;Math.abs(d-A)+Math.abs(p-_)>1&&a[x*t+E]>r?(u(A,_,d,p,E,x),u(v,y,A,_,E,x)):(n[p*t+d]=n[p*t+d]||++i,n[y*t+v]=n[y*t+v]||++i,n[_*t+A]=n[_*t+A]||++i,o++)}u(0,0,s,s,s,0),u(s,s,0,0,0,s);let f=new Uint16Array(i*2),l=new Uint32Array(o*3),c=0;function h(d,p,v,y,A,_){let E=d+v>>1,x=p+y>>1;if(Math.abs(d-A)+Math.abs(p-_)>1&&a[x*t+E]>r)h(A,_,d,p,E,x),h(v,y,A,_,E,x);else{let C=n[p*t+d]-1,B=n[y*t+v]-1,F=n[_*t+A]-1;f[2*C]=d,f[2*C+1]=p,f[2*B]=v,f[2*B+1]=y,f[2*F]=A,f[2*F+1]=_,l[c++]=C,l[c++]=B,l[c++]=F}}return h(0,0,s,s,s,0),h(s,s,0,0,0,s),{vertices:f,triangles:l}}};var b2=m(H()),T2=m(z()),x2=function(){function e(r,t){(0,b2.default)(this,e);var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;this.data=r,this.width=t,this.height=n,this.coords=[],this.triangles=[],this._halfedges=[],this._candidates=[],this._queueIndices=[],this._queue=[],this._errors=[],this._rms=[],this._pending=[],this._pendingLen=0,this._rmsSum=0;var a=t-1,i=n-1,o=this._addPoint(0,0),s=this._addPoint(a,0),u=this._addPoint(0,i),f=this._addPoint(a,i),l=this._addTriangle(f,o,u,-1,-1,-1);this._addTriangle(o,f,s,l,-1,-1),this._flush()}return(0,T2.default)(e,[{key:"run",value:function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this.getMaxError()>t;)this.refine()}},{key:"refine",value:function(){this._step(),this._flush()}},{key:"getMaxError",value:function(){return this._errors[0]}},{key:"getRMSD",value:function(){return this._rmsSum>0?Math.sqrt(this._rmsSum/(this.width*this.height)):0}},{key:"heightAt",value:function(t,n){return this.data[this.width*n+t]}},{key:"_flush",value:function(){for(var t=this.coords,n=0;n<this._pendingLen;n++){var a=this._pending[n],i=2*this.triangles[a*3+0],o=2*this.triangles[a*3+1],s=2*this.triangles[a*3+2];this._findCandidate(t[i],t[i+1],t[o],t[o+1],t[s],t[s+1],a)}this._pendingLen=0}},{key:"_findCandidate",value:function(t,n,a,i,o,s,u){for(var f=Math.min(t,a,o),l=Math.min(n,i,s),c=Math.max(t,a,o),h=Math.max(n,i,s),d=aa(a,i,o,s,f,l),p=aa(o,s,t,n,f,l),v=aa(t,n,a,i,f,l),y=i-n,A=t-a,_=s-i,E=a-o,x=n-s,C=o-t,B=aa(t,n,a,i,o,s),F=this.heightAt(t,n)/B,M=this.heightAt(a,i)/B,w=this.heightAt(o,s)/B,b=0,I=0,L=0,k=0,D=l;D<=h;D++){var O=0;d<0&&_!==0&&(O=Math.max(O,Math.floor(-d/_))),p<0&&x!==0&&(O=Math.max(O,Math.floor(-p/x))),v<0&&y!==0&&(O=Math.max(O,Math.floor(-v/y)));for(var P=d+_*O,R=p+x*O,j=v+y*O,G=!1,V=f+O;V<=c;V++){if(P>=0&&R>=0&&j>=0){G=!0;var X=F*P+M*R+w*j,ne=Math.abs(X-this.heightAt(V,D));k+=ne*ne,ne>b&&(b=ne,I=V,L=D)}else if(G)break;P+=_,R+=x,j+=y}d+=E,p+=C,v+=A}(I===t&&L===n||I===a&&L===i||I===o&&L===s)&&(b=0),this._candidates[2*u]=I,this._candidates[2*u+1]=L,this._rms[u]=k,this._queuePush(u,b,k)}},{key:"_step",value:function(){var t=this._queuePop(),n=t*3+0,a=t*3+1,i=t*3+2,o=this.triangles[n],s=this.triangles[a],u=this.triangles[i],f=this.coords[2*o],l=this.coords[2*o+1],c=this.coords[2*s],h=this.coords[2*s+1],d=this.coords[2*u],p=this.coords[2*u+1],v=this._candidates[2*t],y=this._candidates[2*t+1],A=this._addPoint(v,y);if(aa(f,l,c,h,v,y)===0)this._handleCollinear(A,n);else if(aa(c,h,d,p,v,y)===0)this._handleCollinear(A,a);else if(aa(d,p,f,l,v,y)===0)this._handleCollinear(A,i);else{var _=this._halfedges[n],E=this._halfedges[a],x=this._halfedges[i],C=this._addTriangle(o,s,A,_,-1,-1,n),B=this._addTriangle(s,u,A,E,-1,C+1),F=this._addTriangle(u,o,A,x,C+2,B+1);this._legalize(C),this._legalize(B),this._legalize(F)}}},{key:"_addPoint",value:function(t,n){var a=this.coords.length>>1;return this.coords.push(t,n),a}},{key:"_addTriangle",value:function(t,n,a,i,o,s){var u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:this.triangles.length,f=u/3;return this.triangles[u+0]=t,this.triangles[u+1]=n,this.triangles[u+2]=a,this._halfedges[u+0]=i,this._halfedges[u+1]=o,this._halfedges[u+2]=s,i>=0&&(this._halfedges[i]=u+0),o>=0&&(this._halfedges[o]=u+1),s>=0&&(this._halfedges[s]=u+2),this._candidates[2*f+0]=0,this._candidates[2*f+1]=0,this._queueIndices[f]=-1,this._rms[f]=0,this._pending[this._pendingLen++]=f,u}},{key:"_legalize",value:function(t){var n=this._halfedges[t];if(!(n<0)){var a=t-t%3,i=n-n%3,o=a+(t+1)%3,s=a+(t+2)%3,u=i+(n+2)%3,f=i+(n+1)%3,l=this.triangles[s],c=this.triangles[t],h=this.triangles[o],d=this.triangles[u],p=this.coords;if(MU(p[2*l],p[2*l+1],p[2*c],p[2*c+1],p[2*h],p[2*h+1],p[2*d],p[2*d+1])){var v=this._halfedges[o],y=this._halfedges[s],A=this._halfedges[u],_=this._halfedges[f];this._queueRemove(a/3),this._queueRemove(i/3);var E=this._addTriangle(l,d,h,-1,A,v,a),x=this._addTriangle(d,l,c,E,y,_,i);this._legalize(E+1),this._legalize(x+2)}}}},{key:"_handleCollinear",value:function(t,n){var a=n-n%3,i=a+(n+1)%3,o=a+(n+2)%3,s=this.triangles[o],u=this.triangles[n],f=this.triangles[i],l=this._halfedges[i],c=this._halfedges[o],h=this._halfedges[n];if(h<0){var d=this._addTriangle(t,s,u,-1,c,-1,a),p=this._addTriangle(s,t,f,d,-1,l);this._legalize(d+1),this._legalize(p+2);return}var v=h-h%3,y=v+(h+2)%3,A=v+(h+1)%3,_=this.triangles[y],E=this._halfedges[y],x=this._halfedges[A];this._queueRemove(v/3);var C=this._addTriangle(s,u,t,c,-1,-1,a),B=this._addTriangle(u,_,t,x,-1,C+1,v),F=this._addTriangle(_,f,t,E,-1,B+1),M=this._addTriangle(f,s,t,l,C+2,F+1);this._legalize(C),this._legalize(B),this._legalize(F),this._legalize(M)}},{key:"_queuePush",value:function(t,n,a){var i=this._queue.length;this._queueIndices[t]=i,this._queue.push(t),this._errors.push(n),this._rmsSum+=a,this._queueUp(i)}},{key:"_queuePop",value:function(){var t=this._queue.length-1;return this._queueSwap(0,t),this._queueDown(0,t),this._queuePopBack()}},{key:"_queuePopBack",value:function(){var t=this._queue.pop();return this._errors.pop(),this._rmsSum-=this._rms[t],this._queueIndices[t]=-1,t}},{key:"_queueRemove",value:function(t){var n=this._queueIndices[t];if(n<0){var a=this._pending.indexOf(t);if(a!==-1)this._pending[a]=this._pending[--this._pendingLen];else throw new Error("Broken triangulation (something went wrong).");return}var i=this._queue.length-1;i!==n&&(this._queueSwap(n,i),this._queueDown(n,i)||this._queueUp(n)),this._queuePopBack()}},{key:"_queueLess",value:function(t,n){return this._errors[t]>this._errors[n]}},{key:"_queueSwap",value:function(t,n){var a=this._queue[t],i=this._queue[n];this._queue[t]=i,this._queue[n]=a,this._queueIndices[a]=n,this._queueIndices[i]=t;var o=this._errors[t];this._errors[t]=this._errors[n],this._errors[n]=o}},{key:"_queueUp",value:function(t){for(var n=t;;){var a=n-1>>1;if(a===n||!this._queueLess(n,a))break;this._queueSwap(a,n),n=a}}},{key:"_queueDown",value:function(t,n){for(var a=t;;){var i=2*a+1;if(i>=n||i<0)break;var o=i+1,s=i;if(o<n&&this._queueLess(o,i)&&(s=o),!this._queueLess(s,a))break;this._queueSwap(a,s),a=s}return a>t}}]),e}();function aa(e,r,t,n,a,i){return(t-a)*(r-i)-(n-i)*(e-a)}function MU(e,r,t,n,a,i,o,s){var u=e-o,f=r-s,l=t-o,c=n-s,h=a-o,d=i-s,p=u*u+f*f,v=l*l+c*c,y=h*h+d*d;return u*(c*y-v*d)-f*(l*y-v*h)+p*(l*d-c*h)<0}function E2(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Af(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?E2(Object(t),!0).forEach(function(n){(0,C2.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):E2(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function _f(e,r,t,n,a){for(var i=n.rScaler,o=n.bScaler,s=n.gScaler,u=n.offset,f=new Float32Array((r+1)*(t+1)),l=0,c=0;c<t;c++)for(var h=0;h<r;h++,l++){var d=l*4,p=e[d+0],v=e[d+1],y=e[d+2];f[l+c]=p*i+v*s+y*o+u}if(a==="martini"){for(var A=(r+1)*r,_=0;_<r;_++,A++)f[A]=f[A-r-1];for(var E=t,x=0;x<t+1;x++,E+=t+1)f[E]=f[E-1]}return f}function OU(e,r,t,n,a){for(var i=t+1,o=e.length/2,s=new Float32Array(o*3),u=new Float32Array(o*2),f=a||[0,0,t,n],l=(0,M2.default)(f,4),c=l[0],h=l[1],d=l[2],p=l[3],v=(d-c)/t,y=(p-h)/n,A=0;A<o;A++){var _=e[A*2],E=e[A*2+1],x=E*i+_;s[3*A+0]=_*v+c,s[3*A+1]=-E*y+p,s[3*A+2]=r[x],u[2*A+0]=_/t,u[2*A+1]=E/n}return{POSITION:{value:s,size:3},TEXCOORD_0:{value:u,size:2}}}function PU(e,r){if(e===null)return null;var t=r.meshMaxError,n=r.bounds,a=r.elevationDecoder,i=e.data,o=e.width,s=e.height,u,f;switch(r.tesselator){case"martini":u=_f(i,o,s,a,r.tesselator),f=S2(t,o,u);break;case"delatin":u=_f(i,o,s,a,r.tesselator),f=w2(t,o,s,u);break;default:o===s&&!(s&o-1)?(u=_f(i,o,s,a,"martini"),f=S2(t,o,u)):(u=_f(i,o,s,a,"delatin"),f=w2(t,o,s,u));break}var l=f,c=l.vertices,h=f,d=h.triangles,p=OU(c,u,o,s,n),v=zn(p);if(r.skirtHeight){var y=gf(p,d,r.skirtHeight),A=y.attributes,_=y.triangles;p=A,d=_}return{loaderData:{header:{}},header:{vertexCount:d.length,boundingBox:v},mode:4,indices:{value:Uint32Array.from(d),size:1},attributes:p}}function S2(e,r,t){var n=r+1,a=new wo(n),i=a.createTile(t),o=i.getMesh(e),s=o.vertices,u=o.triangles;return{vertices:s,triangles:u}}function w2(e,r,t,n){var a=new x2(n,r+1,t+1);a.run(e);var i=a.coords,o=a.triangles,s=i;return{vertices:s,triangles:o}}function Xm(e,r,t){return Jm.apply(this,arguments)}function Jm(){return Jm=(0,B2.default)(qm.default.mark(function e(r,t,n){var a,i;return qm.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=Af(Af({},t),{},{mimeType:"application/x.image",image:Af(Af({},t.image),{},{type:"data"})}),s.next=3,n.parse(r,a);case 3:return i=s.sent,s.abrupt("return",PU(i,t.terrain));case 5:case"end":return s.stop()}},e)})),Jm.apply(this,arguments)}var bf="3.4.2";var Tf={name:"Terrain",id:"terrain",module:"terrain",version:bf,worker:!0,extensions:["png","pngraw","jpg","jpeg","gif","webp","bmp"],mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp"],options:{terrain:{tesselator:"auto",bounds:null,meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0},skirtHeight:null}}};var O2={name:"Quantized Mesh",id:"quantized-mesh",module:"terrain",version:bf,worker:!0,extensions:["terrain"],mimeTypes:["application/vnd.quantized-mesh"],options:{"quantized-mesh":{bounds:[0,0,1,1],skirtHeight:null}}};function P2(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function xf(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?P2(Object(t),!0).forEach(function(n){(0,R2.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):P2(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var vae=xf(xf({},Tf),{},{parse:Xm});var gae=xf(xf({},O2),{},{parseSync:yf,parse:function(){var e=(0,I2.default)(Km.default.mark(function t(n,a){return Km.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",yf(n,a));case 1:case"end":return o.stop()}},t)}));function r(t,n){return e.apply(this,arguments)}return r}()});function IU(e){var r=RU();return function(){var n=(0,Zm.default)(e),a;if(r){var i=(0,Zm.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,H2.default)(this,a)}}function RU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function F2(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function fn(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?F2(Object(t),!0).forEach(function(n){(0,Co.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F2(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var L2=[1],FU=fn(fn({},yr.defaultProps),{},{elevationData:qr,texture:fn(fn({},qr),{},{optional:!0}),meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:"",wireframe:!1,material:!0,loaders:[Tf]});function k2(e){return Array.isArray(e)?e.join(";"):e||""}var Sf=function(e){(0,j2.default)(t,e);var r=IU(t);function t(){var n;(0,G2.default)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=r.call.apply(r,[this].concat(i)),(0,Co.default)((0,U2.default)(n),"state",void 0),n}return(0,N2.default)(t,[{key:"updateState",value:function(a){var i=a.props,o=a.oldProps,s=i.elevationData!==o.elevationData;if(s){var u=i.elevationData,f=u&&(Array.isArray(u)||u.includes("{x}")&&u.includes("{y}"));this.setState({isTiled:f})}var l=s||i.meshMaxError!==o.meshMaxError||i.elevationDecoder!==o.elevationDecoder||i.bounds!==o.bounds;if(!this.state.isTiled&&l){var c=this.loadTerrain(i);this.setState({terrain:c})}i.workerUrl&&Ef.log.removed("workerUrl","loadOptions.terrain.workerUrl")()}},{key:"loadTerrain",value:function(a){var i,o=a.elevationData,s=a.bounds,u=a.elevationDecoder,f=a.meshMaxError,l=a.signal;if(!o)return null;var c=this.getLoadOptions();c=fn(fn({},c),{},{terrain:fn(fn({skirtHeight:this.state.isTiled?f*2:0},(i=c)===null||i===void 0?void 0:i.terrain),{},{bounds:s,meshMaxError:f,elevationDecoder:u})});var h=this.props.fetch;return h(o,{propName:"elevationData",layer:this,loadOptions:c,signal:l})}},{key:"getTiledTerrainData",value:function(a){var i=this.props,o=i.elevationData,s=i.fetch,u=i.texture,f=i.elevationDecoder,l=i.meshMaxError,c=this.context.viewport,h=ar(o,a),d=u&&ar(u,a),p=a.signal,v=[0,0],y=[0,0];if(c.isGeospatial){var A=a.bbox;v=c.projectFlat([A.west,A.south]),y=c.projectFlat([A.east,A.north])}else{var _=a.bbox;v=[_.left,_.bottom],y=[_.right,_.top]}var E=[v[0],v[1],y[0],y[1]],x=this.loadTerrain({elevationData:h,bounds:E,elevationDecoder:f,meshMaxError:l,signal:p}),C=d?s(d,{propName:"texture",layer:this,loaders:[],signal:p}).catch(function(B){return null}):Promise.resolve(null);return Promise.all([x,C])}},{key:"renderSubLayers",value:function(a){var i=this.getSubLayerClass("mesh",$m.SimpleMeshLayer),o=this.props,s=o.color,u=o.wireframe,f=o.material,l=a.data;if(!l)return null;var c=(0,D2.default)(l,2),h=c[0],d=c[1];return new i(a,{data:L2,mesh:h,texture:d,_instanced:!1,coordinateSystem:V2.COORDINATE_SYSTEM.CARTESIAN,getPosition:function(v){return[0,0,0]},getColor:s,wireframe:u,material:f})}},{key:"onViewportLoad",value:function(a){if(a){var i=this.state.zRange,o=a.map(function(f){return f.content}).filter(Boolean).map(function(f){var l=f[0].header.boundingBox;return l.map(function(c){return c[2]})});if(o.length!==0){var s=Math.min.apply(Math,(0,Ym.default)(o.map(function(f){return f[0]}))),u=Math.max.apply(Math,(0,Ym.default)(o.map(function(f){return f[1]})));(!i||s<i[0]||u>i[1])&&this.setState({zRange:[s,u]})}}}},{key:"renderLayers",value:function(){var a=this.props,i=a.color,o=a.material,s=a.elevationData,u=a.texture,f=a.wireframe,l=a.meshMaxError,c=a.elevationDecoder,h=a.tileSize,d=a.maxZoom,p=a.minZoom,v=a.extent,y=a.maxRequests,A=a.onTileLoad,_=a.onTileUnload,E=a.onTileError,x=a.maxCacheSize,C=a.maxCacheByteSize,B=a.refinementStrategy;if(this.state.isTiled)return new yr(this.getSubLayerProps({id:"tiles"}),{getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:k2(s),texture:k2(u),meshMaxError:l,elevationDecoder:c}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:h,maxZoom:d,minZoom:p,extent:v,maxRequests:y,onTileLoad:A,onTileUnload:_,onTileError:E,maxCacheSize:x,maxCacheByteSize:C,refinementStrategy:B});var F=this.getSubLayerClass("mesh",$m.SimpleMeshLayer);return new F(this.getSubLayerProps({id:"mesh"}),{data:L2,mesh:this.state.terrain,texture:u,_instanced:!1,getPosition:function(w){return[0,0,0]},getColor:i,material:o,wireframe:f})}}]),t}(Ef.CompositeLayer);(0,Co.default)(Sf,"defaultProps",FU);(0,Co.default)(Sf,"layerName","TerrainLayer");var dM=m(st()),pM=m(K()),mM=m(H()),vM=m(z()),cn=m(dn()),gM=m(Te()),yM=m(xe()),lr=m(be()),Df=m(W()),xv=m(Y()),Gf=m(Ut()),Ev=m(Nt()),AM=m(W2());var ZB=m(K()),$B=m(W()),gv=m(Y());var XB=m(ie());var oB=m(W());var K2=m(H()),Y2=m(z());function Qm(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=q2(e,t);return n!==r?(LU(e,t),!0):!1}function q2(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Math.sign(Pr(e,r))}function Pr(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.start,n=t===void 0?0:t,a=r.end,i=a===void 0?e.length:a,o=r.size||2,s=0,u=n,f=i-o;u<i;u+=o)s+=(e[u]-e[f])*(e[u+1]+e[f+1]),f=u;return s/2}function ev(e,r){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.start,a=n===void 0?0:n,i=t.end,o=i===void 0?e.length:i,s=t.size,u=s===void 0?2:s,f=t.isClosed,l=(o-a)/u,c=0;c<l-1;++c)r(e[a+c*u],e[a+c*u+1],e[a+(c+1)*u],e[a+(c+1)*u+1],c,c+1);var h=a+(l-1)*u,d=f||Ze(e[a],e[h])&&Ze(e[a+1],e[h+1]);d||r(e[h],e[h+1],e[a],e[a+1],l-1,0)}function LU(e,r){for(var t=r.start,n=t===void 0?0:t,a=r.end,i=a===void 0?e.length:a,o=r.size,s=o===void 0?2:o,u=(i-n)/s,f=Math.floor(u/2),l=0;l<f;++l)for(var c=n+l*s,h=n+(u-1-l)*s,d=0;d<s;++d){var p=e[c+d];e[c+d]=e[h+d],e[h+d]=p}}function J2(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=kU(e,t);return n!==r?(e.reverse(),!0):!1}function kU(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Math.sign(tv(e,r))}function tv(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.start,n=t===void 0?0:t,a=r.end,i=a===void 0?e.length:a,o=0,s=n,u=i-1;s<i;++s)o+=(e[s][0]-e[u][0])*(e[s][1]+e[u][1]),u=s;return o/2}function X2(e,r){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.start,a=n===void 0?0:n,i=t.end,o=i===void 0?e.length:i,s=t.isClosed,u=a;u<o-1;++u)r(e[u],e[u+1],u,u+1);var f=s||Ze(e[o-1],e[0]);f||r(e[o-1],e[0],o-1,0)}var Z2=function(){function e(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,K2.default)(this,e),g(this,"points",void 0),g(this,"isFlatArray",void 0),g(this,"options",void 0),this.points=r,this.isFlatArray=!ft(r[0]),this.options={start:t.start||0,end:t.end||r.length,size:t.size||2,isClosed:t.isClosed},Object.freeze(this)}return(0,Y2.default)(e,[{key:"getSignedArea",value:function(){return this.isFlatArray?Pr(this.points,this.options):tv(this.points,this.options)}},{key:"getArea",value:function(){return Math.abs(this.getSignedArea())}},{key:"getWindingDirection",value:function(){return Math.sign(this.getSignedArea())}},{key:"forEachSegment",value:function(t){this.isFlatArray?ev(this.points,function(n,a,i,o,s,u){t([n,a],[i,o],s,u)},this.options):X2(this.points,t,this.options)}},{key:"modifyWindingDirection",value:function(t){return this.isFlatArray?Qm(this.points,t,this.options):J2(this.points,t,this.options)}}]),e}();function av(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:2,n=arguments.length>3?arguments[3]:void 0,a=r&&r.length,i=a?r[0]*t:e.length,o=Q2(e,0,i,t,!0,n&&n[0]),s=[];if(!o||o.next===o.prev)return s;var u,f,l,c,h,d,p;if(a&&(o=jU(e,r,o,t,n)),e.length>80*t){c=f=e[0],h=l=e[1];for(var v=t;v<i;v+=t)d=e[v],p=e[v+1],d<c&&(c=d),p<h&&(h=p),d>f&&(f=d),p>l&&(l=p);u=Math.max(f-c,l-h),u=u!==0?1/u:0}return Bo(o,s,t,c,h,u),s}function Q2(e,r,t,n,a,i){var o,s;if(i===void 0&&(i=Pr(e,{start:r,end:t,size:n})),a===i<0)for(o=r;o<t;o+=n)s=$2(o,e[o],e[o+1],s);else for(o=t-n;o>=r;o-=n)s=$2(o,e[o],e[o+1],s);return s&&Bf(s,s.next)&&(Oo(s),s=s.next),s}function ln(e,r){if(!e)return e;r||(r=e);var t=e,n;do if(n=!1,!t.steiner&&(Bf(t,t.next)||Le(t.prev,t,t.next)===0)){if(Oo(t),t=r=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==r);return r}function Bo(e,r,t,n,a,i,o){if(e){!o&&i&&qU(e,n,a,i);for(var s=e,u,f;e.prev!==e.next;){if(u=e.prev,f=e.next,i?GU(e,n,a,i):DU(e)){r.push(u.i/t),r.push(e.i/t),r.push(f.i/t),Oo(e),e=f.next,s=f.next;continue}if(e=f,e===s){o?o===1?(e=NU(ln(e),r,t),Bo(e,r,t,n,a,i,2)):o===2&&UU(e,r,t,n,a,i):Bo(ln(e),r,t,n,a,i,1);break}}}}function DU(e){var r=e.prev,t=e,n=e.next;if(Le(r,t,n)>=0)return!1;for(var a=e.next.next;a!==e.prev;){if(ti(r.x,r.y,t.x,t.y,n.x,n.y,a.x,a.y)&&Le(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function GU(e,r,t,n){var a=e.prev,i=e,o=e.next;if(Le(a,i,o)>=0)return!1;for(var s=a.x<i.x?a.x<o.x?a.x:o.x:i.x<o.x?i.x:o.x,u=a.y<i.y?a.y<o.y?a.y:o.y:i.y<o.y?i.y:o.y,f=a.x>i.x?a.x>o.x?a.x:o.x:i.x>o.x?i.x:o.x,l=a.y>i.y?a.y>o.y?a.y:o.y:i.y>o.y?i.y:o.y,c=rv(s,u,r,t,n),h=rv(f,l,r,t,n),d=e.prevZ,p=e.nextZ;d&&d.z>=c&&p&&p.z<=h;){if(d!==e.prev&&d!==e.next&&ti(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&Le(d.prev,d,d.next)>=0||(d=d.prevZ,p!==e.prev&&p!==e.next&&ti(a.x,a.y,i.x,i.y,o.x,o.y,p.x,p.y)&&Le(p.prev,p,p.next)>=0))return!1;p=p.nextZ}for(;d&&d.z>=c;){if(d!==e.prev&&d!==e.next&&ti(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&Le(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=h;){if(p!==e.prev&&p!==e.next&&ti(a.x,a.y,i.x,i.y,o.x,o.y,p.x,p.y)&&Le(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function NU(e,r,t){var n=e;do{var a=n.prev,i=n.next.next;!Bf(a,i)&&eB(a,n,n.next,i)&&Mo(a,i)&&Mo(i,a)&&(r.push(a.i/t),r.push(n.i/t),r.push(i.i/t),Oo(n),Oo(n.next),n=e=i),n=n.next}while(n!==e);return ln(n)}function UU(e,r,t,n,a,i){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&KU(o,s)){var u=tB(o,s);o=ln(o,o.next),u=ln(u,u.next),Bo(o,r,t,n,a,i),Bo(u,r,t,n,a,i);return}s=s.next}o=o.next}while(o!==e)}function jU(e,r,t,n,a){var i=[],o,s,u,f,l;for(o=0,s=r.length;o<s;o++)u=r[o]*n,f=o<s-1?r[o+1]*n:e.length,l=Q2(e,u,f,n,!1,a&&a[o+1]),l===l.next&&(l.steiner=!0),i.push(XU(l));for(i.sort(HU),o=0;o<i.length;o++)VU(i[o],t),t=ln(t,t.next);return t}function HU(e,r){return e.x-r.x}function VU(e,r){if(r=zU(e,r),r){var t=tB(r,e);ln(r,r.next),ln(t,t.next)}}function zU(e,r){var t=r,n=e.x,a=e.y,i=-1/0,o;do{if(a<=t.y&&a>=t.next.y&&t.next.y!==t.y){var s=t.x+(a-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(s<=n&&s>i){if(i=s,s===n){if(a===t.y)return t;if(a===t.next.y)return t.next}o=t.x<t.next.x?t:t.next}}t=t.next}while(t!==r);if(!o)return null;if(n===i)return o;var u=o,f=o.x,l=o.y,c=1/0,h;t=o;do n>=t.x&&t.x>=f&&n!==t.x&&ti(a<l?n:i,a,f,l,a<l?i:n,a,t.x,t.y)&&(h=Math.abs(a-t.y)/(n-t.x),Mo(t,e)&&(h<c||h===c&&(t.x>o.x||t.x===o.x&&WU(o,t)))&&(o=t,c=h)),t=t.next;while(t!==u);return o}function WU(e,r){return Le(e.prev,e,r.prev)<0&&Le(r.next,e,e.next)<0}function qU(e,r,t,n){var a=e;do a.z===null&&(a.z=rv(a.x,a.y,r,t,n)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==e);a.prevZ.nextZ=null,a.prevZ=null,JU(a)}function JU(e){var r,t,n=1,a,i,o,s,u,f;do{for(i=e,e=null,f=null,a=0;i;){for(a++,s=i,o=0,t=0;t<n&&(o++,s=s.nextZ,!!s);t++);for(u=n;o>0||u>0&&s;)o!==0&&(u===0||!s||i.z<=s.z)?(r=i,i=i.nextZ,o--):(r=s,s=s.nextZ,u--),f?f.nextZ=r:e=r,r.prevZ=f,f=r;i=s}f.nextZ=null,n*=2}while(a>1);return e}function rv(e,r,t,n,a){return e=32767*(e-t)*a,r=32767*(r-n)*a,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e|r<<1}function XU(e){var r=e,t=e;do(r.x<t.x||r.x===t.x&&r.y<t.y)&&(t=r),r=r.next;while(r!==e);return t}function ti(e,r,t,n,a,i,o,s){return(a-o)*(r-s)-(e-o)*(i-s)>=0&&(e-o)*(n-s)-(t-o)*(r-s)>=0&&(t-o)*(i-s)-(a-o)*(n-s)>=0}function KU(e,r){return e.next.i!==r.i&&e.prev.i!==r.i&&!YU(e,r)&&(Mo(e,r)&&Mo(r,e)&&ZU(e,r)&&(Le(e.prev,e,r.prev)||Le(e,r.prev,r))||Bf(e,r)&&Le(e.prev,e,e.next)>0&&Le(r.prev,r,r.next)>0)}function Le(e,r,t){return(r.y-e.y)*(t.x-r.x)-(r.x-e.x)*(t.y-r.y)}function Bf(e,r){return e.x===r.x&&e.y===r.y}function eB(e,r,t,n){var a=Cf(Le(e,r,t)),i=Cf(Le(e,r,n)),o=Cf(Le(t,n,e)),s=Cf(Le(t,n,r));return!!(a!==i&&o!==s||a===0&&wf(e,t,r)||i===0&&wf(e,n,r)||o===0&&wf(t,e,n)||s===0&&wf(t,r,n))}function wf(e,r,t){return r.x<=Math.max(e.x,t.x)&&r.x>=Math.min(e.x,t.x)&&r.y<=Math.max(e.y,t.y)&&r.y>=Math.min(e.y,t.y)}function Cf(e){return e>0?1:e<0?-1:0}function YU(e,r){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==r.i&&t.next.i!==r.i&&eB(t,t.next,e,r))return!0;t=t.next}while(t!==e);return!1}function Mo(e,r){return Le(e.prev,e,e.next)<0?Le(e,r,e.next)>=0&&Le(e,e.prev,r)>=0:Le(e,r,e.prev)<0||Le(e,e.next,r)<0}function ZU(e,r){var t=e,n=!1,a=(e.x+r.x)/2,i=(e.y+r.y)/2;do t.y>i!=t.next.y>i&&t.next.y!==t.y&&a<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==e);return n}function tB(e,r){var t=new nv(e.i,e.x,e.y),n=new nv(r.i,r.x,r.y),a=e.next,i=r.prev;return e.next=r,r.prev=e,t.next=a,a.prev=t,n.next=t,t.prev=n,i.next=n,n.prev=i,n}function $2(e,r,t,n){var a=new nv(e,r,t);return n?(a.next=n.next,a.prev=n,n.next.prev=a,n.next=a):(a.prev=a,a.next=a),a}function Oo(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function nv(e,r,t){this.i=e,this.x=r,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function sv(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=t6(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function t6(e,r){if(e){if(typeof e=="string")return aB(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return aB(e,r)}}function aB(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function iB(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function ia(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?iB(Object(t),!0).forEach(function(n){(0,oB.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):iB(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function uv(e,r,t){var n=r6(e),a=Object.keys(n).filter(function(i){return n[i]!==Array});return n6(e,ia({propArrayTypes:n},r),{numericPropKeys:t&&t.numericPropKeys||a,PositionDataType:t?t.PositionDataType:Float32Array})}function r6(e){var r={},t=sv(e),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;if(a.properties)for(var i in a.properties){var o=a.properties[i];r[i]=f6(o,r[i])}}}catch(s){t.e(s)}finally{t.f()}return r}function n6(e,r,t){for(var n=r.pointPositionsCount,a=r.pointFeaturesCount,i=r.linePositionsCount,o=r.linePathsCount,s=r.lineFeaturesCount,u=r.polygonPositionsCount,f=r.polygonObjectsCount,l=r.polygonRingsCount,c=r.polygonFeaturesCount,h=r.propArrayTypes,d=r.coordLength,p=t.numericPropKeys,v=p===void 0?[]:p,y=t.PositionDataType,A=y===void 0?Float32Array:y,_=e[0]&&("id"in e[0]),E=e.length>65535?Uint32Array:Uint16Array,x={type:"Point",positions:new A(n*d),globalFeatureIds:new E(n),featureIds:a>65535?new Uint32Array(n):new Uint16Array(n),numericProps:{},properties:[],fields:[]},C={type:"LineString",pathIndices:i>65535?new Uint32Array(o+1):new Uint16Array(o+1),positions:new A(i*d),globalFeatureIds:new E(i),featureIds:s>65535?new Uint32Array(i):new Uint16Array(i),numericProps:{},properties:[],fields:[]},B={type:"Polygon",polygonIndices:u>65535?new Uint32Array(f+1):new Uint16Array(f+1),primitivePolygonIndices:u>65535?new Uint32Array(l+1):new Uint16Array(l+1),positions:new A(u*d),triangles:[],globalFeatureIds:new E(u),featureIds:c>65535?new Uint32Array(u):new Uint16Array(u),numericProps:{},properties:[],fields:[]},F=0,M=[x,C,B];F<M.length;F++){var w=M[F],b=sv(v),I;try{for(b.s();!(I=b.n()).done;){var L=I.value,k=h[L];w.numericProps[L]=new k(w.positions.length/d)}}catch(V){b.e(V)}finally{b.f()}}C.pathIndices[o]=i,B.polygonIndices[f]=u,B.primitivePolygonIndices[l]=u;var D={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0},O=sv(e),P;try{for(O.s();!(P=O.n()).done;){var R=P.value,j=R.geometry,G=R.properties||{};switch(j.type){case"Point":a6(j,x,D,d,G),x.properties.push(ov(G,v)),_&&x.fields.push({id:R.id}),D.pointFeature++;break;case"LineString":i6(j,C,D,d,G),C.properties.push(ov(G,v)),_&&C.fields.push({id:R.id}),D.lineFeature++;break;case"Polygon":o6(j,B,D,d,G),B.properties.push(ov(G,v)),_&&B.fields.push({id:R.id}),D.polygonFeature++;break;default:throw new Error("Invalid geometry type")}D.feature++}}catch(V){O.e(V)}finally{O.f()}return u6(x,C,B,d)}function a6(e,r,t,n,a){r.positions.set(e.data,t.pointPosition*n);var i=e.data.length/n;fv(r,a,t.pointPosition,i),r.globalFeatureIds.fill(t.feature,t.pointPosition,t.pointPosition+i),r.featureIds.fill(t.pointFeature,t.pointPosition,t.pointPosition+i),t.pointPosition+=i}function i6(e,r,t,n,a){r.positions.set(e.data,t.linePosition*n);var i=e.data.length/n;fv(r,a,t.linePosition,i),r.globalFeatureIds.fill(t.feature,t.linePosition,t.linePosition+i),r.featureIds.fill(t.lineFeature,t.linePosition,t.linePosition+i);for(var o=0,s=e.indices.length;o<s;++o){var u=e.indices[o],f=o===s-1?e.data.length:e.indices[o+1];r.pathIndices[t.linePath++]=t.linePosition,t.linePosition+=(f-u)/n}}function o6(e,r,t,n,a){r.positions.set(e.data,t.polygonPosition*n);var i=e.data.length/n;fv(r,a,t.polygonPosition,i),r.globalFeatureIds.fill(t.feature,t.polygonPosition,t.polygonPosition+i),r.featureIds.fill(t.polygonFeature,t.polygonPosition,t.polygonPosition+i);for(var o=0,s=e.indices.length;o<s;++o){var u=t.polygonPosition;r.polygonIndices[t.polygonObject++]=u;for(var f=e.areas[o],l=e.indices[o],c=e.indices[o+1],h=0,d=l.length;h<d;++h){var p=l[h],v=h===d-1?c===void 0?e.data.length:c[0]:l[h+1];r.primitivePolygonIndices[t.polygonRing++]=t.polygonPosition,t.polygonPosition+=(v-p)/n}var y=t.polygonPosition;s6(r,f,l,{startPosition:u,endPosition:y,coordLength:n})}}function s6(e,r,t,n){for(var a=n.startPosition,i=n.endPosition,o=n.coordLength,s=a*o,u=i*o,f=e.positions.subarray(s,u),l=t[0],c=t.slice(1).map(function(v){return(v-l)/o}),h=av(f,c,o,r),d=0,p=h.length;d<p;++d)e.triangles.push(a+h[d])}function iv(e,r){var t={};for(var n in e)t[n]={value:e[n],size:r};return t}function u6(e,r,t,n){return{points:ia(ia({},e),{},{positions:{value:e.positions,size:n},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:iv(e.numericProps,1)}),lines:ia(ia({},r),{},{positions:{value:r.positions,size:n},pathIndices:{value:r.pathIndices,size:1},globalFeatureIds:{value:r.globalFeatureIds,size:1},featureIds:{value:r.featureIds,size:1},numericProps:iv(r.numericProps,1)}),polygons:ia(ia({},t),{},{positions:{value:t.positions,size:n},polygonIndices:{value:t.polygonIndices,size:1},primitivePolygonIndices:{value:t.primitivePolygonIndices,size:1},triangles:{value:new Uint32Array(t.triangles),size:1},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:iv(t.numericProps,1)})}}function fv(e,r,t,n){for(var a in e.numericProps)if(a in r){var i=r[a];e.numericProps[a].fill(i,t,t+n)}}function ov(e,r){var t={};for(var n in e)r.includes(n)||(t[n]=e[n]);return t}function f6(e,r){return r===Array||!Number.isFinite(e)?Array:r===Float64Array||Math.fround(e)!==e?Float64Array:Float32Array}var fB=m(W());function sB(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function l6(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?sB(Object(t),!0).forEach(function(n){(0,fB.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):sB(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function lB(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=c6(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function c6(e,r){if(e){if(typeof e=="string")return uB(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return uB(e,r)}}function uB(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Pf(e,r){var t=r?.globalFeatureId;return t!==void 0?h6(e,t):d6(e,r?.type)}function h6(e,r){var t=hB(e),n=lB(t),a;try{for(n.s();!(a=n.n()).done;){for(var i=a.value,o=0,s=i.featureIds.value[0],u=0;u<i.featureIds.value.length;u++){var f=i.featureIds.value[u];if(f!==s){if(r===i.globalFeatureIds.value[o])return Mf(i,o,u);o=u,s=f}}if(r===i.globalFeatureIds.value[o])return Mf(i,o,i.featureIds.value.length)}}catch(l){n.e(l)}finally{n.f()}throw new Error("featureId:".concat(r," not found"))}function d6(e,r){var t=hB(e,r);return p6(t)}function cB(e,r,t){switch(e.type){case"Point":return y6(e,r,t);case"LineString":return g6(e,r,t);case"Polygon":return dB(e,r,t);default:var n=e;throw new Error("Unsupported geometry type: ".concat(n?.type))}}function hB(e,r){var t=Boolean(e.points||e.lines||e.polygons);if(!t)return e.type=r||A6(e),[e];var n=[];return e.points&&(e.points.type="Point",n.push(e.points)),e.lines&&(e.lines.type="LineString",n.push(e.lines)),e.polygons&&(e.polygons.type="Polygon",n.push(e.polygons)),n}function p6(e){var r=[],t=lB(e),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;if(a.featureIds.value.length!==0){for(var i=0,o=a.featureIds.value[0],s=0;s<a.featureIds.value.length;s++){var u=a.featureIds.value[s];u!==o&&(r.push(Mf(a,i,s)),i=s,o=u)}r.push(Mf(a,i,a.featureIds.value.length))}}}catch(f){t.e(f)}finally{t.f()}return r}function Mf(e,r,t){var n=cB(e,r,t),a=v6(e,r,t),i=m6(e,r,t);return l6({type:"Feature",geometry:n,properties:a},i)}function m6(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2?arguments[2]:void 0;return e.fields&&e.fields[e.featureIds.value[r]]}function v6(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2?arguments[2]:void 0,n=Object.assign({},e.properties[e.featureIds.value[r]]);for(var a in e.numericProps)n[a]=e.numericProps[a].value[r];return n}function dB(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1/0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1/0,n=e.positions,a=e.polygonIndices.value.filter(function(A){return A>=r&&A<=t}),i=e.primitivePolygonIndices.value.filter(function(A){return A>=r&&A<=t}),o=a.length>2;if(!o){for(var s=[],u=0;u<i.length-1;u++){var f=i[u],l=i[u+1],c=Of(n,f,l);s.push(c)}return{type:"Polygon",coordinates:s}}for(var h=[],d=0;d<a.length-1;d++){var p=a[d],v=a[d+1],y=dB(e,p,v).coordinates;h.push(y)}return{type:"MultiPolygon",coordinates:h}}function g6(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1/0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1/0,n=e.positions,a=e.pathIndices.value.filter(function(l){return l>=r&&l<=t}),i=a.length>2;if(!i){var o=Of(n,a[0],a[1]);return{type:"LineString",coordinates:o}}for(var s=[],u=0;u<a.length-1;u++){var f=Of(n,a[u],a[u+1]);s.push(f)}return{type:"MultiLineString",coordinates:s}}function y6(e,r,t){var n=e.positions,a=Of(n,r,t),i=a.length>1;return i?{type:"MultiPoint",coordinates:a}:{type:"Point",coordinates:a[0]}}function Of(e,r,t){r=r||0,t=t||e.value.length/e.size;for(var n=[],a=r;a<t;a++){for(var i=Array(),o=a*e.size;o<(a+1)*e.size;o++)i.push(Number(e.value[o]));n.push(i)}return n}function A6(e){return e.pathIndices?"LineString":e.polygonIndices?"Polygon":"Point"}var vv=m(_B());var MB=m(H());var wB=m(H()),CB=m(z());var xB=m(H()),EB=m(z());function bB(e){var r=e.length;if(r<=1)return[e];for(var t=[],n,a,i=0;i<r;i++){var o=D6(e[i]);o!==0&&(a===void 0&&(a=o<0),a===o<0?(n&&t.push(n),n=[e[i]]):n&&n.push(e[i]))}return n&&t.push(n),t}function D6(e){for(var r=0,t=0,n=e.length-1,a,i;t<e.length;n=t++)a=e[t],i=e[n],r+=(i[0]-a[0])*(a[1]+i[1]);return r}function TB(e,r,t){r&&t&&(e===1?r.id=t.readVarint():e===2?G6(t,r):e===3?r.type=t.readVarint():e===4&&(r._geometry=t.pos))}function G6(e,r){for(var t=e.readVarint()+e.pos;e.pos<t;){var n=r._keys[e.readVarint()],a=r._values[e.readVarint()];r.properties[n]=a}}var SB=function(){function e(r,t,n,a,i){(0,xB.default)(this,e),g(this,"properties",void 0),g(this,"extent",void 0),g(this,"type",void 0),g(this,"id",void 0),g(this,"_pbf",void 0),g(this,"_geometry",void 0),g(this,"_keys",void 0),g(this,"_values",void 0),this.properties={},this.extent=n,this.type=0,this.id=null,this._pbf=r,this._geometry=-1,this._keys=a,this._values=i,r.readFields(TB,this,t)}return(0,EB.default)(e,[{key:"loadGeometry",value:function(){var t=this._pbf;t.pos=this._geometry;for(var n=t.readVarint()+t.pos,a=1,i=0,o=0,s=0,u=[],f;t.pos<n;){if(i<=0){var l=t.readVarint();a=l&7,i=l>>3}if(i--,a===1||a===2)o+=t.readSVarint(),s+=t.readSVarint(),a===1&&(f&&u.push(f),f=[]),f&&f.push([o,s]);else if(a===7)f&&f.push(f[0].slice());else throw new Error("unknown command ".concat(a))}return f&&u.push(f),u}},{key:"bbox",value:function(){var t=this._pbf;t.pos=this._geometry;for(var n=t.readVarint()+t.pos,a=1,i=0,o=0,s=0,u=1/0,f=-1/0,l=1/0,c=-1/0;t.pos<n;){if(i<=0){var h=t.readVarint();a=h&7,i=h>>3}if(i--,a===1||a===2)o+=t.readSVarint(),s+=t.readSVarint(),o<u&&(u=o),o>f&&(f=o),s<l&&(l=s),s>c&&(c=s);else if(a!==7)throw new Error("unknown command ".concat(a))}return[u,l,f,c]}},{key:"_toGeoJSON",value:function(t){var n=this.loadGeometry(),a=e.types[this.type],i,o;switch(this.type){case 1:var s=[];for(i=0;i<n.length;i++)s[i]=n[i][0];n=s,t(n,this);break;case 2:for(i=0;i<n.length;i++)t(n[i],this);break;case 3:for(n=bB(n),i=0;i<n.length;i++)for(o=0;o<n[i].length;o++)t(n[i][o],this);break}n.length===1?n=n[0]:a="Multi".concat(a);var u={type:"Feature",geometry:{type:a,coordinates:n},properties:this.properties};return this.id!==null&&(u.id=this.id),u}},{key:"toGeoJSON",value:function(t){if(typeof t=="function")return this._toGeoJSON(t);var n=t.x,a=t.y,i=t.z,o=this.extent*Math.pow(2,i),s=this.extent*n,u=this.extent*a;function f(l){for(var c=0;c<l.length;c++){var h=l[c];h[0]=(h[0]+s)*360/o-180;var d=180-(h[1]+u)*360/o;h[1]=360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90}}return this._toGeoJSON(f)}}],[{key:"types",get:function(){return["Unknown","Point","LineString","Polygon"]}}]),e}();var BB=function(){function e(r,t){(0,wB.default)(this,e),g(this,"version",void 0),g(this,"name",void 0),g(this,"extent",void 0),g(this,"length",void 0),g(this,"_pbf",void 0),g(this,"_keys",void 0),g(this,"_values",void 0),g(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(N6,this,t),this.length=this._features.length}return(0,CB.default)(e,[{key:"feature",value:function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var n=this._pbf.readVarint()+this._pbf.pos;return new SB(this._pbf,n,this.extent,this._keys,this._values)}}]),e}();function N6(e,r,t){r&&t&&(e===15?r.version=t.readVarint():e===1?r.name=t.readString():e===5?r.extent=t.readVarint():e===2?r._features.push(t.pos):e===3?r._keys.push(t.readString()):e===4&&r._values.push(U6(t)))}function U6(e){for(var r=null,t=e.readVarint()+e.pos;e.pos<t;){var n=e.readVarint()>>3;r=n===1?e.readString():n===2?e.readFloat():n===3?e.readDouble():n===4?e.readVarint64():n===5?e.readVarint():n===6?e.readSVarint():n===7?e.readBoolean():null}return r}var OB=function e(r,t){(0,MB.default)(this,e),g(this,"layers",void 0),this.layers=r.readFields(j6,{},t)};function j6(e,r,t){if(e===3&&t){var n=new BB(t,t.readVarint()+t.pos);n.length&&r&&(r[n.name]=n)}}var WB=m(H());var HB=m(H()),VB=m(z());var GB=m(W()),NB=m(H()),UB=m(z());function PB(e){var r=e.indices.length,t="Polygon";if(r<=1)return{type:t,data:e.data,areas:[[Pr(e.data)]],indices:[e.indices]};for(var n=[],a=[],i=[],o=[],s,u=0,f,l=0,c;l<r;l++){c=e.indices[l]-u,f=e.indices[l+1]-u||e.data.length;var h=e.data.slice(c,f),d=Pr(h);if(d===0){var p=e.data.slice(0,c),v=e.data.slice(f);e.data=p.concat(v),u+=f-c;continue}s===void 0&&(s=d<0),s===d<0?(o.length&&(n.push(i),a.push(o)),o=[c],i=[d]):(i.push(d),o.push(c))}return i&&n.push(i),o.length&&a.push(o),{type:t,areas:n,indices:a,data:e.data}}function IB(e,r,t,n){for(var a=0,i=e.length;a<i;a+=2){e[a]=(e[a]+r)*360/n-180;var o=180-(e[a+1]+t)*360/n;e[a+1]=360/Math.PI*Math.atan(Math.exp(o*Math.PI/180))-90}}function RB(e,r,t){r&&t&&(e===1?r.id=t.readVarint():e===2?H6(t,r):e===3?r.type=t.readVarint():e===4&&(r._geometry=t.pos))}function H6(e,r){for(var t=e.readVarint()+e.pos;e.pos<t;){var n=r._keys[e.readVarint()],a=r._values[e.readVarint()];r.properties[n]=a}}function V6(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=z6(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function z6(e,r){if(e){if(typeof e=="string")return FB(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return FB(e,r)}}function FB(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function LB(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function kB(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?LB(Object(t),!0).forEach(function(n){(0,GB.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):LB(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var DB,oa,hv,Ff,dv,pv,Po;var jB=function(){function e(r,t,n,a,i,o){(0,NB.default)(this,e),g(this,"properties",void 0),g(this,"extent",void 0),g(this,"type",void 0),g(this,"id",void 0),g(this,"_pbf",void 0),g(this,"_geometry",void 0),g(this,"_keys",void 0),g(this,"_values",void 0),g(this,"_geometryInfo",void 0),this.properties={},this.extent=n,this.type=0,this.id=null,this._pbf=r,this._geometry=-1,this._keys=a,this._values=i,this._geometryInfo=o,r.readFields(RB,this,t)}return(0,UB.default)(e,[{key:"loadGeometry",value:function(){var t=this._pbf;t.pos=this._geometry,DB=t.readVarint()+t.pos,oa=1,Ff=0,dv=0,pv=0,Po=0;for(var n=[],a=[];t.pos<DB;)if(Ff<=0&&(hv=t.readVarint(),oa=hv&7,Ff=hv>>3),Ff--,oa===1||oa===2)dv+=t.readSVarint(),pv+=t.readSVarint(),oa===1&&n.push(Po),a.push(dv,pv),Po+=2;else if(oa===7){if(Po>0){var i=n[n.length-1];a.push(a[i],a[i+1]),Po+=2}}else throw new Error("unknown command ".concat(oa));return{data:a,indices:n}}},{key:"_toBinaryCoordinates",value:function(t){var n=this.loadGeometry(),a;t(n.data,this);var i=2;switch(this.type){case 1:this._geometryInfo.pointFeaturesCount++,this._geometryInfo.pointPositionsCount+=n.indices.length,a=kB({type:"Point"},n);break;case 2:this._geometryInfo.lineFeaturesCount++,this._geometryInfo.linePathsCount+=n.indices.length,this._geometryInfo.linePositionsCount+=n.data.length/i,a=kB({type:"LineString"},n);break;case 3:a=PB(n),this._geometryInfo.polygonFeaturesCount++,this._geometryInfo.polygonObjectsCount+=a.indices.length;var o=V6(a.indices),s;try{for(o.s();!(s=o.n()).done;){var u=s.value;this._geometryInfo.polygonRingsCount+=u.length}}catch(l){o.e(l)}finally{o.f()}this._geometryInfo.polygonPositionsCount+=a.data.length/i;break;default:throw new Error("Invalid geometry type: ".concat(this.type))}var f={type:"Feature",geometry:a,properties:this.properties};return this.id!==null&&(f.id=this.id),f}},{key:"toBinaryCoordinates",value:function(t){if(typeof t=="function")return this._toBinaryCoordinates(t);var n=t.x,a=t.y,i=t.z,o=this.extent*Math.pow(2,i),s=this.extent*n,u=this.extent*a;return this._toBinaryCoordinates(function(f){return IB(f,s,u,o)})}}]),e}();var zB=function(){function e(r,t){(0,HB.default)(this,e),g(this,"version",void 0),g(this,"name",void 0),g(this,"extent",void 0),g(this,"length",void 0),g(this,"_pbf",void 0),g(this,"_keys",void 0),g(this,"_values",void 0),g(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(W6,this,t),this.length=this._features.length}return(0,VB.default)(e,[{key:"feature",value:function(t,n){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var a=this._pbf.readVarint()+this._pbf.pos;return new jB(this._pbf,a,this.extent,this._keys,this._values,n)}}]),e}();function W6(e,r,t){r&&t&&(e===15?r.version=t.readVarint():e===1?r.name=t.readString():e===5?r.extent=t.readVarint():e===2?r._features.push(t.pos):e===3?r._keys.push(t.readString()):e===4&&r._values.push(q6(t)))}function q6(e){for(var r=null,t=e.readVarint()+e.pos;e.pos<t;){var n=e.readVarint()>>3;r=n===1?e.readString():n===2?e.readFloat():n===3?e.readDouble():n===4?e.readVarint64():n===5?e.readVarint():n===6?e.readSVarint():n===7?e.readBoolean():null}return r}var qB=function e(r,t){(0,WB.default)(this,e),g(this,"layers",void 0),this.layers=r.readFields(J6,{},t)};function J6(e,r,t){if(e===3&&t){var n=new zB(t,t.readVarint()+t.pos);n.length&&r&&(r[n.name]=n)}}function Lf(e,r){var t,n,a=K6(r),i=(r==null||(t=r.gis)===null||t===void 0?void 0:t.format)||(r==null||(n=r.mvt)===null||n===void 0?void 0:n.shape);switch(i){case"columnar-table":return{shape:"columnar-table",data:mv(e,a)};case"geojson-row-table":{var o={shape:"geojson-row-table",data:JB(e,a)};return o}case"geojson":return JB(e,a);case"binary-geometry":return mv(e,a);case"binary":return mv(e,a);default:throw new Error(i)}}function mv(e,r){var t=X6(e,r),n=(0,XB.default)(t,2),a=n[0],i=n[1],o=uv(a,i);return o.byteLength=e.byteLength,o}function X6(e,r){var t=[],n={coordLength:2,pointPositionsCount:0,pointFeaturesCount:0,linePositionsCount:0,linePathsCount:0,lineFeaturesCount:0,polygonPositionsCount:0,polygonObjectsCount:0,polygonRingsCount:0,polygonFeaturesCount:0};if(e.byteLength<=0)return[t,n];var a=new qB(new vv.default(e)),i=r&&Array.isArray(r.layers)?r.layers:Object.keys(a.layers);return i.forEach(function(o){var s=a.layers[o];if(s)for(var u=0;u<s.length;u++){var f=s.feature(u,n),l=Z6(f,r,o);t.push(l)}}),[t,n]}function JB(e,r){if(e.byteLength<=0)return[];var t=[],n=new OB(new vv.default(e)),a=Array.isArray(r.layers)?r.layers:Object.keys(n.layers);return a.forEach(function(i){var o=n.layers[i];if(o)for(var s=0;s<o.length;s++){var u=o.feature(s),f=Y6(u,r,i);t.push(f)}}),t}function K6(e){var r;if(!(e!=null&&e.mvt))throw new Error("mvt options required");var t=((r=e.mvt)===null||r===void 0?void 0:r.coordinates)==="wgs84",n=e.mvt.tileIndex,a=n&&Number.isFinite(n.x)&&Number.isFinite(n.y)&&Number.isFinite(n.z);if(t&&!a)throw new Error("MVT Loader: WGS84 coordinates need tileIndex property");return e.mvt}function Y6(e,r,t){var n=e.toGeoJSON(r.coordinates==="wgs84"?r.tileIndex:$6);return r.layerProperty&&(n.properties[r.layerProperty]=t),n}function Z6(e,r,t){var n=e.toBinaryCoordinates(r.coordinates==="wgs84"?r.tileIndex:Q6);return r.layerProperty&&n.properties&&(n.properties[r.layerProperty]=t),n}function $6(e,r){for(var t=r.extent,n=0;n<e.length;n++){var a=e[n];a[0]/=t,a[1]/=t}}function Q6(e,r){for(var t=r.extent,n=0,a=e.length;n<a;++n)e[n]/=t}function KB(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function YB(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?KB(Object(t),!0).forEach(function(n){(0,$B.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):KB(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var e8="3.4.2",t8={mvt:{shape:"geojson",coordinates:"local",layerProperty:"layerName",layers:void 0,tileIndex:null}},kf={name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:e8,extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:t8},r8=YB(YB({},kf),{},{parse:function(){var e=(0,ZB.default)(gv.default.mark(function t(n,a){return gv.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",Lf(n,a));case 1:case"end":return o.stop()}},t)}));function r(t,n){return e.apply(this,arguments)}return r}(),parseSync:Lf,binary:!0});var tM=m(W()),yv=m(ie());function QB(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function eM(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?QB(Object(t),!0).forEach(function(n){(0,tM.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):QB(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var n8={Point:rM,MultiPoint:a8,LineString:nM,MultiLineString:i8,Polygon:aM,MultiPolygon:o8};function rM(e,r,t){var n=(0,yv.default)(e,2),a=n[0],i=n[1],o=(0,yv.default)(r,2),s=o[0],u=o[1],f=Ur(s[0],u[0],a),l=Ur(s[1],u[1],i);return t.unprojectFlat([f,l])}function Av(e,r,t){return e.map(function(n){return rM(n,r,t)})}function a8(e,r,t){return Av(e,r,t)}function nM(e,r,t){return Av(e,r,t)}function i8(e,r,t){return e.map(function(n){return nM(n,r,t)})}function aM(e,r,t){return e.map(function(n){return Av(n,r,t)})}function o8(e,r,t){return e.map(function(n){return aM(n,r,t)})}function iM(e,r,t){var n=t.projectFlat([r.west,r.north]),a=t.projectFlat([r.east,r.south]),i=[n,a];return eM(eM({},e),{},{coordinates:n8[e.type](e.coordinates,i,t)})}function s8(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=u8(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function u8(e,r){if(e){if(typeof e=="string")return oM(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return oM(e,r)}}function oM(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var f8=["points","lines","polygons"];function _v(e,r,t,n){var a=s8(f8),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e[o]&&l8(e[o],r,t,n);if(s>=0)return s}}catch(u){a.e(u)}finally{a.f()}return-1}function l8(e,r,t,n){var a=e.featureIds.value;if(!a.length)return-1;var i=0,o=a[a.length-1]+1;if(n){var s=c8(e,n);if(s)i=s[0],o=s[1]+1;else return-1}var u=-1;if(r in e.numericProps){var f=e.numericProps[r].value.findIndex(function(l,c){return l===t&&a[c]>=i&&a[c]<o});return f>=0?e.globalFeatureIds.value[f]:-1}else r?u=sM(e.properties,function(l){return l[r]===t},i,o):e.fields&&(u=sM(e.fields,function(l){return l.id===t},i,o));return u>=0?h8(e,u):-1}function c8(e,r){if(!e.__layers){for(var t={},n=e.properties,a=0;a<n.length;a++){var i=n[a],o=i.layerName;o&&(t[o]?t[o][1]=a:t[o]=[a,a])}e.__layers=t}return e.__layers[r]}function h8(e,r){if(!e.__ids){for(var t=[],n=e.featureIds.value,a=e.globalFeatureIds.value,i=0;i<n.length;i++)t[n[i]]=a[i];e.__ids=t}return e.__ids[r]}function sM(e,r,t,n){for(var a=t;a<n;a++)if(r(e[a],a))return a;return-1}function d8(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=p8(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function p8(e,r){if(e){if(typeof e=="string")return uM(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return uM(e,r)}}function uM(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function m8(e){var r=v8();return function(){var n=(0,lr.default)(e),a;if(r){var i=(0,lr.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,yM.default)(this,a)}}function v8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fM(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function hn(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?fM(Object(t),!0).forEach(function(n){(0,Df.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):fM(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var bv=512,g8=hn(hn({},Ev.GeoJsonLayer.defaultProps),{},{data:qr,onDataLoad:{type:"function",value:null,optional:!0,compare:!1},uniqueIdProperty:"",highlightedFeatureId:null,loaders:[kf],binary:!0}),Nf=function(e){(0,gM.default)(t,e);var r=m8(t);function t(){return(0,mM.default)(this,t),r.apply(this,arguments)}return(0,vM.default)(t,[{key:"initializeState",value:function(){(0,cn.default)((0,lr.default)(t.prototype),"initializeState",this).call(this);var a=this.context.viewport.resolution!==void 0?!1:this.props.binary;this.setState({binary:a,data:null,tileJSON:null})}},{key:"isLoaded",get:function(){return this.state&&this.state.data&&this.state.tileset&&(0,cn.default)((0,lr.default)(t.prototype),"isLoaded",this)}},{key:"updateState",value:function(a){var i,o=a.props,s=a.oldProps,u=a.context,f=a.changeFlags;f.dataChanged&&this._updateTileData(),(i=this.state)!==null&&i!==void 0&&i.data&&((0,cn.default)((0,lr.default)(t.prototype),"updateState",this).call(this,{props:o,oldProps:s,context:u,changeFlags:f}),this._setWGS84PropertyForTiles());var l=o.highlightColor;l!==s.highlightColor&&Array.isArray(l)&&this.setState({highlightColor:l})}},{key:"_updateTileData",value:function(){var n=(0,pM.default)(xv.default.mark(function i(){var o,s,u,f,l;return xv.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(o=this.props.data,s=null,!(typeof o=="string"&&!oh(o))){h.next=18;break}return u=this.props,f=u.onDataLoad,l=u.fetch,this.setState({data:null,tileJSON:null}),h.prev=5,h.next=8,l(o,{propName:"data",layer:this,loaders:[]});case 8:s=h.sent,h.next=15;break;case 11:h.prev=11,h.t0=h.catch(5),this.raiseError(h.t0,"loading TileJSON"),o=null;case 15:f&&f(s,{propName:"data",layer:this}),h.next=19;break;case 18:o.tilejson&&(s=o);case 19:s&&(o=s.tiles),this.setState({data:o,tileJSON:s});case 21:case"end":return h.stop()}},i,this,[[5,11]])}));function a(){return n.apply(this,arguments)}return a}()},{key:"_getTilesetOptions",value:function(){var a=(0,cn.default)((0,lr.default)(t.prototype),"_getTilesetOptions",this).call(this),i=this.state.tileJSON,o=this.props,s=o.minZoom,u=o.maxZoom;return i&&(Number.isFinite(i.minzoom)&&i.minzoom>s&&(a.minZoom=i.minzoom),Number.isFinite(i.maxzoom)&&(!Number.isFinite(u)||i.maxzoom<u)&&(a.maxZoom=i.maxzoom)),a}},{key:"renderLayers",value:function(){var a;return(a=this.state)!==null&&a!==void 0&&a.data?(0,cn.default)((0,lr.default)(t.prototype),"renderLayers",this).call(this):null}},{key:"getTileData",value:function(a){var i,o=this.state,s=o.data,u=o.binary,f=a.index,l=a.signal,c=ar(s,a);if(!c)return Promise.reject("Invalid URL");var h=this.getLoadOptions(),d=this.props.fetch;return h=hn(hn({},h),{},{mimeType:"application/x-protobuf",mvt:hn(hn({},(i=h)===null||i===void 0?void 0:i.mvt),{},{coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:f}),gis:u?{format:"binary"}:{}}),d(c,{propName:"data",layer:this,loadOptions:h,signal:l})}},{key:"renderSubLayers",value:function(a){var i=a.tile.index,o=i.x,s=i.y,u=i.z,f=Math.pow(2,u),l=bv/f,c=-l,h=bv*o/f,d=bv*(1-s/f),p=new ee().scale([l,c,1]);a.autoHighlight=!1,this.context.viewport.resolution||(a.modelMatrix=p,a.coordinateOrigin=[h,d,0],a.coordinateSystem=Gf.COORDINATE_SYSTEM.CARTESIAN,a.extensions=[].concat((0,dM.default)(a.extensions||[]),[new AM.ClipExtension]));var v=(0,cn.default)((0,lr.default)(t.prototype),"renderSubLayers",this).call(this,a);return this.state.binary&&!(v instanceof Ev.GeoJsonLayer)&&Gf.log.warn("renderSubLayers() must return GeoJsonLayer when using binary:true")(),v}},{key:"_updateAutoHighlight",value:function(a){var i=this.props.uniqueIdProperty,o=this.state,s=o.hoveredFeatureId,u=o.hoveredFeatureLayerName,f=a.object,l,c;f&&(l=Tv(f,i),c=lM(f));var h=this.props.highlightColor;typeof h=="function"&&(h=h(a)),(s!==l||u!==c)&&this.setState({highlightColor:h,hoveredFeatureId:l,hoveredFeatureLayerName:c})}},{key:"getPickingInfo",value:function(a){var i=(0,cn.default)((0,lr.default)(t.prototype),"getPickingInfo",this).call(this,a),o=Boolean(this.context.viewport.resolution);if(this.state.binary&&i.index!==-1){var s=a.sourceLayer.props.data;i.object=Pf(s,{globalFeatureId:i.index})}return i.object&&!o&&(i.object=hM(i.object,i.tile.bbox,this.context.viewport)),i}},{key:"getSubLayerPropsByTile",value:function(a){return{highlightedObjectIndex:this.getHighlightedObjectIndex(a),highlightColor:this.state.highlightColor}}},{key:"getHighlightedObjectIndex",value:function(a){var i=this.state,o=i.hoveredFeatureId,s=i.hoveredFeatureLayerName,u=i.binary,f=this.props,l=f.uniqueIdProperty,c=f.highlightedFeatureId,h=a.content,d=cM(c),p=cM(o)||d;if(!p)return-1;var v=d?c:o;return Array.isArray(h)?h.findIndex(function(y){var A=Tv(y,l)===v,_=d||lM(y)===s;return A&&_}):h&&u?_v(h,l,v,d?"":s):-1}},{key:"_pickObjects",value:function(a){var i=this.context,o=i.deck,s=i.viewport,u=s.width,f=s.height,l=s.x,c=s.y,h=[this.id];return o.pickObjects({x:l,y:c,width:u,height:f,layerIds:h,maxObjects:a})}},{key:"getRenderedFeatures",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this._pickObjects(a),o=new Set,s=[],u=d8(i),f;try{for(u.s();!(f=u.n()).done;){var l=f.value,c=Tv(l.object,this.props.uniqueIdProperty);c===void 0?s.push(l.object):o.has(c)||(o.add(c),s.push(l.object))}}catch(h){u.e(h)}finally{u.f()}return s}},{key:"_setWGS84PropertyForTiles",value:function(){var a=this,i="dataInWGS84",o=this.state.tileset;o.selectedTiles.forEach(function(s){s.hasOwnProperty(i)||Object.defineProperty(s,i,{get:function(){if(!s.content)return null;if(a.state.binary&&Array.isArray(s.content)&&!s.content.length)return[];var f=s.bbox;if(s._contentWGS84===void 0&&sh(f)){var l=a.state.binary?Pf(s.content):s.content;s._contentWGS84=l.map(function(c){return hM(c,f,a.context.viewport)})}return s._contentWGS84}})})}}]),t}(yr);(0,Df.default)(Nf,"layerName","MVTLayer");(0,Df.default)(Nf,"defaultProps",g8);function Tv(e,r){if(e.properties&&r)return e.properties[r];if("id"in e)return e.id}function lM(e){var r;return((r=e.properties)===null||r===void 0?void 0:r.layerName)||null}function cM(e){return e!=null&&e!==""}function hM(e,r,t){var n=hn(hn({},e),{},{geometry:{type:e.geometry.type}});return Object.defineProperty(n.geometry,"coordinates",{get:function(){var i=iM(e.geometry,r,t);return i.coordinates}}),n}var EM=m(H()),SM=m(z()),wM=m(Te()),CM=m(xe()),Sv=m(be()),wv=m(W());var bM=m(ie()),_M="0123456789bcdefghjkmnpqrstuvwxyz",TM={};for(Io=0;Io<_M.length;Io++)TM[_M.charAt(Io)]=Io;var Io,y8=-90,A8=90,_8=-180,b8=180;function T8(e){for(var r=!0,t=A8,n=y8,a=b8,i=_8,o,s=0,u=0,f=e.length;u<f;u++){var l=e[u].toLowerCase();s=TM[l];for(var c=4;c>=0;c--){var h=s>>c&1;r?(o=(a+i)/2,h===1?i=o:a=o):(o=(t+n)/2,h===1?n=o:t=o),r=!r}}return[n,i,t,a]}function xM(e){var r=T8(e),t=(0,bM.default)(r,4),n=t[0],a=t[1],i=t[2],o=t[3];return[o,i,o,n,a,n,a,i,o,i]}function x8(e){var r=E8();return function(){var n=(0,Sv.default)(e),a;if(r){var i=(0,Sv.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,CM.default)(this,a)}}function E8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var S8={getGeohash:{type:"accessor",value:function(r){return r.geohash}}},Uf=function(e){(0,wM.default)(t,e);var r=x8(t);function t(){return(0,EM.default)(this,t),r.apply(this,arguments)}return(0,SM.default)(t,[{key:"indexToBounds",value:function(){var a=this.props,i=a.data,o=a.getGeohash;return{data:i,_normalize:!1,positionFormat:"XY",getPolygon:function(u,f){return xM(o(u,f))}}}}]),t}(Pt);(0,wv.default)(Uf,"layerName","GeohashLayer");(0,wv.default)(Uf,"defaultProps",S8);return RM(Ro);})();
      return __exports__;
      });
